{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u534e\u521b\u8bc1\u5238\u91d1\u878d\u79d1\u6280\u56e2\u961f\u8363\u8a89\u51fa\u54c1 \u7ffb\u8bd1\uff1a\u738b\u6c5f\u4e30\u3001\u9648\u6d77\u51e4\u3001\u5218\u4e91\u9e4f\u3001\u4e54\u5b87 \u6821\u5bf9\uff1a\u6768\u5174\u3001\u6b66\u71a0\u9633 Docs \u2022 GitHub \u2022 Download JanusGraph\u662f\u4e00\u4e2a\u5f39\u6027\u6613\u6269\u5c55\u7684\u56fe\u5f62\u6570\u636e\u5e93\uff0c\u5b83\u4f18\u5316\u7528\u4e8e\u5b58\u50a8\u548c\u67e5\u8be2\u5305\u542b\u5206\u5e03\u5728\u591a\u673a\u5668\u96c6\u7fa4\u4e0a\u7684\u6570\u5343\u4ebf\u4e2a\u9876\u70b9\u548c\u8fb9\u7684\u56fe\u3002JanusGraph\u662f\u4e00\u4e2a\u4e8b\u52a1\u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u652f\u6301\u6570\u5343\u4e2a\u5e76\u53d1\u7528\u6237\u5b9e\u65f6\u6267\u884c\u590d\u6742\u7684\u56fe\u904d\u5386\u3002 \u6b64\u5916\uff0cJanusGraph\u8fd8\u63d0\u4f9b\u4ee5\u4e0b\u76f8\u5173\u7684\u529f\u80fd\u548c\u7279\u6027: \u2022 \u652f\u6301\u6570\u636e\u548c\u7528\u6237\u589e\u957f\u7684\u5f39\u6027\u548c\u7ebf\u6027\u6269\u5c55; \u2022 \u901a\u8fc7\u6570\u636e\u5206\u53d1\u548c\u590d\u5236\u6765\u63d0\u8fc7\u6027\u80fd\u548c\u5bb9\u9519; \u2022 \u652f\u6301\u591a\u6570\u636e\u4e2d\u5fc3\u7684\u9ad8\u53ef\u7528\u548c\u70ed\u5907\u4efd; \u2022 \u652f\u6301ACID \u548c\u6700\u7ec8\u4e00\u81f4\u6027; \u2022 \u652f\u6301\u591a\u79cd\u540e\u7aef\u5b58\u50a8\uff1a \u2022 Apache Cassandra\u00ae \u2022 Apache HBase\u00ae \u2022 Google Cloud Bigtable \u2022 Oracle BerkeleyDB \u2022 \u652f\u6301\u5168\u5c40\u7684\u56fe\u6570\u636e\u5206\u6790\uff0c\u62a5\u8868\u4ee5\u53ca\u548c\u5982\u4e0b\u5927\u6570\u636e\u5e73\u53f0\u7684ETL\u96c6\u6210\uff1a \u2022 Apache Spark\u2122 \u2022 Apache Giraph\u2122 \u2022 Apache Hadoop\u00ae \u2022 \u652f\u6301geo, \u6570\u503c\u8303\u56f4\u4ee5\u53ca\u901a\u8fc7\u5982\u4e0b\u5de5\u5177\u8fdb\u884c\u5168\u6587\u68c0\u7d22\uff1a \u2022 ElasticSearch\u2122 \u2022 Apache Solr\u2122 \u2022 Apache Lucene\u00ae \u2022 \u652f\u6301\u4e0eApache TinkerPop\u56fe\u6808\u8fdb\u884c\u539f\u751f\u96c6\u6210\uff1a \u2022 Gremlin graph query language \u2022 Gremlin graph server \u2022 Gremlin applications \u2022 \u5728Apache 2 license\u4e0b\u5f00\u6e90 \u2022 \u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u5de5\u5177\u6765\u53ef\u89c6\u5316\u5b58\u50a8\u5728JanusGraph\u4e2d\u7684\u56fe\u6570\u636e\uff1a \u2022 Cytoscape \u2022 Gephi plugin for Apache TinkerPop \u2022 Graphexp \u2022 KeyLines by Cambridge Intelligence \u2022 Linkurious \u4f60\u53ef\u4ee5\u4eceGithub\u4e0b\u8f7dJanusGraph Read the JanusGraph documentation and join the users or developers mailing lists. \u9605\u8bfbJanusGraph\u5b98\u65b9\u6587\u6863\u5e76\u4e14\u52a0\u5165\u7528\u6237\u6216\u8005\u5f00\u53d1\u8005\u90ae\u4ef6\u7ec4. \u6839\u636eJanusGraph\u5165\u95e8\u6307\u5357\u9010\u6b65\u5f00\u59cb \u5173\u4e8e JanusGraph\u662fLinux\u57fa\u91d1\u4f1a\u4e0b\u9762\u7684\u4e00\u4e2a\u9879\u76ee\u5de5\u7a0b\uff0c\u5176\u4e2d\u53c2\u4e0e\u8005\u5305\u62ec\uff1aExpero, Google, GRAKN.AI, Hortonworks, IBM and Amazon \u4e1a\u52a1\u6f14\u793a \u4ee5\u4e0b\u662f\u9879\u76ee\u6f14\u793a\u7684\u6587\u7a3f: DataWorksJun2017: Large Scale Graph Analytics with JanusGraph , P. Taylor Goetz, 2017.06.13 HBaseCon2017 Community-Driven Graphs with JanusGraph , Jing Chen He Jason Plurad, 2017.06.12 JanusGraph\u7528\u6237 \u4ee5\u4e0b\u7528\u6237\u5c06JanusGraph\u7528\u4e8e\u751f\u6210\u73af\u5883. CELUM COMPOSE FINE GDATA 360 redhat TimesInternet","title":"\u9996\u9875"},{"location":"advanced_topics/advanced_schema/","text":"30 schema\u7684\u9ad8\u7ea7\u7279\u6027 30.1 Static Vertices \u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u9759\u6001\uff0c\u8fd9\u610f\u5473\u7740\u5177\u6709\u8be5\u6807\u7b7e\u7684\u9876\u70b9\u4e0d\u80fd\u5728\u521b\u5efa\u5b83\u4eec\u7684\u4e8b\u52a1\u4e4b\u5916\u88ab\u4fee\u6539\u3002 mgmt = graph.openManagement() tweet = mgmt.makeVertexLabel('tweet').setStatic().make() mgmt.commit() \u9759\u6001\u9876\u70b9\u6807\u7b7e\u662f\u63a7\u5236\u6570\u636e\u751f\u547d\u5468\u671f\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u56fe\u5f62\u4e2d\u65f6\u5f88\u6709\u7528\uff0c\u56fe\u5f62\u521b\u5efa\u540e\u4e0d\u5e94\u4fee\u6539\u8fd9\u4e9b\u6570\u636e\u3002 30.2 Edge and Vertex TTL \u8fb9\u53ef\u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u8bbe\u7f6e\u751f\u547d\u5468\u671f\u3002\u6807\u7b7e\u5728\u521d\u59cb\u521b\u5efa\u901a\u8fc7\u540e\uff0c\u5f53TTL\u8fc7\u671f\u540e\u5e26\u6709\u6b64\u7c7b\u6807\u7b7e\u7684\u8fb9\u548c\u9876\u70b9\u4f1a\u88ab\u81ea\u52a8\u79fb\u9664\u3002\u5f53\u4ec5\u4ec5\u662f\u4e34\u65f6\u52a0\u8f7d\u5927\u91cf\u6570\u636e\u5230\u56fe\u65f6TTL\u662f\u975e\u5e38\u6709\u7528\u7684\u3002\u5b9a\u4e49TTL\u6d88\u9664\u4e86\u624b\u52a8\u6e05\u7406\u7684\u9700\u8981\uff0c\u5e76\u4e14\u975e\u5e38\u6709\u6548\u5730\u5904\u7406\u4e86\u5220\u9664\u7684\u9700\u6c42\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8eTTL\u4e8b\u4ef6\u7684\u8fb9\uff08\u4f8b\u5982\u7528\u6237\u9875\u9762\u8bbf\u95ee\uff09\u5728\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\u8fdb\u884c\u6c47\u603b\u6216\u8005\u4ec5\u4ec5\u4e0d\u518d\u9700\u8981\u8fdb\u884c\u5206\u6790\u6216\u64cd\u4f5c\u67e5\u8be2\u5904\u7406\u65f6\uff0c\u8fd9\u5c06\u662f\u6709\u610f\u4e49\u7684\u3002 \u4ee5\u4e0b\u5b58\u50a8\u540e\u7aef\u652f\u6301\u8fb9\u548c\u9876\u70b9TTL\uff1a - Cassandra - HBase 30.2.1 Edge TTL \u8fb9\u7684\u751f\u547d\u5468\u671f\u57fa\u4e8e\u6bcf\u4e2a\u8fb9\u6807\u7b7e\u5b9a\u4e49\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u6807\u7b7e\u7684\u6240\u6709\u8fb9\u5177\u6709\u76f8\u540c\u7684\u751f\u547d\u5468\u671f\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5355\u5143\u7ea7\u522b\u751f\u547d\u5468\u671f\u3002\u5f53\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\uff1a mgmt = graph.openManagement() visits = mgmt.makeEdgeLabel('visits').make() mgmt.setTTL(visits, Duration.ofDays(7)) mgmt.commit() \u6ce8\u610f\uff0c\u4fee\u6539\u8fb9\u4f1a\u91cd\u7f6e\u8fb9\u7684\u751f\u547d\u5468\u671f\u3002\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fb9\u6807\u7b7e\u7684\u751f\u547d\u5468\u671f\u53ef\u4ee5\u6539\u53d8\uff0c\u4f46\u66f4\u6539\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u4f20\u64ad\u5230\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\uff0c\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u540c\u4e00\u4e2a\u6807\u7b7e\u53ef\u4ee5\u4e34\u65f6\u4f7f\u7528\u4e24\u4e2a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u3002 30.2.2. Property TTL \u5c5e\u6027\u7684\u751f\u547d\u5468\u671f\u4e0e\u8fb9\u751f\u547d\u5468\u671f\u975e\u5e38\u76f8\u4f3c\uff0c\u5e76\u4e14\u57fa\u4e8e\u6bcf\u4e2a\u5c5e\u6027\u952e\u5b9a\u4e49\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u952e\u7684\u6240\u6709\u5c5e\u6027\u5177\u6709\u76f8\u540c\u7684\u751f\u5b58\u65f6\u95f4\u3002\u8bf7\u6ce8\u610f\uff0c\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5355\u5143\u7ea7\u522b\u751f\u547d\u5468\u671f\u3002\u76ee\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\u8fd9\u4e00\u70b9: mgmt = graph.openManagement() sensor = mgmt.makePropertyKey('sensor').cardinality(Cardinality.LIST).dataType(Double.class).make() mgmt.setTTL(sensor, Duration.ofDays(21)) mgmt.commit() \u4e0e\u8fb9\u7684\u751f\u547d\u5468\u671f\u4e00\u6837\uff0c\u4fee\u6539\u73b0\u6709\u5c5e\u6027\u4f1a\u91cd\u7f6e\u8be5\u5c5e\u6027\u7684\u751f\u547d\u5468\u671f\uff0c\u5e76\u4e14\u4fee\u6539\u5c5e\u6027\u952e\u7684\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u751f\u6548\u3002 30.2.3. Vertex TTL \u9876\u70b9\u7684\u751f\u547d\u5468\u671f\u662f\u57fa\u4e8e\u6bcf\u4e2a\u9876\u70b9\u6807\u7b7e\u5b9a\u4e49\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u6807\u7b7e\u7684\u6240\u6709\u9876\u70b9\u5177\u6709\u76f8\u540c\u7684\u751f\u5b58\u65f6\u95f4\u3002\u914d\u7f6e\u7684\u751f\u547d\u5468\u671f\u5e94\u7528\u4e8e\u5176\u9876\u70b9\uff0c\u5c5e\u6027\u548c\u6240\u6709\u7684\u5165\u5c04\u8fb9\uff0c\u4ee5\u786e\u4fdd\u4ece\u56fe\u4e2d\u5220\u9664\u6574\u4e2a\u9876\u70b9\u3002\u56e0\u6b64\uff0c\u5fc5\u987b\u5148\u5c06\u9876\u70b9\u6807\u7b7e\u5b9a\u4e49\u4e3a\u9759\u6001\uff0c\u7136\u540e\u624d\u80fd\u8bbe\u7f6e\u751f\u547d\u5468\u671f\u4ee5\u6392\u9664\u4efb\u4f55\u53ef\u80fd\u662f\u9876\u70b9\u751f\u547d\u5468\u671f\u5931\u6548\u7684\u4fee\u6539\u3002\u9876\u70b9\u751f\u547d\u5468\u671f\u4ec5\u9002\u7528\u4e8e\u9759\u6001\u9876\u70b9\u6807\u7b7e\u3002\u8981\u6ce8\u610f\u7684\u662f\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5b58\u50a8\u7ea7\u522b\u7684\u751f\u547d\u5468\u671f\u3002\u76ee\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\u3002 mgmt = graph.openManagement() tweet = mgmt.makeVertexLabel('tweet').setStatic().make() mgmt.setTTL(tweet, Duration.ofHours(36)) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u53ef\u4ee5\u4fee\u6539\u9876\u70b9\u6807\u7b7e\u7684\u751f\u547d\u5468\u671f\uff0c\u4f46\u6b64\u66f4\u6539\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u624d\u80fd\u4f20\u64ad\u5230\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\uff0c\u8fd9\u610f\u5473\u7740\u4e24\u4e2a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u53ef\u80fd\u4f5c\u7528\u4e8e\u540c\u4e00\u6807\u7b7e\u3002 30.3. Multi-Properties \u6b63\u5982\u7b2c5\u7ae0\u201c\u67b6\u6784\u548c\u6570\u636e\u5efa\u6a21\u201d\u4e2d\u6240\u8ba8\u8bba\u7684\uff0cJanusGraph\u652f\u6301\u5177\u6709SET\u548cLIST\u57fa\u6570\u7684\u5c5e\u6027\u952e\u3002\u56e0\u6b64\uff0cJanusGraph\u5728\u5355\u4e2a\u9876\u70b9\u4e0a\u652f\u6301\u5177\u6709\u76f8\u540c\u952e\u7684\u591a\u4e2a\u5c5e\u6027\u3002\u6b64\u5916\uff0cJanusGraph\u5bf9\u5c5e\u6027\u7684\u5904\u7406\u7c7b\u4f3c\u4e8e\u5bf9\u8fb9\u7684\u5904\u7406\uff0c\u5728\u5c5e\u6027\u4e0a\u5141\u8bb8\u4f7f\u7528\u5355\u503c\u5c5e\u6027\u6ce8\u91ca\uff0c\u5982\u4e0b\u9762\u7684\u793a\u4f8b\u6240\u793a\uff1a mgmt = graph.openManagement() mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.LIST).make() mgmt.commit() v = graph.addVertex() p1 = v.property('name', 'Dan LaRocque') p1.property('source', 'web') p2 = v.property('name', 'dalaro') p2.property('source', 'github') graph.tx().commit() v.properties('name') == Iterable over all name properties \u8fd9\u4e9b\u7279\u6027\u5728\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u90fd\u5f88\u6709\u7528\uff0c\u4f8b\u5982\u9700\u8981\u5411\u5c5e\u6027\u9644\u52a0\u51fa\u5904\u4fe1\u606f(\u4f8b\u5982\u8c01\u6dfb\u52a0\u4e86\u5c5e\u6027\u3001\u4f55\u65f6\u4ee5\u53ca\u4ece\u4f55\u5904\u6dfb\u52a0?)\u3002\u5982\u7b2c31\u7ae0Eventually-Consistent Storage Backends\uff08\u6700\u7ec8\u5b58\u50a8\u4e00\u81f4\u6027\uff09\u6240\u8ff0\uff0c\u652f\u6301\u8ddf\u9ad8\u7684\u57fa\u6570\u5c5e\u6027\u548c\u5c5e\u6027\u4e0a\u7684\u6ce8\u91ca\u5728\u9ad8\u5e76\u53d1\u6027\uff0c\u6c34\u5e73\u6269\u5c55\u7684\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u4e5f\u5f88\u6709\u7528\u3002 \u5c5e\u6027\u652f\u6301\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u548c\u5168\u5c40\u56fe\u7d22\u5f15\uff0c\u5176\u65b9\u5f0f\u4e0e\u8fb9\u652f\u6301\u7684\u65b9\u5f0f\u76f8\u540c\u3002\u6709\u5173\u5b9a\u4e49\u8fb9\u7684\u7d22\u5f15\u4fe1\u606f\uff0c\u8bf7\u53c2\u800311\u7ae0\u201c Indexing for Better Performance\u201d\uff0c\u5e76\u4f7f\u7528\u76f8\u5e94\u7684API\u65b9\u6cd5\u4e3a\u5c5e\u6027\u5b9a\u4e49\u76f8\u540c\u7684\u7d22\u5f15\u3002 30.4. Unidirected Edges \u5355\u5411\u8fb9\u662f\u53ea\u80fd\u6cbf\u8f93\u51fa\u65b9\u5411\u904d\u5386\u7684\u8fb9\u3002\u5355\u5411\u8fb9\u5177\u6709\u8f83\u4f4e\u7684\u5b58\u50a8\u5360\u7528\uff0c\u4f46\u4ed6\u4eec\u652f\u6301\u7684\u904d\u5386\u7c7b\u578b\u6709\u9650\u3002\u5355\u5411\u8fb9\u5728\u6982\u5ff5\u4e0a\u7c7b\u4f3c\u4e8e\u4e07\u7ef4\u7f51\u7684\u8d85\u94fe\u63a5\uff0c\u65e2\u8f93\u51fa\u9876\u70b9\u53ef\u4ee5\u901a\u8fc7\u8fb9\u904d\u5386\uff0c\u4f46\u8f93\u5165\u9876\u70b9\u4e0d\u77e5\u9053\u5b83\u7684\u5b58\u5728\u3002 mgmt = graph.openManagement() mgmt.makeEdgeLabel('author').unidirected().make() mgmt.commit() \u6ce8\u610f\uff0c\u5f53\u5b83\u4eec\u8f93\u5165\u7684\u9876\u70b9\u88ab\u5220\u9664\u65f6\uff0c\u5355\u5411\u8fb9\u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u660e\u786e\u7684\u68c0\u67e5\u4e8b\u7269\u4e2d\u7684\u9876\u70b9\u7684\u5b58\u5728\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u4e0d\u4e00\u81f4\u4e0d\u4f1a\u5728\u67e5\u8be2\u65f6\u51fa\u73b0\u6216\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002\u8bf7\u53c2\u89c1 31.2.2\u8282 \u201cGhost Vertices\u201d\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\u3002","title":"38.JanusGraph\u76d1\u63a7"},{"location":"advanced_topics/advanced_schema/#30-schema","text":"","title":"30 schema\u7684\u9ad8\u7ea7\u7279\u6027"},{"location":"advanced_topics/advanced_schema/#301-static-vertices","text":"\u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u9759\u6001\uff0c\u8fd9\u610f\u5473\u7740\u5177\u6709\u8be5\u6807\u7b7e\u7684\u9876\u70b9\u4e0d\u80fd\u5728\u521b\u5efa\u5b83\u4eec\u7684\u4e8b\u52a1\u4e4b\u5916\u88ab\u4fee\u6539\u3002 mgmt = graph.openManagement() tweet = mgmt.makeVertexLabel('tweet').setStatic().make() mgmt.commit() \u9759\u6001\u9876\u70b9\u6807\u7b7e\u662f\u63a7\u5236\u6570\u636e\u751f\u547d\u5468\u671f\u7684\u4e00\u79cd\u65b9\u6cd5\uff0c\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u56fe\u5f62\u4e2d\u65f6\u5f88\u6709\u7528\uff0c\u56fe\u5f62\u521b\u5efa\u540e\u4e0d\u5e94\u4fee\u6539\u8fd9\u4e9b\u6570\u636e\u3002","title":"30.1 Static Vertices"},{"location":"advanced_topics/advanced_schema/#302-edge-and-vertex-ttl","text":"\u8fb9\u53ef\u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u8bbe\u7f6e\u751f\u547d\u5468\u671f\u3002\u6807\u7b7e\u5728\u521d\u59cb\u521b\u5efa\u901a\u8fc7\u540e\uff0c\u5f53TTL\u8fc7\u671f\u540e\u5e26\u6709\u6b64\u7c7b\u6807\u7b7e\u7684\u8fb9\u548c\u9876\u70b9\u4f1a\u88ab\u81ea\u52a8\u79fb\u9664\u3002\u5f53\u4ec5\u4ec5\u662f\u4e34\u65f6\u52a0\u8f7d\u5927\u91cf\u6570\u636e\u5230\u56fe\u65f6TTL\u662f\u975e\u5e38\u6709\u7528\u7684\u3002\u5b9a\u4e49TTL\u6d88\u9664\u4e86\u624b\u52a8\u6e05\u7406\u7684\u9700\u8981\uff0c\u5e76\u4e14\u975e\u5e38\u6709\u6548\u5730\u5904\u7406\u4e86\u5220\u9664\u7684\u9700\u6c42\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8eTTL\u4e8b\u4ef6\u7684\u8fb9\uff08\u4f8b\u5982\u7528\u6237\u9875\u9762\u8bbf\u95ee\uff09\u5728\u4e00\u6bb5\u65f6\u95f4\u4e4b\u540e\u8fdb\u884c\u6c47\u603b\u6216\u8005\u4ec5\u4ec5\u4e0d\u518d\u9700\u8981\u8fdb\u884c\u5206\u6790\u6216\u64cd\u4f5c\u67e5\u8be2\u5904\u7406\u65f6\uff0c\u8fd9\u5c06\u662f\u6709\u610f\u4e49\u7684\u3002 \u4ee5\u4e0b\u5b58\u50a8\u540e\u7aef\u652f\u6301\u8fb9\u548c\u9876\u70b9TTL\uff1a - Cassandra - HBase","title":"30.2  Edge and Vertex TTL"},{"location":"advanced_topics/advanced_schema/#3021-edge-ttl","text":"\u8fb9\u7684\u751f\u547d\u5468\u671f\u57fa\u4e8e\u6bcf\u4e2a\u8fb9\u6807\u7b7e\u5b9a\u4e49\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u6807\u7b7e\u7684\u6240\u6709\u8fb9\u5177\u6709\u76f8\u540c\u7684\u751f\u547d\u5468\u671f\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5355\u5143\u7ea7\u522b\u751f\u547d\u5468\u671f\u3002\u5f53\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\uff1a mgmt = graph.openManagement() visits = mgmt.makeEdgeLabel('visits').make() mgmt.setTTL(visits, Duration.ofDays(7)) mgmt.commit() \u6ce8\u610f\uff0c\u4fee\u6539\u8fb9\u4f1a\u91cd\u7f6e\u8fb9\u7684\u751f\u547d\u5468\u671f\u3002\u53e6\u5916\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fb9\u6807\u7b7e\u7684\u751f\u547d\u5468\u671f\u53ef\u4ee5\u6539\u53d8\uff0c\u4f46\u66f4\u6539\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u4f20\u64ad\u5230\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\uff0c\u8fd9\u5c31\u610f\u5473\u7740\uff0c\u540c\u4e00\u4e2a\u6807\u7b7e\u53ef\u4ee5\u4e34\u65f6\u4f7f\u7528\u4e24\u4e2a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u3002","title":"30.2.1  Edge TTL"},{"location":"advanced_topics/advanced_schema/#3022-property-ttl","text":"\u5c5e\u6027\u7684\u751f\u547d\u5468\u671f\u4e0e\u8fb9\u751f\u547d\u5468\u671f\u975e\u5e38\u76f8\u4f3c\uff0c\u5e76\u4e14\u57fa\u4e8e\u6bcf\u4e2a\u5c5e\u6027\u952e\u5b9a\u4e49\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u952e\u7684\u6240\u6709\u5c5e\u6027\u5177\u6709\u76f8\u540c\u7684\u751f\u5b58\u65f6\u95f4\u3002\u8bf7\u6ce8\u610f\uff0c\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5355\u5143\u7ea7\u522b\u751f\u547d\u5468\u671f\u3002\u76ee\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\u8fd9\u4e00\u70b9: mgmt = graph.openManagement() sensor = mgmt.makePropertyKey('sensor').cardinality(Cardinality.LIST).dataType(Double.class).make() mgmt.setTTL(sensor, Duration.ofDays(21)) mgmt.commit() \u4e0e\u8fb9\u7684\u751f\u547d\u5468\u671f\u4e00\u6837\uff0c\u4fee\u6539\u73b0\u6709\u5c5e\u6027\u4f1a\u91cd\u7f6e\u8be5\u5c5e\u6027\u7684\u751f\u547d\u5468\u671f\uff0c\u5e76\u4e14\u4fee\u6539\u5c5e\u6027\u952e\u7684\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u751f\u6548\u3002","title":"30.2.2. Property TTL"},{"location":"advanced_topics/advanced_schema/#3023-vertex-ttl","text":"\u9876\u70b9\u7684\u751f\u547d\u5468\u671f\u662f\u57fa\u4e8e\u6bcf\u4e2a\u9876\u70b9\u6807\u7b7e\u5b9a\u4e49\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u6807\u7b7e\u7684\u6240\u6709\u9876\u70b9\u5177\u6709\u76f8\u540c\u7684\u751f\u5b58\u65f6\u95f4\u3002\u914d\u7f6e\u7684\u751f\u547d\u5468\u671f\u5e94\u7528\u4e8e\u5176\u9876\u70b9\uff0c\u5c5e\u6027\u548c\u6240\u6709\u7684\u5165\u5c04\u8fb9\uff0c\u4ee5\u786e\u4fdd\u4ece\u56fe\u4e2d\u5220\u9664\u6574\u4e2a\u9876\u70b9\u3002\u56e0\u6b64\uff0c\u5fc5\u987b\u5148\u5c06\u9876\u70b9\u6807\u7b7e\u5b9a\u4e49\u4e3a\u9759\u6001\uff0c\u7136\u540e\u624d\u80fd\u8bbe\u7f6e\u751f\u547d\u5468\u671f\u4ee5\u6392\u9664\u4efb\u4f55\u53ef\u80fd\u662f\u9876\u70b9\u751f\u547d\u5468\u671f\u5931\u6548\u7684\u4fee\u6539\u3002\u9876\u70b9\u751f\u547d\u5468\u671f\u4ec5\u9002\u7528\u4e8e\u9759\u6001\u9876\u70b9\u6807\u7b7e\u3002\u8981\u6ce8\u610f\u7684\u662f\u540e\u7aef\u5fc5\u987b\u652f\u6301\u5b58\u50a8\u7ea7\u522b\u7684\u751f\u547d\u5468\u671f\u3002\u76ee\u524d\u53ea\u6709Cassandra\u548cHBase\u652f\u6301\u3002 mgmt = graph.openManagement() tweet = mgmt.makeVertexLabel('tweet').setStatic().make() mgmt.setTTL(tweet, Duration.ofHours(36)) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u53ef\u4ee5\u4fee\u6539\u9876\u70b9\u6807\u7b7e\u7684\u751f\u547d\u5468\u671f\uff0c\u4f46\u6b64\u66f4\u6539\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u624d\u80fd\u4f20\u64ad\u5230\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\uff0c\u8fd9\u610f\u5473\u7740\u4e24\u4e2a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u53ef\u80fd\u4f5c\u7528\u4e8e\u540c\u4e00\u6807\u7b7e\u3002","title":"30.2.3. Vertex TTL"},{"location":"advanced_topics/advanced_schema/#303-multi-properties","text":"\u6b63\u5982\u7b2c5\u7ae0\u201c\u67b6\u6784\u548c\u6570\u636e\u5efa\u6a21\u201d\u4e2d\u6240\u8ba8\u8bba\u7684\uff0cJanusGraph\u652f\u6301\u5177\u6709SET\u548cLIST\u57fa\u6570\u7684\u5c5e\u6027\u952e\u3002\u56e0\u6b64\uff0cJanusGraph\u5728\u5355\u4e2a\u9876\u70b9\u4e0a\u652f\u6301\u5177\u6709\u76f8\u540c\u952e\u7684\u591a\u4e2a\u5c5e\u6027\u3002\u6b64\u5916\uff0cJanusGraph\u5bf9\u5c5e\u6027\u7684\u5904\u7406\u7c7b\u4f3c\u4e8e\u5bf9\u8fb9\u7684\u5904\u7406\uff0c\u5728\u5c5e\u6027\u4e0a\u5141\u8bb8\u4f7f\u7528\u5355\u503c\u5c5e\u6027\u6ce8\u91ca\uff0c\u5982\u4e0b\u9762\u7684\u793a\u4f8b\u6240\u793a\uff1a mgmt = graph.openManagement() mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.LIST).make() mgmt.commit() v = graph.addVertex() p1 = v.property('name', 'Dan LaRocque') p1.property('source', 'web') p2 = v.property('name', 'dalaro') p2.property('source', 'github') graph.tx().commit() v.properties('name') == Iterable over all name properties \u8fd9\u4e9b\u7279\u6027\u5728\u8bb8\u591a\u5e94\u7528\u7a0b\u5e8f\u4e2d\u90fd\u5f88\u6709\u7528\uff0c\u4f8b\u5982\u9700\u8981\u5411\u5c5e\u6027\u9644\u52a0\u51fa\u5904\u4fe1\u606f(\u4f8b\u5982\u8c01\u6dfb\u52a0\u4e86\u5c5e\u6027\u3001\u4f55\u65f6\u4ee5\u53ca\u4ece\u4f55\u5904\u6dfb\u52a0?)\u3002\u5982\u7b2c31\u7ae0Eventually-Consistent Storage Backends\uff08\u6700\u7ec8\u5b58\u50a8\u4e00\u81f4\u6027\uff09\u6240\u8ff0\uff0c\u652f\u6301\u8ddf\u9ad8\u7684\u57fa\u6570\u5c5e\u6027\u548c\u5c5e\u6027\u4e0a\u7684\u6ce8\u91ca\u5728\u9ad8\u5e76\u53d1\u6027\uff0c\u6c34\u5e73\u6269\u5c55\u7684\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\u4e5f\u5f88\u6709\u7528\u3002 \u5c5e\u6027\u652f\u6301\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u548c\u5168\u5c40\u56fe\u7d22\u5f15\uff0c\u5176\u65b9\u5f0f\u4e0e\u8fb9\u652f\u6301\u7684\u65b9\u5f0f\u76f8\u540c\u3002\u6709\u5173\u5b9a\u4e49\u8fb9\u7684\u7d22\u5f15\u4fe1\u606f\uff0c\u8bf7\u53c2\u800311\u7ae0\u201c Indexing for Better Performance\u201d\uff0c\u5e76\u4f7f\u7528\u76f8\u5e94\u7684API\u65b9\u6cd5\u4e3a\u5c5e\u6027\u5b9a\u4e49\u76f8\u540c\u7684\u7d22\u5f15\u3002","title":"30.3. Multi-Properties"},{"location":"advanced_topics/advanced_schema/#304-unidirected-edges","text":"\u5355\u5411\u8fb9\u662f\u53ea\u80fd\u6cbf\u8f93\u51fa\u65b9\u5411\u904d\u5386\u7684\u8fb9\u3002\u5355\u5411\u8fb9\u5177\u6709\u8f83\u4f4e\u7684\u5b58\u50a8\u5360\u7528\uff0c\u4f46\u4ed6\u4eec\u652f\u6301\u7684\u904d\u5386\u7c7b\u578b\u6709\u9650\u3002\u5355\u5411\u8fb9\u5728\u6982\u5ff5\u4e0a\u7c7b\u4f3c\u4e8e\u4e07\u7ef4\u7f51\u7684\u8d85\u94fe\u63a5\uff0c\u65e2\u8f93\u51fa\u9876\u70b9\u53ef\u4ee5\u901a\u8fc7\u8fb9\u904d\u5386\uff0c\u4f46\u8f93\u5165\u9876\u70b9\u4e0d\u77e5\u9053\u5b83\u7684\u5b58\u5728\u3002 mgmt = graph.openManagement() mgmt.makeEdgeLabel('author').unidirected().make() mgmt.commit() \u6ce8\u610f\uff0c\u5f53\u5b83\u4eec\u8f93\u5165\u7684\u9876\u70b9\u88ab\u5220\u9664\u65f6\uff0c\u5355\u5411\u8fb9\u4e0d\u4f1a\u81ea\u52a8\u5220\u9664\u3002\u7528\u6237\u5fc5\u987b\u901a\u8fc7\u660e\u786e\u7684\u68c0\u67e5\u4e8b\u7269\u4e2d\u7684\u9876\u70b9\u7684\u5b58\u5728\uff0c\u4ee5\u786e\u4fdd\u8fd9\u4e9b\u4e0d\u4e00\u81f4\u4e0d\u4f1a\u5728\u67e5\u8be2\u65f6\u51fa\u73b0\u6216\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u3002\u8bf7\u53c2\u89c1 31.2.2\u8282 \u201cGhost Vertices\u201d\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\u3002","title":"30.4. Unidirected Edges"},{"location":"advanced_topics/bulk_loading/","text":"34\u3001 \u6279\u91cf\u52a0\u8f7d \u6709\u8bb8\u591a\u914d\u7f6e\u9009\u9879\u548c\u5de5\u5177\u53ef\u4ee5\u66f4\u6709\u6548\u5730\u5c06\u5927\u91cf\u56fe\u5f62\u6570\u636e\u63d0\u53d6\u5230JanusGraph\u4e2d\u3002\u4e0e\u901a\u8fc7\u5355\u4e2a\u4e8b\u52a1\u6dfb\u52a0\u5c11\u91cf\u6570\u636e\u7684\u9ed8\u8ba4\u4e8b\u52a1\u52a0\u8f7d\u76f8\u6bd4\uff0c\u8fd9\u79cd\u63d0\u53d6\u88ab\u79f0\u4e3a\u6279\u91cf\u52a0\u8f7d\u3002 \u6709\u8bb8\u591a\u7528\u4f8b\u5c06\u6570\u636e\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\uff0c\u5305\u62ec\uff1a - \u5c06JanusGraph\u5f15\u5165\u5177\u6709\u73b0\u6709\u6570\u636e\u7684\u73b0\u6709\u73af\u5883\uff0c\u5e76\u5c06\u6b64\u6570\u636e\u8fc1\u79fb\u6216\u590d\u5236\u5230\u65b0\u7684JanusGraph\u96c6\u7fa4\u4e2d\u3002 - \u4f7f\u7528JanusGraph\u4f5c\u4e3aETL\u8fc7\u7a0b\u7684\u7ec8\u70b9\u3002 - \u5c06\u73b0\u6709\u6216\u5916\u90e8\u56fe\u5f62\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u516c\u5f00\u53ef\u7528\u7684RDF\u6570\u636e\u96c6\uff09\u6dfb\u52a0\u5230\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u96c6\u7fa4\u3002 - \u4f7f\u7528\u56fe\u8868\u5206\u6790\u4f5c\u4e1a\u7684\u7ed3\u679c\u66f4\u65b0JanusGraph\u56fe\u8868\u3002 \u672c\u9875\u4ecb\u7ecd\u4e86\u5728JanusGraph\u4e2d\u4f7f\u6279\u91cf\u52a0\u8f7d\u66f4\u9ad8\u6548\u7684\u914d\u7f6e\u9009\u9879\u548c\u5de5\u5177\u3002\u5728\u7ee7\u7eed\u64cd\u4f5c\u4e4b\u524d\uff0c\u8bf7\u4ed4\u7ec6\u89c2\u5bdf\u6bcf\u4e2a\u9009\u9879\u7684\u9650\u5236\u548c\u5047\u8bbe\uff0c\u4ee5\u907f\u514d\u6570\u636e\u4e22\u5931\u6216\u6570\u636e\u635f\u574f\u3002 \u672c\u6587\u6863\u91cd\u70b9\u4ecb\u7ecdJanusGraph\u7684\u5177\u4f53\u4f18\u5316\u3002\u6b64\u5916\uff0c\u8003\u8651\u6539\u8fdb\u6240\u9009\u7684\u5b58\u50a8\u540e\u7aef\u548c\uff08\u53ef\u9009\uff09\u7d22\u5f15\u540e\u7aef\u4ee5\u5b9e\u73b0\u9ad8\u5199\u5165\u6027\u80fd\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u76f8\u5e94\u540e\u7aef\u7684\u6587\u6863\u3002 34.1 \u914d\u7f6e\u9009\u9879 34.1.1 \u6279\u91cf\u52a0\u8f7d storage.batch-loading\u5bf9\u5927\u591a\u6570\u5e94\u7528\u7a0b\u5e8f\u800c\u8a00\uff0c\u542f\u7528\u914d\u7f6e\u9009\u9879\u5c06\u5bf9\u6279\u91cf\u52a0\u8f7d\u65f6\u95f4\u4ea7\u751f\u6700\u5927\u7684\u79ef\u6781\u5f71\u54cd\u3002\u542f\u7528\u6279\u91cf\u52a0\u8f7d\u4f1a\u5728\u8bb8\u591a\u5730\u65b9\u7981\u7528JanusGraph\u5185\u90e8\u4e00\u81f4\u6027\u68c0\u67e5\u3002\u6700\u91cd\u8981\u7684\u662f\uff0c\u5b83\u7981\u7528\u9501\u5b9a\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cJanusGraph\u5047\u8bbe\u8981\u52a0\u8f7d\u5230JanusGraph\u4e2d\u7684\u6570\u636e\u4e0e\u56fe\u5f62\u4e00\u81f4\uff0c\u56e0\u6b64\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\u800c\u7981\u7528\u81ea\u5df1\u7684\u68c0\u67e5\u3002 \u5728\u8bb8\u591a\u6279\u91cf\u52a0\u8f7d\u65b9\u6848\u4e2d\uff0c\u5728\u52a0\u8f7d\u6570\u636e\u4e4b\u524d\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u7136\u540e\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u4e2d\u65f6\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u8981\u4fbf\u5b9c\u5f97\u591a\u3002storage.batch-loading\u7531\u4e8e\u6b64\u89c2\u5bdf\uff0c\u914d\u7f6e\u9009\u9879\u5b58\u5728\u3002 \u5728\u8bb8\u591a\u6279\u91cf\u52a0\u8f7d\u573a\u666f\u4e2d\uff0c\u5728\u52a0\u8f7d\u6570\u636e\u4e4b\u524d\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u8981\u6bd4\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u65f6\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u4fbf\u5b9c\u5f97\u591a\u3002\u7531\u4e8e\u6b64\u89c2\u5bdfstorage.batch-loading\uff0c\u914d\u7f6e\u9009\u9879\u5b58\u5728\u3002 \u4f8b\u5982\uff0c\u8003\u8651\u5c06\u73b0\u6709\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\u7684\u7528\u4f8b\u3002\u6b64\u5916\uff0c\u5047\u8bbe\u7528\u6237\u540d\u5c5e\u6027\u952e\u5177\u6709\u5728\u5176\u4e0a\u5b9a\u4e49\u7684\u552f\u4e00\u590d\u5408\u7d22\u5f15\uff0c\u5373\u7528\u6237\u540d\u5728\u6574\u4e2a\u56fe\u5f62\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002\u5982\u679c\u4ece\u5176\u4ed6\u6570\u636e\u5e93\u5bfc\u5165\u7528\u6237\u914d\u7f6e\u6587\u4ef6\uff0c\u5219\u53ef\u80fd\u5df2\u4fdd\u8bc1\u7528\u6237\u540d\u552f\u4e00\u6027\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5219\u6309\u540d\u79f0\u5bf9\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u5e8f\u5e76\u8fc7\u6ee4\u6389\u91cd\u590d\u9879\u6216\u7f16\u5199\u6267\u884c\u6b64\u7c7b\u8fc7\u6ee4\u7684Hadoop\u4f5c\u4e1a\u5f88\u7b80\u5355\u3002\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u7528storage.batch-loading\u54ea\u4e2a\u663e\u7740\u51cf\u5c11\u6279\u91cf\u52a0\u8f7d\u65f6\u95f4\uff0c\u56e0\u4e3aJanusGraph\u4e0d\u5fc5\u68c0\u67e5\u6bcf\u4e2a\u6dfb\u52a0\u7684\u7528\u6237\u662f\u5426\u8be5\u540d\u79f0\u5df2\u5b58\u5728\u4e8e\u6570\u636e\u5e93\u4e2d\u3002 \u8981\u70b9\uff1a\u542f\u7528storage.batch-loading\u8981\u6c42\u7528\u6237\u786e\u4fdd\u52a0\u8f7d\u7684\u6570\u636e\u5728\u5185\u90e8\u4e00\u81f4\u4e14\u4e0e\u56fe\u4e2d\u5df2\u6709\u7684\u4efb\u4f55\u6570\u636e\u4e00\u81f4\u3002\u7279\u522b\u662f\uff0c\u5728\u542f\u7528\u6279\u91cf\u52a0\u8f7d\u65f6\uff0c\u5e76\u53d1\u7c7b\u578b\u521b\u5efa\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u6570\u636e\u5b8c\u6574\u6027\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u901a\u8fc7schema.default = none\u5728\u56fe\u8868\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u6765\u7981\u7528\u81ea\u52a8\u7c7b\u578b\u521b\u5efa\u3002 34.1.2 \u4f18\u5316ID\u5206\u914d 34.1.2.1 ID\u5757\u5927\u5c0f \u6bcf\u4e2a\u65b0\u6dfb\u52a0\u7684\u9876\u70b9\u6216\u8fb9\u7f18\u90fd\u88ab\u5206\u914d\u4e00\u4e2a\u60df\u4e00\u7684id\u3002JanusGraph\u7684id\u6c60\u7ba1\u7406\u5668\u4e3a\u7279\u5b9a\u7684JanusGraph\u5b9e\u4f8b\u83b7\u53d6\u5757\u4e2d\u7684id\u3002id\u5757\u83b7\u53d6\u8fc7\u7a0b\u4ee3\u4ef7\u9ad8\u6602\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4fdd\u8bc1\u5757\u7684\u5168\u5c40\u60df\u4e00\u5206\u914d\u3002\u589e\u52a0id\u5757\u5927\u5c0f\u51cf\u5c11\u4e86\u83b7\u53d6\u7684\u6570\u91cf\uff0c\u4f46\u53ef\u80fd\u4f1a\u7559\u4e0b\u8bb8\u591aid\u672a\u5206\u914d\uff0c\u4ece\u800c\u9020\u6210\u6d6a\u8d39\u3002\u5bf9\u4e8e\u4e8b\u52a1\u6027\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u9ed8\u8ba4\u7684\u5757\u5927\u5c0f\u662f\u5408\u7406\u7684\uff0c\u4f46\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u9876\u70b9\u548c\u8fb9\u7684\u6dfb\u52a0\u9891\u7387\u8981\u9ad8\u5f97\u591a\uff0c\u800c\u4e14\u901f\u5ea6\u4e5f\u5feb\u5f97\u591a\u3002\u56e0\u6b64\uff0c\u901a\u5e38\u5efa\u8bae\u6839\u636e\u6bcf\u53f0\u673a\u5668\u8981\u6dfb\u52a0\u7684\u9876\u70b9\u6570\u91cf\u5c06\u5757\u5927\u5c0f\u589e\u52a010\u500d\u6216\u66f4\u591a\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u8bbe\u7f6eids.block-size\u4e3a\u6bcf\u5c0f\u65f6\u6bcf\u4e2aJanusGraph\u5b9e\u4f8b\u6dfb\u52a0\u7684\u9876\u70b9\u6570\u3002 \u91cd\u8981\u63d0\u793a\uff1a\u6240\u6709JanusGraph\u5b9e\u4f8b\u5fc5\u987b\u914d\u7f6e\u76f8\u540c\u7684ids.block-size\u503c\u4ee5\u786e\u4fdd\u6b63\u786e\u7684id\u5206\u914d\u3002\u56e0\u6b64\uff0c\u5728\u66f4\u6539\u6b64\u503c\u4e4b\u524d\uff0c\u8bf7\u52a1\u5fc5\u5173\u95ed\u6240\u6709JanusGraph\u5b9e\u4f8b\u3002 34.1.2.2 \u8eab\u4efd\u8bc6\u522b\u83b7\u53d6\u6d41\u7a0b \u5f53\u8bb8\u591aJanusGraph\u5b9e\u4f8b\u7ecf\u5e38\u5e76\u884c\u5206\u914did\u5757\u65f6\uff0c\u5b9e\u4f8b\u4e4b\u95f4\u7684\u5206\u914d\u51b2\u7a81\u5c06\u4e0d\u53ef\u907f\u514d\u5730\u51fa\u73b0\u5e76\u51cf\u6162\u5206\u914d\u8fc7\u7a0b\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u6279\u91cf\u52a0\u8f7d\u800c\u589e\u52a0\u7684\u5199\u5165\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u8fdb\u4e00\u6b65\u51cf\u6162\u8fdb\u7a0b\uff0c\u4f7f\u5f97JanusGraph\u8ba4\u4e3a\u5b83\u5931\u8d25\u5e76\u629b\u51fa\u5f02\u5e38\u3002\u6709\u4e09\u79cd\u914d\u7f6e\u9009\u9879\u53ef\u4ee5\u8c03\u6574\u4ee5\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u3002 1\uff09ids.authority.wait-time\u914d\u7f6eid\u6c60\u7ba1\u7406\u5668\u7b49\u5f85\u5b58\u50a8\u540e\u7aef\u786e\u8ba4id\u5757\u5e94\u7528\u7a0b\u5e8f\u7684\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002\u6b64\u65f6\u95f4\u8d8a\u77ed\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u62e5\u585e\u7684\u5b58\u50a8\u7fa4\u96c6\u4e0a\u5931\u8d25\u7684\u53ef\u80fd\u6027\u5c31\u8d8a\u5927\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u5c06\u6b64\u503c\u8bbe\u7f6e\u4e3a\u52a0\u8f7d\u65f6\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u4e0a\u6d4b\u91cf\u768495%\u8bfb\u53d6\u548c\u5199\u5165\u65f6\u95f4\u7684\u603b\u548c\u3002 \u91cd\u8981\u63d0\u793a\uff1a\u6240\u6709JanusGraph\u5b9e\u4f8b\u7684\u503c\u90fd\u5e94\u76f8\u540c\u3002 2\uff09ids.renew-timeout\u914d\u7f6eJanusGraph\u7684id\u6c60\u7ba1\u7406\u5668\u5728\u5c1d\u8bd5\u83b7\u53d6\u5931\u8d25\u524d\u7684\u65b0id\u5757\u65f6\u5c06\u7b49\u5f85\u7684\u6beb\u79d2\u6570\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u5c06\u6b64\u503c\u8bbe\u7f6e\u4e3a\u5c3d\u53ef\u80fd\u5927\uff0c\u4ee5\u4fbf\u4e0d\u5fc5\u7b49\u5f85\u592a\u957f\u65f6\u95f4\u4ee5\u5e94\u5bf9\u4e0d\u53ef\u6062\u590d\u7684\u6545\u969c\u3002\u589e\u52a0\u5b83\u7684\u552f\u4e00\u7f3a\u70b9\u662fJanusGraph\u5c06\u5728\u4e0d\u53ef\u7528\u7684\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u4e0a\u5c1d\u8bd5\u5f88\u957f\u65f6\u95f4\u3002 34.1.3 \u4f18\u5316\u5199\u5165\u548c\u8bfb\u53d6 34.1.3.1 \u7f13\u51b2\u533a\u5927\u5c0f JanusGraph\u7f13\u51b2\u5199\u5165\u5e76\u4ee5\u5c0f\u6279\u91cf\u6267\u884c\u5b83\u4eec\u4ee5\u51cf\u5c11\u9488\u5bf9\u5b58\u50a8\u540e\u7aef\u7684\u8bf7\u6c42\u6570\u3002\u8fd9\u4e9b\u6279\u6b21\u7684\u5927\u5c0f\u7531storage.buffer-size\u3002\u5728\u77ed\u65f6\u95f4\u5185\u6267\u884c\u5927\u91cf\u5199\u5165\u65f6\uff0c\u5b58\u50a8\u540e\u7aef\u53ef\u80fd\u4f1a\u56e0\u5199\u5165\u8bf7\u6c42\u800c\u8fc7\u8f7d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u589e\u52a0storage.buffer-size\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5199\u5165\u6b21\u6570\u6765\u907f\u514d\u5931\u8d25\uff0c\u4ece\u800c\u51cf\u5c11\u8bf7\u6c42\u7684\u6570\u91cf\u3002 \u4f46\u662f\uff0c\u589e\u52a0\u7f13\u51b2\u533a\u5927\u5c0f\u4f1a\u589e\u52a0\u5199\u8bf7\u6c42\u7684\u5ef6\u8fdf\u53ca\u5176\u5931\u8d25\u7684\u53ef\u80fd\u6027\u3002\u56e0\u6b64\uff0c\u4e0d\u5efa\u8bae\u4e3a\u4e8b\u52a1\u6027\u8d1f\u8f7d\u589e\u52a0\u6b64\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5e94\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\u4ed4\u7ec6\u5c1d\u8bd5\u6b64\u8bbe\u7f6e\u3002 34.1.3.2 \u8bfb\u5199\u7a33\u5065\u6027 \u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u7fa4\u96c6\u4e0a\u7684\u8d1f\u8f7d\u901a\u5e38\u4f1a\u589e\u52a0\uff0c\u4ece\u800c\u4f7f\u8bfb\u53d6\u548c\u5199\u5165\u64cd\u4f5c\u66f4\u6709\u53ef\u80fd\u5931\u8d25\uff08\u7279\u522b\u662f\u5982\u679c\u7f13\u51b2\u533a\u5927\u5c0f\u5982\u4e0a\u6240\u8ff0\u589e\u52a0\uff09\u3002 storage.read-attempts\u5e76storage.write-attempts\u914d\u7f6eJanusGraph\u5728\u653e\u5f03\u4e4b\u524d\u5c1d\u8bd5\u5bf9\u5b58\u50a8\u540e\u7aef\u6267\u884c\u8bfb\u53d6\u6216\u5199\u5165\u64cd\u4f5c\u7684\u6b21\u6570\u3002\u5982\u679c\u9884\u8ba1\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\u540e\u7aef\u6709\u9ad8\u8d1f\u8f7d\uff0c\u901a\u5e38\u5efa\u8bae\u589e\u52a0\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 storage.attempt-wait\u6307\u5b9aJanusGraph\u5728\u91cd\u65b0\u5c1d\u8bd5\u5931\u8d25\u7684\u540e\u7aef\u64cd\u4f5c\u4e4b\u524d\u5c06\u7b49\u5f85\u7684\u6beb\u79d2\u6570\u3002\u8f83\u9ad8\u7684\u503c\u53ef\u4ee5\u786e\u4fdd\u64cd\u4f5c\u91cd\u8bd5\u4e0d\u4f1a\u8fdb\u4e00\u6b65\u589e\u52a0\u540e\u7aef\u7684\u8d1f\u8f7d\u3002 34.2 \u7b56\u7565 34.2.1 \u5e76\u884c\u5316\u8d1f\u8f7d \u5982\u679cJanusGraph\u7684\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u8db3\u591f\u5927\u4ee5\u6ee1\u8db3\u5176\u4ed6\u8bf7\u6c42,\u901a\u8fc7\u5e76\u884c\u5904\u7406\u8de8\u591a\u53f0\u8ba1\u7b97\u673a\u7684\u6279\u91cf\u52a0\u8f7d\uff0c\u5219\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u52a0\u8f7d\u65f6\u95f4\u3002\u8fd9\u57fa\u672c\u4e0a\u662f\u65b9\u6cd5 \u7b2c37\u7ae0\uff0cJanusGraph\u548cTinkerPop\u7684Hadoop-Gremlin \u4f7f\u7528MapReduce\u5c06\u6570\u636e\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\u3002 \u5982\u679cHadoop\u4e0d\u80fd\u7528\u4e8e\u5e76\u884c\u5316\u6279\u91cf\u52a0\u8f7d\u8fc7\u7a0b\uff0c\u90a3\u4e48\u4ee5\u4e0b\u662f\u4e00\u4e9b\u6709\u6548\u5e76\u884c\u5316\u52a0\u8f7d\u8fc7\u7a0b\u7684\u9ad8\u7ea7\u6307\u5357\uff1a \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u56fe\u8868\u6570\u636e\u53ef\u4ee5\u5206\u89e3\u4e3a\u591a\u4e2a\u65ad\u5f00\u8fde\u63a5\u7684\u5b50\u56fe\u3002\u8fd9\u4e9b\u5b50\u56fe\u53ef\u4ee5\u5728\u591a\u53f0\u673a\u5668\u4e0a\u5e76\u884c\u72ec\u7acb\u52a0\u8f7d\uff08\u4f8b\u5982\uff0c\u5982\u4e0a\u6240\u8ff0\u4f7f\u7528BatchGraph\uff09\u3002 \u5982\u679c\u65e0\u6cd5\u5206\u89e3\u56fe\u5f62\uff0c\u5219\u5728\u591a\u4e2a\u6b65\u9aa4\u4e2d\u52a0\u8f7d\u901a\u5e38\u662f\u6709\u76ca\u7684\uff0c\u5176\u4e2d\u6700\u540e\u4e24\u4e2a\u6b65\u9aa4\u53ef\u4ee5\u8de8\u591a\u4e2a\u673a\u5668\u5e76\u884c\u5316\uff1a \u786e\u4fdd\u9876\u70b9\u548c\u8fb9\u7f18\u6570\u636e\u96c6\u662f\u91cd\u590d\u6570\u636e\u5220\u9664\u4e14\u4e00\u81f4\u7684\u3002 \u8bbe\u7f6ebatch-loading=true\u3002\u53ef\u80fd\u4f18\u5316\u4e0a\u8ff0\u9644\u52a0\u914d\u7f6e\u8bbe\u7f6e\u3002 \u5c06\u6240\u6709\u9876\u70b9\u53ca\u5176\u5c5e\u6027\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\uff08\u4f46\u6ca1\u6709\u8fb9\u7f18\uff09\u3002\u7ef4\u62a4\u4e00\u4e2a\uff08\u5206\u5e03\u5f0f\uff09\u6620\u5c04\uff0c\u4ece\u9876\u70b9id\uff08\u7531\u52a0\u8f7d\u7684\u6570\u636e\u5b9a\u4e49\uff09\u5230JanusGraph\u7684\u5185\u90e8\u9876\u70b9id\uff08\u5373vertex.getId()\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a64\u4f4d\u957f\u7684id\u3002 \u4f7f\u7528\u5730\u56fe\u6dfb\u52a0\u6240\u6709\u8fb9\u4ee5\u67e5\u627eJanusGraph\u7684\u9876\u70b9id\u5e76\u4f7f\u7528\u8be5id\u68c0\u7d22\u9876\u70b9\u3002 34.3 \u95ee\u4e0e\u7b54 \u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u6211\u8be5\u600e\u4e48\u505a\u624d\u80fd\u907f\u514d\u4ee5\u4e0b\u5f02\u5e38\uff1a java.io.IOException: ID renewal thread on partition [X] did not complete in time.\uff1f\u6b64\u5f02\u5e38\u5f88\u53ef\u80fd\u662f\u7531\u4e8e\u9ad8\u5ea6\u538b\u7f29\u7684\u5b58\u50a8\u540e\u7aef\u5728id\u5206\u914d\u9636\u6bb5\u91cd\u590d\u8d85\u65f6\u9020\u6210\u7684\u3002\u8bf7\u53c2\u9605\u4e0a\u9762\u7684 ID\u5206\u914d\u4f18\u5316\u90e8\u5206\u3002","title":"34.\u6279\u91cf\u52a0\u8f7d"},{"location":"advanced_topics/bulk_loading/#34","text":"\u6709\u8bb8\u591a\u914d\u7f6e\u9009\u9879\u548c\u5de5\u5177\u53ef\u4ee5\u66f4\u6709\u6548\u5730\u5c06\u5927\u91cf\u56fe\u5f62\u6570\u636e\u63d0\u53d6\u5230JanusGraph\u4e2d\u3002\u4e0e\u901a\u8fc7\u5355\u4e2a\u4e8b\u52a1\u6dfb\u52a0\u5c11\u91cf\u6570\u636e\u7684\u9ed8\u8ba4\u4e8b\u52a1\u52a0\u8f7d\u76f8\u6bd4\uff0c\u8fd9\u79cd\u63d0\u53d6\u88ab\u79f0\u4e3a\u6279\u91cf\u52a0\u8f7d\u3002 \u6709\u8bb8\u591a\u7528\u4f8b\u5c06\u6570\u636e\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\uff0c\u5305\u62ec\uff1a - \u5c06JanusGraph\u5f15\u5165\u5177\u6709\u73b0\u6709\u6570\u636e\u7684\u73b0\u6709\u73af\u5883\uff0c\u5e76\u5c06\u6b64\u6570\u636e\u8fc1\u79fb\u6216\u590d\u5236\u5230\u65b0\u7684JanusGraph\u96c6\u7fa4\u4e2d\u3002 - \u4f7f\u7528JanusGraph\u4f5c\u4e3aETL\u8fc7\u7a0b\u7684\u7ec8\u70b9\u3002 - \u5c06\u73b0\u6709\u6216\u5916\u90e8\u56fe\u5f62\u6570\u636e\u96c6\uff08\u4f8b\u5982\uff0c\u516c\u5f00\u53ef\u7528\u7684RDF\u6570\u636e\u96c6\uff09\u6dfb\u52a0\u5230\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u96c6\u7fa4\u3002 - \u4f7f\u7528\u56fe\u8868\u5206\u6790\u4f5c\u4e1a\u7684\u7ed3\u679c\u66f4\u65b0JanusGraph\u56fe\u8868\u3002 \u672c\u9875\u4ecb\u7ecd\u4e86\u5728JanusGraph\u4e2d\u4f7f\u6279\u91cf\u52a0\u8f7d\u66f4\u9ad8\u6548\u7684\u914d\u7f6e\u9009\u9879\u548c\u5de5\u5177\u3002\u5728\u7ee7\u7eed\u64cd\u4f5c\u4e4b\u524d\uff0c\u8bf7\u4ed4\u7ec6\u89c2\u5bdf\u6bcf\u4e2a\u9009\u9879\u7684\u9650\u5236\u548c\u5047\u8bbe\uff0c\u4ee5\u907f\u514d\u6570\u636e\u4e22\u5931\u6216\u6570\u636e\u635f\u574f\u3002 \u672c\u6587\u6863\u91cd\u70b9\u4ecb\u7ecdJanusGraph\u7684\u5177\u4f53\u4f18\u5316\u3002\u6b64\u5916\uff0c\u8003\u8651\u6539\u8fdb\u6240\u9009\u7684\u5b58\u50a8\u540e\u7aef\u548c\uff08\u53ef\u9009\uff09\u7d22\u5f15\u540e\u7aef\u4ee5\u5b9e\u73b0\u9ad8\u5199\u5165\u6027\u80fd\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u76f8\u5e94\u540e\u7aef\u7684\u6587\u6863\u3002","title":"34\u3001 \u6279\u91cf\u52a0\u8f7d"},{"location":"advanced_topics/bulk_loading/#341","text":"","title":"34.1 \u914d\u7f6e\u9009\u9879"},{"location":"advanced_topics/bulk_loading/#3411","text":"storage.batch-loading\u5bf9\u5927\u591a\u6570\u5e94\u7528\u7a0b\u5e8f\u800c\u8a00\uff0c\u542f\u7528\u914d\u7f6e\u9009\u9879\u5c06\u5bf9\u6279\u91cf\u52a0\u8f7d\u65f6\u95f4\u4ea7\u751f\u6700\u5927\u7684\u79ef\u6781\u5f71\u54cd\u3002\u542f\u7528\u6279\u91cf\u52a0\u8f7d\u4f1a\u5728\u8bb8\u591a\u5730\u65b9\u7981\u7528JanusGraph\u5185\u90e8\u4e00\u81f4\u6027\u68c0\u67e5\u3002\u6700\u91cd\u8981\u7684\u662f\uff0c\u5b83\u7981\u7528\u9501\u5b9a\u3002\u6362\u53e5\u8bdd\u8bf4\uff0cJanusGraph\u5047\u8bbe\u8981\u52a0\u8f7d\u5230JanusGraph\u4e2d\u7684\u6570\u636e\u4e0e\u56fe\u5f62\u4e00\u81f4\uff0c\u56e0\u6b64\u4e3a\u4e86\u63d0\u9ad8\u6027\u80fd\u800c\u7981\u7528\u81ea\u5df1\u7684\u68c0\u67e5\u3002 \u5728\u8bb8\u591a\u6279\u91cf\u52a0\u8f7d\u65b9\u6848\u4e2d\uff0c\u5728\u52a0\u8f7d\u6570\u636e\u4e4b\u524d\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u7136\u540e\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u4e2d\u65f6\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u8981\u4fbf\u5b9c\u5f97\u591a\u3002storage.batch-loading\u7531\u4e8e\u6b64\u89c2\u5bdf\uff0c\u914d\u7f6e\u9009\u9879\u5b58\u5728\u3002 \u5728\u8bb8\u591a\u6279\u91cf\u52a0\u8f7d\u573a\u666f\u4e2d\uff0c\u5728\u52a0\u8f7d\u6570\u636e\u4e4b\u524d\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u8981\u6bd4\u5728\u5c06\u6570\u636e\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u65f6\u786e\u4fdd\u6570\u636e\u4e00\u81f4\u6027\u4fbf\u5b9c\u5f97\u591a\u3002\u7531\u4e8e\u6b64\u89c2\u5bdfstorage.batch-loading\uff0c\u914d\u7f6e\u9009\u9879\u5b58\u5728\u3002 \u4f8b\u5982\uff0c\u8003\u8651\u5c06\u73b0\u6709\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\u7684\u7528\u4f8b\u3002\u6b64\u5916\uff0c\u5047\u8bbe\u7528\u6237\u540d\u5c5e\u6027\u952e\u5177\u6709\u5728\u5176\u4e0a\u5b9a\u4e49\u7684\u552f\u4e00\u590d\u5408\u7d22\u5f15\uff0c\u5373\u7528\u6237\u540d\u5728\u6574\u4e2a\u56fe\u5f62\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002\u5982\u679c\u4ece\u5176\u4ed6\u6570\u636e\u5e93\u5bfc\u5165\u7528\u6237\u914d\u7f6e\u6587\u4ef6\uff0c\u5219\u53ef\u80fd\u5df2\u4fdd\u8bc1\u7528\u6237\u540d\u552f\u4e00\u6027\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5219\u6309\u540d\u79f0\u5bf9\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u6392\u5e8f\u5e76\u8fc7\u6ee4\u6389\u91cd\u590d\u9879\u6216\u7f16\u5199\u6267\u884c\u6b64\u7c7b\u8fc7\u6ee4\u7684Hadoop\u4f5c\u4e1a\u5f88\u7b80\u5355\u3002\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u7528storage.batch-loading\u54ea\u4e2a\u663e\u7740\u51cf\u5c11\u6279\u91cf\u52a0\u8f7d\u65f6\u95f4\uff0c\u56e0\u4e3aJanusGraph\u4e0d\u5fc5\u68c0\u67e5\u6bcf\u4e2a\u6dfb\u52a0\u7684\u7528\u6237\u662f\u5426\u8be5\u540d\u79f0\u5df2\u5b58\u5728\u4e8e\u6570\u636e\u5e93\u4e2d\u3002 \u8981\u70b9\uff1a\u542f\u7528storage.batch-loading\u8981\u6c42\u7528\u6237\u786e\u4fdd\u52a0\u8f7d\u7684\u6570\u636e\u5728\u5185\u90e8\u4e00\u81f4\u4e14\u4e0e\u56fe\u4e2d\u5df2\u6709\u7684\u4efb\u4f55\u6570\u636e\u4e00\u81f4\u3002\u7279\u522b\u662f\uff0c\u5728\u542f\u7528\u6279\u91cf\u52a0\u8f7d\u65f6\uff0c\u5e76\u53d1\u7c7b\u578b\u521b\u5efa\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u6570\u636e\u5b8c\u6574\u6027\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u60a8\u901a\u8fc7schema.default = none\u5728\u56fe\u8868\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\u6765\u7981\u7528\u81ea\u52a8\u7c7b\u578b\u521b\u5efa\u3002","title":"34.1.1 \u6279\u91cf\u52a0\u8f7d"},{"location":"advanced_topics/bulk_loading/#3412-id","text":"","title":"34.1.2 \u4f18\u5316ID\u5206\u914d"},{"location":"advanced_topics/bulk_loading/#34121-id","text":"\u6bcf\u4e2a\u65b0\u6dfb\u52a0\u7684\u9876\u70b9\u6216\u8fb9\u7f18\u90fd\u88ab\u5206\u914d\u4e00\u4e2a\u60df\u4e00\u7684id\u3002JanusGraph\u7684id\u6c60\u7ba1\u7406\u5668\u4e3a\u7279\u5b9a\u7684JanusGraph\u5b9e\u4f8b\u83b7\u53d6\u5757\u4e2d\u7684id\u3002id\u5757\u83b7\u53d6\u8fc7\u7a0b\u4ee3\u4ef7\u9ad8\u6602\uff0c\u56e0\u4e3a\u5b83\u9700\u8981\u4fdd\u8bc1\u5757\u7684\u5168\u5c40\u60df\u4e00\u5206\u914d\u3002\u589e\u52a0id\u5757\u5927\u5c0f\u51cf\u5c11\u4e86\u83b7\u53d6\u7684\u6570\u91cf\uff0c\u4f46\u53ef\u80fd\u4f1a\u7559\u4e0b\u8bb8\u591aid\u672a\u5206\u914d\uff0c\u4ece\u800c\u9020\u6210\u6d6a\u8d39\u3002\u5bf9\u4e8e\u4e8b\u52a1\u6027\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u9ed8\u8ba4\u7684\u5757\u5927\u5c0f\u662f\u5408\u7406\u7684\uff0c\u4f46\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u9876\u70b9\u548c\u8fb9\u7684\u6dfb\u52a0\u9891\u7387\u8981\u9ad8\u5f97\u591a\uff0c\u800c\u4e14\u901f\u5ea6\u4e5f\u5feb\u5f97\u591a\u3002\u56e0\u6b64\uff0c\u901a\u5e38\u5efa\u8bae\u6839\u636e\u6bcf\u53f0\u673a\u5668\u8981\u6dfb\u52a0\u7684\u9876\u70b9\u6570\u91cf\u5c06\u5757\u5927\u5c0f\u589e\u52a010\u500d\u6216\u66f4\u591a\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u8bbe\u7f6eids.block-size\u4e3a\u6bcf\u5c0f\u65f6\u6bcf\u4e2aJanusGraph\u5b9e\u4f8b\u6dfb\u52a0\u7684\u9876\u70b9\u6570\u3002 \u91cd\u8981\u63d0\u793a\uff1a\u6240\u6709JanusGraph\u5b9e\u4f8b\u5fc5\u987b\u914d\u7f6e\u76f8\u540c\u7684ids.block-size\u503c\u4ee5\u786e\u4fdd\u6b63\u786e\u7684id\u5206\u914d\u3002\u56e0\u6b64\uff0c\u5728\u66f4\u6539\u6b64\u503c\u4e4b\u524d\uff0c\u8bf7\u52a1\u5fc5\u5173\u95ed\u6240\u6709JanusGraph\u5b9e\u4f8b\u3002","title":"34.1.2.1 ID\u5757\u5927\u5c0f"},{"location":"advanced_topics/bulk_loading/#34122","text":"\u5f53\u8bb8\u591aJanusGraph\u5b9e\u4f8b\u7ecf\u5e38\u5e76\u884c\u5206\u914did\u5757\u65f6\uff0c\u5b9e\u4f8b\u4e4b\u95f4\u7684\u5206\u914d\u51b2\u7a81\u5c06\u4e0d\u53ef\u907f\u514d\u5730\u51fa\u73b0\u5e76\u51cf\u6162\u5206\u914d\u8fc7\u7a0b\u3002\u6b64\u5916\uff0c\u7531\u4e8e\u6279\u91cf\u52a0\u8f7d\u800c\u589e\u52a0\u7684\u5199\u5165\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u8fdb\u4e00\u6b65\u51cf\u6162\u8fdb\u7a0b\uff0c\u4f7f\u5f97JanusGraph\u8ba4\u4e3a\u5b83\u5931\u8d25\u5e76\u629b\u51fa\u5f02\u5e38\u3002\u6709\u4e09\u79cd\u914d\u7f6e\u9009\u9879\u53ef\u4ee5\u8c03\u6574\u4ee5\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\u3002 1\uff09ids.authority.wait-time\u914d\u7f6eid\u6c60\u7ba1\u7406\u5668\u7b49\u5f85\u5b58\u50a8\u540e\u7aef\u786e\u8ba4id\u5757\u5e94\u7528\u7a0b\u5e8f\u7684\u65f6\u95f4\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002\u6b64\u65f6\u95f4\u8d8a\u77ed\uff0c\u5e94\u7528\u7a0b\u5e8f\u5728\u62e5\u585e\u7684\u5b58\u50a8\u7fa4\u96c6\u4e0a\u5931\u8d25\u7684\u53ef\u80fd\u6027\u5c31\u8d8a\u5927\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u5c06\u6b64\u503c\u8bbe\u7f6e\u4e3a\u52a0\u8f7d\u65f6\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u4e0a\u6d4b\u91cf\u768495%\u8bfb\u53d6\u548c\u5199\u5165\u65f6\u95f4\u7684\u603b\u548c\u3002 \u91cd\u8981\u63d0\u793a\uff1a\u6240\u6709JanusGraph\u5b9e\u4f8b\u7684\u503c\u90fd\u5e94\u76f8\u540c\u3002 2\uff09ids.renew-timeout\u914d\u7f6eJanusGraph\u7684id\u6c60\u7ba1\u7406\u5668\u5728\u5c1d\u8bd5\u83b7\u53d6\u5931\u8d25\u524d\u7684\u65b0id\u5757\u65f6\u5c06\u7b49\u5f85\u7684\u6beb\u79d2\u6570\u3002 \u7ecf\u9a8c\u6cd5\u5219\uff1a\u5c06\u6b64\u503c\u8bbe\u7f6e\u4e3a\u5c3d\u53ef\u80fd\u5927\uff0c\u4ee5\u4fbf\u4e0d\u5fc5\u7b49\u5f85\u592a\u957f\u65f6\u95f4\u4ee5\u5e94\u5bf9\u4e0d\u53ef\u6062\u590d\u7684\u6545\u969c\u3002\u589e\u52a0\u5b83\u7684\u552f\u4e00\u7f3a\u70b9\u662fJanusGraph\u5c06\u5728\u4e0d\u53ef\u7528\u7684\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u4e0a\u5c1d\u8bd5\u5f88\u957f\u65f6\u95f4\u3002","title":"34.1.2.2 \u8eab\u4efd\u8bc6\u522b\u83b7\u53d6\u6d41\u7a0b"},{"location":"advanced_topics/bulk_loading/#3413","text":"","title":"34.1.3 \u4f18\u5316\u5199\u5165\u548c\u8bfb\u53d6"},{"location":"advanced_topics/bulk_loading/#34131","text":"JanusGraph\u7f13\u51b2\u5199\u5165\u5e76\u4ee5\u5c0f\u6279\u91cf\u6267\u884c\u5b83\u4eec\u4ee5\u51cf\u5c11\u9488\u5bf9\u5b58\u50a8\u540e\u7aef\u7684\u8bf7\u6c42\u6570\u3002\u8fd9\u4e9b\u6279\u6b21\u7684\u5927\u5c0f\u7531storage.buffer-size\u3002\u5728\u77ed\u65f6\u95f4\u5185\u6267\u884c\u5927\u91cf\u5199\u5165\u65f6\uff0c\u5b58\u50a8\u540e\u7aef\u53ef\u80fd\u4f1a\u56e0\u5199\u5165\u8bf7\u6c42\u800c\u8fc7\u8f7d\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u589e\u52a0storage.buffer-size\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u6bcf\u4e2a\u8bf7\u6c42\u7684\u5199\u5165\u6b21\u6570\u6765\u907f\u514d\u5931\u8d25\uff0c\u4ece\u800c\u51cf\u5c11\u8bf7\u6c42\u7684\u6570\u91cf\u3002 \u4f46\u662f\uff0c\u589e\u52a0\u7f13\u51b2\u533a\u5927\u5c0f\u4f1a\u589e\u52a0\u5199\u8bf7\u6c42\u7684\u5ef6\u8fdf\u53ca\u5176\u5931\u8d25\u7684\u53ef\u80fd\u6027\u3002\u56e0\u6b64\uff0c\u4e0d\u5efa\u8bae\u4e3a\u4e8b\u52a1\u6027\u8d1f\u8f7d\u589e\u52a0\u6b64\u8bbe\u7f6e\uff0c\u5e76\u4e14\u5e94\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\u4ed4\u7ec6\u5c1d\u8bd5\u6b64\u8bbe\u7f6e\u3002","title":"34.1.3.1 \u7f13\u51b2\u533a\u5927\u5c0f"},{"location":"advanced_topics/bulk_loading/#34132","text":"\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u7fa4\u96c6\u4e0a\u7684\u8d1f\u8f7d\u901a\u5e38\u4f1a\u589e\u52a0\uff0c\u4ece\u800c\u4f7f\u8bfb\u53d6\u548c\u5199\u5165\u64cd\u4f5c\u66f4\u6709\u53ef\u80fd\u5931\u8d25\uff08\u7279\u522b\u662f\u5982\u679c\u7f13\u51b2\u533a\u5927\u5c0f\u5982\u4e0a\u6240\u8ff0\u589e\u52a0\uff09\u3002 storage.read-attempts\u5e76storage.write-attempts\u914d\u7f6eJanusGraph\u5728\u653e\u5f03\u4e4b\u524d\u5c1d\u8bd5\u5bf9\u5b58\u50a8\u540e\u7aef\u6267\u884c\u8bfb\u53d6\u6216\u5199\u5165\u64cd\u4f5c\u7684\u6b21\u6570\u3002\u5982\u679c\u9884\u8ba1\u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\u540e\u7aef\u6709\u9ad8\u8d1f\u8f7d\uff0c\u901a\u5e38\u5efa\u8bae\u589e\u52a0\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 storage.attempt-wait\u6307\u5b9aJanusGraph\u5728\u91cd\u65b0\u5c1d\u8bd5\u5931\u8d25\u7684\u540e\u7aef\u64cd\u4f5c\u4e4b\u524d\u5c06\u7b49\u5f85\u7684\u6beb\u79d2\u6570\u3002\u8f83\u9ad8\u7684\u503c\u53ef\u4ee5\u786e\u4fdd\u64cd\u4f5c\u91cd\u8bd5\u4e0d\u4f1a\u8fdb\u4e00\u6b65\u589e\u52a0\u540e\u7aef\u7684\u8d1f\u8f7d\u3002","title":"34.1.3.2 \u8bfb\u5199\u7a33\u5065\u6027"},{"location":"advanced_topics/bulk_loading/#342","text":"","title":"34.2 \u7b56\u7565"},{"location":"advanced_topics/bulk_loading/#3421","text":"\u5982\u679cJanusGraph\u7684\u5b58\u50a8\u540e\u7aef\u7fa4\u96c6\u8db3\u591f\u5927\u4ee5\u6ee1\u8db3\u5176\u4ed6\u8bf7\u6c42,\u901a\u8fc7\u5e76\u884c\u5904\u7406\u8de8\u591a\u53f0\u8ba1\u7b97\u673a\u7684\u6279\u91cf\u52a0\u8f7d\uff0c\u5219\u53ef\u4ee5\u5927\u5927\u51cf\u5c11\u52a0\u8f7d\u65f6\u95f4\u3002\u8fd9\u57fa\u672c\u4e0a\u662f\u65b9\u6cd5 \u7b2c37\u7ae0\uff0cJanusGraph\u548cTinkerPop\u7684Hadoop-Gremlin \u4f7f\u7528MapReduce\u5c06\u6570\u636e\u6279\u91cf\u52a0\u8f7d\u5230JanusGraph\u4e2d\u3002 \u5982\u679cHadoop\u4e0d\u80fd\u7528\u4e8e\u5e76\u884c\u5316\u6279\u91cf\u52a0\u8f7d\u8fc7\u7a0b\uff0c\u90a3\u4e48\u4ee5\u4e0b\u662f\u4e00\u4e9b\u6709\u6548\u5e76\u884c\u5316\u52a0\u8f7d\u8fc7\u7a0b\u7684\u9ad8\u7ea7\u6307\u5357\uff1a \u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u56fe\u8868\u6570\u636e\u53ef\u4ee5\u5206\u89e3\u4e3a\u591a\u4e2a\u65ad\u5f00\u8fde\u63a5\u7684\u5b50\u56fe\u3002\u8fd9\u4e9b\u5b50\u56fe\u53ef\u4ee5\u5728\u591a\u53f0\u673a\u5668\u4e0a\u5e76\u884c\u72ec\u7acb\u52a0\u8f7d\uff08\u4f8b\u5982\uff0c\u5982\u4e0a\u6240\u8ff0\u4f7f\u7528BatchGraph\uff09\u3002 \u5982\u679c\u65e0\u6cd5\u5206\u89e3\u56fe\u5f62\uff0c\u5219\u5728\u591a\u4e2a\u6b65\u9aa4\u4e2d\u52a0\u8f7d\u901a\u5e38\u662f\u6709\u76ca\u7684\uff0c\u5176\u4e2d\u6700\u540e\u4e24\u4e2a\u6b65\u9aa4\u53ef\u4ee5\u8de8\u591a\u4e2a\u673a\u5668\u5e76\u884c\u5316\uff1a \u786e\u4fdd\u9876\u70b9\u548c\u8fb9\u7f18\u6570\u636e\u96c6\u662f\u91cd\u590d\u6570\u636e\u5220\u9664\u4e14\u4e00\u81f4\u7684\u3002 \u8bbe\u7f6ebatch-loading=true\u3002\u53ef\u80fd\u4f18\u5316\u4e0a\u8ff0\u9644\u52a0\u914d\u7f6e\u8bbe\u7f6e\u3002 \u5c06\u6240\u6709\u9876\u70b9\u53ca\u5176\u5c5e\u6027\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\uff08\u4f46\u6ca1\u6709\u8fb9\u7f18\uff09\u3002\u7ef4\u62a4\u4e00\u4e2a\uff08\u5206\u5e03\u5f0f\uff09\u6620\u5c04\uff0c\u4ece\u9876\u70b9id\uff08\u7531\u52a0\u8f7d\u7684\u6570\u636e\u5b9a\u4e49\uff09\u5230JanusGraph\u7684\u5185\u90e8\u9876\u70b9id\uff08\u5373vertex.getId()\uff09\uff0c\u8fd9\u662f\u4e00\u4e2a64\u4f4d\u957f\u7684id\u3002 \u4f7f\u7528\u5730\u56fe\u6dfb\u52a0\u6240\u6709\u8fb9\u4ee5\u67e5\u627eJanusGraph\u7684\u9876\u70b9id\u5e76\u4f7f\u7528\u8be5id\u68c0\u7d22\u9876\u70b9\u3002 34.3 \u95ee\u4e0e\u7b54 \u5728\u6279\u91cf\u52a0\u8f7d\u671f\u95f4\uff0c\u6211\u8be5\u600e\u4e48\u505a\u624d\u80fd\u907f\u514d\u4ee5\u4e0b\u5f02\u5e38\uff1a java.io.IOException: ID renewal thread on partition [X] did not complete in time.\uff1f\u6b64\u5f02\u5e38\u5f88\u53ef\u80fd\u662f\u7531\u4e8e\u9ad8\u5ea6\u538b\u7f29\u7684\u5b58\u50a8\u540e\u7aef\u5728id\u5206\u914d\u9636\u6bb5\u91cd\u590d\u8d85\u65f6\u9020\u6210\u7684\u3002\u8bf7\u53c2\u9605\u4e0a\u9762\u7684 ID\u5206\u914d\u4f18\u5316\u90e8\u5206\u3002","title":"34.2.1 \u5e76\u884c\u5316\u8d1f\u8f7d"},{"location":"advanced_topics/datatype_and_attribute_serializer_configuration/","text":"36\u3001 \u6570\u636e\u7c7b\u578b\u548c\u5c5e\u6027\u5e8f\u5217\u5316\u914d\u7f6e JanusGraph\u652f\u6301\u8bb8\u591a\u5c5e\u6027\u503c\u7684\u7c7b\u3002JanusGraph\u6709\u6548\u5730\u4e32\u884c\u5316\u57fa\u5143\uff0c\u57fa\u672c\u6570\u7ec4\u548cGeoshape\uff0cUUID\u548cDate\u3002JanusGraph\u652f\u6301\u5c06\u4efb\u610f\u5bf9\u8c61\u5e8f\u5217\u5316\u4e3a\u5c5e\u6027\u503c\uff0c\u4f46\u8fd9\u4e9b\u9700\u8981\u5b9a\u4e49\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u7a0b\u5e8f\u3002 \u8981\u4f7f\u7528\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316\u7a0b\u5e8f\u914d\u7f6e\u81ea\u5b9a\u4e49\u5c5e\u6027\u7c7b\uff0c\u8bf7\u6309\u7167\u4e0b\u5217\u6b65\u9aa4\u64cd\u4f5c\uff1a - \u5b9e\u73b0\u81eaAttributeSerializer\u5b9a\u4e49\u5c5e\u6027\u7c7b\u7684\u81ea\u5b9a\u4e49 - \u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\uff0c\u5176\u4e2d[X]\u662f\u81ea\u5b9a\u4e49\u5c5e\u6027id\uff0c\u5fc5\u987b\u5927\u4e8e\u5df2\u914d\u7f6e\u7684\u81ea\u5b9a\u4e49\u5c5e\u6027\u7684\u6240\u6709\u5c5e\u6027ID\uff1a a.attributes.custom.attribute[X].attribute-class = [Full attribute class name] b.attributes.custom.attribute[X].serializer-class = [Full serializer class name] \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u6ce8\u518c\u4e00\u4e2a\u7279\u6b8a\u7684\u6574\u6570\u5c5e\u6027\u7c7b\uff0cSpecialInt\u5e76\u4e14\u5df2\u7ecf\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5b9e\u73b0\u7684\u81ea\u5b9a\u4e49\u5e8f\u5217\u5316SpecialIntSerializer\u7a0b\u5e8fAttributeSerializer\u3002\u6211\u4eec\u5df2\u7ecf\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e869\u4e2a\u81ea\u5b9a\u4e49\u5c5e\u6027\uff0c\u56e0\u6b64\u6211\u4eec\u5c06\u6dfb\u52a0\u4ee5\u4e0b\u884c attributes.custom.attribute10.attribute-class = com.example.SpecialInt attributes.custom.attribute10.serializer-class = com.example.SpecialIntSerializer 36.1 \u81ea\u5b9a\u4e49\u5bf9\u8c61\u5e8f\u5217\u5316 JanusGraph\u652f\u6301\u4efb\u610f\u5bf9\u8c61\u4f5c\u4e3a\u5c5e\u6027\u7684\u5c5e\u6027\uff0c\u5e76\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u5bf9\u8c61\u5e8f\u5217\u5316\u5230\u78c1\u76d8\u3002\u8981\u4f7f\u6b64\u9ed8\u8ba4\u5e8f\u5217\u5316\u7a0b\u5e8f\u9002\u7528\u4e8e\u81ea\u5b9a\u4e49\u7c7b\uff0c\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u8be5\u7c7b\u5fc5\u987b\u5b9e\u73b0AttributeSerializer \u8be5\u7c7b\u5fc5\u987b\u5177\u6709\u65e0\u53c2\u6570\u6784\u9020\u51fd\u6570 \u8be5\u7c7b\u5fc5\u987b\u5b9e\u73b0\u8be5equals(Object)\u65b9\u6cd5 \u6700\u540e\u4e00\u4e2a\u8981\u6c42\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3aJanusGraph\u5c06\u5728\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u78c1\u76d8\u4e4b\u524d\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u7c7b\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002","title":"36.\u6570\u636e\u7c7b\u578b\u548c\u5c5e\u6027\u5e8f\u5217\u5316\u914d\u7f6e"},{"location":"advanced_topics/datatype_and_attribute_serializer_configuration/#361","text":"JanusGraph\u652f\u6301\u4efb\u610f\u5bf9\u8c61\u4f5c\u4e3a\u5c5e\u6027\u7684\u5c5e\u6027\uff0c\u5e76\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u5bf9\u8c61\u5e8f\u5217\u5316\u5230\u78c1\u76d8\u3002\u8981\u4f7f\u6b64\u9ed8\u8ba4\u5e8f\u5217\u5316\u7a0b\u5e8f\u9002\u7528\u4e8e\u81ea\u5b9a\u4e49\u7c7b\uff0c\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u8be5\u7c7b\u5fc5\u987b\u5b9e\u73b0AttributeSerializer \u8be5\u7c7b\u5fc5\u987b\u5177\u6709\u65e0\u53c2\u6570\u6784\u9020\u51fd\u6570 \u8be5\u7c7b\u5fc5\u987b\u5b9e\u73b0\u8be5equals(Object)\u65b9\u6cd5 \u6700\u540e\u4e00\u4e2a\u8981\u6c42\u662f\u5fc5\u9700\u7684\uff0c\u56e0\u4e3aJanusGraph\u5c06\u5728\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u78c1\u76d8\u4e4b\u524d\u6d4b\u8bd5\u81ea\u5b9a\u4e49\u7c7b\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u3002","title":"36.1 \u81ea\u5b9a\u4e49\u5bf9\u8c61\u5e8f\u5217\u5316"},{"location":"advanced_topics/eventually_consistent_storage_backends/","text":"","title":"31.\u6700\u7ec8\u4e00\u81f4\u7684\u5b58\u50a8\u540e\u7aef"},{"location":"advanced_topics/failure_recovery/","text":"\u7b2c32\u7ae0 \u6545\u969c\u548c\u6062\u590d JanusGraph\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u7528\u4e14\u5f3a\u5927\u7684\u56fe\u5f62\u6570\u636e\u5e93\u3002\u5728\u5927\u89c4\u6a21\u7684JanusGraph\u90e8\u7f72\u5931\u8d25\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002\u672c\u9875\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u5931\u8d25\u60c5\u51b5\u4ee5\u53caJanusGraph\u5982\u4f55\u5904\u7406\u5b83\u4eec\u3002 32.1 \u4e8b\u52a1\u5931\u8d25 \u4e8b\u52a1\u5931\u8d25\u7684\u539f\u56e0\u6709\u5f88\u591a\u3002\u5982\u679c\u4e8b\u52a1\u5728\u63d0\u4ea4\u4e4b\u524d\u5931\u8d25\uff0c\u90a3\u4e48\u66f4\u6539\u5c06\u88ab\u4e22\u5f03\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u903b\u8f91\u91cd\u8bd5\u4e8b\u52a1\u3002\u540c\u6837\uff0c\u9501\u6216\u5176\u4ed6\u4e00\u81f4\u6027\u5931\u8d25\u5c06\u5728\u6301\u4e45\u6027\u4e4b\u524d\u5bfc\u81f4\u5f02\u5e38\uff0c\u56e0\u6b64\u53ef\u4ee5\u91cd\u8bd5\u3002\u4e8b\u52a1\u7684\u6301\u4e45\u6027\u9636\u6bb5\u662fJanusGraph\u5f00\u59cb\u5c06\u6570\u636e\u6301\u4e45\u5316\u5230\u5404\u79cd\u540e\u7aef\u7cfb\u7edf\u7684\u65f6\u5019\u3002 JanusGraph\u9996\u5148\u5c06\u6240\u6709\u56fe\u5f62\u53d8\u5316\u6301\u4e45\u5316\u5230\u5b58\u50a8\u540e\u7aef\u3002\u6b64\u6301\u4e45\u6027\u4f5c\u4e3a\u6279\u5904\u7406\u53d8\u5316\u6267\u884c\uff0c\u4ee5\u786e\u4fdd\u5bf9\u652f\u6301\u539f\u5b50\u6027\u7684\u540e\u7aef\u4ee5\u539f\u5b50\u65b9\u5f0f\u63d0\u4ea4\u8be5\u53d8\u5316\u3002\u5982\u679c\u6279\u5904\u7406\u66f4\u6539\u7531\u4e8e\u5b58\u50a8\u540e\u7aef\u4e2d\u7684\u5f02\u5e38\u800c\u5931\u8d25\uff0c\u5219\u6574\u4e2a\u4e8b\u52a1\u5931\u8d25\u3002 \u4f46\u662f\uff0c\u8fd9\u53ef\u80fd\u4e0e\u7d22\u5f15\u548c\u65e5\u5fd7\u4e0d\u4e00\u81f4\u3002\u4e3a\u4e86\u81ea\u52a8\u4fee\u590d\u8fd9\u4e9b\u4e0d\u4e00\u81f4\uff0cJanusGraph\u53ef\u4ee5\u901a\u8fc7\u7ef4\u62a4\u914d\u7f6e\u542f\u7528\u7684\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u3002 tx.log -tx = true tx.max-commit-time = 10000 max-commit-time\u5c5e\u6027\u7528\u4e8e\u786e\u5b9a\u4e8b\u52a1\u4f55\u65f6\u5931\u8d25\u3002\u5982\u679c\u4e8b\u52a1\u7684\u6301\u4e45\u6027\u9636\u6bb5\u82b1\u8d39\u7684\u65f6\u95f4\u8d85\u8fc7\u6b64\u65f6\u95f4\uff0cJanusGraph\u5c06\u5728\u5fc5\u8981\u65f6\u5c1d\u8bd5\u6062\u590d\u5b83\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u5c06\u6b64\u8d85\u65f6\u914d\u7f6e\u4e3a\u6301\u4e45\u6027\u6700\u5927\u6301\u7eed\u65f6\u95f4\u7684\u4e0a\u9650\u3002\u6ce8\u610f\uff0c\u8fd9\u5e76\u4e0d\u5305\u62ec\u63d0\u4ea4\u4e4b\u524d\u82b1\u8d39\u7684\u65f6\u95f4\u3002 \u6b64\u5916\uff0c\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u6765\u8bfb\u53d6\u65e5\u5fd7\uff0c\u4ee5\u8bc6\u522b\u90e8\u5206\u5931\u8d25\u7684\u4e8b\u52a1\u5e76\u4fee\u590d\u5bfc\u81f4\u7684\u4efb\u4f55\u4e0d\u4e00\u81f4\u3002\u5efa\u8bae\u5728\u8fde\u63a5\u5230\u96c6\u7fa4\u7684\u5355\u72ec\u673a\u5668\u4e0a\u8fd0\u884c\u4e8b\u52a1\u4fee\u590d\u8fc7\u7a0b\uff0c\u4ee5\u9694\u79bb\u6545\u969c\u3002\u914d\u7f6e\u4e00\u4e2a\u5355\u72ec\u63a7\u5236\u7684\u8fdb\u7a0b\u6765\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c:\u5f00\u59cb\u65f6\u95f4\u6307\u5b9a\u4eceepoch\u5f00\u59cb\u6062\u590d\u8fdb\u7a0b\u5f00\u59cb\u4ece\u5199\u524d\u65e5\u5fd7\u8bfb\u53d6\u7684\u65f6\u95f4\u3002 recovery = JanusGraphFactory.startTransactionRecovery(graph, startTime, TimeUnit.MILLISECONDS); \u542f\u7528\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u4f1a\u5bfc\u81f4\u5bf9\u4e8b\u52a1\u8fdb\u884c\u989d\u5916\u7684\u5199\u64cd\u4f5c\uff0c\u4ece\u800c\u589e\u52a0\u5ef6\u8fdf\u3002\u53e6\u8bf7\u6ce8\u610f\uff0c\u5b58\u50a8\u65e5\u5fd7\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u3002\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u5177\u67092\u5929\u7684\u53ef\u914d\u7f6e\u751f\u5b58\u65f6\u95f4\uff0c\u8fd9\u610f\u5473\u7740\u65e5\u5fd7\u6761\u76ee\u5728\u8be5\u65f6\u95f4\u4e4b\u540e\u5230\u671f\u4ee5\u4fdd\u6301\u8f83\u5c0f\u7684\u5b58\u50a8\u5f00\u9500\u3002\u6709\u5173\u7528\u4e8e\u5fae\u8c03\u65e5\u5fd7\u8bb0\u5f55\u884c\u4e3a\u7684\u6240\u6709\u65e5\u5fd7\u76f8\u5173\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605\u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003\u3002 32.2 JanusGraph\u5b9e\u4f8b\u5931\u8d25 JanusGraph\u5bf9\u4e8e\u5355\u4e2a\u5b9e\u4f8b\u5931\u8d25\u662f\u5065\u58ee\u7684\uff0c\u56e0\u4e3aJanusGraph\u96c6\u7fa4\u7684\u5176\u4ed6\u5b9e\u4f8b\u4e0d\u53d7\u6b64\u7c7b\u5931\u8d25\u7684\u5f71\u54cd\uff0c\u5e76\u4e14\u5728\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5b9e\u4f8b\u65f6\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u4e8b\u52a1\u800c\u4e0d\u4f1a\u635f\u5931\u6027\u80fd\u3002 \u7136\u800c\uff0c\u4e00\u4e9b\u6a21\u5f0f\u76f8\u5173\u7684\u64cd\u4f5c(\u5982\u5b89\u88c5\u7d22\u5f15)\u9700\u8981\u534f\u8c03\u6240\u6709JanusGraph\u5b9e\u4f8b\u3002\u56e0\u6b64\uff0cJanusGraph\u7ef4\u62a4\u6240\u6709\u8fd0\u884c\u5b9e\u4f8b\u7684\u8bb0\u5f55\u3002\u5982\u679c\u4e00\u4e2a\u5b9e\u4f8b\u5931\u8d25\uff0c\u5373\u6ca1\u6709\u6b63\u786e\u5730\u5173\u95ed\uff0cJanusGraph\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6d3b\u52a8\u7684\uff0c\u5e76\u671f\u671b\u5b83\u53c2\u4e0e\u96c6\u7fa4\u8303\u56f4\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u968f\u540e\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u8be5\u5b9e\u4f8b\u6ca1\u6709\u53c2\u4e0e\u6216\u6ca1\u6709\u786e\u8ba4\u64cd\u4f5c\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u5fc5\u987b\u624b\u52a8\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\u8bb0\u5f55\uff0c\u7136\u540e\u91cd\u8bd5\u64cd\u4f5c\u3002\u8981\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u8bf7\u5bf9\u4efb\u4f55\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\u6253\u5f00\u4e00\u4e2a\u7ba1\u7406\u4e8b\u52a1\uff0c\u68c0\u67e5\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u5217\u8868\uff0c\u4ee5\u8bc6\u522b\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u6700\u540e\u5220\u9664\u5b83\u3002 mgmt = graph.openManagement() mgmt.getOpenInstances() //all open instances == 7f0001016161-dunwich1(current) == 7f0001016161-atlantis1 mgmt.forceCloseInstance('7f0001016161-atlantis1') //remove an instance mgmt.commit() \u5f53\u524dJanusGraph\u5b9e\u4f8b\u7684\u60df\u4e00\u6807\u8bc6\u7b26\u662f\u7528\u540e\u7f00(current)\u6807\u8bb0\u7684\uff0c\u4ee5\u4fbf\u4e8e\u5bb9\u6613\u8bc6\u522b\u3002\u8fd9\u4e2a\u5b9e\u4f8b\u4e0d\u80fd\u901a\u8fc7forceCloseInstance\u65b9\u6cd5\u5173\u95ed\uff0c\u800c\u662f\u5e94\u8be5\u901a\u8fc7g.close()\u5173\u95ed\u3002 \u5fc5\u987b\u786e\u4fdd\u624b\u52a8\u5220\u9664\u7684\u5b9e\u4f8b\u786e\u5b9e\u4e0d\u518d\u6d3b\u52a8\u3002\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u4e00\u4e2a\u6d3b\u52a8\u7684JanusGraph\u5b9e\u4f8b\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\u3002\u56e0\u6b64\uff0c\u7279\u522b\u5f53JanusGraph\u5728\u5b9e\u4f8b\u81ea\u52a8\u91cd\u542f\u7684\u73af\u5883\u4e2d\u64cd\u4f5c\u65f6\uff0c\u8bf7\u5c0f\u5fc3\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002","title":"32.\u5931\u8d25 & \u91cd\u8bd5"},{"location":"advanced_topics/failure_recovery/#32","text":"JanusGraph\u662f\u4e00\u4e2a\u9ad8\u5ea6\u53ef\u7528\u4e14\u5f3a\u5927\u7684\u56fe\u5f62\u6570\u636e\u5e93\u3002\u5728\u5927\u89c4\u6a21\u7684JanusGraph\u90e8\u7f72\u5931\u8d25\u662f\u4e0d\u53ef\u907f\u514d\u7684\u3002\u672c\u9875\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u5931\u8d25\u60c5\u51b5\u4ee5\u53caJanusGraph\u5982\u4f55\u5904\u7406\u5b83\u4eec\u3002","title":"\u7b2c32\u7ae0 \u6545\u969c\u548c\u6062\u590d"},{"location":"advanced_topics/failure_recovery/#321","text":"\u4e8b\u52a1\u5931\u8d25\u7684\u539f\u56e0\u6709\u5f88\u591a\u3002\u5982\u679c\u4e8b\u52a1\u5728\u63d0\u4ea4\u4e4b\u524d\u5931\u8d25\uff0c\u90a3\u4e48\u66f4\u6539\u5c06\u88ab\u4e22\u5f03\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u6839\u636e\u4e1a\u52a1\u903b\u8f91\u91cd\u8bd5\u4e8b\u52a1\u3002\u540c\u6837\uff0c\u9501\u6216\u5176\u4ed6\u4e00\u81f4\u6027\u5931\u8d25\u5c06\u5728\u6301\u4e45\u6027\u4e4b\u524d\u5bfc\u81f4\u5f02\u5e38\uff0c\u56e0\u6b64\u53ef\u4ee5\u91cd\u8bd5\u3002\u4e8b\u52a1\u7684\u6301\u4e45\u6027\u9636\u6bb5\u662fJanusGraph\u5f00\u59cb\u5c06\u6570\u636e\u6301\u4e45\u5316\u5230\u5404\u79cd\u540e\u7aef\u7cfb\u7edf\u7684\u65f6\u5019\u3002 JanusGraph\u9996\u5148\u5c06\u6240\u6709\u56fe\u5f62\u53d8\u5316\u6301\u4e45\u5316\u5230\u5b58\u50a8\u540e\u7aef\u3002\u6b64\u6301\u4e45\u6027\u4f5c\u4e3a\u6279\u5904\u7406\u53d8\u5316\u6267\u884c\uff0c\u4ee5\u786e\u4fdd\u5bf9\u652f\u6301\u539f\u5b50\u6027\u7684\u540e\u7aef\u4ee5\u539f\u5b50\u65b9\u5f0f\u63d0\u4ea4\u8be5\u53d8\u5316\u3002\u5982\u679c\u6279\u5904\u7406\u66f4\u6539\u7531\u4e8e\u5b58\u50a8\u540e\u7aef\u4e2d\u7684\u5f02\u5e38\u800c\u5931\u8d25\uff0c\u5219\u6574\u4e2a\u4e8b\u52a1\u5931\u8d25\u3002 \u4f46\u662f\uff0c\u8fd9\u53ef\u80fd\u4e0e\u7d22\u5f15\u548c\u65e5\u5fd7\u4e0d\u4e00\u81f4\u3002\u4e3a\u4e86\u81ea\u52a8\u4fee\u590d\u8fd9\u4e9b\u4e0d\u4e00\u81f4\uff0cJanusGraph\u53ef\u4ee5\u901a\u8fc7\u7ef4\u62a4\u914d\u7f6e\u542f\u7528\u7684\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u3002 tx.log -tx = true tx.max-commit-time = 10000 max-commit-time\u5c5e\u6027\u7528\u4e8e\u786e\u5b9a\u4e8b\u52a1\u4f55\u65f6\u5931\u8d25\u3002\u5982\u679c\u4e8b\u52a1\u7684\u6301\u4e45\u6027\u9636\u6bb5\u82b1\u8d39\u7684\u65f6\u95f4\u8d85\u8fc7\u6b64\u65f6\u95f4\uff0cJanusGraph\u5c06\u5728\u5fc5\u8981\u65f6\u5c1d\u8bd5\u6062\u590d\u5b83\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u5c06\u6b64\u8d85\u65f6\u914d\u7f6e\u4e3a\u6301\u4e45\u6027\u6700\u5927\u6301\u7eed\u65f6\u95f4\u7684\u4e0a\u9650\u3002\u6ce8\u610f\uff0c\u8fd9\u5e76\u4e0d\u5305\u62ec\u63d0\u4ea4\u4e4b\u524d\u82b1\u8d39\u7684\u65f6\u95f4\u3002 \u6b64\u5916\uff0c\u5fc5\u987b\u8bbe\u7f6e\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u6765\u8bfb\u53d6\u65e5\u5fd7\uff0c\u4ee5\u8bc6\u522b\u90e8\u5206\u5931\u8d25\u7684\u4e8b\u52a1\u5e76\u4fee\u590d\u5bfc\u81f4\u7684\u4efb\u4f55\u4e0d\u4e00\u81f4\u3002\u5efa\u8bae\u5728\u8fde\u63a5\u5230\u96c6\u7fa4\u7684\u5355\u72ec\u673a\u5668\u4e0a\u8fd0\u884c\u4e8b\u52a1\u4fee\u590d\u8fc7\u7a0b\uff0c\u4ee5\u9694\u79bb\u6545\u969c\u3002\u914d\u7f6e\u4e00\u4e2a\u5355\u72ec\u63a7\u5236\u7684\u8fdb\u7a0b\u6765\u8fd0\u884c\u4ee5\u4e0b\u64cd\u4f5c:\u5f00\u59cb\u65f6\u95f4\u6307\u5b9a\u4eceepoch\u5f00\u59cb\u6062\u590d\u8fdb\u7a0b\u5f00\u59cb\u4ece\u5199\u524d\u65e5\u5fd7\u8bfb\u53d6\u7684\u65f6\u95f4\u3002 recovery = JanusGraphFactory.startTransactionRecovery(graph, startTime, TimeUnit.MILLISECONDS); \u542f\u7528\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u4f1a\u5bfc\u81f4\u5bf9\u4e8b\u52a1\u8fdb\u884c\u989d\u5916\u7684\u5199\u64cd\u4f5c\uff0c\u4ece\u800c\u589e\u52a0\u5ef6\u8fdf\u3002\u53e6\u8bf7\u6ce8\u610f\uff0c\u5b58\u50a8\u65e5\u5fd7\u9700\u8981\u989d\u5916\u7684\u7a7a\u95f4\u3002\u4e8b\u52a1\u9884\u5199\u65e5\u5fd7\u5177\u67092\u5929\u7684\u53ef\u914d\u7f6e\u751f\u5b58\u65f6\u95f4\uff0c\u8fd9\u610f\u5473\u7740\u65e5\u5fd7\u6761\u76ee\u5728\u8be5\u65f6\u95f4\u4e4b\u540e\u5230\u671f\u4ee5\u4fdd\u6301\u8f83\u5c0f\u7684\u5b58\u50a8\u5f00\u9500\u3002\u6709\u5173\u7528\u4e8e\u5fae\u8c03\u65e5\u5fd7\u8bb0\u5f55\u884c\u4e3a\u7684\u6240\u6709\u65e5\u5fd7\u76f8\u5173\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605\u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003\u3002","title":"32.1 \u4e8b\u52a1\u5931\u8d25"},{"location":"advanced_topics/failure_recovery/#322-janusgraph","text":"JanusGraph\u5bf9\u4e8e\u5355\u4e2a\u5b9e\u4f8b\u5931\u8d25\u662f\u5065\u58ee\u7684\uff0c\u56e0\u4e3aJanusGraph\u96c6\u7fa4\u7684\u5176\u4ed6\u5b9e\u4f8b\u4e0d\u53d7\u6b64\u7c7b\u5931\u8d25\u7684\u5f71\u54cd\uff0c\u5e76\u4e14\u5728\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5b9e\u4f8b\u65f6\u53ef\u4ee5\u7ee7\u7eed\u5904\u7406\u4e8b\u52a1\u800c\u4e0d\u4f1a\u635f\u5931\u6027\u80fd\u3002 \u7136\u800c\uff0c\u4e00\u4e9b\u6a21\u5f0f\u76f8\u5173\u7684\u64cd\u4f5c(\u5982\u5b89\u88c5\u7d22\u5f15)\u9700\u8981\u534f\u8c03\u6240\u6709JanusGraph\u5b9e\u4f8b\u3002\u56e0\u6b64\uff0cJanusGraph\u7ef4\u62a4\u6240\u6709\u8fd0\u884c\u5b9e\u4f8b\u7684\u8bb0\u5f55\u3002\u5982\u679c\u4e00\u4e2a\u5b9e\u4f8b\u5931\u8d25\uff0c\u5373\u6ca1\u6709\u6b63\u786e\u5730\u5173\u95ed\uff0cJanusGraph\u4f1a\u8ba4\u4e3a\u5b83\u662f\u6d3b\u52a8\u7684\uff0c\u5e76\u671f\u671b\u5b83\u53c2\u4e0e\u96c6\u7fa4\u8303\u56f4\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u968f\u540e\u4f1a\u5931\u8d25\uff0c\u56e0\u4e3a\u8be5\u5b9e\u4f8b\u6ca1\u6709\u53c2\u4e0e\u6216\u6ca1\u6709\u786e\u8ba4\u64cd\u4f5c\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u5fc5\u987b\u624b\u52a8\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\u8bb0\u5f55\uff0c\u7136\u540e\u91cd\u8bd5\u64cd\u4f5c\u3002\u8981\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u8bf7\u5bf9\u4efb\u4f55\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u5b9e\u4f8b\u6253\u5f00\u4e00\u4e2a\u7ba1\u7406\u4e8b\u52a1\uff0c\u68c0\u67e5\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\u5217\u8868\uff0c\u4ee5\u8bc6\u522b\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u6700\u540e\u5220\u9664\u5b83\u3002 mgmt = graph.openManagement() mgmt.getOpenInstances() //all open instances == 7f0001016161-dunwich1(current) == 7f0001016161-atlantis1 mgmt.forceCloseInstance('7f0001016161-atlantis1') //remove an instance mgmt.commit() \u5f53\u524dJanusGraph\u5b9e\u4f8b\u7684\u60df\u4e00\u6807\u8bc6\u7b26\u662f\u7528\u540e\u7f00(current)\u6807\u8bb0\u7684\uff0c\u4ee5\u4fbf\u4e8e\u5bb9\u6613\u8bc6\u522b\u3002\u8fd9\u4e2a\u5b9e\u4f8b\u4e0d\u80fd\u901a\u8fc7forceCloseInstance\u65b9\u6cd5\u5173\u95ed\uff0c\u800c\u662f\u5e94\u8be5\u901a\u8fc7g.close()\u5173\u95ed\u3002 \u5fc5\u987b\u786e\u4fdd\u624b\u52a8\u5220\u9664\u7684\u5b9e\u4f8b\u786e\u5b9e\u4e0d\u518d\u6d3b\u52a8\u3002\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664\u4e00\u4e2a\u6d3b\u52a8\u7684JanusGraph\u5b9e\u4f8b\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u4e0d\u4e00\u81f4\u3002\u56e0\u6b64\uff0c\u7279\u522b\u5f53JanusGraph\u5728\u5b9e\u4f8b\u81ea\u52a8\u91cd\u542f\u7684\u73af\u5883\u4e2d\u64cd\u4f5c\u65f6\uff0c\u8bf7\u5c0f\u5fc3\u4f7f\u7528\u6b64\u65b9\u6cd5\u3002","title":"32.2 JanusGraph\u5b9e\u4f8b\u5931\u8d25"},{"location":"advanced_topics/graph_partitioning/","text":"35\u3001 \u56fe\u5206\u533a \u5f53JanusGraph\u90e8\u7f72\u5728\u591a\u4e2a\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u7684\u96c6\u7fa4\u4e0a\u65f6\uff0c\u56fe\u8868\u5c06\u5728\u8fd9\u4e9b\u8ba1\u7b97\u673a\u4e0a\u8fdb\u884c\u5206\u533a\u3002\u7531\u4e8eJanusGraph\u5c06\u56fe\u5f62\u5b58\u50a8\u5728\u90bb\u63a5\u5217\u8868\u8868\u793a\u4e2d\uff0c\u56e0\u6b64\u5c06\u9876\u70b9\u5206\u914d\u7ed9\u673a\u5668\u786e\u5b9a\u4e86\u5206\u533a\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u4f7f\u7528\u968f\u673a\u5206\u533a\u7b56\u7565\u5c06\u9876\u70b9\u968f\u673a\u5206\u914d\u7ed9\u8ba1\u7b97\u673a\u3002\u968f\u673a\u5206\u533a\u975e\u5e38\u6709\u6548\uff0c\u65e0\u9700\u914d\u7f6e\uff0c\u5e76\u53ef\u5b9e\u73b0\u5e73\u8861\u5206\u533a\u3002\u76ee\u524d\u4e0d\u652f\u6301\u663e\u5f0f\u5206\u533a\u3002 cluster.max-partitions = 32 id.placement = simple \u914d\u7f6e\u9009\u9879max-partitions\u63a7\u5236JanusGraph\u521b\u5efa\u7684\u865a\u62df\u5206\u533a\u6570\u3002\u6b64\u6570\u5b57\u5e94\u5927\u7ea6\u662f\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u6570\u7684\u4e24\u500d\u3002\u5982\u679c\u9884\u8ba1\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u96c6\u7fa4\u5c06\u589e\u957f\uff0c\u8bf7\u5728\u53ef\u9884\u89c1\u7684\u672a\u6765\u4f30\u8ba1\u96c6\u7fa4\u7684\u5927\u5c0f\uff0c\u5e76\u5c06\u6b64\u6570\u91cf\u4f5c\u4e3a\u57fa\u51c6\u3002\u5c06\u6b64\u6570\u5b57\u8bbe\u7f6e\u5f97\u8fc7\u5927\u4f1a\u4e0d\u5fc5\u8981\u5730\u7834\u574f\u7fa4\u96c6\uff0c\u4ece\u800c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002\u6b64\u6570\u5b57\u5e94\u5927\u4e8eJanusGraph\u56fe\u4e2d\u6700\u5927\u9884\u671f\u8282\u70b9\u6570\u3002\u5b83\u5fc5\u987b\u5927\u4e8e1\u4e14\u5e42\u4e3a2\u3002 \u56fe\u5f62\u5206\u533a\u6709\u4e24\u4e2a\u65b9\u9762\u53ef\u4ee5\u5355\u72ec\u63a7\u5236\uff1a\u8fb9\u7f18\u5207\u5272\u548c\u9876\u70b9\u5207\u5272\u3002 35.1 \u8fb9\u7f18\u5207\u5272 \u5728\u5c06\u9876\u70b9\u5206\u914d\u7ed9\u5206\u533a\u65f6\uff0c\u4eba\u4eec\u52aa\u529b\u4f18\u5316\u5206\u914d\uff0c\u4f7f\u5f97\u7ecf\u5e38\u5171\u540c\u904d\u5386\u7684\u9876\u70b9\u6258\u7ba1\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u3002\u5047\u8bbe\u9876\u70b9A\u5206\u914d\u7ed9\u673a\u56681\uff0c\u9876\u70b9B\u5206\u914d\u7ed9\u673a\u56682.\u9876\u70b9\u4e4b\u95f4\u7684\u8fb9\u7f18\u79f0\u4e3a\u5207\u8fb9\uff0c\u56e0\u4e3a\u5b83\u7684\u7aef\u70b9\u6258\u7ba1\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u3002\u904d\u5386\u6b64\u8fb9\u7f18\u4f5c\u4e3a\u56fe\u5f62\u67e5\u8be2\u7684\u4e00\u90e8\u5206\u9700\u8981\u5728\u673a\u5668\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\uff0c\u8fd9\u4f1a\u51cf\u6162\u67e5\u8be2\u5904\u7406\u901f\u5ea6\u3002\u56e0\u6b64\uff0c\u5e0c\u671b\u51cf\u5c11\u9891\u7e41\u904d\u5386\u8fb9\u7f18\u7684\u8fb9\u7f18\u5207\u5272\u3002\u53cd\u8fc7\u6765\uff0c\u8fd9\u9700\u8981\u5c06\u9891\u7e41\u904d\u5386\u7684\u8fb9\u7f18\u7684\u76f8\u90bb\u9876\u70b9\u653e\u7f6e\u5728\u540c\u4e00\u5206\u533a\u4e2d\u3002 \u9876\u70b9\u901a\u8fc7\u6307\u5b9a\u7684\u9876\u70b9id\u653e\u7f6e\u5728\u5206\u533a\u4e2d\u3002\u5206\u533a\u672c\u8d28\u4e0a\u662f\u9876\u70b9id\u7684\u8fde\u7eed\u8303\u56f4\u3002\u8981\u5728\u7279\u5b9a\u5206\u533a\u4e2d\u653e\u7f6e\u9876\u70b9\uff0cJanusGraph\u4f1a\u4ece\u5206\u533a\u7684\u9876\u70b9id\u8303\u56f4\u4e2d\u9009\u62e9\u4e00\u4e2aid\u3002JanusGraph\u901a\u8fc7\u914d\u7f6e\u7684\u653e\u7f6e\u7b56\u7565\u63a7\u5236\u9876\u70b9\u5230\u5206\u533a\u7684\u5206\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u540c\u4e00\u4e8b\u52a1\u4e2d\u521b\u5efa\u7684\u9876\u70b9\u5c06\u5206\u914d\u7ed9\u540c\u4e00\u5206\u533a\u3002\u8fd9\u79cd\u7b56\u7565\u5f88\u5bb9\u6613\u63a8\u7406\uff0c\u5e76\u4e14\u5728\u540c\u4e00\u4e8b\u52a1\u4e2d\u7ecf\u5e38\u5171\u540c\u904d\u5386\u9876\u70b9\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u826f\u597d - \u901a\u8fc7\u4f18\u5316\u52a0\u8f7d\u7b56\u7565\u5230\u8be5\u6548\u679c\uff0c\u6216\u8005\u56e0\u4e3a\u9876\u70b9\u81ea\u7136\u5730\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\u3002\u4f46\u662f\uff0c\u7b56\u7565\u662f\u6709\u9650\u7684\uff0c\u5f53\u5728\u5927\u578b\u4e8b\u52a1\u4e2d\u52a0\u8f7d\u6570\u636e\u65f6\u5bfc\u81f4\u4e0d\u5e73\u8861\u7684\u5206\u533a\uff0c\u800c\u4e0d\u662f\u8bb8\u591a\u7528\u4f8b\u7684\u6700\u4f73\u7b56\u7565\u3002IDPlacementStrategy\u63a5\u53e3\u5e76\u901a\u8fc7ids.placement\u9009\u9879\u5728\u914d\u7f6e\u4e2d\u6ce8\u518c\u5b83\u3002 \u5b9e\u73b0\u65f6IDPlacementStrategy\uff0c\u8bf7\u6ce8\u610f\u5206\u533a\u7531\u6574\u6570id\u6807\u8bc6\uff0c\u8303\u56f4\u4ece0\u5230\u914d\u7f6e\u7684\u865a\u62df\u5206\u533a\u6570\u51cf1.\u5bf9\u4e8e\u6211\u4eec\u7684\u793a\u4f8b\u914d\u7f6e\uff0c\u6709\u5206\u533a0,1,2,3\uff0c..31\u3002\u5206\u533aID\u4e0e\u9876\u70b9ID\u4e0d\u540c\u3002\u5f53JanusGraph\u670d\u52a1\u5668\u4e0e\u5b58\u50a8\u540e\u7aef\u4f4d\u4e8e\u540c\u4e00\u4e3b\u673a\u4e0a\u65f6\uff0c\u8fb9\u7f18\u5207\u5272\u66f4\u6709\u610f\u4e49\u3002\u5982\u679c\u60a8\u5fc5\u987b\u5728\u904d\u5386\u7684\u6bcf\u4e00\u8df3\u4e0a\u5bf9\u4e0d\u540c\u7684\u4e3b\u673a\u8fdb\u884c\u7f51\u7edc\u547c\u53eb\uff0c\u5219\u8fb9\u7f18\u524a\u51cf\u548c\u81ea\u5b9a\u4e49\u653e\u7f6e\u7b56\u7565\u7684\u597d\u5904\u53ef\u80fd\u4f1a\u5927\u5927\u65e0\u6548\u3002 35.2 \u9876\u70b9\u5207\u5272 \u8fb9\u5207\u4f18\u5316\u65e8\u5728\u51cf\u5c11\u4ea4\u53c9\u901a\u4fe1\uff0c\u4ece\u800c\u6539\u5584\u67e5\u8be2\u6267\u884c\uff0c\u800c\u9876\u70b9\u5207\u5272\u89e3\u51b3\u4e86\u7531\u5177\u6709\u5927\u91cf\u5165\u5c04\u8fb9\u7684\u9876\u70b9\u5f15\u8d77\u7684\u70ed\u70b9\u95ee\u9898\u3002\u867d\u7136\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u6709\u6548\u5730\u89e3\u51b3\u4e86\u5927\u5ea6\u9876\u70b9\u7684\u67e5\u8be2\u6027\u80fd\uff0c\u4f46\u662f\u9700\u8981\u9876\u70b9\u5207\u5272\u6765\u89e3\u51b3\u975e\u5e38\u5927\u7684\u56fe\u4e0a\u7684\u70ed\u70b9\u95ee\u9898\u3002 \u526a\u5207\u9876\u70b9\u610f\u5473\u7740\u5728\u56fe\u4e2d\u7684\u6bcf\u4e2a\u5206\u533a\u4e0a\u5b58\u50a8\u8be5\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\u7684\u5b50\u96c6\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u9876\u70b9\u53ca\u5176\u90bb\u63a5\u5217\u8868\u88ab\u5206\u533a\uff0c\u4ece\u800c\u6709\u6548\u5730\u5c06\u8be5\u5355\u4e2a\u9876\u70b9\u4e0a\u7684\u8d1f\u8f7d\u5206\u5e03\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u5b9e\u4f8b\u4e0a\u5e76\u79fb\u9664\u70ed\u70b9\u3002 JanusGraph\u6309\u6807\u7b7e\u5207\u5272\u9876\u70b9\u3002\u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5206\u533a\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u6807\u7b7e\u7684\u6240\u6709\u9876\u70b9\u5c06\u4ee5\u4e0a\u8ff0\u65b9\u5f0f\u5728\u6574\u4e2a\u96c6\u7fa4\u4e2d\u8fdb\u884c\u5206\u533a\u3002 mgmt = graph.openManagement() mgmt.makeVertexLabel('user').make() mgmt.makeVertexLabel('product').partition().make() mgmt.commit() \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0cproduct\u5b9a\u4e49\u4e3a\u5206\u533a\u9876\u70b9\u6807\u7b7e\uff0cuser\u662f\u666e\u901a\u6807\u7b7e\u3002\u8fd9\u79cd\u914d\u7f6e\u6709\u5229\u4e8e\u6570\u5343\u79cd\u4ea7\u54c1\u4f46\u6570\u767e\u4e07\u7528\u6237\u548c\u7528\u6237\u4e0e\u4ea7\u54c1\u4e4b\u95f4\u8bb0\u5f55\u4ea4\u6613\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ea7\u54c1\u9876\u70b9\u5c06\u5177\u6709\u975e\u5e38\u9ad8\u7684\u7a0b\u5ea6\uff0c\u5982\u679c\u6ca1\u6709\u5206\u533a\uff0c\u6d41\u884c\u7684\u4ea7\u54c1\u5c06\u53d8\u6210\u70ed\u70b9\u3002 35.3 \u56fe\u5206\u533a\u5e38\u89c1\u95ee\u9898\u89e3\u7b54 35.3.1 \u968f\u673a\u5206\u533a\u4e0e\u663e\u5f0f\u5206\u533a \u5f53\u56fe\u8868\u5f88\u5c0f\u6216\u7531\u5c11\u6570\u5b58\u50a8\u5b9e\u4f8b\u5bb9\u7eb3\u65f6\uff0c\u6700\u597d\u4f7f\u7528\u968f\u673a\u5206\u533a\u4ee5\u7b80\u5316\u3002\u6839\u636e\u7ecf\u9a8c\uff0c\u5f53\u56fe\u5f62\u589e\u957f\u5230\u6570\u5341\u4ebf\u4e2a\u8fb9\u7f18\u768410s\u65f6\uff0c\u5e94\u8be5\u5f3a\u70c8\u8003\u8651\u542f\u7528\u663e\u5f0f\u56fe\u5f62\u5206\u533a\u5e76\u914d\u7f6e\u5408\u9002\u7684\u5206\u533a\u542f\u53d1\u5f0f\u7b97\u6cd5\u3002","title":"35.\u56fe\u5206\u533a"},{"location":"advanced_topics/graph_partitioning/#35","text":"\u5f53JanusGraph\u90e8\u7f72\u5728\u591a\u4e2a\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u7684\u96c6\u7fa4\u4e0a\u65f6\uff0c\u56fe\u8868\u5c06\u5728\u8fd9\u4e9b\u8ba1\u7b97\u673a\u4e0a\u8fdb\u884c\u5206\u533a\u3002\u7531\u4e8eJanusGraph\u5c06\u56fe\u5f62\u5b58\u50a8\u5728\u90bb\u63a5\u5217\u8868\u8868\u793a\u4e2d\uff0c\u56e0\u6b64\u5c06\u9876\u70b9\u5206\u914d\u7ed9\u673a\u5668\u786e\u5b9a\u4e86\u5206\u533a\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u4f7f\u7528\u968f\u673a\u5206\u533a\u7b56\u7565\u5c06\u9876\u70b9\u968f\u673a\u5206\u914d\u7ed9\u8ba1\u7b97\u673a\u3002\u968f\u673a\u5206\u533a\u975e\u5e38\u6709\u6548\uff0c\u65e0\u9700\u914d\u7f6e\uff0c\u5e76\u53ef\u5b9e\u73b0\u5e73\u8861\u5206\u533a\u3002\u76ee\u524d\u4e0d\u652f\u6301\u663e\u5f0f\u5206\u533a\u3002 cluster.max-partitions = 32 id.placement = simple \u914d\u7f6e\u9009\u9879max-partitions\u63a7\u5236JanusGraph\u521b\u5efa\u7684\u865a\u62df\u5206\u533a\u6570\u3002\u6b64\u6570\u5b57\u5e94\u5927\u7ea6\u662f\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u6570\u7684\u4e24\u500d\u3002\u5982\u679c\u9884\u8ba1\u5b58\u50a8\u540e\u7aef\u5b9e\u4f8b\u96c6\u7fa4\u5c06\u589e\u957f\uff0c\u8bf7\u5728\u53ef\u9884\u89c1\u7684\u672a\u6765\u4f30\u8ba1\u96c6\u7fa4\u7684\u5927\u5c0f\uff0c\u5e76\u5c06\u6b64\u6570\u91cf\u4f5c\u4e3a\u57fa\u51c6\u3002\u5c06\u6b64\u6570\u5b57\u8bbe\u7f6e\u5f97\u8fc7\u5927\u4f1a\u4e0d\u5fc5\u8981\u5730\u7834\u574f\u7fa4\u96c6\uff0c\u4ece\u800c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\u3002\u6b64\u6570\u5b57\u5e94\u5927\u4e8eJanusGraph\u56fe\u4e2d\u6700\u5927\u9884\u671f\u8282\u70b9\u6570\u3002\u5b83\u5fc5\u987b\u5927\u4e8e1\u4e14\u5e42\u4e3a2\u3002 \u56fe\u5f62\u5206\u533a\u6709\u4e24\u4e2a\u65b9\u9762\u53ef\u4ee5\u5355\u72ec\u63a7\u5236\uff1a\u8fb9\u7f18\u5207\u5272\u548c\u9876\u70b9\u5207\u5272\u3002","title":"35\u3001 \u56fe\u5206\u533a"},{"location":"advanced_topics/graph_partitioning/#351","text":"\u5728\u5c06\u9876\u70b9\u5206\u914d\u7ed9\u5206\u533a\u65f6\uff0c\u4eba\u4eec\u52aa\u529b\u4f18\u5316\u5206\u914d\uff0c\u4f7f\u5f97\u7ecf\u5e38\u5171\u540c\u904d\u5386\u7684\u9876\u70b9\u6258\u7ba1\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u3002\u5047\u8bbe\u9876\u70b9A\u5206\u914d\u7ed9\u673a\u56681\uff0c\u9876\u70b9B\u5206\u914d\u7ed9\u673a\u56682.\u9876\u70b9\u4e4b\u95f4\u7684\u8fb9\u7f18\u79f0\u4e3a\u5207\u8fb9\uff0c\u56e0\u4e3a\u5b83\u7684\u7aef\u70b9\u6258\u7ba1\u5728\u4e0d\u540c\u7684\u673a\u5668\u4e0a\u3002\u904d\u5386\u6b64\u8fb9\u7f18\u4f5c\u4e3a\u56fe\u5f62\u67e5\u8be2\u7684\u4e00\u90e8\u5206\u9700\u8981\u5728\u673a\u5668\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\uff0c\u8fd9\u4f1a\u51cf\u6162\u67e5\u8be2\u5904\u7406\u901f\u5ea6\u3002\u56e0\u6b64\uff0c\u5e0c\u671b\u51cf\u5c11\u9891\u7e41\u904d\u5386\u8fb9\u7f18\u7684\u8fb9\u7f18\u5207\u5272\u3002\u53cd\u8fc7\u6765\uff0c\u8fd9\u9700\u8981\u5c06\u9891\u7e41\u904d\u5386\u7684\u8fb9\u7f18\u7684\u76f8\u90bb\u9876\u70b9\u653e\u7f6e\u5728\u540c\u4e00\u5206\u533a\u4e2d\u3002 \u9876\u70b9\u901a\u8fc7\u6307\u5b9a\u7684\u9876\u70b9id\u653e\u7f6e\u5728\u5206\u533a\u4e2d\u3002\u5206\u533a\u672c\u8d28\u4e0a\u662f\u9876\u70b9id\u7684\u8fde\u7eed\u8303\u56f4\u3002\u8981\u5728\u7279\u5b9a\u5206\u533a\u4e2d\u653e\u7f6e\u9876\u70b9\uff0cJanusGraph\u4f1a\u4ece\u5206\u533a\u7684\u9876\u70b9id\u8303\u56f4\u4e2d\u9009\u62e9\u4e00\u4e2aid\u3002JanusGraph\u901a\u8fc7\u914d\u7f6e\u7684\u653e\u7f6e\u7b56\u7565\u63a7\u5236\u9876\u70b9\u5230\u5206\u533a\u7684\u5206\u914d\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u540c\u4e00\u4e8b\u52a1\u4e2d\u521b\u5efa\u7684\u9876\u70b9\u5c06\u5206\u914d\u7ed9\u540c\u4e00\u5206\u533a\u3002\u8fd9\u79cd\u7b56\u7565\u5f88\u5bb9\u6613\u63a8\u7406\uff0c\u5e76\u4e14\u5728\u540c\u4e00\u4e8b\u52a1\u4e2d\u7ecf\u5e38\u5171\u540c\u904d\u5386\u9876\u70b9\u7684\u60c5\u51b5\u4e0b\u8fd0\u884c\u826f\u597d - \u901a\u8fc7\u4f18\u5316\u52a0\u8f7d\u7b56\u7565\u5230\u8be5\u6548\u679c\uff0c\u6216\u8005\u56e0\u4e3a\u9876\u70b9\u81ea\u7136\u5730\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\u3002\u4f46\u662f\uff0c\u7b56\u7565\u662f\u6709\u9650\u7684\uff0c\u5f53\u5728\u5927\u578b\u4e8b\u52a1\u4e2d\u52a0\u8f7d\u6570\u636e\u65f6\u5bfc\u81f4\u4e0d\u5e73\u8861\u7684\u5206\u533a\uff0c\u800c\u4e0d\u662f\u8bb8\u591a\u7528\u4f8b\u7684\u6700\u4f73\u7b56\u7565\u3002IDPlacementStrategy\u63a5\u53e3\u5e76\u901a\u8fc7ids.placement\u9009\u9879\u5728\u914d\u7f6e\u4e2d\u6ce8\u518c\u5b83\u3002 \u5b9e\u73b0\u65f6IDPlacementStrategy\uff0c\u8bf7\u6ce8\u610f\u5206\u533a\u7531\u6574\u6570id\u6807\u8bc6\uff0c\u8303\u56f4\u4ece0\u5230\u914d\u7f6e\u7684\u865a\u62df\u5206\u533a\u6570\u51cf1.\u5bf9\u4e8e\u6211\u4eec\u7684\u793a\u4f8b\u914d\u7f6e\uff0c\u6709\u5206\u533a0,1,2,3\uff0c..31\u3002\u5206\u533aID\u4e0e\u9876\u70b9ID\u4e0d\u540c\u3002\u5f53JanusGraph\u670d\u52a1\u5668\u4e0e\u5b58\u50a8\u540e\u7aef\u4f4d\u4e8e\u540c\u4e00\u4e3b\u673a\u4e0a\u65f6\uff0c\u8fb9\u7f18\u5207\u5272\u66f4\u6709\u610f\u4e49\u3002\u5982\u679c\u60a8\u5fc5\u987b\u5728\u904d\u5386\u7684\u6bcf\u4e00\u8df3\u4e0a\u5bf9\u4e0d\u540c\u7684\u4e3b\u673a\u8fdb\u884c\u7f51\u7edc\u547c\u53eb\uff0c\u5219\u8fb9\u7f18\u524a\u51cf\u548c\u81ea\u5b9a\u4e49\u653e\u7f6e\u7b56\u7565\u7684\u597d\u5904\u53ef\u80fd\u4f1a\u5927\u5927\u65e0\u6548\u3002","title":"35.1 \u8fb9\u7f18\u5207\u5272"},{"location":"advanced_topics/graph_partitioning/#352","text":"\u8fb9\u5207\u4f18\u5316\u65e8\u5728\u51cf\u5c11\u4ea4\u53c9\u901a\u4fe1\uff0c\u4ece\u800c\u6539\u5584\u67e5\u8be2\u6267\u884c\uff0c\u800c\u9876\u70b9\u5207\u5272\u89e3\u51b3\u4e86\u7531\u5177\u6709\u5927\u91cf\u5165\u5c04\u8fb9\u7684\u9876\u70b9\u5f15\u8d77\u7684\u70ed\u70b9\u95ee\u9898\u3002\u867d\u7136\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u6709\u6548\u5730\u89e3\u51b3\u4e86\u5927\u5ea6\u9876\u70b9\u7684\u67e5\u8be2\u6027\u80fd\uff0c\u4f46\u662f\u9700\u8981\u9876\u70b9\u5207\u5272\u6765\u89e3\u51b3\u975e\u5e38\u5927\u7684\u56fe\u4e0a\u7684\u70ed\u70b9\u95ee\u9898\u3002 \u526a\u5207\u9876\u70b9\u610f\u5473\u7740\u5728\u56fe\u4e2d\u7684\u6bcf\u4e2a\u5206\u533a\u4e0a\u5b58\u50a8\u8be5\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\u7684\u5b50\u96c6\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u9876\u70b9\u53ca\u5176\u90bb\u63a5\u5217\u8868\u88ab\u5206\u533a\uff0c\u4ece\u800c\u6709\u6548\u5730\u5c06\u8be5\u5355\u4e2a\u9876\u70b9\u4e0a\u7684\u8d1f\u8f7d\u5206\u5e03\u5728\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u5b9e\u4f8b\u4e0a\u5e76\u79fb\u9664\u70ed\u70b9\u3002 JanusGraph\u6309\u6807\u7b7e\u5207\u5272\u9876\u70b9\u3002\u9876\u70b9\u6807\u7b7e\u53ef\u4ee5\u5b9a\u4e49\u4e3a\u5206\u533a\uff0c\u8fd9\u610f\u5473\u7740\u8be5\u6807\u7b7e\u7684\u6240\u6709\u9876\u70b9\u5c06\u4ee5\u4e0a\u8ff0\u65b9\u5f0f\u5728\u6574\u4e2a\u96c6\u7fa4\u4e2d\u8fdb\u884c\u5206\u533a\u3002 mgmt = graph.openManagement() mgmt.makeVertexLabel('user').make() mgmt.makeVertexLabel('product').partition().make() mgmt.commit() \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0cproduct\u5b9a\u4e49\u4e3a\u5206\u533a\u9876\u70b9\u6807\u7b7e\uff0cuser\u662f\u666e\u901a\u6807\u7b7e\u3002\u8fd9\u79cd\u914d\u7f6e\u6709\u5229\u4e8e\u6570\u5343\u79cd\u4ea7\u54c1\u4f46\u6570\u767e\u4e07\u7528\u6237\u548c\u7528\u6237\u4e0e\u4ea7\u54c1\u4e4b\u95f4\u8bb0\u5f55\u4ea4\u6613\u7684\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4ea7\u54c1\u9876\u70b9\u5c06\u5177\u6709\u975e\u5e38\u9ad8\u7684\u7a0b\u5ea6\uff0c\u5982\u679c\u6ca1\u6709\u5206\u533a\uff0c\u6d41\u884c\u7684\u4ea7\u54c1\u5c06\u53d8\u6210\u70ed\u70b9\u3002","title":"35.2 \u9876\u70b9\u5207\u5272"},{"location":"advanced_topics/graph_partitioning/#353","text":"","title":"35.3 \u56fe\u5206\u533a\u5e38\u89c1\u95ee\u9898\u89e3\u7b54"},{"location":"advanced_topics/graph_partitioning/#3531","text":"\u5f53\u56fe\u8868\u5f88\u5c0f\u6216\u7531\u5c11\u6570\u5b58\u50a8\u5b9e\u4f8b\u5bb9\u7eb3\u65f6\uff0c\u6700\u597d\u4f7f\u7528\u968f\u673a\u5206\u533a\u4ee5\u7b80\u5316\u3002\u6839\u636e\u7ecf\u9a8c\uff0c\u5f53\u56fe\u5f62\u589e\u957f\u5230\u6570\u5341\u4ebf\u4e2a\u8fb9\u7f18\u768410s\u65f6\uff0c\u5e94\u8be5\u5f3a\u70c8\u8003\u8651\u542f\u7528\u663e\u5f0f\u56fe\u5f62\u5206\u533a\u5e76\u914d\u7f6e\u5408\u9002\u7684\u5206\u533a\u542f\u53d1\u5f0f\u7b97\u6cd5\u3002","title":"35.3.1 \u968f\u673a\u5206\u533a\u4e0e\u663e\u5f0f\u5206\u533a"},{"location":"advanced_topics/index_management/","text":"33.1 \u91cd\u5efa\u7d22\u5f15 \u7b2c11.1\u8282\u201c\u56fe\u5f62\u7d22\u5f15\u201d\u548c\u7b2c11.2\u8282\u201c\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u201d\u63cf\u8ff0\u4e86\u5982\u4f55\u6784\u5efa\u56fe\u5f62\u5168\u5c40\u7d22\u5f15\u548c\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u6765\u63d0\u9ad8\u67e5\u8be2\u6027\u80fd\u3002\u5982\u679c\u5728\u76f8\u540c\u7684\u7ba1\u7406\u4e8b\u52a1\u4e2d\u65b0\u5b9a\u4e49\u4e86\u7d22\u5f15\u952e\u6216\u6807\u7b7e\uff0c\u5219\u53ef\u4ee5\u7acb\u5373\u4f7f\u7528\u8fd9\u4e9b\u7d22\u5f15\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u9700\u8981\u91cd\u65b0\u7d22\u5f15\u56fe\uff0c\u8fd9\u4e2a\u90e8\u5206\u53ef\u4ee5\u8df3\u8fc7\u3002\u5982\u679c\u7d22\u5f15\u952e\u548c\u6807\u7b7e\u5728\u7d22\u5f15\u6784\u9020\u4e4b\u524d\u5c31\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u6709\u5fc5\u8981\u91cd\u65b0\u7d22\u5f15\u6574\u4e2a\u56fe\uff0c\u4ee5\u786e\u4fdd\u7d22\u5f15\u5305\u542b\u4ee5\u524d\u6dfb\u52a0\u7684\u5143\u7d20\u3002\u672c\u8282\u4ecb\u7ecd\u91cd\u5efa\u7d22\u5f15\u8fc7\u7a0b\u3002 \u8b66\u544a: \u91cd\u65b0\u7d22\u5f15\u662f\u4e00\u4e2a\u7531\u591a\u4e2a\u6b65\u9aa4\u7ec4\u6210\u7684\u624b\u52a8\u8fc7\u7a0b\u3002\u5fc5\u987b\u6309\u6b63\u786e\u7684\u987a\u5e8f\u4ed4\u7ec6\u9075\u5faa\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u4ee5\u907f\u514d\u7d22\u5f15\u4e0d\u4e00\u81f4\u3002 33.1.1 \u6982\u8ff0 JanusGraph\u53ef\u4ee5\u5728\u5b9a\u4e49\u7d22\u5f15\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u7f16\u5199\u589e\u91cf\u7d22\u5f15\u66f4\u65b0\u3002\u4f46\u662f\uff0c\u5728\u7d22\u5f15\u5b8c\u6210\u5e76\u53ef\u7528\u4e4b\u524d\uff0cJanusGraph\u8fd8\u5fc5\u987b\u4e00\u6b21\u6027\u8bfb\u53d6\u4e0e\u65b0\u7d22\u5f15\u6a21\u5f0f\u7c7b\u578b\u5173\u8054\u7684\u6240\u6709\u73b0\u6709\u56fe\u5f62\u5143\u7d20\u3002\u4e00\u65e6\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u5b8c\u6210\uff0c\u7d22\u5f15\u5c31\u88ab\u5b8c\u5168\u586b\u5145\u5e76\u51c6\u5907\u597d\u4f7f\u7528\u3002\u7136\u540e\u5fc5\u987b\u542f\u7528\u7d22\u5f15\u624d\u80fd\u5728\u67e5\u8be2\u5904\u7406\u671f\u95f4\u4f7f\u7528\u3002 33.1.2 \u5728\u91cd\u5efa\u7d22\u5f15\u4e4b\u524d \u91cd\u5efa\u7d22\u5f15\u8fc7\u7a0b\u7684\u8d77\u70b9\u662f\u6784\u5efa\u4e00\u4e2a\u7d22\u5f15\u3002\u6709\u5173\u5168\u5c40\u56fe\u548c\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u7684\u5b8c\u6574\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605\u7b2c11\u7ae0\uff0c\u7d22\u5f15\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\u3002\u8bf7\u6ce8\u610f\uff0c\u5168\u5c40\u56fe\u7d22\u5f15\u7531\u5176\u540d\u79f0\u552f\u4e00\u6807\u8bc6\u3002\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7531\u5176\u540d\u79f0\u548c\u5b9a\u4e49\u7d22\u5f15\u7684\u8fb9\u7f18\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u7ec4\u5408\u60df\u4e00\u6807\u8bc6 \u2014\u2014 \u540e\u8005\u7684\u540d\u79f0\u5728\u672c\u8282\u4e2d\u79f0\u4e3a\u7d22\u5f15\u7c7b\u578b\uff0c\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u3002 \u5728\u9488\u5bf9\u73b0\u6709\u6a21\u5f0f\u5143\u7d20\u6784\u5efa\u65b0\u7d22\u5f15\u4e4b\u540e\uff0c\u5efa\u8bae\u7b49\u5f85\u51e0\u5206\u949f\u5c06\u7d22\u5f15\u901a\u77e5\u5230\u96c6\u7fa4\u3002\u6ce8\u610f\u7d22\u5f15\u540d(\u5bf9\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\uff0c\u4ee5\u53ca\u7d22\u5f15\u7c7b\u578b)\uff0c\u56e0\u4e3a\u5728\u7d22\u5f15\u68c0\u7d22\u65f6\u9700\u8981\u6b64\u4fe1\u606f\u3002 33.1.3 \u51c6\u5907\u91cd\u65b0\u7d22\u5f15 \u53ef\u4ee5\u5728\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u7684\u4e24\u4e2a\u6267\u884c\u6846\u67b6\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\uff1a - MapReduce - JanusGraphManagement MapReduce\u4e0a\u7684Reindex\u652f\u6301\u5927\u578b\u6c34\u5e73\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3002JanusGraphManagement\u4e0a\u7684\u91cd\u65b0\u7d22\u5f15\u4f1a\u751f\u6210\u5355\u673aOLAP\u4f5c\u4e1a\u3002\u8fd9\u662f\u4e3a\u4e86\u65b9\u4fbf\u548c\u5feb\u901f\u5730\u5728\u90a3\u4e9b\u5c0f\u5230\u8db3\u4ee5\u7531\u4e00\u53f0\u673a\u5668\u5904\u7406\u7684\u6570\u636e\u5e93\u3002 \u91cd\u65b0\u7d22\u5f15\u9700\u8981\uff1a \u7d22\u5f15\u540d\u79f0\uff08\u4e00\u4e2a\u5b57\u7b26\u4e32 - \u7528\u6237\u5728\u6784\u5efa\u65b0\u7d22\u5f15\u65f6\u5c06\u6b64\u63d0\u4f9b\u7ed9JanusGraph\uff09 \u7d22\u5f15\u7c7b\u578b\uff08\u5b57\u7b26\u4e32 - \u6784\u5efa\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff09\u3002\u8fd9\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 - \u4e3a\u5168\u5c40\u56fe\u7d22\u5f15\u7559\u7a7a\u3002 33.1.4 \u5728MapReduce\u4e0a\u6267\u884c\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a \u5728MapReduce\u4e0a\u751f\u6210\u548c\u8fd0\u884creindex\u4f5c\u4e1a\u7684\u63a8\u8350\u65b9\u6cd5\u662f\u901a\u8fc7MapReduceIndexManagement\u7c7b\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528\u6b64\u7c7b\u8fd0\u884creindex\u4f5c\u4e1a\u7684\u6b65\u9aa4\u7684\u6982\u8ff0\uff1a - \u6253\u5f00\u4e00\u4e2aJanusGraph\u5b9e\u4f8b - \u5c06\u56fe\u5f62\u5b9e\u4f8b\u4f20\u9012\u7ed9MapReduceIndexManagement\u6784\u9020\u51fd\u6570 - \u8c03\u7528updateIndex( , SchemaAction.REINDEX)\u7684MapReduceIndexManagement\u5b9e\u4f8b - \u5982\u679c\u5c1a\u672a\u542f\u7528\u7d22\u5f15\uff0c\u8bf7\u542f\u7528\u5b83 JanusGraphManagement \u8be5\u7c7b\u5b9e\u73b0\u4e86\u4e00\u4e2aupdateIndex\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4ec5\u652f\u6301\u5176SchemaAction\u53c2\u6570\u7684REINDEX\u548cREMOVE_INDEX\u64cd\u4f5c\u3002\u8be5\u7c7b\u4f7f\u7528Hadoop\u914d\u7f6e\u542f\u52a8Hadoop MapReduce\u4f5c\u4e1a\uff0c\u5e76\u5728\u7c7b\u8def\u5f84\u4e0a\u4f7f\u7528jar\u3002\u652f\u6301Hadoop 1\u548c2\u3002\u8be5\u7c7b\u4ece\u7ed9\u5176\u6784\u9020\u51fd\u6570\u7684JanusGraph\u5b9e\u4f8b\u4e2d\u83b7\u53d6\u5173\u4e8e\u7d22\u5f15\u548c\u5b58\u50a8\u540e\u7aef(\u4f8b\u5982Cassandra partitioner)\u7684\u5143\u6570\u636e\u3002 graph = JanusGraphFactory.open(...) mgmt = graph.openManagement() mr = new MapReduceIndexManagement(graph) mr.updateIndex(mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ), SchemaAction.REINDEX).get() mgmt.commit() 33.1.4.1 MapReduce\u4e0a\u7684\u91cd\u5efa\u7d22\u5f15\u793a\u4f8b \u4ee5\u4e0bGremlin\u7247\u6bb5\u5728\u4e00\u4e2a\u81ea\u5305\u542b\u793a\u4f8b\u4e2d\u4f7f\u7528\u9488\u5bf9Cassandra\u5b58\u50a8\u540e\u7aef\u7684\u6700\u5c0f\u865a\u62df\u6570\u636e\u6982\u8ff0\u4e86MapReduce reindex\u8fc7\u7a0b\u7684\u6240\u6709\u6b65\u9aa4\u3002 // Open a graph graph = JanusGraphFactory.open( conf/janusgraph-cql-es.properties ) g = graph.traversal() // Define a property mgmt = graph.openManagement() desc = mgmt.makePropertyKey( desc ).dataType(String.class).make() mgmt.commit() // Insert some data graph.addVertex( desc , foo bar ) graph.addVertex( desc , foo baz ) graph.tx().commit() // Run a query -- note the planner warning recommending the use of an index g.V().has( desc , containsText( baz )) // Create an index mgmt = graph.openManagement() desc = mgmt.getPropertyKey( desc ) mixedIndex = mgmt.buildIndex( mixedExample , Vertex.class).addKey(desc).buildMixedIndex( search ) mgmt.commit() // Rollback or commit transactions on the graph which predate the index definition graph.tx().rollback() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED report = ManagementSystem.awaitGraphIndexStatus(graph, mixedExample ).call() // Run a JanusGraph-Hadoop job to reindex mgmt = graph.openManagement() mr = new MapReduceIndexManagement(graph) mr.updateIndex(mgmt.getGraphIndex( mixedExample ), SchemaAction.REINDEX).get() // Enable the index mgmt = graph.openManagement() mgmt.updateIndex(mgmt.getGraphIndex( mixedExample ), SchemaAction.ENABLE_INDEX).get() mgmt.commit() // Block until the SchemaStatus is ENABLED mgmt = graph.openManagement() report = ManagementSystem.awaitGraphIndexStatus(graph, mixedExample ).status(SchemaStatus.ENABLED).call() mgmt.rollback() // Run a query -- JanusGraph will use the new index, no planner warning g.V().has( desc , containsText( baz )) // Concerned that JanusGraph could have read cache in that last query, instead of relying on the index? // Start a new instance to rule out cache hits. Now we're definitely using the index. graph.close() graph = JanusGraphFactory.open( conf/janusgraph-cql-es.properties ) g.V().has( desc , containsText( baz )) 33.1.5 \u5728JanusGraphManagement\u4e0a\u6267\u884c\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a \u8981\u5728JanusGraphManagement\u4e0a\u8fd0\u884creindex\u4f5c\u4e1a\uff0c\u8bf7JanusGraphManagement.updateIndex\u4f7f\u7528SchemaAction.REINDEX\u53c2\u6570\u8fdb\u884c\u8c03\u7528\u3002\u4f8b\u5982\uff1a m = graph.openManagement() i = m.getGraphIndex('indexName') m.updateIndex(i, SchemaAction.REINDEX).get() m.commit() 33.1.5.1 JanusGraphManagement\u7684\u793a\u4f8b \u4e0b\u9762\u5c06\u4e00\u4e9b\u793a\u4f8b\u6570\u636e\u52a0\u8f7d\u5230BerkeleyDB\u652f\u6301\u7684JanusGraph\u6570\u636e\u5e93\u4e2d\uff0c\u5728\u4e8b\u540e\u5b9a\u4e49\u7d22\u5f15\uff0c\u4f7f\u7528JanusGraphManagement\u91cd\u65b0\u7d22\u5f15\uff0c\u6700\u540e\u542f\u7528\u5e76\u4f7f\u7528\u7d22\u5f15\uff1a import org.janusgraph.graphdb.database.management.ManagementSystem // Load some data from a file without any predefined schema graph = JanusGraphFactory.open('conf/janusgraph-berkeleyje.properties') g = graph.traversal() m = graph.openManagement() m.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.LIST).make() m.makePropertyKey('lang').dataType(String.class).cardinality(Cardinality.LIST).make() m.makePropertyKey('age').dataType(Integer.class).cardinality(Cardinality.LIST).make() m.commit() graph.io(IoCore.gryo()).readGraph('data/tinkerpop-modern.gio') graph.tx().commit() // Run a query -- note the planner warning recommending the use of an index g.V().has('name', 'lop') graph.tx().rollback() // Create an index m = graph.openManagement() m.buildIndex('names', Vertex.class).addKey(m.getPropertyKey('name')).buildCompositeIndex() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'names').status(SchemaStatus.REGISTERED).call() // Reindex using JanusGraphManagement m = graph.openManagement() i = m.getGraphIndex('names') m.updateIndex(i, SchemaAction.REINDEX) m.commit() // Enable the index ManagementSystem.awaitGraphIndexStatus(graph, 'names').status(SchemaStatus.ENABLED).call() // Run a query -- JanusGraph will use the new index, no planner warning g.V().has('name', 'lop') graph.tx().rollback() // Concerned that JanusGraph could have read cache in that last query, instead of relying on the index? // Start a new instance to rule out cache hits. Now we're definitely using the index. graph.close() graph = JanusGraphFactory.open( conf/janusgraph-berkeleyje.properties ) g = graph.traversal() g.V().has('name', 'lop') 33.2 \u5220\u9664\u7d22\u5f15 \u8b66\u544a: \u7d22\u5f15\u5220\u9664\u662f\u4e00\u4e2a\u7531\u591a\u4e2a\u6b65\u9aa4\u7ec4\u6210\u7684\u624b\u52a8\u8fc7\u7a0b\u3002\u5fc5\u987b\u6309\u6b63\u786e\u7684\u987a\u5e8f\u4ed4\u7ec6\u9075\u5faa\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u4ee5\u907f\u514d\u7d22\u5f15\u4e0d\u4e00\u81f4\u3002 33.2.1 \u6982\u8ff0 \u7d22\u5f15\u5220\u9664\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\u3002\u5728\u7b2c\u4e00\u9636\u6bb5\uff0c\u4e00\u4e2aJanusGraph\u901a\u8fc7\u5b58\u50a8\u540e\u7aef\u5411\u6240\u6709\u5176\u4ed6\u4eba\u53d1\u4fe1\u53f7\u901a\u77e5\u7d22\u5f15\u5c06\u88ab\u5220\u9664\u3002\u8fd9\u4f1a\u5c06\u7d22\u5f15\u7684\u72b6\u6001\u66f4\u6539\u4e3aDISABLED\u3002\u6b64\u65f6\uff0cJanusGraph\u505c\u6b62\u4f7f\u7528\u7d22\u5f15\u6765\u5e94\u7b54\u67e5\u8be2\u5e76\u505c\u6b62\u9010\u6b65\u66f4\u65b0\u7d22\u5f15\u3002\u5b58\u50a8\u540e\u7aef\u4e2d\u4e0e\u7d22\u5f15\u76f8\u5173\u7684\u6570\u636e\u4ecd\u7136\u5b58\u5728\u4f46\u88ab\u5ffd\u7565\u3002 \u7b2c\u4e8c\u9636\u6bb5\u53d6\u51b3\u4e8e\u6307\u6570\u662f\u6df7\u5408\u7684\u8fd8\u662f\u590d\u5408\u7684\u3002\u590d\u5408\u7d22\u5f15\u53ef\u4ee5\u901a\u8fc7JanusGraph\u5220\u9664\u3002\u4e0e\u91cd\u5efa\u7d22\u5f15\u4e00\u6837\uff0c\u53ef\u4ee5\u901a\u8fc7MapReduce\u6216JanusGraphManagement\u8fdb\u884c\u5220\u9664\u3002\u4f46\u662f\uff0c\u6df7\u5408\u7d22\u5f15\u5fc5\u987b\u5728\u7d22\u5f15\u540e\u7aef\u624b\u52a8\u5220\u9664;JanusGraph\u4e0d\u63d0\u4f9b\u4ece\u7d22\u5f15\u540e\u7aef\u5220\u9664\u7d22\u5f15\u7684\u81ea\u52a8\u673a\u5236\u3002 \u9664\u6a21\u5f0f\u5b9a\u4e49\u548c\u7981\u7528\u72b6\u6001\u5916\uff0c\u7d22\u5f15\u5220\u9664\u5220\u9664\u4e0e\u7d22\u5f15\u5173\u8054\u7684\u6240\u6709\u5185\u5bb9\u3002\u5373\u4f7f\u5728\u5220\u9664\u4e4b\u540e\uff0c\u7d22\u5f15\u7684\u8fd9\u4e2a\u6a21\u5f0f\u5b58\u6839\u4ecd\u7136\u4fdd\u7559\uff0c\u5c3d\u7ba1\u5b83\u7684\u5b58\u50a8\u5360\u7528\u53ef\u4ee5\u5ffd\u7565\u5e76\u4e14\u662f\u56fa\u5b9a\u7684\u3002 33.2.2 \u51c6\u5907\u5220\u9664\u7d22\u5f15 \u5982\u679c\u5f53\u524d\u542f\u7528\u4e86\u7d22\u5f15\uff0c\u5219\u5e94\u9996\u5148\u7981\u7528\u5b83\u3002\u8fd9\u662f\u901a\u8fc7ManagementSystem\u3002 mgmt = graph.openManagement() rindex = mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ) mgmt.updateIndex(rindex, SchemaAction.DISABLE_INDEX).get() gindex = mgmt.getGraphIndex( byName ) mgmt.updateIndex(gindex, SchemaAction.DISABLE_INDEX).get() mgmt.commit() \u4e00\u65e6\u7d22\u5f15\u4e0a\u7684\u6240\u6709\u952e\u7684\u72b6\u6001\u53d8\u4e3aDISABLED\uff0c\u5c31\u53ef\u4ee5\u5220\u9664\u7d22\u5f15\u3002ManagementSystem\u4e2d\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u81ea\u52a8\u6267\u884c\u7b49\u5f85DISABLED\u6b65\u9aa4\uff1a ManagementSystem.awaitGraphIndexStatus(graph, 'byName').status(SchemaStatus.DISABLED).call() \u5728\u590d\u5408\u7d22\u5f15\u4e4b\u540eDISABLED\uff0c\u53ef\u4ee5\u9009\u62e9\u4e24\u4e2a\u6267\u884c\u6846\u67b6\u6765\u5220\u9664\u5b83\uff1a - MapReduce - JanusGraphManagement MapReduce\u4e0a\u7684\u7d22\u5f15\u5220\u9664\u652f\u6301\u5927\u578b\u6c34\u5e73\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3002JanusGraphManagement\u4e0a\u7684\u7d22\u5f15\u5220\u9664\u4f1a\u4ea7\u751f\u5355\u673aOLAP\u4f5c\u4e1a\u3002\u8fd9\u662f\u4e3a\u4e86\u65b9\u4fbf\u548c\u5feb\u901f\u5730\u5728\u90a3\u4e9b\u5c0f\u5230\u8db3\u4ee5\u7531\u4e00\u53f0\u673a\u5668\u5904\u7406\u7684\u6570\u636e\u5e93\u4e0a\u3002 \u5220\u9664\u7d22\u5f15\u9700\u8981\uff1a - \u7d22\u5f15\u540d\u79f0\uff08\u4e00\u4e2a\u5b57\u7b26\u4e32 - \u7528\u6237\u5728\u6784\u5efa\u65b0\u7d22\u5f15\u65f6\u5c06\u6b64\u63d0\u4f9b\u7ed9JanusGraph\uff09 - \u7d22\u5f15\u7c7b\u578b\uff08\u5b57\u7b26\u4e32 - \u6784\u5efa\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff09\u3002\u8fd9\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 - \u4e3a\u5168\u5c40\u56fe\u7d22\u5f15\u7559\u7a7a\u3002 \u5982\u6982\u8ff0\u4e2d\u6240\u8ff0\uff0c\u5fc5\u987b\u4ece\u7d22\u5f15\u540e\u7aef\u624b\u52a8\u5220\u9664\u6df7\u5408\u7d22\u5f15\u3002MapReduce\u6846\u67b6\u548cJanusGraphManagement\u6846\u67b6\u90fd\u4e0d\u4f1a\u4ece\u7d22\u5f15\u540e\u7aef\u5220\u9664\u6df7\u5408\u540e\u7aef\u3002 33.2.3 \u5728MapReduce\u4e0a\u6267\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a \u4e0e\u91cd\u5efa\u7d22\u5f15\u4e00\u6837\uff0c\u5728MapReduce\u4e0a\u751f\u6210\u548c\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\u7684\u63a8\u8350\u65b9\u6cd5\u662f\u901a\u8fc7MapReduceIndexManagement\u7c7b\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528\u6b64\u7c7b\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\u7684\u6b65\u9aa4\u7684\u6982\u8ff0\uff1a - \u6253\u5f00\u4e00\u4e2aJanusGraph\u5b9e\u4f8b - \u5982\u679c\u5c1a\u672a\u7981\u7528\u7d22\u5f15\uff0c\u8bf7\u5c06\u5176\u7981\u7528 JanusGraphManagement - \u5c06\u56fe\u5f62\u5b9e\u4f8b\u4f20\u9012\u7ed9MapReduceIndexManagement\u6784\u9020\u51fd\u6570 - \u8c03\u7528 updateIndex( , SchemaAction.REMOVE_INDEX) \u6ce8\u91ca\u4ee3\u7801\u793a\u4f8b\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\u4ecb\u7ecd\u3002 33.2.3.1 MapReduce\u7684\u793a\u4f8b import org.janusgraph.graphdb.database.management.ManagementSystem // Load the Graph of the Gods sample data graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') g = graph.traversal() GraphOfTheGodsFactory.load(graph) g.V().has('name', 'jupiter') // Disable the name composite index m = graph.openManagement() nameIndex = m.getGraphIndex('name') m.updateIndex(nameIndex, SchemaAction.DISABLE_INDEX).get() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'name').status(SchemaStatus.DISABLED).call() // Delete the index using MapReduceIndexJobs m = graph.openManagement() mr = new MapReduceIndexManagement(graph) future = mr.updateIndex(m.getGraphIndex('name'), SchemaAction.REMOVE_INDEX) m.commit() graph.tx().commit() future.get() // Index still shows up in management interface as DISABLED -- this is normal m = graph.openManagement() idx = m.getGraphIndex('name') idx.getIndexStatus(m.getPropertyKey('name')) m.rollback() // JanusGraph should issue a warning about this query requiring a full scan g.V().has('name', 'jupiter') 33.2.4 \u5728JanusGraphManagement\u4e0a\u6267\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a \u8981\u5728JanusGraphManagement\u4e0a\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\uff0c\u8bf7JanusGraphManagement.updateIndex\u4f7f\u7528SchemaAction.REMOVE_INDEX\u53c2\u6570\u8fdb\u884c\u8c03\u7528\u3002\u4f8b\u5982\uff1a m = graph.openManagement() i = m.getGraphIndex('indexName') m.updateIndex(i, SchemaAction.REMOVE_INDEX).get() m.commit() 33.2.4.1 JanusGraphManagement\u7684\u793a\u4f8b \u4ee5\u4e0b\u5c06\u4e00\u4e9b\u7d22\u5f15\u6837\u672c\u6570\u636e\u52a0\u8f7d\u5230BerkeleyDB\u652f\u6301\u7684JanusGraph\u6570\u636e\u5e93\u4e2d\uff0c\u7136\u540e\u901a\u8fc7JanusGraphManagement\u7981\u7528\u548c\u5220\u9664\u7d22\u5f15\uff1a import org.janusgraph.graphdb.database.management.ManagementSystem // Load the Graph of the Gods sample data graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') g = graph.traversal() GraphOfTheGodsFactory.load(graph) g.V().has('name', 'jupiter') // Disable the name composite index m = graph.openManagement() nameIndex = m.getGraphIndex('name') m.updateIndex(nameIndex, SchemaAction.DISABLE_INDEX).get() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'name').status(SchemaStatus.DISABLED).call() // Delete the index using JanusGraphManagement m = graph.openManagement() nameIndex = m.getGraphIndex('name') future = m.updateIndex(nameIndex, SchemaAction.REMOVE_INDEX) m.commit() graph.tx().commit() future.get() m = graph.openManagement() nameIndex = m.getGraphIndex('name') g.V().has('name', 'jupiter') 33.3 \u7d22\u5f15\u7ba1\u7406\u7684\u5e38\u89c1\u95ee\u9898 33.3.1 \u542f\u52a8\u4f5c\u4e1a\u65f6\u51fa\u73b0IllegalArgumentException \u5728\u6784\u5efa\u7d22\u5f15\u540e\u4e0d\u4e45\u542f\u52a8\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a\u65f6\uff0c\u4f5c\u4e1a\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u5e76\u51fa\u73b0\u4f8b\u5982\u4ee5\u4e0b\u60c5\u51b5\u4e4b\u4e00\u7684\u5f02\u5e38\uff1a The index mixedExample is in an invalid state and cannot be indexed. The following index keys have invalid status: desc has status INSTALLED (status must be one of [REGISTERED, ENABLED]) The index mixedExample is in an invalid state and cannot be indexed. The index has status INSTALLED, but one of [REGISTERED, ENABLED] is required \u5728\u6784\u5efa\u7d22\u5f15\u65f6\uff0c\u5b83\u7684\u5b58\u5728\u88ab\u5e7f\u64ad\u5230\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u5176\u4ed6JanusGraph\u5b9e\u4f8b\u3002\u8fd9\u4e9b\u5fc5\u987b\u786e\u8ba4\u7d22\u5f15\u7684\u5b58\u5728\uff0c\u7136\u540e\u624d\u80fd\u5f00\u59cb\u91cd\u5efa\u8fc7\u7a0b\u3002\u6839\u636e\u96c6\u7fa4\u7684\u5927\u5c0f\u548c\u8fde\u63a5\u901f\u5ea6\uff0c\u786e\u8ba4\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u5728\u6784\u5efa\u7d22\u5f15\u4e4b\u540e\u7b49\u5f85\u51e0\u5206\u949f\uff0c\u7136\u540e\u5f00\u59cb\u91cd\u65b0\u7d22\u5f15\u8fc7\u7a0b\u3002 \u8bf7\u6ce8\u610f\uff0c\u7531\u4e8eJanusGraph\u5b9e\u4f8b\u5931\u8d25\uff0c\u786e\u8ba4\u53ef\u80fd\u4f1a\u5931\u8d25\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u7fa4\u96c6\u53ef\u80fd\u65e0\u9650\u671f\u5730\u7b49\u5f85\u786e\u8ba4\u5931\u8d25\u7684\u5b9e\u4f8b\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u5fc5\u987b\u624b\u52a8\u4ece\u7fa4\u96c6\u6ce8\u518c\u8868\u4e2d\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u5982\u7b2c32\u7ae0\u201c \u6545\u969c\u548c\u6062\u590d\u201d\u4e2d\u6240\u8ff0\u3002\u6062\u590d\u96c6\u7fa4\u72b6\u6001\u540e\uff0c\u5fc5\u987b\u901a\u8fc7\u5728\u7ba1\u7406\u7cfb\u7edf\u4e2d\u518d\u6b21\u624b\u52a8\u6ce8\u518c\u7d22\u5f15\u6765\u91cd\u65b0\u542f\u52a8\u786e\u8ba4\u8fc7\u7a0b\u3002 mgmt = graph.openManagement() rindex = mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ) mgmt.updateIndex(rindex, SchemaAction.REGISTER_INDEX).get() gindex = mgmt.getGraphIndex( byName ) mgmt.updateIndex(gindex, SchemaAction.REGISTER_INDEX).get() mgmt.commit() \u7b49\u5f85\u51e0\u5206\u949f\u786e\u8ba4\u5230\u8fbe\u540e\uff0c\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u5e94\u8be5\u6210\u529f\u542f\u52a8\u3002 33.3.2 \u627e\u4e0d\u5230\u7d22\u5f15 \u5728\u201c\u91cd\u65b0\u7d22\u5f15\u201d\u4f5c\u4e1a\u4e2d\u51fa\u73b0\u7684\u8fd9\u4e2a\u5f02\u5e38\u8868\u660e\uff0c\u5177\u6709\u7ed9\u5b9a\u540d\u79f0\u7684\u7d22\u5f15\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u540d\u79f0\u6ca1\u6709\u6b63\u786e\u6307\u5b9a\u3002\u5f53\u91cd\u65b0\u7d22\u5f15\u5168\u5c40\u56fe\u7d22\u5f15\u65f6\uff0c\u53ea\u9700\u8981\u6307\u5b9a\u5728\u6784\u5efa\u7d22\u5f15\u65f6\u5b9a\u4e49\u7684\u7d22\u5f15\u540d\u79f0\u3002\u5728\u68c0\u7d22\u5168\u5c40\u56fe\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u5728\u5b9a\u4e49\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u7f18\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\u4e4b\u5916\u52a0\u4e0a\u7d22\u5f15\u7684\u540d\u79f0\u3002 33.3.3 Cassandra Mappers\u5931\u8d25\u201c\u592a\u591a\u6253\u5f00\u7684\u6587\u4ef6\u201d \u5f02\u5e38\u5806\u6808\u8ddf\u8e2a\u7684\u7ed3\u5c3e\u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a java.net.SocketException: Too many open files at java.net.Socket.createImpl(Socket.java:447) at java.net.Socket.getImpl(Socket.java:510) at java.net.Socket.setSoLinger(Socket.java:988) at org.apache.thrift.transport.TSocket.initSocket(TSocket.java:118) at org.apache.thrift.transport.TSocket. init (TSocket.java:109) \u5728\u542f\u7528\u865a\u62df\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\u8fd0\u884cCassandra\u65f6\uff0c\u865a\u62df\u8282\u70b9\u7684\u6570\u91cf\u4f3c\u4e4e\u5728\u6620\u5c04\u5668\u7684\u6570\u91cf\u4e4b\u4e0b\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u4e0b\u9650\u3002\u5bf9\u4e8e\u5177\u6709\u5927\u91cf\u6570\u636e\u7684\u96c6\u7fa4\uff0cCassandra\u53ef\u80fd\u4f1a\u751f\u6210\u6bd4\u865a\u62df\u8282\u70b9\u66f4\u591a\u7684\u6620\u5c04\u5668\uff0c\u4f46\u5b83\u4f3c\u4e4e\u81f3\u5c11\u4f1a\u751f\u6210\u4e0e\u865a\u62df\u8282\u70b9\u4e00\u6837\u591a\u7684\u6620\u5c04\u5668\uff0c\u5373\u4f7f\u96c6\u7fa4\u53ef\u80fd\u662f\u7a7a\u7684\u6216\u63a5\u8fd1\u7a7a\u7684\u3002\u5728\u7f16\u5199\u672c\u6587\u65f6\uff0c\u7f3a\u7701\u503c\u662f256\u3002 \u6bcf\u4e2a\u6620\u5c04\u5668\u6253\u5f00\u5e76\u5feb\u901f\u5173\u95ed\u51e0\u4e2a\u6307\u5411Cassandra\u7684\u5957\u63a5\u5b57\u3002\u7531\u4e8eThrift\u4f7f\u7528SO_LINGER\uff0c\u8fd9\u4e9b\u5173\u95ed\u5957\u63a5\u5b57\u7684\u5ba2\u6237\u7aef\u5185\u6838\u5c06\u8fdb\u5165\u5f02\u6b65TIME_WAIT\u3002\u4efb\u4f55\u65f6\u5019\u53ea\u6709\u5c11\u91cf\u7684\u5957\u63a5\u5b57\u662f\u6253\u5f00\u7684\u2014\u2014\u901a\u5e38\u662f\u8f83\u4f4e\u7684\u4e2a\u4f4d\u6570\u2014\u2014\u4f46\u662f\u53ef\u80fd\u4f1a\u6709\u8bb8\u591a\u5ef6\u8fdf\u7684\u5957\u63a5\u5b57\u5728TIME_WAIT\u4e2d\u7d2f\u79ef\u3002\u5f53\u672c\u5730\u8fd0\u884c\u91cd\u7d22\u5f15\u4f5c\u4e1a(\u4e0d\u5728\u5206\u5e03\u5f0fMapReduce\u96c6\u7fa4\u4e0a)\u65f6\uff0c\u8fd9\u79cd\u7d2f\u79ef\u6700\u660e\u663e\uff0c\u56e0\u4e3a\u6240\u6709\u8fd9\u4e9b\u5ba2\u6237\u7aefTIME_WAIT\u5957\u63a5\u5b57\u90fd\u9a7b\u7559\u5728\u5355\u4e2a\u5ba2\u6237\u673a\u673a\u5668\u4e0a\uff0c\u800c\u4e0d\u662f\u5206\u6563\u5728\u96c6\u7fa4\u4e2d\u7684\u8bb8\u591a\u673a\u5668\u4e0a\u3002\u7ed3\u5408256\u4e2a\u6620\u5c04\u5668\u7684\u5730\u677f\uff0c\u4e00\u4e2a\u91cd\u7d22\u5f15\u4f5c\u4e1a\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u6253\u5f00\u6570\u5343\u4e2a\u5957\u63a5\u5b57\u3002\u5f53\u8fd9\u4e9b\u5957\u63a5\u5b57\u90fd\u5728\u540c\u4e00\u4e2a\u5ba2\u6237\u673a\u4e0a\u505c\u7559\u5728TIME_WAIT\u4e2d\u65f6\uff0c\u5b83\u4eec\u5c31\u6709\u53ef\u80fd\u5230\u8fbe\u6253\u5f00\u7684\u6587\u4ef6ulimit, ulimit\u4e5f\u63a7\u5236\u6253\u5f00\u7684\u5957\u63a5\u5b57\u7684\u6570\u91cf\u3002\u6253\u5f00\u6587\u4ef6\u7684ulimit\u901a\u5e38\u8bbe\u7f6e\u4e3a1024\u3002 \u4ee5\u4e0b\u662f\u5728\u5355\u53f0\u673a\u5668\u4e0a\u91cd\u5efa\u7d22\u5f15\u65f6\u5904\u7406\u201cToo many open files\u201d\u95ee\u9898\u7684\u4e00\u4e9b\u5efa\u8bae\uff1a - \u51cf\u5c0fCassandra\u8fde\u63a5\u6c60\u7684\u6700\u5927\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u8003\u8651\u5c06cassandrathrift\u5b58\u50a8\u540e\u7aefmax-active\u548cmax-idle\u9009\u9879\u8bbe\u7f6emax-total\u4e3a1\uff0c\u5e76\u8bbe\u7f6e\u4e3a-1\u3002\u6709\u5173Cassandra\u5b58\u50a8\u540e\u7aef\u4e0a\u8fde\u63a5\u6c60\u8bbe\u7f6e\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1\u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003\u3002 - \u589e\u52a0nofileulimit\u3002\u7406\u60f3\u503c\u53d6\u51b3\u4e8eCassandra\u6570\u636e\u96c6\u7684\u5927\u5c0f\u548creindex\u6620\u5c04\u5668\u7684\u541e\u5410\u91cf; \u5982\u679c\u4ece1024\u5f00\u59cb\uff0c\u8bf7\u5c1d\u8bd5\u66f4\u5927\u7684\u6570\u91cf\u7ea7\uff1a10000\u3002\u8fd9\u5bf9\u4e8e\u7ef4\u6301\u5ef6\u8fdf\u7684TIME_WAIT\u5957\u63a5\u5b57\u662f\u5fc5\u8981\u7684\u3002reindex\u4f5c\u4e1a\u4e0d\u4f1a\u5c1d\u8bd5\u4e00\u6b21\u6253\u5f00\u90a3\u4e48\u591a\u5957\u63a5\u5b57\u3002 - \u5728\u591a\u8282\u70b9MapReduce\u96c6\u7fa4\u4e0a\u8fd0\u884creindex\u4efb\u52a1\u4ee5\u5206\u6563\u5957\u63a5\u5b57\u8d1f\u8f7d\u3002","title":"33.\u7d22\u5f15\u7ba1\u7406"},{"location":"advanced_topics/index_management/#331","text":"\u7b2c11.1\u8282\u201c\u56fe\u5f62\u7d22\u5f15\u201d\u548c\u7b2c11.2\u8282\u201c\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u201d\u63cf\u8ff0\u4e86\u5982\u4f55\u6784\u5efa\u56fe\u5f62\u5168\u5c40\u7d22\u5f15\u548c\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u6765\u63d0\u9ad8\u67e5\u8be2\u6027\u80fd\u3002\u5982\u679c\u5728\u76f8\u540c\u7684\u7ba1\u7406\u4e8b\u52a1\u4e2d\u65b0\u5b9a\u4e49\u4e86\u7d22\u5f15\u952e\u6216\u6807\u7b7e\uff0c\u5219\u53ef\u4ee5\u7acb\u5373\u4f7f\u7528\u8fd9\u4e9b\u7d22\u5f15\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u9700\u8981\u91cd\u65b0\u7d22\u5f15\u56fe\uff0c\u8fd9\u4e2a\u90e8\u5206\u53ef\u4ee5\u8df3\u8fc7\u3002\u5982\u679c\u7d22\u5f15\u952e\u548c\u6807\u7b7e\u5728\u7d22\u5f15\u6784\u9020\u4e4b\u524d\u5c31\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u6709\u5fc5\u8981\u91cd\u65b0\u7d22\u5f15\u6574\u4e2a\u56fe\uff0c\u4ee5\u786e\u4fdd\u7d22\u5f15\u5305\u542b\u4ee5\u524d\u6dfb\u52a0\u7684\u5143\u7d20\u3002\u672c\u8282\u4ecb\u7ecd\u91cd\u5efa\u7d22\u5f15\u8fc7\u7a0b\u3002 \u8b66\u544a: \u91cd\u65b0\u7d22\u5f15\u662f\u4e00\u4e2a\u7531\u591a\u4e2a\u6b65\u9aa4\u7ec4\u6210\u7684\u624b\u52a8\u8fc7\u7a0b\u3002\u5fc5\u987b\u6309\u6b63\u786e\u7684\u987a\u5e8f\u4ed4\u7ec6\u9075\u5faa\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u4ee5\u907f\u514d\u7d22\u5f15\u4e0d\u4e00\u81f4\u3002","title":"33.1 \u91cd\u5efa\u7d22\u5f15"},{"location":"advanced_topics/index_management/#3311","text":"JanusGraph\u53ef\u4ee5\u5728\u5b9a\u4e49\u7d22\u5f15\u4e4b\u540e\u7acb\u5373\u5f00\u59cb\u7f16\u5199\u589e\u91cf\u7d22\u5f15\u66f4\u65b0\u3002\u4f46\u662f\uff0c\u5728\u7d22\u5f15\u5b8c\u6210\u5e76\u53ef\u7528\u4e4b\u524d\uff0cJanusGraph\u8fd8\u5fc5\u987b\u4e00\u6b21\u6027\u8bfb\u53d6\u4e0e\u65b0\u7d22\u5f15\u6a21\u5f0f\u7c7b\u578b\u5173\u8054\u7684\u6240\u6709\u73b0\u6709\u56fe\u5f62\u5143\u7d20\u3002\u4e00\u65e6\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u5b8c\u6210\uff0c\u7d22\u5f15\u5c31\u88ab\u5b8c\u5168\u586b\u5145\u5e76\u51c6\u5907\u597d\u4f7f\u7528\u3002\u7136\u540e\u5fc5\u987b\u542f\u7528\u7d22\u5f15\u624d\u80fd\u5728\u67e5\u8be2\u5904\u7406\u671f\u95f4\u4f7f\u7528\u3002","title":"33.1.1 \u6982\u8ff0"},{"location":"advanced_topics/index_management/#3312","text":"\u91cd\u5efa\u7d22\u5f15\u8fc7\u7a0b\u7684\u8d77\u70b9\u662f\u6784\u5efa\u4e00\u4e2a\u7d22\u5f15\u3002\u6709\u5173\u5168\u5c40\u56fe\u548c\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u7684\u5b8c\u6574\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605\u7b2c11\u7ae0\uff0c\u7d22\u5f15\u4ee5\u83b7\u5f97\u66f4\u597d\u7684\u6027\u80fd\u3002\u8bf7\u6ce8\u610f\uff0c\u5168\u5c40\u56fe\u7d22\u5f15\u7531\u5176\u540d\u79f0\u552f\u4e00\u6807\u8bc6\u3002\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7531\u5176\u540d\u79f0\u548c\u5b9a\u4e49\u7d22\u5f15\u7684\u8fb9\u7f18\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u7ec4\u5408\u60df\u4e00\u6807\u8bc6 \u2014\u2014 \u540e\u8005\u7684\u540d\u79f0\u5728\u672c\u8282\u4e2d\u79f0\u4e3a\u7d22\u5f15\u7c7b\u578b\uff0c\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u3002 \u5728\u9488\u5bf9\u73b0\u6709\u6a21\u5f0f\u5143\u7d20\u6784\u5efa\u65b0\u7d22\u5f15\u4e4b\u540e\uff0c\u5efa\u8bae\u7b49\u5f85\u51e0\u5206\u949f\u5c06\u7d22\u5f15\u901a\u77e5\u5230\u96c6\u7fa4\u3002\u6ce8\u610f\u7d22\u5f15\u540d(\u5bf9\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\uff0c\u4ee5\u53ca\u7d22\u5f15\u7c7b\u578b)\uff0c\u56e0\u4e3a\u5728\u7d22\u5f15\u68c0\u7d22\u65f6\u9700\u8981\u6b64\u4fe1\u606f\u3002","title":"33.1.2 \u5728\u91cd\u5efa\u7d22\u5f15\u4e4b\u524d"},{"location":"advanced_topics/index_management/#3313","text":"\u53ef\u4ee5\u5728\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u7684\u4e24\u4e2a\u6267\u884c\u6846\u67b6\u4e4b\u95f4\u8fdb\u884c\u9009\u62e9\uff1a - MapReduce - JanusGraphManagement MapReduce\u4e0a\u7684Reindex\u652f\u6301\u5927\u578b\u6c34\u5e73\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3002JanusGraphManagement\u4e0a\u7684\u91cd\u65b0\u7d22\u5f15\u4f1a\u751f\u6210\u5355\u673aOLAP\u4f5c\u4e1a\u3002\u8fd9\u662f\u4e3a\u4e86\u65b9\u4fbf\u548c\u5feb\u901f\u5730\u5728\u90a3\u4e9b\u5c0f\u5230\u8db3\u4ee5\u7531\u4e00\u53f0\u673a\u5668\u5904\u7406\u7684\u6570\u636e\u5e93\u3002 \u91cd\u65b0\u7d22\u5f15\u9700\u8981\uff1a \u7d22\u5f15\u540d\u79f0\uff08\u4e00\u4e2a\u5b57\u7b26\u4e32 - \u7528\u6237\u5728\u6784\u5efa\u65b0\u7d22\u5f15\u65f6\u5c06\u6b64\u63d0\u4f9b\u7ed9JanusGraph\uff09 \u7d22\u5f15\u7c7b\u578b\uff08\u5b57\u7b26\u4e32 - \u6784\u5efa\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff09\u3002\u8fd9\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 - \u4e3a\u5168\u5c40\u56fe\u7d22\u5f15\u7559\u7a7a\u3002","title":"33.1.3 \u51c6\u5907\u91cd\u65b0\u7d22\u5f15"},{"location":"advanced_topics/index_management/#3314-mapreduce","text":"\u5728MapReduce\u4e0a\u751f\u6210\u548c\u8fd0\u884creindex\u4f5c\u4e1a\u7684\u63a8\u8350\u65b9\u6cd5\u662f\u901a\u8fc7MapReduceIndexManagement\u7c7b\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528\u6b64\u7c7b\u8fd0\u884creindex\u4f5c\u4e1a\u7684\u6b65\u9aa4\u7684\u6982\u8ff0\uff1a - \u6253\u5f00\u4e00\u4e2aJanusGraph\u5b9e\u4f8b - \u5c06\u56fe\u5f62\u5b9e\u4f8b\u4f20\u9012\u7ed9MapReduceIndexManagement\u6784\u9020\u51fd\u6570 - \u8c03\u7528updateIndex( , SchemaAction.REINDEX)\u7684MapReduceIndexManagement\u5b9e\u4f8b - \u5982\u679c\u5c1a\u672a\u542f\u7528\u7d22\u5f15\uff0c\u8bf7\u542f\u7528\u5b83 JanusGraphManagement \u8be5\u7c7b\u5b9e\u73b0\u4e86\u4e00\u4e2aupdateIndex\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4ec5\u652f\u6301\u5176SchemaAction\u53c2\u6570\u7684REINDEX\u548cREMOVE_INDEX\u64cd\u4f5c\u3002\u8be5\u7c7b\u4f7f\u7528Hadoop\u914d\u7f6e\u542f\u52a8Hadoop MapReduce\u4f5c\u4e1a\uff0c\u5e76\u5728\u7c7b\u8def\u5f84\u4e0a\u4f7f\u7528jar\u3002\u652f\u6301Hadoop 1\u548c2\u3002\u8be5\u7c7b\u4ece\u7ed9\u5176\u6784\u9020\u51fd\u6570\u7684JanusGraph\u5b9e\u4f8b\u4e2d\u83b7\u53d6\u5173\u4e8e\u7d22\u5f15\u548c\u5b58\u50a8\u540e\u7aef(\u4f8b\u5982Cassandra partitioner)\u7684\u5143\u6570\u636e\u3002 graph = JanusGraphFactory.open(...) mgmt = graph.openManagement() mr = new MapReduceIndexManagement(graph) mr.updateIndex(mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ), SchemaAction.REINDEX).get() mgmt.commit()","title":"33.1.4 \u5728MapReduce\u4e0a\u6267\u884c\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a"},{"location":"advanced_topics/index_management/#33141-mapreduce","text":"\u4ee5\u4e0bGremlin\u7247\u6bb5\u5728\u4e00\u4e2a\u81ea\u5305\u542b\u793a\u4f8b\u4e2d\u4f7f\u7528\u9488\u5bf9Cassandra\u5b58\u50a8\u540e\u7aef\u7684\u6700\u5c0f\u865a\u62df\u6570\u636e\u6982\u8ff0\u4e86MapReduce reindex\u8fc7\u7a0b\u7684\u6240\u6709\u6b65\u9aa4\u3002 // Open a graph graph = JanusGraphFactory.open( conf/janusgraph-cql-es.properties ) g = graph.traversal() // Define a property mgmt = graph.openManagement() desc = mgmt.makePropertyKey( desc ).dataType(String.class).make() mgmt.commit() // Insert some data graph.addVertex( desc , foo bar ) graph.addVertex( desc , foo baz ) graph.tx().commit() // Run a query -- note the planner warning recommending the use of an index g.V().has( desc , containsText( baz )) // Create an index mgmt = graph.openManagement() desc = mgmt.getPropertyKey( desc ) mixedIndex = mgmt.buildIndex( mixedExample , Vertex.class).addKey(desc).buildMixedIndex( search ) mgmt.commit() // Rollback or commit transactions on the graph which predate the index definition graph.tx().rollback() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED report = ManagementSystem.awaitGraphIndexStatus(graph, mixedExample ).call() // Run a JanusGraph-Hadoop job to reindex mgmt = graph.openManagement() mr = new MapReduceIndexManagement(graph) mr.updateIndex(mgmt.getGraphIndex( mixedExample ), SchemaAction.REINDEX).get() // Enable the index mgmt = graph.openManagement() mgmt.updateIndex(mgmt.getGraphIndex( mixedExample ), SchemaAction.ENABLE_INDEX).get() mgmt.commit() // Block until the SchemaStatus is ENABLED mgmt = graph.openManagement() report = ManagementSystem.awaitGraphIndexStatus(graph, mixedExample ).status(SchemaStatus.ENABLED).call() mgmt.rollback() // Run a query -- JanusGraph will use the new index, no planner warning g.V().has( desc , containsText( baz )) // Concerned that JanusGraph could have read cache in that last query, instead of relying on the index? // Start a new instance to rule out cache hits. Now we're definitely using the index. graph.close() graph = JanusGraphFactory.open( conf/janusgraph-cql-es.properties ) g.V().has( desc , containsText( baz ))","title":"33.1.4.1 MapReduce\u4e0a\u7684\u91cd\u5efa\u7d22\u5f15\u793a\u4f8b"},{"location":"advanced_topics/index_management/#3315-janusgraphmanagement","text":"\u8981\u5728JanusGraphManagement\u4e0a\u8fd0\u884creindex\u4f5c\u4e1a\uff0c\u8bf7JanusGraphManagement.updateIndex\u4f7f\u7528SchemaAction.REINDEX\u53c2\u6570\u8fdb\u884c\u8c03\u7528\u3002\u4f8b\u5982\uff1a m = graph.openManagement() i = m.getGraphIndex('indexName') m.updateIndex(i, SchemaAction.REINDEX).get() m.commit()","title":"33.1.5 \u5728JanusGraphManagement\u4e0a\u6267\u884c\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a"},{"location":"advanced_topics/index_management/#33151-janusgraphmanagement","text":"\u4e0b\u9762\u5c06\u4e00\u4e9b\u793a\u4f8b\u6570\u636e\u52a0\u8f7d\u5230BerkeleyDB\u652f\u6301\u7684JanusGraph\u6570\u636e\u5e93\u4e2d\uff0c\u5728\u4e8b\u540e\u5b9a\u4e49\u7d22\u5f15\uff0c\u4f7f\u7528JanusGraphManagement\u91cd\u65b0\u7d22\u5f15\uff0c\u6700\u540e\u542f\u7528\u5e76\u4f7f\u7528\u7d22\u5f15\uff1a import org.janusgraph.graphdb.database.management.ManagementSystem // Load some data from a file without any predefined schema graph = JanusGraphFactory.open('conf/janusgraph-berkeleyje.properties') g = graph.traversal() m = graph.openManagement() m.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.LIST).make() m.makePropertyKey('lang').dataType(String.class).cardinality(Cardinality.LIST).make() m.makePropertyKey('age').dataType(Integer.class).cardinality(Cardinality.LIST).make() m.commit() graph.io(IoCore.gryo()).readGraph('data/tinkerpop-modern.gio') graph.tx().commit() // Run a query -- note the planner warning recommending the use of an index g.V().has('name', 'lop') graph.tx().rollback() // Create an index m = graph.openManagement() m.buildIndex('names', Vertex.class).addKey(m.getPropertyKey('name')).buildCompositeIndex() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'names').status(SchemaStatus.REGISTERED).call() // Reindex using JanusGraphManagement m = graph.openManagement() i = m.getGraphIndex('names') m.updateIndex(i, SchemaAction.REINDEX) m.commit() // Enable the index ManagementSystem.awaitGraphIndexStatus(graph, 'names').status(SchemaStatus.ENABLED).call() // Run a query -- JanusGraph will use the new index, no planner warning g.V().has('name', 'lop') graph.tx().rollback() // Concerned that JanusGraph could have read cache in that last query, instead of relying on the index? // Start a new instance to rule out cache hits. Now we're definitely using the index. graph.close() graph = JanusGraphFactory.open( conf/janusgraph-berkeleyje.properties ) g = graph.traversal() g.V().has('name', 'lop')","title":"33.1.5.1 JanusGraphManagement\u7684\u793a\u4f8b"},{"location":"advanced_topics/index_management/#332","text":"\u8b66\u544a: \u7d22\u5f15\u5220\u9664\u662f\u4e00\u4e2a\u7531\u591a\u4e2a\u6b65\u9aa4\u7ec4\u6210\u7684\u624b\u52a8\u8fc7\u7a0b\u3002\u5fc5\u987b\u6309\u6b63\u786e\u7684\u987a\u5e8f\u4ed4\u7ec6\u9075\u5faa\u8fd9\u4e9b\u6b65\u9aa4\uff0c\u4ee5\u907f\u514d\u7d22\u5f15\u4e0d\u4e00\u81f4\u3002","title":"33.2 \u5220\u9664\u7d22\u5f15"},{"location":"advanced_topics/index_management/#3321","text":"\u7d22\u5f15\u5220\u9664\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\u3002\u5728\u7b2c\u4e00\u9636\u6bb5\uff0c\u4e00\u4e2aJanusGraph\u901a\u8fc7\u5b58\u50a8\u540e\u7aef\u5411\u6240\u6709\u5176\u4ed6\u4eba\u53d1\u4fe1\u53f7\u901a\u77e5\u7d22\u5f15\u5c06\u88ab\u5220\u9664\u3002\u8fd9\u4f1a\u5c06\u7d22\u5f15\u7684\u72b6\u6001\u66f4\u6539\u4e3aDISABLED\u3002\u6b64\u65f6\uff0cJanusGraph\u505c\u6b62\u4f7f\u7528\u7d22\u5f15\u6765\u5e94\u7b54\u67e5\u8be2\u5e76\u505c\u6b62\u9010\u6b65\u66f4\u65b0\u7d22\u5f15\u3002\u5b58\u50a8\u540e\u7aef\u4e2d\u4e0e\u7d22\u5f15\u76f8\u5173\u7684\u6570\u636e\u4ecd\u7136\u5b58\u5728\u4f46\u88ab\u5ffd\u7565\u3002 \u7b2c\u4e8c\u9636\u6bb5\u53d6\u51b3\u4e8e\u6307\u6570\u662f\u6df7\u5408\u7684\u8fd8\u662f\u590d\u5408\u7684\u3002\u590d\u5408\u7d22\u5f15\u53ef\u4ee5\u901a\u8fc7JanusGraph\u5220\u9664\u3002\u4e0e\u91cd\u5efa\u7d22\u5f15\u4e00\u6837\uff0c\u53ef\u4ee5\u901a\u8fc7MapReduce\u6216JanusGraphManagement\u8fdb\u884c\u5220\u9664\u3002\u4f46\u662f\uff0c\u6df7\u5408\u7d22\u5f15\u5fc5\u987b\u5728\u7d22\u5f15\u540e\u7aef\u624b\u52a8\u5220\u9664;JanusGraph\u4e0d\u63d0\u4f9b\u4ece\u7d22\u5f15\u540e\u7aef\u5220\u9664\u7d22\u5f15\u7684\u81ea\u52a8\u673a\u5236\u3002 \u9664\u6a21\u5f0f\u5b9a\u4e49\u548c\u7981\u7528\u72b6\u6001\u5916\uff0c\u7d22\u5f15\u5220\u9664\u5220\u9664\u4e0e\u7d22\u5f15\u5173\u8054\u7684\u6240\u6709\u5185\u5bb9\u3002\u5373\u4f7f\u5728\u5220\u9664\u4e4b\u540e\uff0c\u7d22\u5f15\u7684\u8fd9\u4e2a\u6a21\u5f0f\u5b58\u6839\u4ecd\u7136\u4fdd\u7559\uff0c\u5c3d\u7ba1\u5b83\u7684\u5b58\u50a8\u5360\u7528\u53ef\u4ee5\u5ffd\u7565\u5e76\u4e14\u662f\u56fa\u5b9a\u7684\u3002","title":"33.2.1 \u6982\u8ff0"},{"location":"advanced_topics/index_management/#3322","text":"\u5982\u679c\u5f53\u524d\u542f\u7528\u4e86\u7d22\u5f15\uff0c\u5219\u5e94\u9996\u5148\u7981\u7528\u5b83\u3002\u8fd9\u662f\u901a\u8fc7ManagementSystem\u3002 mgmt = graph.openManagement() rindex = mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ) mgmt.updateIndex(rindex, SchemaAction.DISABLE_INDEX).get() gindex = mgmt.getGraphIndex( byName ) mgmt.updateIndex(gindex, SchemaAction.DISABLE_INDEX).get() mgmt.commit() \u4e00\u65e6\u7d22\u5f15\u4e0a\u7684\u6240\u6709\u952e\u7684\u72b6\u6001\u53d8\u4e3aDISABLED\uff0c\u5c31\u53ef\u4ee5\u5220\u9664\u7d22\u5f15\u3002ManagementSystem\u4e2d\u7684\u5b9e\u7528\u7a0b\u5e8f\u53ef\u4ee5\u81ea\u52a8\u6267\u884c\u7b49\u5f85DISABLED\u6b65\u9aa4\uff1a ManagementSystem.awaitGraphIndexStatus(graph, 'byName').status(SchemaStatus.DISABLED).call() \u5728\u590d\u5408\u7d22\u5f15\u4e4b\u540eDISABLED\uff0c\u53ef\u4ee5\u9009\u62e9\u4e24\u4e2a\u6267\u884c\u6846\u67b6\u6765\u5220\u9664\u5b83\uff1a - MapReduce - JanusGraphManagement MapReduce\u4e0a\u7684\u7d22\u5f15\u5220\u9664\u652f\u6301\u5927\u578b\u6c34\u5e73\u5206\u5e03\u5f0f\u6570\u636e\u5e93\u3002JanusGraphManagement\u4e0a\u7684\u7d22\u5f15\u5220\u9664\u4f1a\u4ea7\u751f\u5355\u673aOLAP\u4f5c\u4e1a\u3002\u8fd9\u662f\u4e3a\u4e86\u65b9\u4fbf\u548c\u5feb\u901f\u5730\u5728\u90a3\u4e9b\u5c0f\u5230\u8db3\u4ee5\u7531\u4e00\u53f0\u673a\u5668\u5904\u7406\u7684\u6570\u636e\u5e93\u4e0a\u3002 \u5220\u9664\u7d22\u5f15\u9700\u8981\uff1a - \u7d22\u5f15\u540d\u79f0\uff08\u4e00\u4e2a\u5b57\u7b26\u4e32 - \u7528\u6237\u5728\u6784\u5efa\u65b0\u7d22\u5f15\u65f6\u5c06\u6b64\u63d0\u4f9b\u7ed9JanusGraph\uff09 - \u7d22\u5f15\u7c7b\u578b\uff08\u5b57\u7b26\u4e32 - \u6784\u5efa\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff09\u3002\u8fd9\u4ec5\u9002\u7528\u4e8e\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 - \u4e3a\u5168\u5c40\u56fe\u7d22\u5f15\u7559\u7a7a\u3002 \u5982\u6982\u8ff0\u4e2d\u6240\u8ff0\uff0c\u5fc5\u987b\u4ece\u7d22\u5f15\u540e\u7aef\u624b\u52a8\u5220\u9664\u6df7\u5408\u7d22\u5f15\u3002MapReduce\u6846\u67b6\u548cJanusGraphManagement\u6846\u67b6\u90fd\u4e0d\u4f1a\u4ece\u7d22\u5f15\u540e\u7aef\u5220\u9664\u6df7\u5408\u540e\u7aef\u3002 33.2.3 \u5728MapReduce\u4e0a\u6267\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a \u4e0e\u91cd\u5efa\u7d22\u5f15\u4e00\u6837\uff0c\u5728MapReduce\u4e0a\u751f\u6210\u548c\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\u7684\u63a8\u8350\u65b9\u6cd5\u662f\u901a\u8fc7MapReduceIndexManagement\u7c7b\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528\u6b64\u7c7b\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\u7684\u6b65\u9aa4\u7684\u6982\u8ff0\uff1a - \u6253\u5f00\u4e00\u4e2aJanusGraph\u5b9e\u4f8b - \u5982\u679c\u5c1a\u672a\u7981\u7528\u7d22\u5f15\uff0c\u8bf7\u5c06\u5176\u7981\u7528 JanusGraphManagement - \u5c06\u56fe\u5f62\u5b9e\u4f8b\u4f20\u9012\u7ed9MapReduceIndexManagement\u6784\u9020\u51fd\u6570 - \u8c03\u7528 updateIndex( , SchemaAction.REMOVE_INDEX) \u6ce8\u91ca\u4ee3\u7801\u793a\u4f8b\u5728\u4e0b\u4e00\u5c0f\u8282\u4e2d\u4ecb\u7ecd\u3002","title":"33.2.2 \u51c6\u5907\u5220\u9664\u7d22\u5f15"},{"location":"advanced_topics/index_management/#33231-mapreduce","text":"import org.janusgraph.graphdb.database.management.ManagementSystem // Load the Graph of the Gods sample data graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') g = graph.traversal() GraphOfTheGodsFactory.load(graph) g.V().has('name', 'jupiter') // Disable the name composite index m = graph.openManagement() nameIndex = m.getGraphIndex('name') m.updateIndex(nameIndex, SchemaAction.DISABLE_INDEX).get() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'name').status(SchemaStatus.DISABLED).call() // Delete the index using MapReduceIndexJobs m = graph.openManagement() mr = new MapReduceIndexManagement(graph) future = mr.updateIndex(m.getGraphIndex('name'), SchemaAction.REMOVE_INDEX) m.commit() graph.tx().commit() future.get() // Index still shows up in management interface as DISABLED -- this is normal m = graph.openManagement() idx = m.getGraphIndex('name') idx.getIndexStatus(m.getPropertyKey('name')) m.rollback() // JanusGraph should issue a warning about this query requiring a full scan g.V().has('name', 'jupiter')","title":"33.2.3.1 MapReduce\u7684\u793a\u4f8b"},{"location":"advanced_topics/index_management/#3324-janusgraphmanagement","text":"\u8981\u5728JanusGraphManagement\u4e0a\u8fd0\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a\uff0c\u8bf7JanusGraphManagement.updateIndex\u4f7f\u7528SchemaAction.REMOVE_INDEX\u53c2\u6570\u8fdb\u884c\u8c03\u7528\u3002\u4f8b\u5982\uff1a m = graph.openManagement() i = m.getGraphIndex('indexName') m.updateIndex(i, SchemaAction.REMOVE_INDEX).get() m.commit()","title":"33.2.4 \u5728JanusGraphManagement\u4e0a\u6267\u884c\u7d22\u5f15\u5220\u9664\u4f5c\u4e1a"},{"location":"advanced_topics/index_management/#33241-janusgraphmanagement","text":"\u4ee5\u4e0b\u5c06\u4e00\u4e9b\u7d22\u5f15\u6837\u672c\u6570\u636e\u52a0\u8f7d\u5230BerkeleyDB\u652f\u6301\u7684JanusGraph\u6570\u636e\u5e93\u4e2d\uff0c\u7136\u540e\u901a\u8fc7JanusGraphManagement\u7981\u7528\u548c\u5220\u9664\u7d22\u5f15\uff1a import org.janusgraph.graphdb.database.management.ManagementSystem // Load the Graph of the Gods sample data graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') g = graph.traversal() GraphOfTheGodsFactory.load(graph) g.V().has('name', 'jupiter') // Disable the name composite index m = graph.openManagement() nameIndex = m.getGraphIndex('name') m.updateIndex(nameIndex, SchemaAction.DISABLE_INDEX).get() m.commit() graph.tx().commit() // Block until the SchemaStatus transitions from INSTALLED to REGISTERED ManagementSystem.awaitGraphIndexStatus(graph, 'name').status(SchemaStatus.DISABLED).call() // Delete the index using JanusGraphManagement m = graph.openManagement() nameIndex = m.getGraphIndex('name') future = m.updateIndex(nameIndex, SchemaAction.REMOVE_INDEX) m.commit() graph.tx().commit() future.get() m = graph.openManagement() nameIndex = m.getGraphIndex('name') g.V().has('name', 'jupiter')","title":"33.2.4.1 JanusGraphManagement\u7684\u793a\u4f8b"},{"location":"advanced_topics/index_management/#333","text":"","title":"33.3 \u7d22\u5f15\u7ba1\u7406\u7684\u5e38\u89c1\u95ee\u9898"},{"location":"advanced_topics/index_management/#3331-illegalargumentexception","text":"\u5728\u6784\u5efa\u7d22\u5f15\u540e\u4e0d\u4e45\u542f\u52a8\u91cd\u5efa\u7d22\u5f15\u4f5c\u4e1a\u65f6\uff0c\u4f5c\u4e1a\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u5e76\u51fa\u73b0\u4f8b\u5982\u4ee5\u4e0b\u60c5\u51b5\u4e4b\u4e00\u7684\u5f02\u5e38\uff1a The index mixedExample is in an invalid state and cannot be indexed. The following index keys have invalid status: desc has status INSTALLED (status must be one of [REGISTERED, ENABLED]) The index mixedExample is in an invalid state and cannot be indexed. The index has status INSTALLED, but one of [REGISTERED, ENABLED] is required \u5728\u6784\u5efa\u7d22\u5f15\u65f6\uff0c\u5b83\u7684\u5b58\u5728\u88ab\u5e7f\u64ad\u5230\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u5176\u4ed6JanusGraph\u5b9e\u4f8b\u3002\u8fd9\u4e9b\u5fc5\u987b\u786e\u8ba4\u7d22\u5f15\u7684\u5b58\u5728\uff0c\u7136\u540e\u624d\u80fd\u5f00\u59cb\u91cd\u5efa\u8fc7\u7a0b\u3002\u6839\u636e\u96c6\u7fa4\u7684\u5927\u5c0f\u548c\u8fde\u63a5\u901f\u5ea6\uff0c\u786e\u8ba4\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u3002\u56e0\u6b64\uff0c\u5e94\u8be5\u5728\u6784\u5efa\u7d22\u5f15\u4e4b\u540e\u7b49\u5f85\u51e0\u5206\u949f\uff0c\u7136\u540e\u5f00\u59cb\u91cd\u65b0\u7d22\u5f15\u8fc7\u7a0b\u3002 \u8bf7\u6ce8\u610f\uff0c\u7531\u4e8eJanusGraph\u5b9e\u4f8b\u5931\u8d25\uff0c\u786e\u8ba4\u53ef\u80fd\u4f1a\u5931\u8d25\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u7fa4\u96c6\u53ef\u80fd\u65e0\u9650\u671f\u5730\u7b49\u5f85\u786e\u8ba4\u5931\u8d25\u7684\u5b9e\u4f8b\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u5fc5\u987b\u624b\u52a8\u4ece\u7fa4\u96c6\u6ce8\u518c\u8868\u4e2d\u5220\u9664\u5931\u8d25\u7684\u5b9e\u4f8b\uff0c\u5982\u7b2c32\u7ae0\u201c \u6545\u969c\u548c\u6062\u590d\u201d\u4e2d\u6240\u8ff0\u3002\u6062\u590d\u96c6\u7fa4\u72b6\u6001\u540e\uff0c\u5fc5\u987b\u901a\u8fc7\u5728\u7ba1\u7406\u7cfb\u7edf\u4e2d\u518d\u6b21\u624b\u52a8\u6ce8\u518c\u7d22\u5f15\u6765\u91cd\u65b0\u542f\u52a8\u786e\u8ba4\u8fc7\u7a0b\u3002 mgmt = graph.openManagement() rindex = mgmt.getRelationIndex(mgmt.getRelationType( battled ), battlesByTime ) mgmt.updateIndex(rindex, SchemaAction.REGISTER_INDEX).get() gindex = mgmt.getGraphIndex( byName ) mgmt.updateIndex(gindex, SchemaAction.REGISTER_INDEX).get() mgmt.commit() \u7b49\u5f85\u51e0\u5206\u949f\u786e\u8ba4\u5230\u8fbe\u540e\uff0c\u91cd\u65b0\u7d22\u5f15\u4f5c\u4e1a\u5e94\u8be5\u6210\u529f\u542f\u52a8\u3002","title":"33.3.1 \u542f\u52a8\u4f5c\u4e1a\u65f6\u51fa\u73b0IllegalArgumentException"},{"location":"advanced_topics/index_management/#3332","text":"\u5728\u201c\u91cd\u65b0\u7d22\u5f15\u201d\u4f5c\u4e1a\u4e2d\u51fa\u73b0\u7684\u8fd9\u4e2a\u5f02\u5e38\u8868\u660e\uff0c\u5177\u6709\u7ed9\u5b9a\u540d\u79f0\u7684\u7d22\u5f15\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u540d\u79f0\u6ca1\u6709\u6b63\u786e\u6307\u5b9a\u3002\u5f53\u91cd\u65b0\u7d22\u5f15\u5168\u5c40\u56fe\u7d22\u5f15\u65f6\uff0c\u53ea\u9700\u8981\u6307\u5b9a\u5728\u6784\u5efa\u7d22\u5f15\u65f6\u5b9a\u4e49\u7684\u7d22\u5f15\u540d\u79f0\u3002\u5728\u68c0\u7d22\u5168\u5c40\u56fe\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u5728\u5b9a\u4e49\u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u7684\u8fb9\u7f18\u6807\u7b7e\u6216\u5c5e\u6027\u952e\u7684\u540d\u79f0\u4e4b\u5916\u52a0\u4e0a\u7d22\u5f15\u7684\u540d\u79f0\u3002","title":"33.3.2 \u627e\u4e0d\u5230\u7d22\u5f15"},{"location":"advanced_topics/index_management/#3333-cassandra-mappers","text":"\u5f02\u5e38\u5806\u6808\u8ddf\u8e2a\u7684\u7ed3\u5c3e\u53ef\u80fd\u5982\u4e0b\u6240\u793a\uff1a java.net.SocketException: Too many open files at java.net.Socket.createImpl(Socket.java:447) at java.net.Socket.getImpl(Socket.java:510) at java.net.Socket.setSoLinger(Socket.java:988) at org.apache.thrift.transport.TSocket.initSocket(TSocket.java:118) at org.apache.thrift.transport.TSocket. init (TSocket.java:109) \u5728\u542f\u7528\u865a\u62df\u8282\u70b9\u7684\u60c5\u51b5\u4e0b\u8fd0\u884cCassandra\u65f6\uff0c\u865a\u62df\u8282\u70b9\u7684\u6570\u91cf\u4f3c\u4e4e\u5728\u6620\u5c04\u5668\u7684\u6570\u91cf\u4e4b\u4e0b\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u4e0b\u9650\u3002\u5bf9\u4e8e\u5177\u6709\u5927\u91cf\u6570\u636e\u7684\u96c6\u7fa4\uff0cCassandra\u53ef\u80fd\u4f1a\u751f\u6210\u6bd4\u865a\u62df\u8282\u70b9\u66f4\u591a\u7684\u6620\u5c04\u5668\uff0c\u4f46\u5b83\u4f3c\u4e4e\u81f3\u5c11\u4f1a\u751f\u6210\u4e0e\u865a\u62df\u8282\u70b9\u4e00\u6837\u591a\u7684\u6620\u5c04\u5668\uff0c\u5373\u4f7f\u96c6\u7fa4\u53ef\u80fd\u662f\u7a7a\u7684\u6216\u63a5\u8fd1\u7a7a\u7684\u3002\u5728\u7f16\u5199\u672c\u6587\u65f6\uff0c\u7f3a\u7701\u503c\u662f256\u3002 \u6bcf\u4e2a\u6620\u5c04\u5668\u6253\u5f00\u5e76\u5feb\u901f\u5173\u95ed\u51e0\u4e2a\u6307\u5411Cassandra\u7684\u5957\u63a5\u5b57\u3002\u7531\u4e8eThrift\u4f7f\u7528SO_LINGER\uff0c\u8fd9\u4e9b\u5173\u95ed\u5957\u63a5\u5b57\u7684\u5ba2\u6237\u7aef\u5185\u6838\u5c06\u8fdb\u5165\u5f02\u6b65TIME_WAIT\u3002\u4efb\u4f55\u65f6\u5019\u53ea\u6709\u5c11\u91cf\u7684\u5957\u63a5\u5b57\u662f\u6253\u5f00\u7684\u2014\u2014\u901a\u5e38\u662f\u8f83\u4f4e\u7684\u4e2a\u4f4d\u6570\u2014\u2014\u4f46\u662f\u53ef\u80fd\u4f1a\u6709\u8bb8\u591a\u5ef6\u8fdf\u7684\u5957\u63a5\u5b57\u5728TIME_WAIT\u4e2d\u7d2f\u79ef\u3002\u5f53\u672c\u5730\u8fd0\u884c\u91cd\u7d22\u5f15\u4f5c\u4e1a(\u4e0d\u5728\u5206\u5e03\u5f0fMapReduce\u96c6\u7fa4\u4e0a)\u65f6\uff0c\u8fd9\u79cd\u7d2f\u79ef\u6700\u660e\u663e\uff0c\u56e0\u4e3a\u6240\u6709\u8fd9\u4e9b\u5ba2\u6237\u7aefTIME_WAIT\u5957\u63a5\u5b57\u90fd\u9a7b\u7559\u5728\u5355\u4e2a\u5ba2\u6237\u673a\u673a\u5668\u4e0a\uff0c\u800c\u4e0d\u662f\u5206\u6563\u5728\u96c6\u7fa4\u4e2d\u7684\u8bb8\u591a\u673a\u5668\u4e0a\u3002\u7ed3\u5408256\u4e2a\u6620\u5c04\u5668\u7684\u5730\u677f\uff0c\u4e00\u4e2a\u91cd\u7d22\u5f15\u4f5c\u4e1a\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u6253\u5f00\u6570\u5343\u4e2a\u5957\u63a5\u5b57\u3002\u5f53\u8fd9\u4e9b\u5957\u63a5\u5b57\u90fd\u5728\u540c\u4e00\u4e2a\u5ba2\u6237\u673a\u4e0a\u505c\u7559\u5728TIME_WAIT\u4e2d\u65f6\uff0c\u5b83\u4eec\u5c31\u6709\u53ef\u80fd\u5230\u8fbe\u6253\u5f00\u7684\u6587\u4ef6ulimit, ulimit\u4e5f\u63a7\u5236\u6253\u5f00\u7684\u5957\u63a5\u5b57\u7684\u6570\u91cf\u3002\u6253\u5f00\u6587\u4ef6\u7684ulimit\u901a\u5e38\u8bbe\u7f6e\u4e3a1024\u3002 \u4ee5\u4e0b\u662f\u5728\u5355\u53f0\u673a\u5668\u4e0a\u91cd\u5efa\u7d22\u5f15\u65f6\u5904\u7406\u201cToo many open files\u201d\u95ee\u9898\u7684\u4e00\u4e9b\u5efa\u8bae\uff1a - \u51cf\u5c0fCassandra\u8fde\u63a5\u6c60\u7684\u6700\u5927\u5927\u5c0f\u3002\u4f8b\u5982\uff0c\u8003\u8651\u5c06cassandrathrift\u5b58\u50a8\u540e\u7aefmax-active\u548cmax-idle\u9009\u9879\u8bbe\u7f6emax-total\u4e3a1\uff0c\u5e76\u8bbe\u7f6e\u4e3a-1\u3002\u6709\u5173Cassandra\u5b58\u50a8\u540e\u7aef\u4e0a\u8fde\u63a5\u6c60\u8bbe\u7f6e\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1\u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003\u3002 - \u589e\u52a0nofileulimit\u3002\u7406\u60f3\u503c\u53d6\u51b3\u4e8eCassandra\u6570\u636e\u96c6\u7684\u5927\u5c0f\u548creindex\u6620\u5c04\u5668\u7684\u541e\u5410\u91cf; \u5982\u679c\u4ece1024\u5f00\u59cb\uff0c\u8bf7\u5c1d\u8bd5\u66f4\u5927\u7684\u6570\u91cf\u7ea7\uff1a10000\u3002\u8fd9\u5bf9\u4e8e\u7ef4\u6301\u5ef6\u8fdf\u7684TIME_WAIT\u5957\u63a5\u5b57\u662f\u5fc5\u8981\u7684\u3002reindex\u4f5c\u4e1a\u4e0d\u4f1a\u5c1d\u8bd5\u4e00\u6b21\u6253\u5f00\u90a3\u4e48\u591a\u5957\u63a5\u5b57\u3002 - \u5728\u591a\u8282\u70b9MapReduce\u96c6\u7fa4\u4e0a\u8fd0\u884creindex\u4efb\u52a1\u4ee5\u5206\u6563\u5957\u63a5\u5b57\u8d1f\u8f7d\u3002","title":"33.3.3 Cassandra Mappers\u5931\u8d25\u201c\u592a\u591a\u6253\u5f00\u7684\u6587\u4ef6\u201d"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/","text":"\u7b2c37\u7ae0 JanusGraph\u4e0eTinkerPop\u7684Hadoop-Gremlin \u672c\u7ae0\u4ecb\u7ecd\u5982\u4f55\u5229\u7528Apache Hadoop\u548cApache Spark\u914d\u7f6eJanusGraph\u4ee5\u8fdb\u884c\u5206\u5e03\u5f0f\u56fe\u5f62\u5904\u7406\u3002\u8fd9\u4e9b\u6b65\u9aa4\u5c06\u6982\u8ff0\u5982\u4f55\u5f00\u59cb\u8fd9\u4e9b\u9879\u76ee\uff0c\u4f46\u8bf7\u53c2\u8003\u8fd9\u4e9b\u9879\u76ee\u793e\u533a\u4ee5\u66f4\u719f\u6089\u5b83\u4eec\u3002 JanusGraph-Hadoop\u4e0eTinkerPop\u7684hadoop-gremlin\u8f6f\u4ef6\u5305\u4e00\u8d77\u7528\u4e8e\u901a\u7528OLAP\u3002 \u5bf9\u4e8e\u4e0b\u9762\u793a\u4f8b\u7684\u8303\u56f4\uff0cApache Spark\u662f\u8ba1\u7b97\u6846\u67b6\uff0cApache Cassandra\u662f\u5b58\u50a8\u540e\u7aef\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5305\u6765\u8ddf\u8e2a\u6307\u793a\uff0c\u53ea\u9700\u5bf9\u914d\u7f6e\u5c5e\u6027\u8fdb\u884c\u5fae\u5c0f\u66f4\u6539\u3002 \u6ce8\u610f: \u672c\u7ae0\u4e2d\u7684\u793a\u4f8b\u57fa\u4e8e\u5728\u672c\u5730\u6a21\u5f0f\u6216\u72ec\u7acb\u7fa4\u96c6\u6a21\u5f0f\u4e0b\u8fd0\u884cSpark\u3002\u5728YARN\u6216Mesos\u4e0a\u4f7f\u7528Spark\u65f6\u9700\u8981\u8fdb\u884c\u5176\u4ed6\u914d\u7f6e\u3002 37.1 \u914d\u7f6eHadoop\u4ee5\u8fd0\u884cOLAP \u8981\u4eceGremlin\u63a7\u5236\u53f0\u8fd0\u884cOLAP\u67e5\u8be2\uff0c\u9700\u8981\u6ee1\u8db3\u51e0\u4e2a\u5148\u51b3\u6761\u4ef6\u3002\u60a8\u9700\u8981\u5c06Hadoop\u914d\u7f6e\u76ee\u5f55\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u4e2d\uff0c\u914d\u7f6e\u76ee\u5f55\u9700\u8981\u6307\u5411\u4e00\u4e2a\u6d3b\u52a8\u7684Hadoop\u96c6\u7fa4\u3002 Hadoop\u63d0\u4f9b\u5206\u5e03\u5f0f\u8bbf\u95ee\u63a7\u5236\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u8fd0\u884c\u5728\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684Spark\u5de5\u4f5c\u7a0b\u5e8f\u4f7f\u7528Hadoop\u6587\u4ef6\u7cfb\u7edf\u6765\u83b7\u5f97\u57fa\u4e8e\u6587\u4ef6\u7684\u64cd\u4f5c\u7684\u516c\u5171\u6e90\u3002\u5404\u79cdOLAP\u67e5\u8be2\u7684\u4e2d\u95f4\u8ba1\u7b97\u53ef\u4ee5\u4fdd\u7559\u5728Hadoop\u6587\u4ef6\u7cfb\u7edf\u4e0a\u3002 \u6709\u5173\u914d\u7f6e\u5355\u8282\u70b9Hadoop\u96c6\u7fa4\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u5b98\u65b9Apache Hadoop\u6587\u6863\u3002 \u4e00\u65e6\u542f\u52a8\u5e76\u8fd0\u884c\u4e86Hadoop\u96c6\u7fa4\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5728CLASSPATH\u4e2d\u6307\u5b9aHadoop\u914d\u7f6e\u6587\u4ef6\u3002\u4e0b\u9762\u7684\u6587\u6863\u5e0c\u671b\u60a8\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e/etc/hadoop/conf\u4e0b\u3002 \u9a8c\u8bc1\u540e\uff0c\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u5c06Hadoop\u914d\u7f6e\u6dfb\u52a0\u5230CLASSPATH\u5e76\u542f\u52a8Gremlin\u63a7\u5236\u53f0\uff0c\u5b83\u5c06\u626e\u6f14Spark\u9a71\u52a8\u7a0b\u5e8f\u7684\u89d2\u8272\u3002 export HADOOP_CONF_DIR=/etc/hadoop/conf export CLASSPATH=$HADOOP_CONF_DIR bin/gremlin.sh \u5c06Hadoop\u914d\u7f6e\u8def\u5f84\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u5feb\u901f\u6b65\u9aa4\u9a8c\u8bc1Gremlin\u63a7\u5236\u53f0\u662f\u5426\u53ef\u4ee5\u8bbf\u95eeHadoop\u96c6\u7fa4: gremlin hdfs == storage[org.apache.hadoop.fs.LocalFileSystem@65bb9029] // BAD gremlin hdfs == storage[DFS[DFSClient[clientName=DFSClient_NONMAPREDUCE_1229457199_1, ugi=user (auth:SIMPLE)]]] // GOOD 37.2 OLAP\u904d\u5386 JanusGraph-Hadoop\u4f7f\u7528TinkerPop\u7684hadoop-gremlin\u5305\u8fdb\u884c\u901a\u7528OLAP\u904d\u5386\u56fe\uff0c\u5e76\u901a\u8fc7\u5229\u7528Apache Spark\u5e76\u884c\u5316\u67e5\u8be2\u3002 37.2.1 \u4f7f\u7528Spark Local\u8fdb\u884cOLAP\u904d\u5386 \u8fd9\u91cc\u6f14\u793a\u7684\u540e\u7aef\u662fCassandra\uff0c\u4e0b\u9762\u662fOLAP\u793a\u4f8b\u3002\u5c06\u9700\u8981\u7279\u5b9a\u4e8e\u8be5\u5b58\u50a8\u540e\u7aef\u7684\u9644\u52a0\u914d\u7f6e\u3002\u914d\u7f6e\u7531gremlin.hadoop.graphReader\u5c5e\u6027\u6307\u5b9a\uff0c\u8be5\u5c5e\u6027\u6307\u5b9a\u4ece\u5b58\u50a8\u540e\u7aef\u8bfb\u53d6\u6570\u636e\u7684\u7c7b\u3002 JanusGraph\u76ee\u524d\u652f\u6301\u4ee5\u4e0bgraphReader\u7c7b\uff1a - Cassandra3InputFormat \u4e0eCassandra 3\u4e00\u8d77\u4f7f\u7528 - CassandraInputFormat \u4e0eCassandra 2\u4e00\u8d77\u4f7f\u7528 - HBaseInputFormat\u548cHBaseSnapshotInputFormatHBase\u4e00\u8d77\u4f7f\u7528 \u4ee5\u4e0b\u5c5e\u6027\u6587\u4ef6\u53ef\u7528\u4e8e\u8fde\u63a5Cassandra\u4e2d\u7684JanusGraph\u5b9e\u4f8b\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u4e0eHadoopGraph\u4e00\u8d77\u4f7f\u7528\u6765\u8fd0\u884cOLAP\u67e5\u8be2\u3002 # read-cassandra-3.properties # # Hadoop Graph Configuration # gremlin.graph=org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph gremlin.hadoop.graphReader=org.janusgraph.hadoop.formats.cassandra.Cassandra3InputFormat gremlin.hadoop.graphWriter=org.apache.tinkerpop.gremlin.hadoop.structure.io.gryo.GryoOutputFormat gremlin.hadoop.jarsInDistributedCache=true gremlin.hadoop.inputLocation=none gremlin.hadoop.outputLocation=output gremlin.spark.persistContext=true # # JanusGraph Cassandra InputFormat configuration # # These properties defines the connection properties which were used while write data to JanusGraph. janusgraphmr.ioformat.conf.storage.backend=cassandra # This specifies the hostname port for Cassandra data store. janusgraphmr.ioformat.conf.storage.hostname=127.0.0.1 janusgraphmr.ioformat.conf.storage.port=9160 # This specifies the keyspace where data is stored. janusgraphmr.ioformat.conf.storage.cassandra.keyspace=janusgraph # This defines the indexing backned configuration used while writing data to JanusGraph. janusgraphmr.ioformat.conf.index.search.backend=elasticsearch janusgraphmr.ioformat.conf.index.search.hostname=127.0.0.1 # Use the appropriate properties for the backend when using a different storage backend (HBase) or indexing backend (Solr). # # Apache Cassandra InputFormat configuration # cassandra.input.partitioner.class=org.apache.cassandra.dht.Murmur3Partitioner # # SparkGraphComputer Configuration # spark.master=local[*] spark.executor.memory=1g spark.serializer=org.apache.spark.serializer.KryoSerializer spark.kryo.registrator=org.apache.tinkerpop.gremlin.spark.structure.io.gryo.GryoRegistrator \u9996\u5148\u4f7f\u7528\u4e0a\u8ff0\u914d\u7f6e\u521b\u5efa\u5c5e\u6027\u6587\u4ef6\uff0c\u7136\u540e\u5728Gremlin\u63a7\u5236\u53f0\u4e0a\u52a0\u8f7d\u5b83\u4ee5\u8fd0\u884cOLAP\u67e5\u8be2\uff0c\u5982\u4e0b\u6240\u793a\uff1a bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: janusgraph.imports gremlin :plugin use tinkerpop.hadoop == tinkerpop.hadoop activated gremlin :plugin use tinkerpop.spark == tinkerpop.spark activated gremlin // 1. Open a the graph for OLAP processing reading in from Cassandra 3 gremlin graph = GraphFactory.open('conf/hadoop-graph/read-cassandra-3.properties') == hadoopgraph[cassandra3inputformat- gryooutputformat] gremlin // 2. Configure the traversal to run with Spark gremlin g = graph.traversal().withComputer(SparkGraphComputer) == graphtraversalsource[hadoopgraph[cassandra3inputformat- gryooutputformat], sparkgraphcomputer] gremlin // 3. Run some OLAP traversals gremlin g.V().count() ...... == 808 gremlin g.E().count() ...... == 8046 37.2.2 \u4f7f\u7528Spark Standalone Cluster\u8fdb\u884cOLAP\u904d\u5386 \u4e0a\u4e00\u8282\u4e2d\u4ecb\u7ecd\u7684\u6b65\u9aa4\u4e5f\u53ef\u4ee5\u4e0eSpark\u72ec\u7acb\u7fa4\u96c6\u4e00\u8d77\u4f7f\u7528\uff0c\u53ea\u9700\u8fdb\u884c\u5c11\u91cf\u66f4\u6539\uff1a \u66f4\u65b0spark.master\u5c5e\u6027\u4ee5\u6307\u5411Spark\u4e3bURL\u800c\u4e0d\u662f\u672c\u5730URL \u66f4\u65b0spark.executor.extraClassPath\u4ee5\u542f\u7528Spark\u6267\u884c\u7a0b\u5e8f\u4ee5\u67e5\u627eJanusGraph\u4f9d\u8d56\u9879jar \u5c06JanusGraph\u4f9d\u8d56\u9879jar\u590d\u5236\u5230\u6bcf\u4e2aSpark\u6267\u884c\u5668\u8ba1\u7b97\u673a\u4e0a\u4e00\u6b65\u4e2d\u6307\u5b9a\u7684\u4f4d\u7f6e \u6ce8\u610f: \u6211\u4eec\u5c06janusgraph-distribution/lib\u4e0b\u7684\u6240\u6709jar\u590d\u5236\u5230/opt/lib/janusgraph /\u4e2d\uff0c\u5e76\u5728\u6240\u6709worker\u4e2d\u521b\u5efa\u76f8\u540c\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u5e76\u5728\u6240\u6709worker\u4e2d\u624b\u52a8\u590d\u5236jar\u3002 \u7528\u4e8eOLAP\u904d\u5386\u7684\u6700\u7ec8\u5c5e\u6027\u6587\u4ef6\u5982\u4e0b\uff1a # read-cassandra-3.properties # # Hadoop Graph Configuration # gremlin.graph=org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph gremlin.hadoop.graphReader=org.janusgraph.hadoop.formats.cassandra.Cassandra3InputFormat gremlin.hadoop.graphWriter=org.apache.tinkerpop.gremlin.hadoop.structure.io.gryo.GryoOutputFormat gremlin.hadoop.jarsInDistributedCache=true gremlin.hadoop.inputLocation=none gremlin.hadoop.outputLocation=output gremlin.spark.persistContext=true # # JanusGraph Cassandra InputFormat configuration # # These properties defines the connection properties which were used while write data to JanusGraph. janusgraphmr.ioformat.conf.storage.backend=cassandra # This specifies the hostname port for Cassandra data store. janusgraphmr.ioformat.conf.storage.hostname=127.0.0.1 janusgraphmr.ioformat.conf.storage.port=9160 # This specifies the keyspace where data is stored. janusgraphmr.ioformat.conf.storage.cassandra.keyspace=janusgraph # This defines the indexing backned configuration used while writing data to JanusGraph. janusgraphmr.ioformat.conf.index.search.backend=elasticsearch janusgraphmr.ioformat.conf.index.search.hostname=127.0.0.1 # Use the appropriate properties for the backend when using a different storage backend (HBase) or indexing backend (Solr). # # Apache Cassandra InputFormat configuration # cassandra.input.partitioner.class=org.apache.cassandra.dht.Murmur3Partitioner # # SparkGraphComputer Configuration # spark.master=spark://127.0.0.1:7077 spark.executor.memory=1g spark.executor.extraClassPath=/opt/lib/janusgraph/* spark.serializer=org.apache.spark.serializer.KryoSerializer spark.kryo.registrator=org.apache.tinkerpop.gremlin.spark.structure.io.gryo.GryoRegistrator \u7136\u540e\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u4e2d\u7684\u5c5e\u6027\u6587\u4ef6\uff0c\u5982\u4e0b\u6240\u793a\uff1a bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: janusgraph.imports gremlin :plugin use tinkerpop.hadoop == tinkerpop.hadoop activated gremlin :plugin use tinkerpop.spark == tinkerpop.spark activated gremlin // 1. Open a the graph for OLAP processing reading in from Cassandra 3 gremlin graph = GraphFactory.open('conf/hadoop-graph/read-cassandra-3.properties') == hadoopgraph[cassandra3inputformat- gryooutputformat] gremlin // 2. Configure the traversal to run with Spark gremlin g = graph.traversal().withComputer(SparkGraphComputer) == graphtraversalsource[hadoopgraph[cassandra3inputformat- gryooutputformat], sparkgraphcomputer] gremlin // 3. Run some OLAP traversals gremlin g.V().count() ...... == 808 gremlin g.E().count() ...... == 8046 37.3 \u5176\u4ed6\u9876\u70b9\u7a0b\u5e8f Apache TinkerPop\u63d0\u4f9b\u5404\u79cd\u9876\u70b9\u7a0b\u5e8f\u3002\u9876\u70b9\u7a0b\u5e8f\u5728\u6bcf\u4e2a\u9876\u70b9\u4e0a\u8fd0\u884c\uff0c\u76f4\u5230\u8fbe\u5230\u7ec8\u6b62\u6761\u4ef6\u6216\u8fbe\u5230\u56fa\u5b9a\u7684\u8fed\u4ee3\u6b21\u6570\u3002\u7531\u4e8e\u9876\u70b9\u7a0b\u5e8f\u7684\u5e76\u884c\u7279\u6027\uff0c\u5b83\u4eec\u53ef\u4ee5\u5229\u7528Spark\u6216Giraph\u7b49\u5e76\u884c\u8ba1\u7b97\u6846\u67b6\u6765\u63d0\u9ad8\u6027\u80fd\u3002 \u4e00\u65e6\u719f\u6089\u5982\u4f55\u914d\u7f6eJanusGraph\u4ee5\u4f7f\u7528Spark\uff0c\u60a8\u5c31\u53ef\u4ee5\u8fd0\u884cApache TinkerPop\u63d0\u4f9b\u7684\u6240\u6709\u5176\u4ed6\u9876\u70b9\u7a0b\u5e8f\uff0c\u5982Page Rank\uff0cBulk Loading\u548cPeer Pressure\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 TinkerPop VertexProgram\u6587\u6863 \u3002","title":"37.JanusGraph\u57fa\u4e8eTinkerPop's Hadoop-Gremlin\u4f7f\u7528"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#37-janusgraphtinkerpophadoop-gremlin","text":"\u672c\u7ae0\u4ecb\u7ecd\u5982\u4f55\u5229\u7528Apache Hadoop\u548cApache Spark\u914d\u7f6eJanusGraph\u4ee5\u8fdb\u884c\u5206\u5e03\u5f0f\u56fe\u5f62\u5904\u7406\u3002\u8fd9\u4e9b\u6b65\u9aa4\u5c06\u6982\u8ff0\u5982\u4f55\u5f00\u59cb\u8fd9\u4e9b\u9879\u76ee\uff0c\u4f46\u8bf7\u53c2\u8003\u8fd9\u4e9b\u9879\u76ee\u793e\u533a\u4ee5\u66f4\u719f\u6089\u5b83\u4eec\u3002 JanusGraph-Hadoop\u4e0eTinkerPop\u7684hadoop-gremlin\u8f6f\u4ef6\u5305\u4e00\u8d77\u7528\u4e8e\u901a\u7528OLAP\u3002 \u5bf9\u4e8e\u4e0b\u9762\u793a\u4f8b\u7684\u8303\u56f4\uff0cApache Spark\u662f\u8ba1\u7b97\u6846\u67b6\uff0cApache Cassandra\u662f\u5b58\u50a8\u540e\u7aef\u3002\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u5305\u6765\u8ddf\u8e2a\u6307\u793a\uff0c\u53ea\u9700\u5bf9\u914d\u7f6e\u5c5e\u6027\u8fdb\u884c\u5fae\u5c0f\u66f4\u6539\u3002 \u6ce8\u610f: \u672c\u7ae0\u4e2d\u7684\u793a\u4f8b\u57fa\u4e8e\u5728\u672c\u5730\u6a21\u5f0f\u6216\u72ec\u7acb\u7fa4\u96c6\u6a21\u5f0f\u4e0b\u8fd0\u884cSpark\u3002\u5728YARN\u6216Mesos\u4e0a\u4f7f\u7528Spark\u65f6\u9700\u8981\u8fdb\u884c\u5176\u4ed6\u914d\u7f6e\u3002","title":"\u7b2c37\u7ae0 JanusGraph\u4e0eTinkerPop\u7684Hadoop-Gremlin"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#371-hadoopolap","text":"\u8981\u4eceGremlin\u63a7\u5236\u53f0\u8fd0\u884cOLAP\u67e5\u8be2\uff0c\u9700\u8981\u6ee1\u8db3\u51e0\u4e2a\u5148\u51b3\u6761\u4ef6\u3002\u60a8\u9700\u8981\u5c06Hadoop\u914d\u7f6e\u76ee\u5f55\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u4e2d\uff0c\u914d\u7f6e\u76ee\u5f55\u9700\u8981\u6307\u5411\u4e00\u4e2a\u6d3b\u52a8\u7684Hadoop\u96c6\u7fa4\u3002 Hadoop\u63d0\u4f9b\u5206\u5e03\u5f0f\u8bbf\u95ee\u63a7\u5236\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u8fd0\u884c\u5728\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684Spark\u5de5\u4f5c\u7a0b\u5e8f\u4f7f\u7528Hadoop\u6587\u4ef6\u7cfb\u7edf\u6765\u83b7\u5f97\u57fa\u4e8e\u6587\u4ef6\u7684\u64cd\u4f5c\u7684\u516c\u5171\u6e90\u3002\u5404\u79cdOLAP\u67e5\u8be2\u7684\u4e2d\u95f4\u8ba1\u7b97\u53ef\u4ee5\u4fdd\u7559\u5728Hadoop\u6587\u4ef6\u7cfb\u7edf\u4e0a\u3002 \u6709\u5173\u914d\u7f6e\u5355\u8282\u70b9Hadoop\u96c6\u7fa4\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u5b98\u65b9Apache Hadoop\u6587\u6863\u3002 \u4e00\u65e6\u542f\u52a8\u5e76\u8fd0\u884c\u4e86Hadoop\u96c6\u7fa4\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5728CLASSPATH\u4e2d\u6307\u5b9aHadoop\u914d\u7f6e\u6587\u4ef6\u3002\u4e0b\u9762\u7684\u6587\u6863\u5e0c\u671b\u60a8\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e/etc/hadoop/conf\u4e0b\u3002 \u9a8c\u8bc1\u540e\uff0c\u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u5c06Hadoop\u914d\u7f6e\u6dfb\u52a0\u5230CLASSPATH\u5e76\u542f\u52a8Gremlin\u63a7\u5236\u53f0\uff0c\u5b83\u5c06\u626e\u6f14Spark\u9a71\u52a8\u7a0b\u5e8f\u7684\u89d2\u8272\u3002 export HADOOP_CONF_DIR=/etc/hadoop/conf export CLASSPATH=$HADOOP_CONF_DIR bin/gremlin.sh \u5c06Hadoop\u914d\u7f6e\u8def\u5f84\u6dfb\u52a0\u5230\u7c7b\u8def\u5f84\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u5feb\u901f\u6b65\u9aa4\u9a8c\u8bc1Gremlin\u63a7\u5236\u53f0\u662f\u5426\u53ef\u4ee5\u8bbf\u95eeHadoop\u96c6\u7fa4: gremlin hdfs == storage[org.apache.hadoop.fs.LocalFileSystem@65bb9029] // BAD gremlin hdfs == storage[DFS[DFSClient[clientName=DFSClient_NONMAPREDUCE_1229457199_1, ugi=user (auth:SIMPLE)]]] // GOOD","title":"37.1 \u914d\u7f6eHadoop\u4ee5\u8fd0\u884cOLAP"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#372-olap","text":"JanusGraph-Hadoop\u4f7f\u7528TinkerPop\u7684hadoop-gremlin\u5305\u8fdb\u884c\u901a\u7528OLAP\u904d\u5386\u56fe\uff0c\u5e76\u901a\u8fc7\u5229\u7528Apache Spark\u5e76\u884c\u5316\u67e5\u8be2\u3002","title":"37.2 OLAP\u904d\u5386"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#3721-spark-localolap","text":"\u8fd9\u91cc\u6f14\u793a\u7684\u540e\u7aef\u662fCassandra\uff0c\u4e0b\u9762\u662fOLAP\u793a\u4f8b\u3002\u5c06\u9700\u8981\u7279\u5b9a\u4e8e\u8be5\u5b58\u50a8\u540e\u7aef\u7684\u9644\u52a0\u914d\u7f6e\u3002\u914d\u7f6e\u7531gremlin.hadoop.graphReader\u5c5e\u6027\u6307\u5b9a\uff0c\u8be5\u5c5e\u6027\u6307\u5b9a\u4ece\u5b58\u50a8\u540e\u7aef\u8bfb\u53d6\u6570\u636e\u7684\u7c7b\u3002 JanusGraph\u76ee\u524d\u652f\u6301\u4ee5\u4e0bgraphReader\u7c7b\uff1a - Cassandra3InputFormat \u4e0eCassandra 3\u4e00\u8d77\u4f7f\u7528 - CassandraInputFormat \u4e0eCassandra 2\u4e00\u8d77\u4f7f\u7528 - HBaseInputFormat\u548cHBaseSnapshotInputFormatHBase\u4e00\u8d77\u4f7f\u7528 \u4ee5\u4e0b\u5c5e\u6027\u6587\u4ef6\u53ef\u7528\u4e8e\u8fde\u63a5Cassandra\u4e2d\u7684JanusGraph\u5b9e\u4f8b\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u4e0eHadoopGraph\u4e00\u8d77\u4f7f\u7528\u6765\u8fd0\u884cOLAP\u67e5\u8be2\u3002 # read-cassandra-3.properties # # Hadoop Graph Configuration # gremlin.graph=org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph gremlin.hadoop.graphReader=org.janusgraph.hadoop.formats.cassandra.Cassandra3InputFormat gremlin.hadoop.graphWriter=org.apache.tinkerpop.gremlin.hadoop.structure.io.gryo.GryoOutputFormat gremlin.hadoop.jarsInDistributedCache=true gremlin.hadoop.inputLocation=none gremlin.hadoop.outputLocation=output gremlin.spark.persistContext=true # # JanusGraph Cassandra InputFormat configuration # # These properties defines the connection properties which were used while write data to JanusGraph. janusgraphmr.ioformat.conf.storage.backend=cassandra # This specifies the hostname port for Cassandra data store. janusgraphmr.ioformat.conf.storage.hostname=127.0.0.1 janusgraphmr.ioformat.conf.storage.port=9160 # This specifies the keyspace where data is stored. janusgraphmr.ioformat.conf.storage.cassandra.keyspace=janusgraph # This defines the indexing backned configuration used while writing data to JanusGraph. janusgraphmr.ioformat.conf.index.search.backend=elasticsearch janusgraphmr.ioformat.conf.index.search.hostname=127.0.0.1 # Use the appropriate properties for the backend when using a different storage backend (HBase) or indexing backend (Solr). # # Apache Cassandra InputFormat configuration # cassandra.input.partitioner.class=org.apache.cassandra.dht.Murmur3Partitioner # # SparkGraphComputer Configuration # spark.master=local[*] spark.executor.memory=1g spark.serializer=org.apache.spark.serializer.KryoSerializer spark.kryo.registrator=org.apache.tinkerpop.gremlin.spark.structure.io.gryo.GryoRegistrator \u9996\u5148\u4f7f\u7528\u4e0a\u8ff0\u914d\u7f6e\u521b\u5efa\u5c5e\u6027\u6587\u4ef6\uff0c\u7136\u540e\u5728Gremlin\u63a7\u5236\u53f0\u4e0a\u52a0\u8f7d\u5b83\u4ee5\u8fd0\u884cOLAP\u67e5\u8be2\uff0c\u5982\u4e0b\u6240\u793a\uff1a bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: janusgraph.imports gremlin :plugin use tinkerpop.hadoop == tinkerpop.hadoop activated gremlin :plugin use tinkerpop.spark == tinkerpop.spark activated gremlin // 1. Open a the graph for OLAP processing reading in from Cassandra 3 gremlin graph = GraphFactory.open('conf/hadoop-graph/read-cassandra-3.properties') == hadoopgraph[cassandra3inputformat- gryooutputformat] gremlin // 2. Configure the traversal to run with Spark gremlin g = graph.traversal().withComputer(SparkGraphComputer) == graphtraversalsource[hadoopgraph[cassandra3inputformat- gryooutputformat], sparkgraphcomputer] gremlin // 3. Run some OLAP traversals gremlin g.V().count() ...... == 808 gremlin g.E().count() ...... == 8046","title":"37.2.1 \u4f7f\u7528Spark Local\u8fdb\u884cOLAP\u904d\u5386"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#3722-spark-standalone-clusterolap","text":"\u4e0a\u4e00\u8282\u4e2d\u4ecb\u7ecd\u7684\u6b65\u9aa4\u4e5f\u53ef\u4ee5\u4e0eSpark\u72ec\u7acb\u7fa4\u96c6\u4e00\u8d77\u4f7f\u7528\uff0c\u53ea\u9700\u8fdb\u884c\u5c11\u91cf\u66f4\u6539\uff1a \u66f4\u65b0spark.master\u5c5e\u6027\u4ee5\u6307\u5411Spark\u4e3bURL\u800c\u4e0d\u662f\u672c\u5730URL \u66f4\u65b0spark.executor.extraClassPath\u4ee5\u542f\u7528Spark\u6267\u884c\u7a0b\u5e8f\u4ee5\u67e5\u627eJanusGraph\u4f9d\u8d56\u9879jar \u5c06JanusGraph\u4f9d\u8d56\u9879jar\u590d\u5236\u5230\u6bcf\u4e2aSpark\u6267\u884c\u5668\u8ba1\u7b97\u673a\u4e0a\u4e00\u6b65\u4e2d\u6307\u5b9a\u7684\u4f4d\u7f6e \u6ce8\u610f: \u6211\u4eec\u5c06janusgraph-distribution/lib\u4e0b\u7684\u6240\u6709jar\u590d\u5236\u5230/opt/lib/janusgraph /\u4e2d\uff0c\u5e76\u5728\u6240\u6709worker\u4e2d\u521b\u5efa\u76f8\u540c\u7684\u76ee\u5f55\u7ed3\u6784\uff0c\u5e76\u5728\u6240\u6709worker\u4e2d\u624b\u52a8\u590d\u5236jar\u3002 \u7528\u4e8eOLAP\u904d\u5386\u7684\u6700\u7ec8\u5c5e\u6027\u6587\u4ef6\u5982\u4e0b\uff1a # read-cassandra-3.properties # # Hadoop Graph Configuration # gremlin.graph=org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph gremlin.hadoop.graphReader=org.janusgraph.hadoop.formats.cassandra.Cassandra3InputFormat gremlin.hadoop.graphWriter=org.apache.tinkerpop.gremlin.hadoop.structure.io.gryo.GryoOutputFormat gremlin.hadoop.jarsInDistributedCache=true gremlin.hadoop.inputLocation=none gremlin.hadoop.outputLocation=output gremlin.spark.persistContext=true # # JanusGraph Cassandra InputFormat configuration # # These properties defines the connection properties which were used while write data to JanusGraph. janusgraphmr.ioformat.conf.storage.backend=cassandra # This specifies the hostname port for Cassandra data store. janusgraphmr.ioformat.conf.storage.hostname=127.0.0.1 janusgraphmr.ioformat.conf.storage.port=9160 # This specifies the keyspace where data is stored. janusgraphmr.ioformat.conf.storage.cassandra.keyspace=janusgraph # This defines the indexing backned configuration used while writing data to JanusGraph. janusgraphmr.ioformat.conf.index.search.backend=elasticsearch janusgraphmr.ioformat.conf.index.search.hostname=127.0.0.1 # Use the appropriate properties for the backend when using a different storage backend (HBase) or indexing backend (Solr). # # Apache Cassandra InputFormat configuration # cassandra.input.partitioner.class=org.apache.cassandra.dht.Murmur3Partitioner # # SparkGraphComputer Configuration # spark.master=spark://127.0.0.1:7077 spark.executor.memory=1g spark.executor.extraClassPath=/opt/lib/janusgraph/* spark.serializer=org.apache.spark.serializer.KryoSerializer spark.kryo.registrator=org.apache.tinkerpop.gremlin.spark.structure.io.gryo.GryoRegistrator \u7136\u540e\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u4e2d\u7684\u5c5e\u6027\u6587\u4ef6\uff0c\u5982\u4e0b\u6240\u793a\uff1a bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: janusgraph.imports gremlin :plugin use tinkerpop.hadoop == tinkerpop.hadoop activated gremlin :plugin use tinkerpop.spark == tinkerpop.spark activated gremlin // 1. Open a the graph for OLAP processing reading in from Cassandra 3 gremlin graph = GraphFactory.open('conf/hadoop-graph/read-cassandra-3.properties') == hadoopgraph[cassandra3inputformat- gryooutputformat] gremlin // 2. Configure the traversal to run with Spark gremlin g = graph.traversal().withComputer(SparkGraphComputer) == graphtraversalsource[hadoopgraph[cassandra3inputformat- gryooutputformat], sparkgraphcomputer] gremlin // 3. Run some OLAP traversals gremlin g.V().count() ...... == 808 gremlin g.E().count() ...... == 8046","title":"37.2.2 \u4f7f\u7528Spark Standalone Cluster\u8fdb\u884cOLAP\u904d\u5386"},{"location":"advanced_topics/janusgraph_with_tinkerPops_hadoop_gremlin/#373","text":"Apache TinkerPop\u63d0\u4f9b\u5404\u79cd\u9876\u70b9\u7a0b\u5e8f\u3002\u9876\u70b9\u7a0b\u5e8f\u5728\u6bcf\u4e2a\u9876\u70b9\u4e0a\u8fd0\u884c\uff0c\u76f4\u5230\u8fbe\u5230\u7ec8\u6b62\u6761\u4ef6\u6216\u8fbe\u5230\u56fa\u5b9a\u7684\u8fed\u4ee3\u6b21\u6570\u3002\u7531\u4e8e\u9876\u70b9\u7a0b\u5e8f\u7684\u5e76\u884c\u7279\u6027\uff0c\u5b83\u4eec\u53ef\u4ee5\u5229\u7528Spark\u6216Giraph\u7b49\u5e76\u884c\u8ba1\u7b97\u6846\u67b6\u6765\u63d0\u9ad8\u6027\u80fd\u3002 \u4e00\u65e6\u719f\u6089\u5982\u4f55\u914d\u7f6eJanusGraph\u4ee5\u4f7f\u7528Spark\uff0c\u60a8\u5c31\u53ef\u4ee5\u8fd0\u884cApache TinkerPop\u63d0\u4f9b\u7684\u6240\u6709\u5176\u4ed6\u9876\u70b9\u7a0b\u5e8f\uff0c\u5982Page Rank\uff0cBulk Loading\u548cPeer Pressure\u3002\u6709\u5173\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 TinkerPop VertexProgram\u6587\u6863 \u3002","title":"37.3 \u5176\u4ed6\u9876\u70b9\u7a0b\u5e8f"},{"location":"advanced_topics/migrating_from_titan/","text":"39\u3001 \u4eceTitan\u8fc1\u79fb \u672c\u9875\u4ecb\u7ecd\u4e86JanusGraph\u63d0\u4f9b\u7684\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\uff0c\u4ee5\u5141\u8bb8\u4ece\u4ee5\u524d\u7531Titan\u521b\u5efa\u7684\u6570\u636e\u5b58\u50a8\u4e2d\u8fc1\u79fb\u6570\u636e\u3002\u8fc1\u79fb\u5230JanusGraph\u7248\u672c0.3.0\u6216\u66f4\u9ad8\u7248\u672c\u540e\uff0c\u8bf7\u6ce8\u610f\uff0c\u60a8\u5c06\u65e0\u6cd5\u4f7f\u7528Titan\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u56fe\u5f62\u3002 39.1 \u914d\u7f6e \u8fde\u63a5\u5230\u73b0\u6709\u7684Titan\u6570\u636e\u5b58\u50a8\u56fe\u65f6\u3002\u6cf0\u5766\u7248\u672c\u5c5e\u6027\u5e94\u8be5\u5df2\u7ecf\u5728\u5168\u5c40\u914d\u7f6e\u4e2d\u8bbe\u7f6e\u4e3a\u6cf0\u5766\u7248\u672c1.0.0\u3002JanusGraph\u4e2d\u7684ID\u5b58\u50a8\u540d\u79f0\u53ef\u4ee5\u901a\u8fc7ids.store-name\u5c5e\u6027\u914d\u7f6e\uff0c\u800c\u5728Titan\u4e2d\u5b83\u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u5982\u679c\u5728\u73b0\u6709\u7684\u5168\u5c40\u914d\u7f6e\u4e2d\u5df2\u7ecf\u8bbe\u7f6e\u4e86graph.titan-version\uff0c\u90a3\u4e48\u60a8\u4e0d\u9700\u8981\u663e\u5f0f\u5730\u8bbe\u7f6eID\u5b58\u50a8\uff0c\u56e0\u4e3a\u5b83\u5c06\u9ed8\u8ba4\u8bbe\u7f6e\u4e3atitan_ids\u3002 39.2 Cassandra Titan\u4f7f\u7528\u7684\u9ed8\u8ba4\u5bc6\u94a5\u7a7a\u95f4\u662ftitan\u4e3a\u4e86\u91cd\u7528\u8be5\u73b0\u6709\u5bc6\u94a5\u7a7a\u95f4\uff0cstorage.cassandra.keyspace\u9700\u8981\u76f8\u5e94\u5730\u8bbe\u7f6e\u8be5\u5c5e\u6027\u3002 storage.cassandra.keyspace=titan \u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u5141\u8bb8JanusGraph\u4ece\u4e4b\u524d\u7531Titan\u521b\u5efa\u7684Cassandra\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6JanusGraph\u56de\u5199\u5230\u8be5\u6570\u636e\u5e93\uff0c\u5b83\u5c06\u6ce8\u518c\u5176\u4ed6\u5e8f\u5217\u5316\u7a0b\u5e8f\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5c06\u4e0d\u518d\u4e0eTitan\u517c\u5bb9\u3002\u56e0\u6b64\uff0c\u9f13\u52b1\u7528\u6237\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\u5728Casssandra\u4e2d\u5907\u4efd\u6570\u636e\u3002 39.3 HBase Titan\u4f7f\u7528\u7684\u8868\u7684\u540d\u79f0\u662ftitan\uff0c\u4e3a\u4e86\u91cd\u7528\u8be5\u73b0\u6709\u8868\uff0cstorage.hbase.table\u9700\u8981\u76f8\u5e94\u5730\u8bbe\u7f6e\u8be5\u5c5e\u6027\u3002 storage.hbase.table = titan \u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u5141\u8bb8JanusGraph\u4ece\u4e4b\u524d\u7531Titan\u521b\u5efa\u7684HBase\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6JanusGraph\u56de\u5199\u5230\u8be5\u6570\u636e\u5e93\uff0c\u5b83\u5c06\u6ce8\u518c\u5176\u4ed6\u5e8f\u5217\u5316\u7a0b\u5e8f\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5c06\u4e0d\u518d\u4e0eTitan\u517c\u5bb9\u3002\u56e0\u6b64\uff0c\u9f13\u52b1\u7528\u6237\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\u5907\u4efdHBase\u4e2d\u7684\u6570\u636e\u3002 39.4 BerkeleyDB BerkeleyDB\u7248\u672c\u5df2\u66f4\u65b0\uff0c\u5b83\u5305\u542b\u5bf9\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u683c\u5f0f\u7684\u66f4\u6539\u3002\u6b64\u6587\u4ef6\u683c\u5f0f\u66f4\u6539\u4e0e\u4ee5\u524d\u7248\u672c\u7684BerkeleyDB\u5411\u524d\u517c\u5bb9\uff0c\u56e0\u6b64\u53ef\u4ee5\u8bfb\u5165\u4e0eTitan\u4e00\u8d77\u5b58\u50a8\u7684\u73b0\u6709\u56fe\u5f62\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6\u4f7f\u7528\u8f83\u65b0\u7248\u672c\u7684BerkeleyDB\u8bfb\u5165\u6570\u636e\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c06\u65e0\u6cd5\u518d\u7531\u65e7\u7248\u672c\u3002\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\uff0c\u5efa\u8bae\u7528\u6237\u5907\u4efdBerkeleyDB\u5b58\u50a8\u76ee\u5f55\u3002","title":"39.\u4eceTitan\u8fc1\u79fb"},{"location":"advanced_topics/migrating_from_titan/#39-titan","text":"\u672c\u9875\u4ecb\u7ecd\u4e86JanusGraph\u63d0\u4f9b\u7684\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\uff0c\u4ee5\u5141\u8bb8\u4ece\u4ee5\u524d\u7531Titan\u521b\u5efa\u7684\u6570\u636e\u5b58\u50a8\u4e2d\u8fc1\u79fb\u6570\u636e\u3002\u8fc1\u79fb\u5230JanusGraph\u7248\u672c0.3.0\u6216\u66f4\u9ad8\u7248\u672c\u540e\uff0c\u8bf7\u6ce8\u610f\uff0c\u60a8\u5c06\u65e0\u6cd5\u4f7f\u7528Titan\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u56fe\u5f62\u3002","title":"39\u3001 \u4eceTitan\u8fc1\u79fb"},{"location":"advanced_topics/migrating_from_titan/#391","text":"\u8fde\u63a5\u5230\u73b0\u6709\u7684Titan\u6570\u636e\u5b58\u50a8\u56fe\u65f6\u3002\u6cf0\u5766\u7248\u672c\u5c5e\u6027\u5e94\u8be5\u5df2\u7ecf\u5728\u5168\u5c40\u914d\u7f6e\u4e2d\u8bbe\u7f6e\u4e3a\u6cf0\u5766\u7248\u672c1.0.0\u3002JanusGraph\u4e2d\u7684ID\u5b58\u50a8\u540d\u79f0\u53ef\u4ee5\u901a\u8fc7ids.store-name\u5c5e\u6027\u914d\u7f6e\uff0c\u800c\u5728Titan\u4e2d\u5b83\u662f\u4e00\u4e2a\u5e38\u91cf\u3002\u5982\u679c\u5728\u73b0\u6709\u7684\u5168\u5c40\u914d\u7f6e\u4e2d\u5df2\u7ecf\u8bbe\u7f6e\u4e86graph.titan-version\uff0c\u90a3\u4e48\u60a8\u4e0d\u9700\u8981\u663e\u5f0f\u5730\u8bbe\u7f6eID\u5b58\u50a8\uff0c\u56e0\u4e3a\u5b83\u5c06\u9ed8\u8ba4\u8bbe\u7f6e\u4e3atitan_ids\u3002","title":"39.1 \u914d\u7f6e"},{"location":"advanced_topics/migrating_from_titan/#392-cassandra","text":"Titan\u4f7f\u7528\u7684\u9ed8\u8ba4\u5bc6\u94a5\u7a7a\u95f4\u662ftitan\u4e3a\u4e86\u91cd\u7528\u8be5\u73b0\u6709\u5bc6\u94a5\u7a7a\u95f4\uff0cstorage.cassandra.keyspace\u9700\u8981\u76f8\u5e94\u5730\u8bbe\u7f6e\u8be5\u5c5e\u6027\u3002 storage.cassandra.keyspace=titan \u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u5141\u8bb8JanusGraph\u4ece\u4e4b\u524d\u7531Titan\u521b\u5efa\u7684Cassandra\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6JanusGraph\u56de\u5199\u5230\u8be5\u6570\u636e\u5e93\uff0c\u5b83\u5c06\u6ce8\u518c\u5176\u4ed6\u5e8f\u5217\u5316\u7a0b\u5e8f\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5c06\u4e0d\u518d\u4e0eTitan\u517c\u5bb9\u3002\u56e0\u6b64\uff0c\u9f13\u52b1\u7528\u6237\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\u5728Casssandra\u4e2d\u5907\u4efd\u6570\u636e\u3002","title":"39.2 Cassandra"},{"location":"advanced_topics/migrating_from_titan/#393-hbase","text":"Titan\u4f7f\u7528\u7684\u8868\u7684\u540d\u79f0\u662ftitan\uff0c\u4e3a\u4e86\u91cd\u7528\u8be5\u73b0\u6709\u8868\uff0cstorage.hbase.table\u9700\u8981\u76f8\u5e94\u5730\u8bbe\u7f6e\u8be5\u5c5e\u6027\u3002 storage.hbase.table = titan \u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u5141\u8bb8JanusGraph\u4ece\u4e4b\u524d\u7531Titan\u521b\u5efa\u7684HBase\u6570\u636e\u5e93\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6JanusGraph\u56de\u5199\u5230\u8be5\u6570\u636e\u5e93\uff0c\u5b83\u5c06\u6ce8\u518c\u5176\u4ed6\u5e8f\u5217\u5316\u7a0b\u5e8f\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5c06\u4e0d\u518d\u4e0eTitan\u517c\u5bb9\u3002\u56e0\u6b64\uff0c\u9f13\u52b1\u7528\u6237\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\u5907\u4efdHBase\u4e2d\u7684\u6570\u636e\u3002","title":"39.3 HBase"},{"location":"advanced_topics/migrating_from_titan/#394-berkeleydb","text":"BerkeleyDB\u7248\u672c\u5df2\u66f4\u65b0\uff0c\u5b83\u5305\u542b\u5bf9\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u7684\u6587\u4ef6\u683c\u5f0f\u7684\u66f4\u6539\u3002\u6b64\u6587\u4ef6\u683c\u5f0f\u66f4\u6539\u4e0e\u4ee5\u524d\u7248\u672c\u7684BerkeleyDB\u5411\u524d\u517c\u5bb9\uff0c\u56e0\u6b64\u53ef\u4ee5\u8bfb\u5165\u4e0eTitan\u4e00\u8d77\u5b58\u50a8\u7684\u73b0\u6709\u56fe\u5f62\u6570\u636e\u3002\u4f46\u662f\uff0c\u4e00\u65e6\u4f7f\u7528\u8f83\u65b0\u7248\u672c\u7684BerkeleyDB\u8bfb\u5165\u6570\u636e\uff0c\u8fd9\u4e9b\u6587\u4ef6\u5c06\u65e0\u6cd5\u518d\u7531\u65e7\u7248\u672c\u3002\u5728\u5c1d\u8bd5\u5c06\u5176\u4e0eJanusGraph\u7248\u672c\u4e00\u8d77\u4f7f\u7528\u4e4b\u524d\uff0c\u5efa\u8bae\u7528\u6237\u5907\u4efdBerkeleyDB\u5b58\u50a8\u76ee\u5f55\u3002","title":"39.4 BerkeleyDB"},{"location":"index_backends/apache_lucene/","text":"\u7b2c29\u7ae0 Apache Lucene Apache Lucene\u662f\u4e00\u4e2a\u5b8c\u5168\u7528Java\u7f16\u5199\u7684\u9ad8\u6027\u80fd\uff0c\u529f\u80fd\u9f50\u5168\u7684\u6587\u672c\u641c\u7d22\u5f15\u64ce\u5e93\u3002\u5b83\u662f\u4e00\u79cd\u9002\u7528\u4e8e\u51e0\u4e4e\u6240\u6709\u9700\u8981\u5168\u6587\u641c\u7d22\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u6280\u672f\uff0c\u5c24\u5176\u662f\u8de8\u5e73\u53f0\u641c\u7d22\u3002Apache Lucene\u662f\u4e00\u4e2a\u53ef\u4f9b\u514d\u8d39\u4e0b\u8f7d\u7684\u5f00\u6e90\u9879\u76ee\u3002 -- Apache Lucence\u4e3b\u9875 JanusGraph\u652f\u6301Apache Lucene\u4f5c\u4e3a\u5355\u673a\u5d4c\u5165\u5f0f\u7d22\u5f15\u540e\u7aef\u3002Lucene\u6709\u4e00\u4e2a\u7565\u5fae\u6269\u5c55\u7684\u7279\u6027\u96c6\uff0c\u4e0eElasticsearch\u76f8\u6bd4\uff0c\u5b83\u5728\u5c0f\u578b\u5e94\u7528\u7a0b\u5e8f\u4e2d\u8868\u73b0\u66f4\u597d\uff0c\u4f46\u4ec5\u9650\u4e8e\u5355\u673a\u90e8\u7f72\u3002 29.3 Lucene\u5d4c\u5165\u5f0f\u914d\u7f6e \u5bf9\u4e8e\u5355\u673a\u90e8\u7f72\uff0cLucene\u8fd0\u884c\u65f6\u5d4c\u5165\u4e86Janusgraph\u3002Janusgraph\u5728\u5185\u90e8\u542f\u52a8\u5e76\u4e0eLucene\u4ea4\u4e92\u3002 \u8981\u8fd0\u884c\u5d4c\u5165\u5f0fLucene\uff0c\u8bf7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\u6dfb\u52a0\u5230\u56fe\u5f62\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5176\u4e2d/data/searchindex\u6307\u5b9aLucene\u5e94\u5b58\u50a8\u7d22\u5f15\u6570\u636e\u7684\u76ee\u5f55\uff1a index.search.backend=lucene index.search.directory=/data/searchindex \u5728\u4e0a\u9762\u7684\u914d\u7f6e\u4e2d\uff0c\u7d22\u5f15\u540e\u7aef\u88ab\u547d\u540dsearch\u3002\u66ff\u6362search\u4e3a\u5176\u4ed6\u540d\u79f0\u4ee5\u66f4\u6539\u7d22\u5f15\u7684\u540d\u79f0\u3002 29.2 \u529f\u80fd\u652f\u6301 \u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 Geo\uff1a\u652f\u6301Geo\u8c13\u8bcd\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4e2d\u76f8\u4ea4\uff0c\u5305\u542b\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u7684\u5706\u548c\u6846\u4ee5\u53ca\u7528\u4e8e\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u7684\u6240\u6709\u5f62\u72b6\u3002 \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 \u65f6\u95f4\uff1a\u7eb3\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668 Not Query-normal-form\uff1a\u652f\u6301Query-normal-form\uff08QNF\uff09\u4ee5\u5916\u7684\u67e5\u8be2\u3002JanusGraph\u7684QNF\u662fCNF\uff08\u8054\u5408\u6b63\u5e38\u5f62\u5f0f\uff09\u7684\u53d8\u4f53\uff0c\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u5185\u8054\u5426\u5b9a\u3002 29.3 \u914d\u7f6e\u9009\u9879 \u6709\u5173\u6240\u6709Lucene\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\u4ee5\u53ca\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003 \u3002 \u8bf7\u6ce8\u610f\uff0c\u6bcf\u4e2a\u7d22\u5f15\u540e\u7aef\u9009\u9879\u90fd\u9700\u8981\u4ee5index.[INDEX-NAME].where [INDEX-NAME]\u4e3a\u7d22\u5f15\u540e\u7aef\u540d\u79f0\u7684\u524d\u7f00\u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7d22\u5f15\u540e\u7aef\u540d\u4e3asearch\uff0c\u5219\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u9700\u8981\u4ee5\u524d\u7f00\u4e3a\u524d\u7f00index.search.\u3002\u8981\u914d\u7f6e\u540d\u4e3asearch\u7684\u7d22\u5f15\u540e\u7aef\u4ee5\u4f7f\u7528Lucene\u4f5c\u4e3a\u7d22\u5f15\u7cfb\u7edf\uff0c\u8bf7\u8bbe\u7f6e\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\uff1a index.search.backend = lucene 29.4 \u5ef6\u4f38\u9605\u8bfb \u6709\u5173Lucene\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Apache Lucene\u4e3b\u9875 \u548c\u53ef\u7528\u6587\u6863\u3002","title":"29.Apache_Lucene"},{"location":"index_backends/apache_lucene/#29-apache-lucene","text":"Apache Lucene\u662f\u4e00\u4e2a\u5b8c\u5168\u7528Java\u7f16\u5199\u7684\u9ad8\u6027\u80fd\uff0c\u529f\u80fd\u9f50\u5168\u7684\u6587\u672c\u641c\u7d22\u5f15\u64ce\u5e93\u3002\u5b83\u662f\u4e00\u79cd\u9002\u7528\u4e8e\u51e0\u4e4e\u6240\u6709\u9700\u8981\u5168\u6587\u641c\u7d22\u7684\u5e94\u7528\u7a0b\u5e8f\u7684\u6280\u672f\uff0c\u5c24\u5176\u662f\u8de8\u5e73\u53f0\u641c\u7d22\u3002Apache Lucene\u662f\u4e00\u4e2a\u53ef\u4f9b\u514d\u8d39\u4e0b\u8f7d\u7684\u5f00\u6e90\u9879\u76ee\u3002 -- Apache Lucence\u4e3b\u9875 JanusGraph\u652f\u6301Apache Lucene\u4f5c\u4e3a\u5355\u673a\u5d4c\u5165\u5f0f\u7d22\u5f15\u540e\u7aef\u3002Lucene\u6709\u4e00\u4e2a\u7565\u5fae\u6269\u5c55\u7684\u7279\u6027\u96c6\uff0c\u4e0eElasticsearch\u76f8\u6bd4\uff0c\u5b83\u5728\u5c0f\u578b\u5e94\u7528\u7a0b\u5e8f\u4e2d\u8868\u73b0\u66f4\u597d\uff0c\u4f46\u4ec5\u9650\u4e8e\u5355\u673a\u90e8\u7f72\u3002","title":"\u7b2c29\u7ae0 Apache Lucene"},{"location":"index_backends/apache_lucene/#293-lucene","text":"\u5bf9\u4e8e\u5355\u673a\u90e8\u7f72\uff0cLucene\u8fd0\u884c\u65f6\u5d4c\u5165\u4e86Janusgraph\u3002Janusgraph\u5728\u5185\u90e8\u542f\u52a8\u5e76\u4e0eLucene\u4ea4\u4e92\u3002 \u8981\u8fd0\u884c\u5d4c\u5165\u5f0fLucene\uff0c\u8bf7\u5c06\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\u6dfb\u52a0\u5230\u56fe\u5f62\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5176\u4e2d/data/searchindex\u6307\u5b9aLucene\u5e94\u5b58\u50a8\u7d22\u5f15\u6570\u636e\u7684\u76ee\u5f55\uff1a index.search.backend=lucene index.search.directory=/data/searchindex \u5728\u4e0a\u9762\u7684\u914d\u7f6e\u4e2d\uff0c\u7d22\u5f15\u540e\u7aef\u88ab\u547d\u540dsearch\u3002\u66ff\u6362search\u4e3a\u5176\u4ed6\u540d\u79f0\u4ee5\u66f4\u6539\u7d22\u5f15\u7684\u540d\u79f0\u3002","title":"29.3 Lucene\u5d4c\u5165\u5f0f\u914d\u7f6e"},{"location":"index_backends/apache_lucene/#292","text":"\u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 Geo\uff1a\u652f\u6301Geo\u8c13\u8bcd\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4e2d\u76f8\u4ea4\uff0c\u5305\u542b\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u7684\u5706\u548c\u6846\u4ee5\u53ca\u7528\u4e8e\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u7684\u6240\u6709\u5f62\u72b6\u3002 \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 \u65f6\u95f4\uff1a\u7eb3\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668 Not Query-normal-form\uff1a\u652f\u6301Query-normal-form\uff08QNF\uff09\u4ee5\u5916\u7684\u67e5\u8be2\u3002JanusGraph\u7684QNF\u662fCNF\uff08\u8054\u5408\u6b63\u5e38\u5f62\u5f0f\uff09\u7684\u53d8\u4f53\uff0c\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u5185\u8054\u5426\u5b9a\u3002","title":"29.2 \u529f\u80fd\u652f\u6301"},{"location":"index_backends/apache_lucene/#293","text":"\u6709\u5173\u6240\u6709Lucene\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\u4ee5\u53ca\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003 \u3002 \u8bf7\u6ce8\u610f\uff0c\u6bcf\u4e2a\u7d22\u5f15\u540e\u7aef\u9009\u9879\u90fd\u9700\u8981\u4ee5index.[INDEX-NAME].where [INDEX-NAME]\u4e3a\u7d22\u5f15\u540e\u7aef\u540d\u79f0\u7684\u524d\u7f00\u4e3a\u524d\u7f00\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7d22\u5f15\u540e\u7aef\u540d\u4e3asearch\uff0c\u5219\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u9700\u8981\u4ee5\u524d\u7f00\u4e3a\u524d\u7f00index.search.\u3002\u8981\u914d\u7f6e\u540d\u4e3asearch\u7684\u7d22\u5f15\u540e\u7aef\u4ee5\u4f7f\u7528Lucene\u4f5c\u4e3a\u7d22\u5f15\u7cfb\u7edf\uff0c\u8bf7\u8bbe\u7f6e\u4ee5\u4e0b\u914d\u7f6e\u9009\u9879\uff1a index.search.backend = lucene","title":"29.3 \u914d\u7f6e\u9009\u9879"},{"location":"index_backends/apache_lucene/#294","text":"\u6709\u5173Lucene\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Apache Lucene\u4e3b\u9875 \u548c\u53ef\u7528\u6587\u6863\u3002","title":"29.4 \u5ef6\u4f38\u9605\u8bfb"},{"location":"index_backends/apache_solr/","text":"\u7b2c28\u7ae0 Apache Solr Solr\u662fApache Lucene\u9879\u76ee\u4e2d\u975e\u5e38\u6d41\u884c\u7684\u3001\u975e\u5e38\u5feb\u901f\u7684\u5f00\u6e90\u4f01\u4e1a\u641c\u7d22\u5e73\u53f0\u3002Solr\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4f01\u4e1a\u641c\u7d22\u670d\u52a1\u5668\uff0c\u5177\u6709\u7c7b\u4f3crest\u7684API\u3002Solr\u662f\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d\u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u5f0f\u914d\u7f6e\u7b49\u3002 - Apache Solr\u4e3b\u9875 JanusGraph\u652f\u6301Apache Solr\u4f5c\u4e3a\u7d22\u5f15\u540e\u7aef\u3002\u4ee5\u4e0b\u662fJanusGraph\u652f\u6301\u7684\u4e00\u4e9bSolr\u529f\u80fd\uff1a \u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 - Geo\uff1a\u652f\u6301\u6240\u6709Geo\u8c13\u8bcd\uff0c\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4f53\u4e2d\u76f8\u4ea4\uff0c\u5185\u90e8\uff0c\u4e0d\u76f8\u4ea4\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u5706\uff0c\u6846\u548c\u591a\u8fb9\u5f62\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u548c\u6240\u6709\u5f62\u72b6\u4ee5\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u3002 - \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 - TTL\uff1a\u652f\u6301\u81ea\u52a8\u4f7f\u7d22\u5f15\u5143\u7d20\u8fc7\u671f\u3002 - \u65f6\u95f4\uff1a\u6beb\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 - \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668\u3002 \u6709\u5173Solr\u5c06\u4e0eJanusGraph\u914d\u5408\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u9644\u5f55B\uff0c\u7248\u672c\u517c\u5bb9\u6027 \u3002 28.1 Solr\u914d\u7f6e\u6982\u8ff0 JanusGraph\u652f\u6301Solr\u5728SolrCloud\u6216Solr Standalone\uff08HTTP\uff09\u914d\u7f6e\u4e2d\u8fd0\u884c\uff0c\u4ee5\u4fbf\u4e0e\u6df7\u5408\u7d22\u5f15\u4e00\u8d77\u4f7f\u7528\uff08\u8bf7\u53c2\u89c1\u7b2c11.1.2\u8282\u201c\u6df7\u5408\u7d22\u5f15\u201d\uff09\u3002\u901a\u8fc7\u53c2\u6570\u914d\u7f6e\u6240\u9700\u7684\u8fde\u63a5\u6a21\u5f0f\uff0c\u8be5\u53c2\u6570mode\u5fc5\u987b\u8bbe\u7f6e\u4e3acloud\u6216\u8005http\uff0c\u524d\u8005\u662f\u9ed8\u8ba4\u503c\u3002\u4f8b\u5982\uff0c\u8981\u660e\u786e\u6307\u5b9aSolr\u5728SolrCloud\u914d\u7f6e\u4e2d\u8fd0\u884c\uff0c\u8bf7\u5c06\u4ee5\u4e0b\u5c5e\u6027\u6307\u5b9a\u4e3aJanusGraph\u914d\u7f6e\u5c5e\u6027\uff1a index.search.solr.mode = cloud \u8fd9\u4e9b\u662f\u4e00\u4e9b\u5173\u952e\u7684Solr\u672f\u8bed\uff1a Core: \u5355\u53f0\u673a\u5668\u4e0a\u7684\u5355\u4e2a\u7d22\u5f15\u3002 Configuration: solrconfig.xml\uff0c schema.xml\u548c\u5b9a\u4e49\u6838\u5fc3\u6240\u9700\u7684\u5176\u4ed6\u6587\u4ef6\u3002 Collection: \u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684\u591a\u4e2a\u6838\u5fc3\u7684\u5355\u4e2a\u903b\u8f91\u7d22\u5f15\u3002 Configset: \u53ef\u7531\u591a\u4e2a\u5185\u6838\u91cd\u7528\u7684\u5171\u4eab\u914d\u7f6e\u3002 28.2 \u8fde\u63a5\u5230SolrCloud \u901a\u8fc7\u5c06mode\u7b49\u4e8e\u8bbe\u7f6e\u4e3a\u8fde\u63a5\u5230SolrCloud\u96c6\u7fa4\u65f6\uff0ccloud\u5fc5\u987b\u6307\u5b9aZookeeper URL\uff08\u4ee5\u53ca\u53ef\u9009\u7684\u7aef\u53e3\uff09\uff0c\u4ee5\u4fbfJanusGraph\u53ef\u4ee5\u53d1\u73b0Solr\u96c6\u7fa4\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002 index.search.backend=solr index.search.solr.mode=cloud index.search.solr.zookeeper-url=localhost:2181 \u4e0e\u521b\u5efa\u65b0\u96c6\u5408\u76f8\u5173\u7684\u8bb8\u591a\u9644\u52a0\u914d\u7f6e\u9009\u9879(\u4ec5\u5728SolrCloud\u64cd\u4f5c\u6a21\u5f0f\u4e2d\u53d7\u652f\u6301)\u53ef\u4ee5\u914d\u7f6e\u4e3a\u63a7\u5236\u5206\u7247\u884c\u4e3a\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0 \u914d\u7f6e\u53c2\u8003 \u3002 SolrCloud\u5229\u7528Zookeeper\u5728Solr\u670d\u52a1\u5668\u4e4b\u95f4\u534f\u8c03\u6536\u96c6\u548c\u914d\u7f6e\u4fe1\u606f\u3002\u4f7f\u7528Zookeeper\u548cSolrCloud\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u4f7f\u7528Solr\u4f5c\u4e3aJanusGraph\u540e\u7aef\u7d22\u5f15\u6240\u9700\u7684\u624b\u52a8\u914d\u7f6e\u91cf\u3002 28.2.1 Configset\u914d\u7f6e \u521b\u5efa\u96c6\u5408\u9700\u8981configset\u3002configset\u5b58\u50a8\u5728Zookeeper\u4e2d\uff0c\u4ee5\u4fbf\u5141\u8bb8\u8de8Solr\u670d\u52a1\u5668\u8bbf\u95ee\u5b83\u3002 - \u6bcf\u4e2a\u96c6\u5408\u5728\u521b\u5efa\u65f6\u90fd\u53ef\u4ee5\u63d0\u4f9b\u81ea\u5df1\u7684configset\uff0c\u4ee5\u4fbf\u6bcf\u4e2a\u96c6\u5408\u53ef\u4ee5\u5177\u6709\u4e0d\u540c\u7684\u914d\u7f6e\u3002\u4f7f\u7528\u6b64\u65b9\u6cd5\uff0c\u5fc5\u987b\u624b\u52a8\u521b\u5efa\u6bcf\u4e2a\u96c6\u5408\u3002 - \u5982\u679c\u4e00\u4e2a\u5171\u4eab\u7684configset\u5c06\u88ab\u591a\u4e2a\u96c6\u5408\u91cd\u7528\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u5355\u72ec\u4e0a\u4f20\u5230Zookeeper\u3002\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0cJanusGraph\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u5171\u4eab\u7684configset\u81ea\u52a8\u521b\u5efa\u96c6\u5408\u3002\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u91cd\u7528configset\u5927\u5927\u51cf\u5c11\u4e86\u5b58\u50a8\u5728Zookeeper\u4e2d\u7684\u6570\u636e\u91cf\u3002 28.2.1.1 \u4f7f\u7528\u5355\u4e2aconfigset \u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\u624b\u52a8\u521b\u5efa\u540d\u4e3averticesByAge\u7684\u96c6\u5408\u3002\u521b\u5efa\u96c6\u5408\u65f6\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u96c6\u5408\u540dverticesByAge\u5c06\u914d\u7f6e\u4e0a\u4f20\u5230Zookeeper\u4e2d\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002 # create the collection $SOLR_HOME/bin/solr create -c verticesByAge -d $JANUSGRAPH_HOME/conf/solr \u4f7f\u7528JanusGraphManagement\u76f8\u540c\u7684\u96c6\u5408\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit() 28.2.1.2 \u4f7f\u7528\u5171\u4eabconfigset \u5728\u4f7f\u7528\u5171\u4eabconfigset\u65f6\uff0c\u6700\u65b9\u4fbf\u7684\u65b9\u6cd5\u662f\u9996\u5148\u5c06\u914d\u7f6e\u4f5c\u4e3a\u4e00\u6b21\u6027\u64cd\u4f5c\u4e0a\u8f7d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\uff0c\u5c06\u540d\u4e3aJanusGraph -configset\u7684configset\u4e0a\u4f20\u5230Zookeeper\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002 # upload the shared configset into Zookeeper # Solr 5 $SOLR_HOME/server/scripts/cloud-scripts/zkcli.sh -cmd upconfig -z localhost:2181 \\ -d $JANUSGRAPH_HOME/conf/solr -n janusgraph-configset # Solr 6 and higher $SOLR_HOME/bin/solr zk upconfig -d $JANUSGRAPH_HOME/conf/solr -n janusgraph-configset \\ -z localhost:2181 \u4e3aJanusGraph\u914d\u7f6eSolrCloud\u7d22\u5f15\u540e\u7aef\u65f6\uff0c\u8bf7\u786e\u4fdd\u4f7f\u7528\u8be5index.search.solr.configset\u5c5e\u6027\u63d0\u4f9b\u5171\u4eabconfigset\u7684\u540d\u79f0\u3002 index.search.backend=solr index.search.solr.mode=cloud index.search.solr.zookeeper-url=localhost:2181 index.search.solr.configset=janusgraph-configset \u4f7f\u7528JanusGraphManagement\u548c\u96c6\u5408\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit() 28.3 \u8fde\u63a5\u5230Solr Standalone(HTTP) \u901a\u8fc7\u8bbe\u7f6emode\u7b49\u4e8ehttp\uff0c\u901a\u8fc7HTTP\u8fde\u63a5\u5230Solr Standalone\u65f6\uff0c\u5fc5\u987b\u63d0\u4f9bSolr\u5b9e\u4f8b\u7684\u5355\u4e2a\u6216URL\u5217\u8868\u3002 index.search.backend=solr index.search.solr.mode=http index.search.solr.http-urls=http://localhost:8983/solr \u7528\u4e8e\u63a7\u5236\u6700\u5927\u8fde\u63a5\u6570\uff0c\u8fde\u63a5\u8d85\u65f6\u548c\u4f20\u8f93\u538b\u7f29\u7684\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u53ef\u7528\u4e8eHTTP\u6a21\u5f0f\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \u7b2c15\u7ae0 \u914d\u7f6e\u53c2\u8003 \u3002 28.3.1 \u6838\u5fc3\u914d\u7f6e Solr Standalone\u7528\u4e8e\u5355\u4e2a\u5b9e\u4f8b\uff0c\u5b83\u5c06\u914d\u7f6e\u4fe1\u606f\u4fdd\u5b58\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u6df7\u5408\u7d22\u5f15\u624b\u52a8\u521b\u5efa\u6838\u5fc3\u3002 \u8981\u521b\u5efa\u6838\u5fc3\uff0c\u9700\u8981\u4e00\u4e2acore_name\u548c\u4e00\u4e2aconfiguration\u76ee\u5f55\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605Solr\u53c2\u8003\u6307\u5357\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3averticesByAge\u7684\u6838\u5fc3\u3002 $SOLR_HOME/bin/solr create -c verticesByAge -d $JANUSGRAPH_HOME/conf/solr \u4f7f\u7528JanusGraphManagement\u76f8\u540c\u7684\u6838\u5fc3\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit() 28.4 Kerberos\u914d\u7f6e \u5728\u8fde\u63a5\u5230\u53d7Kerberos\u4fdd\u62a4\u7684Solr\u73af\u5883\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u4f7f\u7528\u7684Kerberos\uff0c\u5e76\u5f15\u7528JAAS\u914d\u7f6e\u6587\u4ef6\u6765\u6b63\u786e\u914d\u7f6eSolr\u5ba2\u6237\u673a\u3002\u5728\u4f7f\u7528Kerberos\u65f6\uff0c\u65e0\u8bbaSolr\u4ee5\u4f55\u79cd\u6a21\u5f0f\u8fd0\u884c(SolrCloud\u6216Solr\u72ec\u7acb\u8fd0\u884c)\uff0c\u90fd\u9700\u8981\u8fd9\u79cd\u914d\u7f6e\u3002 index.search.solr.kerberos-enabled=true \u901a\u8fc7\u8bbe\u7f6ejava.security.auth.login.config\u7684\u7edd\u5bf9\u8def\u5f84\u6765\u786e\u4fdd\u63d0\u4f9bJAAS\u914d\u7f6e\u6587\u4ef6\u3002\u5e94\u4f7f\u7528JVM\u9009\u9879\u8bbe\u7f6e\u6b64\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u8981\u8fd0\u884c\uff0cgremlin.sh\u60a8\u9700\u8981JAVA_OPTIONS\u5728\u8fd0\u884c\u811a\u672c\u4e4b\u524d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a --- export JAVA_OPTIONS= -Djava.security.auth.login.config=/absolute/path/jaas.conf $JANUSGRAPH_HOME/bin/gremlin.sh --- \u6709\u5173JAAS\u914d\u7f6e\u6587\u4ef6\u4e2d\u6240\u9700\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002 28.5 Solr\u67b6\u6784\u8bbe\u8ba1 28.5.1 \u52a8\u6001\u5b57\u6bb5\u5b9a\u4e49 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u4f7f\u7528Solr\u7684\u52a8\u6001\u5b57\u6bb5\u529f\u80fd\u6765\u5b9a\u4e49\u6240\u6709\u7d22\u5f15\u952e\u7684\u5b57\u6bb5\u7c7b\u578b\u3002\u5c06\u5c5e\u6027\u952e\u6dfb\u52a0\u5230Solr\u652f\u6301\u7684\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u8fd9\u4e0d\u9700\u8981\u989d\u5916\u914d\u7f6e\uff0c\u5e76\u4e14\u63d0\u4f9b\u6bd4\u65e0\u6a21\u5f0f\u6a21\u5f0f\u66f4\u597d\u7684\u6027\u80fd\u3002 JanusGraph\u5047\u8bbe\u5728\u652f\u6301Solr\u96c6\u5408\u7684schema.xml\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u52a8\u6001\u5b57\u6bb5\u6807\u8bb0\u3002\u8bf7\u6ce8\u610f\uff0csolr schema.xml\u6587\u4ef6\u4e2d\u8fd8\u9700\u8981\u4ee5\u4e0b\u5b57\u6bb5\u7684\u9644\u52a0xml\u5b9a\u4e49\u624d\u80fd\u4f7f\u7528\u5b83\u4eec\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605JanusGraph\u5b89\u88c5\u4e2d./conf/solr/schema.xml\u76ee\u5f55\u4e2d\u63d0\u4f9b\u7684\u793a\u4f8bschema.xml\u6587\u4ef6\u3002 dynamicField name= *_i type= int indexed= true stored= true / dynamicField name= *_s type= string indexed= true stored= true / dynamicField name= *_l type= long indexed= true stored= true / dynamicField name= *_t type= text_general indexed= true stored= true / dynamicField name= *_b type= boolean indexed= true stored= true / dynamicField name= *_f type= float indexed= true stored= true / dynamicField name= *_d type= double indexed= true stored= true / dynamicField name= *_g type= geo indexed= true stored= true / dynamicField name= *_dt type= date indexed= true stored= true / dynamicField name= *_uuid type= uuid indexed= true stored= true / \u5728JanusGraph\u7684\u9ed8\u8ba4\u914d\u7f6e\u4e2d\uff0c\u5c5e\u6027\u952e\u540d\u79f0\u4e0d\u5fc5\u4ee5\u7c7b\u578b\u76f8\u5e94\u7684\u540e\u7f00\u7ed3\u675f\uff0c\u4ee5\u4fbf\u5229\u7528Solr\u7684\u52a8\u6001\u5b57\u6bb5\u529f\u80fd\u3002JanusGraph\u901a\u8fc7\u5bf9\u5c5e\u6027\u952e\u5b9a\u4e49\u7684\u6570\u5b57\u6807\u8bc6\u7b26\u548c\u7c7b\u578b\u76f8\u5e94\u7684\u540e\u7f00\u8fdb\u884c\u7f16\u7801\uff0c\u4ece\u5c5e\u6027\u952e\u540d\u79f0\u751f\u6210Solr\u5b57\u6bb5\u540d\u79f0\u3002\u8fd9\u610f\u5473\u7740JanusGraph\u5728\u5e55\u540e\u4f7f\u7528\u5177\u6709\u7c7b\u578b\u76f8\u5e94\u540e\u7f00\u7684\u5408\u6210\u5b57\u6bb5\u540d\u79f0\uff0c\u800c\u4e0d\u7ba1\u4f7f\u7528JanusGraph\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u5b9a\u4e49\u548c\u4f7f\u7528\u7684\u5c5e\u6027\u952e\u540d\u79f0\u3002\u53ef\u4ee5\u901a\u8fc7\u975e\u9ed8\u8ba4\u914d\u7f6e\u8986\u76d6\u6b64\u5b57\u6bb5\u540d\u79f0\u6620\u5c04\u3002\u8fd9\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u63cf\u8ff0\u3002 28.5.2 \u624b\u52a8\u5b57\u6bb5\u5b9a\u4e49 \u5982\u679c\u7528\u6237\u5b81\u613f\u624b\u52a8\u4e3a\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u5b57\u6bb5\u5b9a\u4e49\u5b57\u6bb5\u7c7b\u578b\uff0c\u5219\u9700\u8981\u7981\u7528dyn-fields\u914d\u7f6e\u9009\u9879\u3002\u5728\u5c06\u5c5e\u6027\u952e\u6dfb\u52a0\u5230\u7d22\u5f15\u4e4b\u524d\uff0c\u5fc5\u987b\u5728\u652f\u6301Solr\u67b6\u6784\u4e2d\u5b9a\u4e49\u6bcf\u4e2a\u7d22\u5f15\u5c5e\u6027\u952e\u7684\u5b57\u6bb5\u3002 \u5728\u6b64\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u542f\u7528\u5b57\u6bb5\u6620\u5c04\u7684\u663e\u5f0f\u5c5e\u6027\u952e\u540d\uff0c\u4ee5\u4fbf\u4fee\u590d\u5b57\u6bb5\u540d\u7684\u663e\u5f0f\u5b9a\u4e49\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u4e4b\u4e00\u6765\u5b9e\u73b0\uff1a - \u5728\u5411\u7d22\u5f15\u6dfb\u52a0\u5c5e\u6027\u952e\u65f6\uff0c\u901a\u8fc7\u63d0\u4f9bmapped-name\u53c2\u6570\u914d\u7f6e\u5b57\u6bb5\u540d\u3002\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c25.1\u8282 \u5355\u4e2a\u5b57\u6bb5\u6620\u5c04 \u3002 - \u901a\u8fc7\u4e3aSolr\u7d22\u5f15\u542f\u7528map-name\u914d\u7f6e\u9009\u9879\uff0c\u8be5\u9009\u9879\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u540d\u4f5c\u4e3aSolr\u4e2d\u7684\u5b57\u6bb5\u540d\u3002\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c25.2\u8282 \u5168\u5c40\u5b57\u6bb5\u6620\u5c04 \u3002 28.5.3. Schemaless Mode JanusGraph\u8fd8\u53ef\u4ee5\u4e0e\u4e3a Schemaless Mode\u914d\u7f6e\u7684SolrCloud\u96c6\u7fa4\u8fdb\u884c\u4ea4\u4e92\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u7981\u7528dyn-fields\u914d\u7f6e\u9009\u9879\uff0c\u56e0\u4e3aSolr\u5c06\u4ece\u503c\u800c\u4e0d\u662f\u5b57\u6bb5\u540d\u79f0\u63a8\u65ad\u5b57\u6bb5\u7c7b\u578b\u3002 \u4f46\u8bf7\u6ce8\u610f\uff0cSchemaless Mode\u4ec5\u5efa\u8bae\u7528\u4e8e\u539f\u578b\u8bbe\u8ba1\u548c\u521d\u59cb\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\uff0c\u4e0d\u5efa\u8bae\u7528\u4e8e\u751f\u4ea7\u7528\u9014\u3002 28.6 \u6545\u969c\u6392\u9664 28.6.1 \u96c6\u5408\u4e0d\u5b58\u5728 \u5728\u5b9a\u4e49\u53ef\u4ee5\u4f7f\u7528\u96c6\u5408\u7684\u7d22\u5f15\u4e4b\u524d\uff0c\u5fc5\u987b\u521d\u59cb\u5316\u96c6\u5408(\u4ee5\u53ca\u6240\u6709\u5fc5\u9700\u7684\u914d\u7f6e\u6587\u4ef6)\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u8fde\u63a5\u5230SolrCloud\u3002 \u4f7f\u7528SolrCloud\u65f6\uff0cZookeeper zkCli.sh\u547d\u4ee4\u884c\u5de5\u5177\u53ef\u7528\u4e8e\u68c0\u67e5\u52a0\u8f7d\u5230Zookeeper\u4e2d\u7684\u914d\u7f6e\u3002\u8fd8\u8981\u9a8c\u8bc1\u9ed8\u8ba4\u7684JanusGraph\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u5df2\u590d\u5236\u5230solr\u4e0b\u7684\u6b63\u786e\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u590d\u5236\u6587\u4ef6\u7684\u76ee\u5f55\u662f\u5426\u6b63\u786e\u3002 28.6.2 \u627e\u4e0d\u5230\u6307\u5b9a\u7684Configset \u4f7f\u7528SolrCloud\u65f6\uff0c\u9700\u8981\u4e00\u4e2aconfigset\u6765\u4e3aJanusGraph\u521b\u5efa\u4e00\u4e2a\u6df7\u5408\u7d22\u5f15\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Configset\u914d\u7f6e\u3002 \u5982\u679c\u4f7f\u7528\u5355\u4e2a\u914d\u7f6e\u96c6\uff0c\u5219\u5fc5\u987b\u9996\u5148\u624b\u52a8\u521b\u5efa\u96c6\u5408\u3002 \u5982\u679c\u4f7f\u7528\u5171\u4eab\u914d\u7f6e\u96c6\uff0c\u5219\u5fc5\u987b\u9996\u5148\u5c06\u914d\u7f6e\u96c6\u4e0a\u8f7d\u5230Zookeeper\u3002 \u60a8\u53ef\u4ee5\u9a8c\u8bc1\u914d\u7f6e\u96c6\u53ca\u5176\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u4f4d\u4e8eZookeeper\u4e2d/configs\u3002\u6709\u5173\u5176\u4ed6Zookeeper\u64cd\u4f5c\uff0c\u8bf7\u53c2\u9605\u201c Solr\u53c2\u8003\u6307\u5357\u201d\u3002 # verify the configset in Zookeeper # Solr 5 $SOLR_HOME/server/scripts/cloud-scripts/zkcli.sh -cmd list -z localhost:2181 # Solr 6 and higher $SOLR_HOME/bin/solr zk ls -r /configs/configset-name -z localhost:2181 28.6.3 HTTP 404\u9519\u8bef \u4f7f\u7528Solr Standalone\uff08HTTP\uff09\u6a21\u5f0f\u65f6\u53ef\u80fd\u4f1a\u9047\u5230\u6b64\u9519\u8bef\u3002\u9519\u8bef\u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a 20:01:22 ERROR org.janusgraph.diskstorage.solr.SolrIndex - Unable to save documents to Solr as one of the shape objects stored were not compatible with Solr. org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at http://localhost:8983/solr: Expected mime type application/octet-stream but got text/html. html head meta http-equiv= Content-Type content= text/html;charset=utf-8 / title Error 404 Not Found /title /head body h2 HTTP ERROR 404 /h2 p Problem accessing /solr/verticesByAge/update. Reason: pre Not Found /pre /p /body /html \u5728\u5c1d\u8bd5\u5c06\u6570\u636e\u5b58\u50a8\u5230\u7d22\u5f15\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u624b\u52a8\u521b\u5efa\u6838\u5fc3\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6838\u5fc3\u914d\u7f6e\u3002 28.6.4 \u6838\u5fc3\u6216\u96c6\u5408\u540d\u79f0\u65e0\u6548 \u6838\u5fc3\u6216\u96c6\u5408\u540d\u79f0\u662f\u6807\u8bc6\u7b26\u3002\u5b83\u5fc5\u987b\u5b8c\u5168\u7531\u53e5\u53f7\uff0c\u4e0b\u5212\u7ebf\uff0c\u8fde\u5b57\u7b26\u548c/\u6216\u5b57\u6bcd\u6570\u5b57\u7ec4\u6210\uff0c\u4e5f\u53ef\u80fd\u4e0d\u4ee5\u8fde\u5b57\u7b26\u5f00\u5934\u3002 28.6.5 \u8fde\u63a5\u95ee\u9898 \u65e0\u8bba\u64cd\u4f5c\u6a21\u5f0f\u5982\u4f55\uff0cSolr\u5b9e\u4f8b\u6216Solr\u5b9e\u4f8b\u96c6\u7fa4\u5fc5\u987b\u6b63\u5728\u8fd0\u884c\u5e76\u53ef\u4eceJanusGraph\u5b9e\u4f8b\u8bbf\u95ee\uff0c\u4ee5\u4fbfJanusGraph\u5c06Solr\u7528\u4f5c\u7d22\u5f15\u540e\u7aef\u3002\u68c0\u67e5Solr\u96c6\u7fa4\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u5e76\u4e14\u5b83\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\uff08\u6216\u672c\u5730\uff09\u4eceJanusGraph\u5b9e\u4f8b\u8bbf\u95ee\u3002 28.6.6 \u5e26\u6709\u5730\u7406\u6570\u636e\u7684JTS ClassNotFoundException Solr\u4f9d\u9760Spatial4j\u8fdb\u884c\u5730\u7406\u5904\u7406\u3002Spatial4j\u58f0\u660e\u4e86\u5bf9JTS\u7684\u53ef\u9009\u4f9d\u8d56\uff08\u201cJTS\u62d3\u6251\u5957\u4ef6\u201d\uff09\u3002\u67d0\u4e9b\u5730\u7406\u5b57\u6bb5\u5b9a\u4e49\u548c\u67e5\u8be2\u529f\u80fd\u9700\u8981JTS\u3002\u5982\u679cJTS jar\u4e0d\u5728Solr\u5b88\u62a4\u7a0b\u5e8f\u7684\u7c7b\u8def\u5f84\u4e0a\uff0c\u5e76\u4e14schema.xml\u4e2d\u7684\u5b57\u6bb5\u4f7f\u7528\u5730\u7406\u7c7b\u578b\uff0c\u5219Solr\u53ef\u80fd\u4f1a\u5728\u5176\u4e2d\u4e00\u4e2a\u7f3a\u5c11\u7684JTS\u7c7b\u4e0a\u629b\u51faClassNotFoundException\u3002\u4f7f\u7528\u65e8\u5728\u4e0eJanusGraph\u4e00\u8d77\u4f7f\u7528\u7684schema.xml\u6587\u4ef6\u542f\u52a8Solr\u65f6\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u4f46CREATE\u5728Solr CoreAdmin API\u4e2d\u8c03\u7528\u65f6\u4e5f\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002\u867d\u7136\u6839\u672c\u539f\u56e0\u662f\u76f8\u540c\u7684\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u7684\u683c\u5f0f\u7565\u6709\u4e0d\u540c\u3002 \u4ee5\u4e0b\u662fSolr\u670d\u52a1\u5668\u65e5\u5fd7\u7684\u4ee3\u8868\u793a\u4f8b\uff1a ERROR [http-8983-exec-5] 2014-10-07 02:54:06, 665 SolrCoreResourceManager.java (line 344) com/vividsolutions/jts/geom/Geometry java.lang.NoClassDefFoundError: com/vividsolutions/jts/geom/Geometry at com.spatial4j.core.context.jts.JtsSpatialContextFactory.newSpatialContext(JtsSpatialContextFactory.java:30) at com.spatial4j.core.context.SpatialContextFactory.makeSpatialContext(SpatialContextFactory.java:83) at org.apache.solr.schema.AbstractSpatialFieldType.init(AbstractSpatialFieldType.java:95) at org.apache.solr.schema.AbstractSpatialPrefixTreeFieldType.init(AbstractSpatialPrefixTreeFieldType.java:43) at org.apache.solr.schema.SpatialRecursivePrefixTreeFieldType.init(SpatialRecursivePrefixTreeFieldType.java:37) at org.apache.solr.schema.FieldType.setArgs(FieldType.java:164) at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:141) at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:43) at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:190) at org.apache.solr.schema.IndexSchema.readSchema(IndexSchema.java:470) at com.datastax.bdp.search.solr.CassandraIndexSchema.readSchema(CassandraIndexSchema.java:72) at org.apache.solr.schema.IndexSchema. init (IndexSchema.java:168) at com.datastax.bdp.search.solr.CassandraIndexSchema. init (CassandraIndexSchema.java:54) at com.datastax.bdp.search.solr.core.CassandraCoreContainer.create(CassandraCoreContainer.java:210) at com.datastax.bdp.search.solr.core.SolrCoreResourceManager.createCore(SolrCoreResourceManager.java:256) at com.datastax.bdp.search.solr.handler.admin.CassandraCoreAdminHandler.handleCreateAction(CassandraCoreAdminHandler.java:117) \u4ee5\u4e0b\u662f\u901a\u5e38\u51fa\u73b0\u5728CREATE\u5411CoreAdmin API \u53d1\u51fa\u76f8\u5173\u547d\u4ee4\u7684\u5ba2\u6237\u7aef\u8f93\u51fa\u4e2d\u7684\u5185\u5bb9 org.apache.solr.common.SolrException: com/vividsolutions/jts/geom/Geometry at com.datastax.bdp.search.solr.core.SolrCoreResourceManager.createCore(SolrCoreResourceManager.java:345) at com.datastax.bdp.search.solr.handler.admin.CassandraCoreAdminHandler.handleCreateAction(CassandraCoreAdminHandler.java:117) at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:152) ... \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06JTS jar\u6dfb\u52a0\u5230JanusGraph\u548c/\u6216Solr\u670d\u52a1\u5668\u7684\u7c7b\u8def\u5f84\u6765\u89e3\u51b3\u3002\u7531\u4e8e\u5176LGPL\u8bb8\u53ef\u8bc1\uff0cJTS\u9ed8\u8ba4\u4e0d\u5305\u542b\u5728JanusGraph\u53d1\u884c\u7248\u4e2d\u3002\u7528\u6237\u5fc5\u987b\u5355\u72ec\u4e0b\u8f7dJTS jar\u6587\u4ef6\u5e76\u5c06\u5176\u590d\u5236\u5230JanusGraph\u548c/\u6216Solr\u670d\u52a1\u5668lib\u76ee\u5f55\u4e2d\u3002\u5982\u679c\u4f7f\u7528Solr\u7684\u5185\u7f6eWeb\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5c06JTS jar\u590d\u5236\u5230\u793a\u4f8b/solr-webapp/webapp/WEB-INF/ lib\u76ee\u5f55\u4ee5\u5c06\u5176\u5305\u542b\u5728\u7c7b\u8def\u5f84\u4e2d\u3002Solr\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\uff0c\u5f02\u5e38\u5e94\u8be5\u6d88\u5931\u3002\u9996\u5148\u5fc5\u987b\u4f7f\u7528\u6b63\u786e\u7684schema.xml\u6587\u4ef6\u542f\u52a8Solr\uff0c\u4ee5\u4fbf\u5b58\u5728\u793a\u4f8b/solr-webapp/webapp/WEB-INF/lib\u76ee\u5f55\u3002 \u8981\u786e\u5b9aSolr\u670d\u52a1\u5668\u7684\u7406\u60f3JTS\u7248\u672c\uff0c\u9996\u5148\u68c0\u67e5Solr\u96c6\u7fa4\u4f7f\u7528\u7684Spatial4j\u7684\u7248\u672c\uff0c\u7136\u540e\u786e\u5b9a\u7f16\u8bd1Spatial4j\u7248\u672c\u7684JTS\u7248\u672c\u3002Spatial4j \u5728com.spatial4j:spatial4j\u5de5\u4ef6\u7684pom\u4e2d\u58f0\u660e\u5176\u76ee\u6807JTS\u7248\u672c\u3002\u5c06JTS jar\u590d\u5236\u5230solr\u5b89\u88c5\u4e2d\u7684server/solr-webapp/webapp/WEB-INF/lib\u76ee\u5f55\u3002 28.7 \u9ad8\u7ea7Solr\u914d\u7f6e 28.7.1 DSE\u641c\u7d22 \u672c\u8282\u4ecb\u7ecdJanusGraph\u4e0eDataStax Enterprise\uff08DSE\uff09\u641c\u7d22\u7684\u5b89\u88c5\u548c\u914d\u7f6e\u3002\u6709\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b89\u88c5DSE\uff0c\u4f46\u672c\u8282\u91cd\u70b9\u4ecb\u7ecdDSE\u5728Linux\u4e0a\u7684\u4e8c\u8fdb\u5236tarball\u5b89\u88c5\u9009\u9879\u3002\u672c\u8282\u4e2d\u7684\u5927\u591a\u6570\u6b65\u9aa4\u53ef\u4ee5\u63a8\u5e7f\u5230DSE\u7684\u5176\u4ed6\u5b89\u88c5\u9009\u9879\u3002 \u6309\u7167\u9875\u9762\u7684\u6307\u793a\u5b89\u88c5DataStax Enterprise\u4f7f\u7528\u4e8c\u8fdb\u5236tarball\u5b89\u88c5DataStax Enterprise\u3002 \u5bfc\u51faDSE_HOME\u5e76\u9644\u52a0\u5230PATH shell\u73af\u5883\u4e2d\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528Bash\u8bed\u6cd5\u7684\u793a\u4f8b\uff1a export DSE_HOME=/path/to/dse-version.number export PATH= $DSE_HOME /bin: $PATH \u4e3aSolr\u5b89\u88c5JTS\u3002\u9002\u5f53\u7684\u7248\u672c\u56e0Spatial4j\u7248\u672c\u800c\u5f02\u3002\u4eceDSE 4.5.2\u5f00\u59cb\uff0c\u9002\u5f53\u7684\u7248\u672c\u662f1.13\u3002 cd $DSE_HOME/resources/solr/lib curl -O 'http://central.maven.org/maven2/com/vividsolutions/jts/1.13/jts-1.13.jar' \u5728\u5355\u4e2a\u540e\u53f0\u5b88\u62a4\u7a0b\u5e8f\u4e2d\u542f\u52a8DSE Cassandra\u548cSolr\uff1a # The dse-data path below was chosen to match the # Installing DataStax Enterprise using the binary tarball # documentation page from DataStax. The exact path is not # significant. dse cassandra -s -Ddse.solr.data.dir= $DSE_HOME /dse-data/solr \u4e0a\u4e00\u4e2a\u547d\u4ee4\u4f1a\u5c06\u4e00\u4e9b\u542f\u52a8\u4fe1\u606f\u5199\u5165\u63a7\u5236\u53f0\u548c\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84$DSE_HOME/resources/cassandra/conf/log4j-server.properties\u7684log4j.appender.R.File\u7684\u914d\u7f6e\u3002 \u4e00\u65e6\u4f7f\u7528Cassandra\u548cSolr\u7684DSE\u6b63\u5e38\u542f\u52a8\uff0c\u8bf7\u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5nodetool status\u3002\u5355\u5b9e\u4f8b\u73af\u5e94\u8be5\u663e\u793a\u4e00\u4e2a\u8282\u70b9\u5e26\u6709\u6807\u5fd7 U p \u548c N ormal: nodetool status Note: Ownership information does not include topology; for complete information, specify a keyspace = Datacenter: Solr Status=Up/Down |/ State=Normal/Leaving/Joining/Moving -- Address Load Owns Host ID Token Rack UN 127.0.0.1 99.89 KB 100.0% 5484ef7b-ebce-4560-80f0-cbdcd9e9f496 -7317038863489909889 rack1 \u63a5\u4e0b\u6765\uff0c\u5207\u6362\u5230Gremlin Console\u5e76\u9488\u5bf9DSE\u5b9e\u4f8b\u6253\u5f00JanusGraph\u6570\u636e\u5e93\u3002\u8fd9\u5c06\u521b\u5efaJanusGraph\u7684\u952e\u7a7a\u95f4\u548c\u5217\u65cf\u3002 cd $JANUSGRAPH_HOME bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- gremlin graph = JanusGraphFactory.open('conf/janusgraph-cql-solr.properties') == janusgraph[cql:[127.0.0.1]] gremlin g = graph.traversal() == graphtraversalsource[janusgraph[cql:[127.0.0.1]], standard] gremlin \u4fdd\u6301\u8fd9\u4e2aGremlin\u63a7\u5236\u53f0\u6253\u5f00\u3002\u6211\u4eec\u73b0\u5728\u4f11\u606f\u4e00\u4e0b\u5b89\u88c5\u4e00\u4e2aSolr\u6838\u5fc3\u3002\u7136\u540e\u6211\u4eec\u5c06\u56de\u5230\u6b64\u63a7\u5236\u53f0\u4ee5\u52a0\u8f7d\u4e00\u4e9b\u793a\u4f8b\u6570\u636e\u3002 \u63a5\u4e0b\u6765\uff0c\u4e0a\u4f20JanusGraph\u7684Solr\u96c6\u5408\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u5728DSE\u4e2d\u521b\u5efa\u6838\u5fc3\uff1a # Change to the directory where JanusGraph was extracted. Later commands # use relative paths to the Solr config files shipped with the JanusGraph # distribution. cd $JANUSGRAPH_HOME # The name must be URL safe and should contain one dot/full-stop # character. The part of the name after the dot must not conflict with # any of JanusGraph's internal CF names. Starting the part after the dot # solr will avoid a conflict with JanusGraph's internal CF names. CORE_NAME=janusgraph.solr1 # Where to upload collection configuration and send CoreAdmin requests. SOLR_HOST=localhost:8983 # The value of index.[X].solr.http-urls in JanusGraph's config file # should match $SOLR_HOST and $CORE_NAME. For example, given the # $CORE_NAME and $SOLR_HOST values above, JanusGraph's config file would # contain (assuming search is the desired index alias): # # index.search.solr.http-urls=http://localhost:8983/solr/janusgraph.solr1 # # The stock JanusGraph config file conf/janusgraph-cql-solr.properties # ships with this http-urls value. # Upload Solr config files to DSE Search daemon for xml in conf/solr/{solrconfig, schema, elevate}.xml ; do curl -v http:// $SOLR_HOST /solr/resource/ $CORE_NAME/$xml \\ --data-binary @ $xml -H 'Content-type:text/xml; charset=utf-8' done for txt in conf/solr/{protwords, stopwords, synonyms}.txt ; do curl -v http:// $SOLR_HOST /solr/resource/ $CORE_NAME/$txt \\ --data-binary @ $txt -H 'Content-type:text/plain; charset=utf-8' done sleep 5 # Create core using the Solr config files just uploaded above curl http:// $SOLR_HOST /solr/admin/cores?action=CREATE name=$CORE_NAME sleep 5 # Retrieve and print the status of the core we just created curl http://localhost:8983/solr/admin/cores?action=STATUS core=$CORE_NAME \u73b0\u5728\uff0cJanusGraph\u6570\u636e\u5e93\u548c\u652f\u6301Solr\u6838\u5fc3\u5df2\u7ecf\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528God of the Gods \u6570\u636e\u96c6\u5bf9\u5176\u8fdb\u884c\u6d4b\u8bd5\u3002\u4ece\u4e0a\u9762\u5f00\u59cb\u62fe\u53d6Gremlin\u63a7\u5236\u53f0\u4f1a\u8bdd\uff1a // Assuming graph = JanusGraphFactory.open('conf/janusgraph-cql-solr.properties')... gremlin GraphOfTheGodsFactory.load(graph) == null \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u7b2c3\u7ae0\u201c \u5165\u95e8\u201d\u4e2d\u63cf\u8ff0\u7684\u4efb\u4f55\u67e5\u8be2\u3002Solr\u5c06\u63d0\u4f9b\u6d89\u53ca\u6587\u672c\u548c\u5730\u7406\u8c13\u8bcd\u7684\u67e5\u8be2\u3002\u6709\u5173JanusGraph\u548cSolr\u5ba2\u6237\u7aef\u7684\u66f4\u8be6\u7ec6\u62a5\u544a\uff0c\u8fd0\u884cgremlin.sh -l DEBUG\u5e76\u53d1\u51fa\u4e00\u4e9b\u7d22\u5f15\u652f\u6301\u7684\u67e5\u8be2\u3002","title":"28.Apache Solr"},{"location":"index_backends/apache_solr/#28-apache-solr","text":"Solr\u662fApache Lucene\u9879\u76ee\u4e2d\u975e\u5e38\u6d41\u884c\u7684\u3001\u975e\u5e38\u5feb\u901f\u7684\u5f00\u6e90\u4f01\u4e1a\u641c\u7d22\u5e73\u53f0\u3002Solr\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u4f01\u4e1a\u641c\u7d22\u670d\u52a1\u5668\uff0c\u5177\u6709\u7c7b\u4f3crest\u7684API\u3002Solr\u662f\u9ad8\u5ea6\u53ef\u9760\u3001\u53ef\u4f38\u7f29\u548c\u5bb9\u9519\u7684\uff0c\u63d0\u4f9b\u5206\u5e03\u5f0f\u7d22\u5f15\u3001\u590d\u5236\u548c\u8d1f\u8f7d\u5e73\u8861\u67e5\u8be2\u3001\u81ea\u52a8\u6545\u969c\u8f6c\u79fb\u548c\u6062\u590d\u3001\u96c6\u4e2d\u5f0f\u914d\u7f6e\u7b49\u3002 - Apache Solr\u4e3b\u9875 JanusGraph\u652f\u6301Apache Solr\u4f5c\u4e3a\u7d22\u5f15\u540e\u7aef\u3002\u4ee5\u4e0b\u662fJanusGraph\u652f\u6301\u7684\u4e00\u4e9bSolr\u529f\u80fd\uff1a \u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 - Geo\uff1a\u652f\u6301\u6240\u6709Geo\u8c13\u8bcd\uff0c\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4f53\u4e2d\u76f8\u4ea4\uff0c\u5185\u90e8\uff0c\u4e0d\u76f8\u4ea4\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u5706\uff0c\u6846\u548c\u591a\u8fb9\u5f62\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u548c\u6240\u6709\u5f62\u72b6\u4ee5\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u3002 - \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 - TTL\uff1a\u652f\u6301\u81ea\u52a8\u4f7f\u7d22\u5f15\u5143\u7d20\u8fc7\u671f\u3002 - \u65f6\u95f4\uff1a\u6beb\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 - \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668\u3002 \u6709\u5173Solr\u5c06\u4e0eJanusGraph\u914d\u5408\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u9644\u5f55B\uff0c\u7248\u672c\u517c\u5bb9\u6027 \u3002","title":"\u7b2c28\u7ae0 Apache Solr"},{"location":"index_backends/apache_solr/#281-solr","text":"JanusGraph\u652f\u6301Solr\u5728SolrCloud\u6216Solr Standalone\uff08HTTP\uff09\u914d\u7f6e\u4e2d\u8fd0\u884c\uff0c\u4ee5\u4fbf\u4e0e\u6df7\u5408\u7d22\u5f15\u4e00\u8d77\u4f7f\u7528\uff08\u8bf7\u53c2\u89c1\u7b2c11.1.2\u8282\u201c\u6df7\u5408\u7d22\u5f15\u201d\uff09\u3002\u901a\u8fc7\u53c2\u6570\u914d\u7f6e\u6240\u9700\u7684\u8fde\u63a5\u6a21\u5f0f\uff0c\u8be5\u53c2\u6570mode\u5fc5\u987b\u8bbe\u7f6e\u4e3acloud\u6216\u8005http\uff0c\u524d\u8005\u662f\u9ed8\u8ba4\u503c\u3002\u4f8b\u5982\uff0c\u8981\u660e\u786e\u6307\u5b9aSolr\u5728SolrCloud\u914d\u7f6e\u4e2d\u8fd0\u884c\uff0c\u8bf7\u5c06\u4ee5\u4e0b\u5c5e\u6027\u6307\u5b9a\u4e3aJanusGraph\u914d\u7f6e\u5c5e\u6027\uff1a index.search.solr.mode = cloud \u8fd9\u4e9b\u662f\u4e00\u4e9b\u5173\u952e\u7684Solr\u672f\u8bed\uff1a Core: \u5355\u53f0\u673a\u5668\u4e0a\u7684\u5355\u4e2a\u7d22\u5f15\u3002 Configuration: solrconfig.xml\uff0c schema.xml\u548c\u5b9a\u4e49\u6838\u5fc3\u6240\u9700\u7684\u5176\u4ed6\u6587\u4ef6\u3002 Collection: \u53ef\u4ee5\u8de8\u8d8a\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684\u591a\u4e2a\u6838\u5fc3\u7684\u5355\u4e2a\u903b\u8f91\u7d22\u5f15\u3002 Configset: \u53ef\u7531\u591a\u4e2a\u5185\u6838\u91cd\u7528\u7684\u5171\u4eab\u914d\u7f6e\u3002","title":"28.1 Solr\u914d\u7f6e\u6982\u8ff0"},{"location":"index_backends/apache_solr/#282-solrcloud","text":"\u901a\u8fc7\u5c06mode\u7b49\u4e8e\u8bbe\u7f6e\u4e3a\u8fde\u63a5\u5230SolrCloud\u96c6\u7fa4\u65f6\uff0ccloud\u5fc5\u987b\u6307\u5b9aZookeeper URL\uff08\u4ee5\u53ca\u53ef\u9009\u7684\u7aef\u53e3\uff09\uff0c\u4ee5\u4fbfJanusGraph\u53ef\u4ee5\u53d1\u73b0Solr\u96c6\u7fa4\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002 index.search.backend=solr index.search.solr.mode=cloud index.search.solr.zookeeper-url=localhost:2181 \u4e0e\u521b\u5efa\u65b0\u96c6\u5408\u76f8\u5173\u7684\u8bb8\u591a\u9644\u52a0\u914d\u7f6e\u9009\u9879(\u4ec5\u5728SolrCloud\u64cd\u4f5c\u6a21\u5f0f\u4e2d\u53d7\u652f\u6301)\u53ef\u4ee5\u914d\u7f6e\u4e3a\u63a7\u5236\u5206\u7247\u884c\u4e3a\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0 \u914d\u7f6e\u53c2\u8003 \u3002 SolrCloud\u5229\u7528Zookeeper\u5728Solr\u670d\u52a1\u5668\u4e4b\u95f4\u534f\u8c03\u6536\u96c6\u548c\u914d\u7f6e\u4fe1\u606f\u3002\u4f7f\u7528Zookeeper\u548cSolrCloud\u53ef\u4ee5\u663e\u8457\u51cf\u5c11\u4f7f\u7528Solr\u4f5c\u4e3aJanusGraph\u540e\u7aef\u7d22\u5f15\u6240\u9700\u7684\u624b\u52a8\u914d\u7f6e\u91cf\u3002","title":"28.2 \u8fde\u63a5\u5230SolrCloud"},{"location":"index_backends/apache_solr/#2821-configset","text":"\u521b\u5efa\u96c6\u5408\u9700\u8981configset\u3002configset\u5b58\u50a8\u5728Zookeeper\u4e2d\uff0c\u4ee5\u4fbf\u5141\u8bb8\u8de8Solr\u670d\u52a1\u5668\u8bbf\u95ee\u5b83\u3002 - \u6bcf\u4e2a\u96c6\u5408\u5728\u521b\u5efa\u65f6\u90fd\u53ef\u4ee5\u63d0\u4f9b\u81ea\u5df1\u7684configset\uff0c\u4ee5\u4fbf\u6bcf\u4e2a\u96c6\u5408\u53ef\u4ee5\u5177\u6709\u4e0d\u540c\u7684\u914d\u7f6e\u3002\u4f7f\u7528\u6b64\u65b9\u6cd5\uff0c\u5fc5\u987b\u624b\u52a8\u521b\u5efa\u6bcf\u4e2a\u96c6\u5408\u3002 - \u5982\u679c\u4e00\u4e2a\u5171\u4eab\u7684configset\u5c06\u88ab\u591a\u4e2a\u96c6\u5408\u91cd\u7528\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u5355\u72ec\u4e0a\u4f20\u5230Zookeeper\u3002\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\uff0cJanusGraph\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u5171\u4eab\u7684configset\u81ea\u52a8\u521b\u5efa\u96c6\u5408\u3002\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u91cd\u7528configset\u5927\u5927\u51cf\u5c11\u4e86\u5b58\u50a8\u5728Zookeeper\u4e2d\u7684\u6570\u636e\u91cf\u3002","title":"28.2.1 Configset\u914d\u7f6e"},{"location":"index_backends/apache_solr/#28211-configset","text":"\u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\u624b\u52a8\u521b\u5efa\u540d\u4e3averticesByAge\u7684\u96c6\u5408\u3002\u521b\u5efa\u96c6\u5408\u65f6\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u96c6\u5408\u540dverticesByAge\u5c06\u914d\u7f6e\u4e0a\u4f20\u5230Zookeeper\u4e2d\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002 # create the collection $SOLR_HOME/bin/solr create -c verticesByAge -d $JANUSGRAPH_HOME/conf/solr \u4f7f\u7528JanusGraphManagement\u76f8\u540c\u7684\u96c6\u5408\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit()","title":"28.2.1.1 \u4f7f\u7528\u5355\u4e2aconfigset"},{"location":"index_backends/apache_solr/#28212-configset","text":"\u5728\u4f7f\u7528\u5171\u4eabconfigset\u65f6\uff0c\u6700\u65b9\u4fbf\u7684\u65b9\u6cd5\u662f\u9996\u5148\u5c06\u914d\u7f6e\u4f5c\u4e3a\u4e00\u6b21\u6027\u64cd\u4f5c\u4e0a\u8f7d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\uff0c\u5c06\u540d\u4e3aJanusGraph -configset\u7684configset\u4e0a\u4f20\u5230Zookeeper\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002 # upload the shared configset into Zookeeper # Solr 5 $SOLR_HOME/server/scripts/cloud-scripts/zkcli.sh -cmd upconfig -z localhost:2181 \\ -d $JANUSGRAPH_HOME/conf/solr -n janusgraph-configset # Solr 6 and higher $SOLR_HOME/bin/solr zk upconfig -d $JANUSGRAPH_HOME/conf/solr -n janusgraph-configset \\ -z localhost:2181 \u4e3aJanusGraph\u914d\u7f6eSolrCloud\u7d22\u5f15\u540e\u7aef\u65f6\uff0c\u8bf7\u786e\u4fdd\u4f7f\u7528\u8be5index.search.solr.configset\u5c5e\u6027\u63d0\u4f9b\u5171\u4eabconfigset\u7684\u540d\u79f0\u3002 index.search.backend=solr index.search.solr.mode=cloud index.search.solr.zookeeper-url=localhost:2181 index.search.solr.configset=janusgraph-configset \u4f7f\u7528JanusGraphManagement\u548c\u96c6\u5408\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit()","title":"28.2.1.2 \u4f7f\u7528\u5171\u4eabconfigset"},{"location":"index_backends/apache_solr/#283-solr-standalonehttp","text":"\u901a\u8fc7\u8bbe\u7f6emode\u7b49\u4e8ehttp\uff0c\u901a\u8fc7HTTP\u8fde\u63a5\u5230Solr Standalone\u65f6\uff0c\u5fc5\u987b\u63d0\u4f9bSolr\u5b9e\u4f8b\u7684\u5355\u4e2a\u6216URL\u5217\u8868\u3002 index.search.backend=solr index.search.solr.mode=http index.search.solr.http-urls=http://localhost:8983/solr \u7528\u4e8e\u63a7\u5236\u6700\u5927\u8fde\u63a5\u6570\uff0c\u8fde\u63a5\u8d85\u65f6\u548c\u4f20\u8f93\u538b\u7f29\u7684\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u53ef\u7528\u4e8eHTTP\u6a21\u5f0f\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u89c1 \u7b2c15\u7ae0 \u914d\u7f6e\u53c2\u8003 \u3002","title":"28.3 \u8fde\u63a5\u5230Solr Standalone(HTTP)"},{"location":"index_backends/apache_solr/#2831","text":"Solr Standalone\u7528\u4e8e\u5355\u4e2a\u5b9e\u4f8b\uff0c\u5b83\u5c06\u914d\u7f6e\u4fe1\u606f\u4fdd\u5b58\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u3002\u5fc5\u987b\u4e3a\u6bcf\u4e2a\u6df7\u5408\u7d22\u5f15\u624b\u52a8\u521b\u5efa\u6838\u5fc3\u3002 \u8981\u521b\u5efa\u6838\u5fc3\uff0c\u9700\u8981\u4e00\u4e2acore_name\u548c\u4e00\u4e2aconfiguration\u76ee\u5f55\u3002\u6709\u5173\u53ef\u7528\u53c2\u6570\uff0c\u8bf7\u53c2\u9605Solr\u53c2\u8003\u6307\u5357\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u4f7f\u7528\u53d1\u884c\u7248\u4e2d\u627e\u5230\u7684Solr\u7684\u9ed8\u8ba4JanusGraph\u914d\u7f6e\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3averticesByAge\u7684\u6838\u5fc3\u3002 $SOLR_HOME/bin/solr create -c verticesByAge -d $JANUSGRAPH_HOME/conf/solr \u4f7f\u7528JanusGraphManagement\u76f8\u540c\u7684\u6838\u5fc3\u540d\u79f0\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u3002 mgmt = graph.openManagement() age = mgmt.makePropertyKey( age ).dataType(Integer.class).make() mgmt.buildIndex( verticesByAge , Vertex.class).addKey(age).buildMixedIndex( search ) mgmt.commit()","title":"28.3.1 \u6838\u5fc3\u914d\u7f6e"},{"location":"index_backends/apache_solr/#284-kerberos","text":"\u5728\u8fde\u63a5\u5230\u53d7Kerberos\u4fdd\u62a4\u7684Solr\u73af\u5883\u65f6\uff0c\u5fc5\u987b\u6307\u5b9a\u4f7f\u7528\u7684Kerberos\uff0c\u5e76\u5f15\u7528JAAS\u914d\u7f6e\u6587\u4ef6\u6765\u6b63\u786e\u914d\u7f6eSolr\u5ba2\u6237\u673a\u3002\u5728\u4f7f\u7528Kerberos\u65f6\uff0c\u65e0\u8bbaSolr\u4ee5\u4f55\u79cd\u6a21\u5f0f\u8fd0\u884c(SolrCloud\u6216Solr\u72ec\u7acb\u8fd0\u884c)\uff0c\u90fd\u9700\u8981\u8fd9\u79cd\u914d\u7f6e\u3002 index.search.solr.kerberos-enabled=true \u901a\u8fc7\u8bbe\u7f6ejava.security.auth.login.config\u7684\u7edd\u5bf9\u8def\u5f84\u6765\u786e\u4fdd\u63d0\u4f9bJAAS\u914d\u7f6e\u6587\u4ef6\u3002\u5e94\u4f7f\u7528JVM\u9009\u9879\u8bbe\u7f6e\u6b64\u5c5e\u6027\u3002\u4f8b\u5982\uff0c\u8981\u8fd0\u884c\uff0cgremlin.sh\u60a8\u9700\u8981JAVA_OPTIONS\u5728\u8fd0\u884c\u811a\u672c\u4e4b\u524d\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a --- export JAVA_OPTIONS= -Djava.security.auth.login.config=/absolute/path/jaas.conf $JANUSGRAPH_HOME/bin/gremlin.sh --- \u6709\u5173JAAS\u914d\u7f6e\u6587\u4ef6\u4e2d\u6240\u9700\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Solr\u53c2\u8003\u6307\u5357 \u3002","title":"28.4 Kerberos\u914d\u7f6e"},{"location":"index_backends/apache_solr/#285-solr","text":"","title":"28.5 Solr\u67b6\u6784\u8bbe\u8ba1"},{"location":"index_backends/apache_solr/#2851","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u4f7f\u7528Solr\u7684\u52a8\u6001\u5b57\u6bb5\u529f\u80fd\u6765\u5b9a\u4e49\u6240\u6709\u7d22\u5f15\u952e\u7684\u5b57\u6bb5\u7c7b\u578b\u3002\u5c06\u5c5e\u6027\u952e\u6dfb\u52a0\u5230Solr\u652f\u6301\u7684\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u8fd9\u4e0d\u9700\u8981\u989d\u5916\u914d\u7f6e\uff0c\u5e76\u4e14\u63d0\u4f9b\u6bd4\u65e0\u6a21\u5f0f\u6a21\u5f0f\u66f4\u597d\u7684\u6027\u80fd\u3002 JanusGraph\u5047\u8bbe\u5728\u652f\u6301Solr\u96c6\u5408\u7684schema.xml\u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u52a8\u6001\u5b57\u6bb5\u6807\u8bb0\u3002\u8bf7\u6ce8\u610f\uff0csolr schema.xml\u6587\u4ef6\u4e2d\u8fd8\u9700\u8981\u4ee5\u4e0b\u5b57\u6bb5\u7684\u9644\u52a0xml\u5b9a\u4e49\u624d\u80fd\u4f7f\u7528\u5b83\u4eec\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605JanusGraph\u5b89\u88c5\u4e2d./conf/solr/schema.xml\u76ee\u5f55\u4e2d\u63d0\u4f9b\u7684\u793a\u4f8bschema.xml\u6587\u4ef6\u3002 dynamicField name= *_i type= int indexed= true stored= true / dynamicField name= *_s type= string indexed= true stored= true / dynamicField name= *_l type= long indexed= true stored= true / dynamicField name= *_t type= text_general indexed= true stored= true / dynamicField name= *_b type= boolean indexed= true stored= true / dynamicField name= *_f type= float indexed= true stored= true / dynamicField name= *_d type= double indexed= true stored= true / dynamicField name= *_g type= geo indexed= true stored= true / dynamicField name= *_dt type= date indexed= true stored= true / dynamicField name= *_uuid type= uuid indexed= true stored= true / \u5728JanusGraph\u7684\u9ed8\u8ba4\u914d\u7f6e\u4e2d\uff0c\u5c5e\u6027\u952e\u540d\u79f0\u4e0d\u5fc5\u4ee5\u7c7b\u578b\u76f8\u5e94\u7684\u540e\u7f00\u7ed3\u675f\uff0c\u4ee5\u4fbf\u5229\u7528Solr\u7684\u52a8\u6001\u5b57\u6bb5\u529f\u80fd\u3002JanusGraph\u901a\u8fc7\u5bf9\u5c5e\u6027\u952e\u5b9a\u4e49\u7684\u6570\u5b57\u6807\u8bc6\u7b26\u548c\u7c7b\u578b\u76f8\u5e94\u7684\u540e\u7f00\u8fdb\u884c\u7f16\u7801\uff0c\u4ece\u5c5e\u6027\u952e\u540d\u79f0\u751f\u6210Solr\u5b57\u6bb5\u540d\u79f0\u3002\u8fd9\u610f\u5473\u7740JanusGraph\u5728\u5e55\u540e\u4f7f\u7528\u5177\u6709\u7c7b\u578b\u76f8\u5e94\u540e\u7f00\u7684\u5408\u6210\u5b57\u6bb5\u540d\u79f0\uff0c\u800c\u4e0d\u7ba1\u4f7f\u7528JanusGraph\u7684\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u5b9a\u4e49\u548c\u4f7f\u7528\u7684\u5c5e\u6027\u952e\u540d\u79f0\u3002\u53ef\u4ee5\u901a\u8fc7\u975e\u9ed8\u8ba4\u914d\u7f6e\u8986\u76d6\u6b64\u5b57\u6bb5\u540d\u79f0\u6620\u5c04\u3002\u8fd9\u5c06\u5728\u4e0b\u4e00\u8282\u4e2d\u63cf\u8ff0\u3002","title":"28.5.1 \u52a8\u6001\u5b57\u6bb5\u5b9a\u4e49"},{"location":"index_backends/apache_solr/#2852","text":"\u5982\u679c\u7528\u6237\u5b81\u613f\u624b\u52a8\u4e3a\u96c6\u5408\u4e2d\u7684\u6bcf\u4e2a\u7d22\u5f15\u5b57\u6bb5\u5b9a\u4e49\u5b57\u6bb5\u7c7b\u578b\uff0c\u5219\u9700\u8981\u7981\u7528dyn-fields\u914d\u7f6e\u9009\u9879\u3002\u5728\u5c06\u5c5e\u6027\u952e\u6dfb\u52a0\u5230\u7d22\u5f15\u4e4b\u524d\uff0c\u5fc5\u987b\u5728\u652f\u6301Solr\u67b6\u6784\u4e2d\u5b9a\u4e49\u6bcf\u4e2a\u7d22\u5f15\u5c5e\u6027\u952e\u7684\u5b57\u6bb5\u3002 \u5728\u6b64\u573a\u666f\u4e2d\uff0c\u5efa\u8bae\u542f\u7528\u5b57\u6bb5\u6620\u5c04\u7684\u663e\u5f0f\u5c5e\u6027\u952e\u540d\uff0c\u4ee5\u4fbf\u4fee\u590d\u5b57\u6bb5\u540d\u7684\u663e\u5f0f\u5b9a\u4e49\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u4e4b\u4e00\u6765\u5b9e\u73b0\uff1a - \u5728\u5411\u7d22\u5f15\u6dfb\u52a0\u5c5e\u6027\u952e\u65f6\uff0c\u901a\u8fc7\u63d0\u4f9bmapped-name\u53c2\u6570\u914d\u7f6e\u5b57\u6bb5\u540d\u3002\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c25.1\u8282 \u5355\u4e2a\u5b57\u6bb5\u6620\u5c04 \u3002 - \u901a\u8fc7\u4e3aSolr\u7d22\u5f15\u542f\u7528map-name\u914d\u7f6e\u9009\u9879\uff0c\u8be5\u9009\u9879\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u540d\u4f5c\u4e3aSolr\u4e2d\u7684\u5b57\u6bb5\u540d\u3002\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c25.2\u8282 \u5168\u5c40\u5b57\u6bb5\u6620\u5c04 \u3002","title":"28.5.2 \u624b\u52a8\u5b57\u6bb5\u5b9a\u4e49"},{"location":"index_backends/apache_solr/#2853-schemaless-mode","text":"JanusGraph\u8fd8\u53ef\u4ee5\u4e0e\u4e3a Schemaless Mode\u914d\u7f6e\u7684SolrCloud\u96c6\u7fa4\u8fdb\u884c\u4ea4\u4e92\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u7981\u7528dyn-fields\u914d\u7f6e\u9009\u9879\uff0c\u56e0\u4e3aSolr\u5c06\u4ece\u503c\u800c\u4e0d\u662f\u5b57\u6bb5\u540d\u79f0\u63a8\u65ad\u5b57\u6bb5\u7c7b\u578b\u3002 \u4f46\u8bf7\u6ce8\u610f\uff0cSchemaless Mode\u4ec5\u5efa\u8bae\u7528\u4e8e\u539f\u578b\u8bbe\u8ba1\u548c\u521d\u59cb\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\uff0c\u4e0d\u5efa\u8bae\u7528\u4e8e\u751f\u4ea7\u7528\u9014\u3002","title":"28.5.3. Schemaless Mode"},{"location":"index_backends/apache_solr/#286","text":"","title":"28.6 \u6545\u969c\u6392\u9664"},{"location":"index_backends/apache_solr/#2861","text":"\u5728\u5b9a\u4e49\u53ef\u4ee5\u4f7f\u7528\u96c6\u5408\u7684\u7d22\u5f15\u4e4b\u524d\uff0c\u5fc5\u987b\u521d\u59cb\u5316\u96c6\u5408(\u4ee5\u53ca\u6240\u6709\u5fc5\u9700\u7684\u914d\u7f6e\u6587\u4ef6)\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u8fde\u63a5\u5230SolrCloud\u3002 \u4f7f\u7528SolrCloud\u65f6\uff0cZookeeper zkCli.sh\u547d\u4ee4\u884c\u5de5\u5177\u53ef\u7528\u4e8e\u68c0\u67e5\u52a0\u8f7d\u5230Zookeeper\u4e2d\u7684\u914d\u7f6e\u3002\u8fd8\u8981\u9a8c\u8bc1\u9ed8\u8ba4\u7684JanusGraph\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u5df2\u590d\u5236\u5230solr\u4e0b\u7684\u6b63\u786e\u4f4d\u7f6e\uff0c\u4ee5\u53ca\u590d\u5236\u6587\u4ef6\u7684\u76ee\u5f55\u662f\u5426\u6b63\u786e\u3002","title":"28.6.1 \u96c6\u5408\u4e0d\u5b58\u5728"},{"location":"index_backends/apache_solr/#2862-configset","text":"\u4f7f\u7528SolrCloud\u65f6\uff0c\u9700\u8981\u4e00\u4e2aconfigset\u6765\u4e3aJanusGraph\u521b\u5efa\u4e00\u4e2a\u6df7\u5408\u7d22\u5f15\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Configset\u914d\u7f6e\u3002 \u5982\u679c\u4f7f\u7528\u5355\u4e2a\u914d\u7f6e\u96c6\uff0c\u5219\u5fc5\u987b\u9996\u5148\u624b\u52a8\u521b\u5efa\u96c6\u5408\u3002 \u5982\u679c\u4f7f\u7528\u5171\u4eab\u914d\u7f6e\u96c6\uff0c\u5219\u5fc5\u987b\u9996\u5148\u5c06\u914d\u7f6e\u96c6\u4e0a\u8f7d\u5230Zookeeper\u3002 \u60a8\u53ef\u4ee5\u9a8c\u8bc1\u914d\u7f6e\u96c6\u53ca\u5176\u914d\u7f6e\u6587\u4ef6\u662f\u5426\u4f4d\u4e8eZookeeper\u4e2d/configs\u3002\u6709\u5173\u5176\u4ed6Zookeeper\u64cd\u4f5c\uff0c\u8bf7\u53c2\u9605\u201c Solr\u53c2\u8003\u6307\u5357\u201d\u3002 # verify the configset in Zookeeper # Solr 5 $SOLR_HOME/server/scripts/cloud-scripts/zkcli.sh -cmd list -z localhost:2181 # Solr 6 and higher $SOLR_HOME/bin/solr zk ls -r /configs/configset-name -z localhost:2181","title":"28.6.2 \u627e\u4e0d\u5230\u6307\u5b9a\u7684Configset"},{"location":"index_backends/apache_solr/#2863-http-404","text":"\u4f7f\u7528Solr Standalone\uff08HTTP\uff09\u6a21\u5f0f\u65f6\u53ef\u80fd\u4f1a\u9047\u5230\u6b64\u9519\u8bef\u3002\u9519\u8bef\u7684\u4e00\u4e2a\u4f8b\u5b50\uff1a 20:01:22 ERROR org.janusgraph.diskstorage.solr.SolrIndex - Unable to save documents to Solr as one of the shape objects stored were not compatible with Solr. org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at http://localhost:8983/solr: Expected mime type application/octet-stream but got text/html. html head meta http-equiv= Content-Type content= text/html;charset=utf-8 / title Error 404 Not Found /title /head body h2 HTTP ERROR 404 /h2 p Problem accessing /solr/verticesByAge/update. Reason: pre Not Found /pre /p /body /html \u5728\u5c1d\u8bd5\u5c06\u6570\u636e\u5b58\u50a8\u5230\u7d22\u5f15\u4e4b\u524d\uff0c\u8bf7\u786e\u4fdd\u624b\u52a8\u521b\u5efa\u6838\u5fc3\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6838\u5fc3\u914d\u7f6e\u3002","title":"28.6.3 HTTP 404\u9519\u8bef"},{"location":"index_backends/apache_solr/#2864","text":"\u6838\u5fc3\u6216\u96c6\u5408\u540d\u79f0\u662f\u6807\u8bc6\u7b26\u3002\u5b83\u5fc5\u987b\u5b8c\u5168\u7531\u53e5\u53f7\uff0c\u4e0b\u5212\u7ebf\uff0c\u8fde\u5b57\u7b26\u548c/\u6216\u5b57\u6bcd\u6570\u5b57\u7ec4\u6210\uff0c\u4e5f\u53ef\u80fd\u4e0d\u4ee5\u8fde\u5b57\u7b26\u5f00\u5934\u3002","title":"28.6.4 \u6838\u5fc3\u6216\u96c6\u5408\u540d\u79f0\u65e0\u6548"},{"location":"index_backends/apache_solr/#2865","text":"\u65e0\u8bba\u64cd\u4f5c\u6a21\u5f0f\u5982\u4f55\uff0cSolr\u5b9e\u4f8b\u6216Solr\u5b9e\u4f8b\u96c6\u7fa4\u5fc5\u987b\u6b63\u5728\u8fd0\u884c\u5e76\u53ef\u4eceJanusGraph\u5b9e\u4f8b\u8bbf\u95ee\uff0c\u4ee5\u4fbfJanusGraph\u5c06Solr\u7528\u4f5c\u7d22\u5f15\u540e\u7aef\u3002\u68c0\u67e5Solr\u96c6\u7fa4\u662f\u5426\u6b63\u5e38\u8fd0\u884c\uff0c\u5e76\u4e14\u5b83\u662f\u53ef\u89c1\u7684\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\uff08\u6216\u672c\u5730\uff09\u4eceJanusGraph\u5b9e\u4f8b\u8bbf\u95ee\u3002","title":"28.6.5 \u8fde\u63a5\u95ee\u9898"},{"location":"index_backends/apache_solr/#2866-jts-classnotfoundexception","text":"Solr\u4f9d\u9760Spatial4j\u8fdb\u884c\u5730\u7406\u5904\u7406\u3002Spatial4j\u58f0\u660e\u4e86\u5bf9JTS\u7684\u53ef\u9009\u4f9d\u8d56\uff08\u201cJTS\u62d3\u6251\u5957\u4ef6\u201d\uff09\u3002\u67d0\u4e9b\u5730\u7406\u5b57\u6bb5\u5b9a\u4e49\u548c\u67e5\u8be2\u529f\u80fd\u9700\u8981JTS\u3002\u5982\u679cJTS jar\u4e0d\u5728Solr\u5b88\u62a4\u7a0b\u5e8f\u7684\u7c7b\u8def\u5f84\u4e0a\uff0c\u5e76\u4e14schema.xml\u4e2d\u7684\u5b57\u6bb5\u4f7f\u7528\u5730\u7406\u7c7b\u578b\uff0c\u5219Solr\u53ef\u80fd\u4f1a\u5728\u5176\u4e2d\u4e00\u4e2a\u7f3a\u5c11\u7684JTS\u7c7b\u4e0a\u629b\u51faClassNotFoundException\u3002\u4f7f\u7528\u65e8\u5728\u4e0eJanusGraph\u4e00\u8d77\u4f7f\u7528\u7684schema.xml\u6587\u4ef6\u542f\u52a8Solr\u65f6\u4f1a\u51fa\u73b0\u5f02\u5e38\uff0c\u4f46CREATE\u5728Solr CoreAdmin API\u4e2d\u8c03\u7528\u65f6\u4e5f\u4f1a\u51fa\u73b0\u5f02\u5e38\u3002\u867d\u7136\u6839\u672c\u539f\u56e0\u662f\u76f8\u540c\u7684\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u7684\u683c\u5f0f\u7565\u6709\u4e0d\u540c\u3002 \u4ee5\u4e0b\u662fSolr\u670d\u52a1\u5668\u65e5\u5fd7\u7684\u4ee3\u8868\u793a\u4f8b\uff1a ERROR [http-8983-exec-5] 2014-10-07 02:54:06, 665 SolrCoreResourceManager.java (line 344) com/vividsolutions/jts/geom/Geometry java.lang.NoClassDefFoundError: com/vividsolutions/jts/geom/Geometry at com.spatial4j.core.context.jts.JtsSpatialContextFactory.newSpatialContext(JtsSpatialContextFactory.java:30) at com.spatial4j.core.context.SpatialContextFactory.makeSpatialContext(SpatialContextFactory.java:83) at org.apache.solr.schema.AbstractSpatialFieldType.init(AbstractSpatialFieldType.java:95) at org.apache.solr.schema.AbstractSpatialPrefixTreeFieldType.init(AbstractSpatialPrefixTreeFieldType.java:43) at org.apache.solr.schema.SpatialRecursivePrefixTreeFieldType.init(SpatialRecursivePrefixTreeFieldType.java:37) at org.apache.solr.schema.FieldType.setArgs(FieldType.java:164) at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:141) at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:43) at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:190) at org.apache.solr.schema.IndexSchema.readSchema(IndexSchema.java:470) at com.datastax.bdp.search.solr.CassandraIndexSchema.readSchema(CassandraIndexSchema.java:72) at org.apache.solr.schema.IndexSchema. init (IndexSchema.java:168) at com.datastax.bdp.search.solr.CassandraIndexSchema. init (CassandraIndexSchema.java:54) at com.datastax.bdp.search.solr.core.CassandraCoreContainer.create(CassandraCoreContainer.java:210) at com.datastax.bdp.search.solr.core.SolrCoreResourceManager.createCore(SolrCoreResourceManager.java:256) at com.datastax.bdp.search.solr.handler.admin.CassandraCoreAdminHandler.handleCreateAction(CassandraCoreAdminHandler.java:117) \u4ee5\u4e0b\u662f\u901a\u5e38\u51fa\u73b0\u5728CREATE\u5411CoreAdmin API \u53d1\u51fa\u76f8\u5173\u547d\u4ee4\u7684\u5ba2\u6237\u7aef\u8f93\u51fa\u4e2d\u7684\u5185\u5bb9 org.apache.solr.common.SolrException: com/vividsolutions/jts/geom/Geometry at com.datastax.bdp.search.solr.core.SolrCoreResourceManager.createCore(SolrCoreResourceManager.java:345) at com.datastax.bdp.search.solr.handler.admin.CassandraCoreAdminHandler.handleCreateAction(CassandraCoreAdminHandler.java:117) at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:152) ... \u8fd9\u53ef\u4ee5\u901a\u8fc7\u5c06JTS jar\u6dfb\u52a0\u5230JanusGraph\u548c/\u6216Solr\u670d\u52a1\u5668\u7684\u7c7b\u8def\u5f84\u6765\u89e3\u51b3\u3002\u7531\u4e8e\u5176LGPL\u8bb8\u53ef\u8bc1\uff0cJTS\u9ed8\u8ba4\u4e0d\u5305\u542b\u5728JanusGraph\u53d1\u884c\u7248\u4e2d\u3002\u7528\u6237\u5fc5\u987b\u5355\u72ec\u4e0b\u8f7dJTS jar\u6587\u4ef6\u5e76\u5c06\u5176\u590d\u5236\u5230JanusGraph\u548c/\u6216Solr\u670d\u52a1\u5668lib\u76ee\u5f55\u4e2d\u3002\u5982\u679c\u4f7f\u7528Solr\u7684\u5185\u7f6eWeb\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u5c06JTS jar\u590d\u5236\u5230\u793a\u4f8b/solr-webapp/webapp/WEB-INF/ lib\u76ee\u5f55\u4ee5\u5c06\u5176\u5305\u542b\u5728\u7c7b\u8def\u5f84\u4e2d\u3002Solr\u53ef\u4ee5\u91cd\u65b0\u542f\u52a8\uff0c\u5f02\u5e38\u5e94\u8be5\u6d88\u5931\u3002\u9996\u5148\u5fc5\u987b\u4f7f\u7528\u6b63\u786e\u7684schema.xml\u6587\u4ef6\u542f\u52a8Solr\uff0c\u4ee5\u4fbf\u5b58\u5728\u793a\u4f8b/solr-webapp/webapp/WEB-INF/lib\u76ee\u5f55\u3002 \u8981\u786e\u5b9aSolr\u670d\u52a1\u5668\u7684\u7406\u60f3JTS\u7248\u672c\uff0c\u9996\u5148\u68c0\u67e5Solr\u96c6\u7fa4\u4f7f\u7528\u7684Spatial4j\u7684\u7248\u672c\uff0c\u7136\u540e\u786e\u5b9a\u7f16\u8bd1Spatial4j\u7248\u672c\u7684JTS\u7248\u672c\u3002Spatial4j \u5728com.spatial4j:spatial4j\u5de5\u4ef6\u7684pom\u4e2d\u58f0\u660e\u5176\u76ee\u6807JTS\u7248\u672c\u3002\u5c06JTS jar\u590d\u5236\u5230solr\u5b89\u88c5\u4e2d\u7684server/solr-webapp/webapp/WEB-INF/lib\u76ee\u5f55\u3002","title":"28.6.6 \u5e26\u6709\u5730\u7406\u6570\u636e\u7684JTS ClassNotFoundException"},{"location":"index_backends/apache_solr/#287-solr","text":"","title":"28.7 \u9ad8\u7ea7Solr\u914d\u7f6e"},{"location":"index_backends/apache_solr/#2871-dse","text":"\u672c\u8282\u4ecb\u7ecdJanusGraph\u4e0eDataStax Enterprise\uff08DSE\uff09\u641c\u7d22\u7684\u5b89\u88c5\u548c\u914d\u7f6e\u3002\u6709\u591a\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b89\u88c5DSE\uff0c\u4f46\u672c\u8282\u91cd\u70b9\u4ecb\u7ecdDSE\u5728Linux\u4e0a\u7684\u4e8c\u8fdb\u5236tarball\u5b89\u88c5\u9009\u9879\u3002\u672c\u8282\u4e2d\u7684\u5927\u591a\u6570\u6b65\u9aa4\u53ef\u4ee5\u63a8\u5e7f\u5230DSE\u7684\u5176\u4ed6\u5b89\u88c5\u9009\u9879\u3002 \u6309\u7167\u9875\u9762\u7684\u6307\u793a\u5b89\u88c5DataStax Enterprise\u4f7f\u7528\u4e8c\u8fdb\u5236tarball\u5b89\u88c5DataStax Enterprise\u3002 \u5bfc\u51faDSE_HOME\u5e76\u9644\u52a0\u5230PATH shell\u73af\u5883\u4e2d\u3002\u4ee5\u4e0b\u662f\u4f7f\u7528Bash\u8bed\u6cd5\u7684\u793a\u4f8b\uff1a export DSE_HOME=/path/to/dse-version.number export PATH= $DSE_HOME /bin: $PATH \u4e3aSolr\u5b89\u88c5JTS\u3002\u9002\u5f53\u7684\u7248\u672c\u56e0Spatial4j\u7248\u672c\u800c\u5f02\u3002\u4eceDSE 4.5.2\u5f00\u59cb\uff0c\u9002\u5f53\u7684\u7248\u672c\u662f1.13\u3002 cd $DSE_HOME/resources/solr/lib curl -O 'http://central.maven.org/maven2/com/vividsolutions/jts/1.13/jts-1.13.jar' \u5728\u5355\u4e2a\u540e\u53f0\u5b88\u62a4\u7a0b\u5e8f\u4e2d\u542f\u52a8DSE Cassandra\u548cSolr\uff1a # The dse-data path below was chosen to match the # Installing DataStax Enterprise using the binary tarball # documentation page from DataStax. The exact path is not # significant. dse cassandra -s -Ddse.solr.data.dir= $DSE_HOME /dse-data/solr \u4e0a\u4e00\u4e2a\u547d\u4ee4\u4f1a\u5c06\u4e00\u4e9b\u542f\u52a8\u4fe1\u606f\u5199\u5165\u63a7\u5236\u53f0\u548c\u65e5\u5fd7\u6587\u4ef6\u8def\u5f84$DSE_HOME/resources/cassandra/conf/log4j-server.properties\u7684log4j.appender.R.File\u7684\u914d\u7f6e\u3002 \u4e00\u65e6\u4f7f\u7528Cassandra\u548cSolr\u7684DSE\u6b63\u5e38\u542f\u52a8\uff0c\u8bf7\u68c0\u67e5\u7fa4\u96c6\u8fd0\u884c\u72b6\u51b5nodetool status\u3002\u5355\u5b9e\u4f8b\u73af\u5e94\u8be5\u663e\u793a\u4e00\u4e2a\u8282\u70b9\u5e26\u6709\u6807\u5fd7 U p \u548c N ormal: nodetool status Note: Ownership information does not include topology; for complete information, specify a keyspace = Datacenter: Solr Status=Up/Down |/ State=Normal/Leaving/Joining/Moving -- Address Load Owns Host ID Token Rack UN 127.0.0.1 99.89 KB 100.0% 5484ef7b-ebce-4560-80f0-cbdcd9e9f496 -7317038863489909889 rack1 \u63a5\u4e0b\u6765\uff0c\u5207\u6362\u5230Gremlin Console\u5e76\u9488\u5bf9DSE\u5b9e\u4f8b\u6253\u5f00JanusGraph\u6570\u636e\u5e93\u3002\u8fd9\u5c06\u521b\u5efaJanusGraph\u7684\u952e\u7a7a\u95f4\u548c\u5217\u65cf\u3002 cd $JANUSGRAPH_HOME bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- gremlin graph = JanusGraphFactory.open('conf/janusgraph-cql-solr.properties') == janusgraph[cql:[127.0.0.1]] gremlin g = graph.traversal() == graphtraversalsource[janusgraph[cql:[127.0.0.1]], standard] gremlin \u4fdd\u6301\u8fd9\u4e2aGremlin\u63a7\u5236\u53f0\u6253\u5f00\u3002\u6211\u4eec\u73b0\u5728\u4f11\u606f\u4e00\u4e0b\u5b89\u88c5\u4e00\u4e2aSolr\u6838\u5fc3\u3002\u7136\u540e\u6211\u4eec\u5c06\u56de\u5230\u6b64\u63a7\u5236\u53f0\u4ee5\u52a0\u8f7d\u4e00\u4e9b\u793a\u4f8b\u6570\u636e\u3002 \u63a5\u4e0b\u6765\uff0c\u4e0a\u4f20JanusGraph\u7684Solr\u96c6\u5408\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u5728DSE\u4e2d\u521b\u5efa\u6838\u5fc3\uff1a # Change to the directory where JanusGraph was extracted. Later commands # use relative paths to the Solr config files shipped with the JanusGraph # distribution. cd $JANUSGRAPH_HOME # The name must be URL safe and should contain one dot/full-stop # character. The part of the name after the dot must not conflict with # any of JanusGraph's internal CF names. Starting the part after the dot # solr will avoid a conflict with JanusGraph's internal CF names. CORE_NAME=janusgraph.solr1 # Where to upload collection configuration and send CoreAdmin requests. SOLR_HOST=localhost:8983 # The value of index.[X].solr.http-urls in JanusGraph's config file # should match $SOLR_HOST and $CORE_NAME. For example, given the # $CORE_NAME and $SOLR_HOST values above, JanusGraph's config file would # contain (assuming search is the desired index alias): # # index.search.solr.http-urls=http://localhost:8983/solr/janusgraph.solr1 # # The stock JanusGraph config file conf/janusgraph-cql-solr.properties # ships with this http-urls value. # Upload Solr config files to DSE Search daemon for xml in conf/solr/{solrconfig, schema, elevate}.xml ; do curl -v http:// $SOLR_HOST /solr/resource/ $CORE_NAME/$xml \\ --data-binary @ $xml -H 'Content-type:text/xml; charset=utf-8' done for txt in conf/solr/{protwords, stopwords, synonyms}.txt ; do curl -v http:// $SOLR_HOST /solr/resource/ $CORE_NAME/$txt \\ --data-binary @ $txt -H 'Content-type:text/plain; charset=utf-8' done sleep 5 # Create core using the Solr config files just uploaded above curl http:// $SOLR_HOST /solr/admin/cores?action=CREATE name=$CORE_NAME sleep 5 # Retrieve and print the status of the core we just created curl http://localhost:8983/solr/admin/cores?action=STATUS core=$CORE_NAME \u73b0\u5728\uff0cJanusGraph\u6570\u636e\u5e93\u548c\u652f\u6301Solr\u6838\u5fc3\u5df2\u7ecf\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528God of the Gods \u6570\u636e\u96c6\u5bf9\u5176\u8fdb\u884c\u6d4b\u8bd5\u3002\u4ece\u4e0a\u9762\u5f00\u59cb\u62fe\u53d6Gremlin\u63a7\u5236\u53f0\u4f1a\u8bdd\uff1a // Assuming graph = JanusGraphFactory.open('conf/janusgraph-cql-solr.properties')... gremlin GraphOfTheGodsFactory.load(graph) == null \u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u8fd0\u884c\u7b2c3\u7ae0\u201c \u5165\u95e8\u201d\u4e2d\u63cf\u8ff0\u7684\u4efb\u4f55\u67e5\u8be2\u3002Solr\u5c06\u63d0\u4f9b\u6d89\u53ca\u6587\u672c\u548c\u5730\u7406\u8c13\u8bcd\u7684\u67e5\u8be2\u3002\u6709\u5173JanusGraph\u548cSolr\u5ba2\u6237\u7aef\u7684\u66f4\u8be6\u7ec6\u62a5\u544a\uff0c\u8fd0\u884cgremlin.sh -l DEBUG\u5e76\u53d1\u51fa\u4e00\u4e9b\u7d22\u5f15\u652f\u6301\u7684\u67e5\u8be2\u3002","title":"28.7.1 DSE\u641c\u7d22"},{"location":"index_backends/direct_index_query/","text":"26\u3001 \u76f4\u63a5\u7d22\u5f15\u67e5\u8be2 JanusGraph\u7684\u6807\u51c6\u5168\u5c40\u56fe\u67e5\u8be2\u673a\u5236\u652f\u6301\u9876\u70b9\u6216\u8fb9\u7684\u5e03\u5c14\u67e5\u8be2\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5143\u7d20\u8981\u4e48\u4e0e\u67e5\u8be2\u5339\u914d\uff0c\u8981\u4e48\u4e0d\u5339\u914d\u3002\u6ca1\u6709\u90e8\u5206\u5339\u914d\u6216\u7ed3\u679c\u8bc4\u5206\u3002 \u4e00\u4e9b\u7d22\u5f15\u540e\u7aef\u8fd8\u652f\u6301\u6a21\u7cca\u641c\u7d22\u67e5\u8be2\u3002\u5bf9\u4e8e\u90a3\u4e9b\u67e5\u8be2\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u5339\u914d\u7684\u5206\u6570\u4ee5\u6307\u793a\u5339\u914d\u7684\u201c\u826f\u597d\u6027\u201d\uff0c\u5e76\u4e14\u4ee5\u5176\u5206\u6570\u7684\u987a\u5e8f\u8fd4\u56de\u7ed3\u679c\u3002\u6a21\u7cca\u641c\u7d22\u5728\u5904\u7406\u5168\u6587\u641c\u7d22\u67e5\u8be2\u65f6\u7279\u522b\u6709\u7528\uff0c\u5176\u4e2d\u5339\u914d\u66f4\u591a\u5355\u8bcd\u88ab\u8ba4\u4e3a\u66f4\u597d\u3002 \u7531\u4e8e\u6a21\u7cca\u641c\u7d22\u5b9e\u73b0\u548c\u8bc4\u5206\u7b97\u6cd5\u5728\u7d22\u5f15\u540e\u7aef\u4e4b\u95f4\u5b58\u5728\u663e\u7740\u5dee\u5f02\uff0c\u56e0\u6b64JanusGraph\u672c\u8eab\u4e0d\u652f\u6301\u6a21\u7cca\u641c\u7d22\u3002\u4f46\u662f\uff0cJanusGraph\u63d0\u4f9b\u4e86\u4e00\u79cd\u76f4\u63a5\u7d22\u5f15\u67e5\u8be2\u673a\u5236\uff0c\u5141\u8bb8\u5c06\u641c\u7d22\u67e5\u8be2\u76f4\u63a5\u53d1\u9001\u5230\u7d22\u5f15\u540e\u7aef\u8fdb\u884c\u8bc4\u4f30\uff08\u5bf9\u4e8e\u90a3\u4e9b\u652f\u6301\u5b83\u7684\u540e\u7aef\uff09\u3002 \u4f7f\u7528Graph.indexQuery()\u64b0\u5199\u662f\u76f4\u63a5\u9488\u5bf9\u67d0\u4e2a\u7d22\u5f15\u540e\u7aef\u6267\u884c\u67e5\u8be2\u3002\u6b64\u67e5\u8be2\u6784\u5efa\u5668\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff1a 1. \u8981\u67e5\u8be2\u7684\u7d22\u5f15\u540e\u7aef\u7684\u540d\u79f0\u3002\u8fd9\u5fc5\u987b\u662f\u5728JanusGraph\u914d\u7f6e\u4e2d\u914d\u7f6e\u7684\u540d\u79f0\uff0c\u5e76\u5728\u5c5e\u6027\u952e\u7d22\u5f15\u5b9a\u4e49\u4e2d\u4f7f\u7528 2. \u67e5\u8be2\u5b57\u7b26\u4e32 \u6784\u5efa\u5668\u5141\u8bb8\u901a\u8fc7\u5176limit(int)\u65b9\u6cd5\u914d\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u5143\u7d20\u6570\u3002\u6784\u5efa\u5668offset(int)\u63a7\u5236\u8981\u8df3\u8fc7\u7684\u7ed3\u679c\u96c6\u4e2d\u7684\u521d\u59cb\u5339\u914d\u6570\u3002\u8981\u68c0\u7d22\u4e0e\u6307\u5b9a\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u7ed9\u5b9a\u67e5\u8be2\u5339\u914d\u7684\u6240\u6709\u9876\u70b9\u6216\u8fb9\uff0c\u8bf7\u5206\u522b\u8c03\u7528vertices()\u6216edges()\u3002\u65e0\u6cd5\u540c\u65f6\u67e5\u8be2\u9876\u70b9\u548c\u8fb9\u3002\u8fd9\u4e9b\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2aIterableover Result\u5bf9\u8c61\u3002\u7ed3\u679c\u5bf9\u8c61\u5305\u542b\u5339\u914d\u7684\u53e5\u67c4\uff0c\u53ef\u68c0\u7d22\u7684getElement()\u548c\u76f8\u5173\u7684\u5206\u6570 - getScore()\u3002 \u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\uff1a ManagementSystem mgmt = graph.openManagement(); PropertyKey text = mgmt.makePropertyKey( text ).dataType(String.class).make(); mgmt.buildIndex( vertexByText , Vertex.class).addKey(text).buildMixedIndex( search ); mgmt.commit(); // ... Load vertices ... for (Result Vertex result : graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertices()) { System.out.println(result.getElement() + : + result.getScore()); } 26.1 \u8bf7\u6c42\u53c2\u6570 \u67e5\u8be2\u5b57\u7b26\u4e32\u76f4\u63a5\u4f20\u9012\u7ed9\u7d22\u5f15\u540e\u7aef\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u67e5\u8be2\u5b57\u7b26\u4e32\u8bed\u6cd5\u53d6\u51b3\u4e8e\u7d22\u5f15\u540e\u7aef\u652f\u6301\u7684\u5185\u5bb9\u3002\u5bf9\u4e8e\u9876\u70b9\u67e5\u8be2\uff0cJanusGraph\u5c06\u5206\u6790\u4ee5\u201cv.\u201d\u5f00\u5934\u7684\u5c5e\u6027\u952e\u5f15\u7528\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u3002\u5e76\u901a\u8fc7\u53e5\u67c4\u66ff\u6362\u90a3\u4e9b\u4e0e\u5c5e\u6027\u952e\u5bf9\u5e94\u7684\u7d22\u5f15\u5b57\u6bb5\u3002\u540c\u6837\uff0c\u5bf9\u4e8e\u8fb9\u7f18\u67e5\u8be2\uff0cJanusGraph\u5c06\u66ff\u6362\u4ee5\u201ce.\u201d\u5f00\u5934\u7684\u5c5e\u6027\u952e\u5f15\u7528\u3002\u56e0\u6b64\uff0c\u8981\u5f15\u7528\u9876\u70b9\u7684\u5c5e\u6027\uff0c\u8bf7\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528\u201cv.[KEY_NAME]\u201d\u3002\u540c\u6837\uff0c\u5bf9\u4e8e\u8fb9\u7f18\u5199\u201ce.[KEY_NAME]\u201d\u3002 Elasticsearch\u548cLucene\u652f\u6301Lucene\u67e5\u8be2\u8bed\u6cd5\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Lucene\u6587\u6863\u6216Elasticsearch\u6587\u6863\u3002\u4e0a\u9762\u793a\u4f8b\u4e2d\u4f7f\u7528\u7684\u67e5\u8be2\u9075\u5faaLucene\u67e5\u8be2\u8bed\u6cd5\u3002 graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertices() \u6b64\u67e5\u8be2\u5339\u914d\u6240\u6709\u9876\u70b9\uff0c\u5176\u4e2d\u6587\u672c\u5305\u542b\u4e09\u4e2a\u5355\u8bcd\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff08\u6309\u62ec\u53f7\u5206\u7ec4\uff09\uff0c\u5206\u6570\u5339\u914d\u8d8a\u9ad8\uff0c\u6587\u672c\u4e2d\u5339\u914d\u7684\u5355\u8bcd\u8d8a\u591a\u3002 \u6b64\u5916\uff0cElasticsearch\u652f\u6301\u901a\u914d\u7b26\u67e5\u8be2\uff0c\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528\u201cv. \u201d\u6216\u201ce. \u201d\u6765\u67e5\u8be2\u5143\u7d20\u4e0a\u7684\u4efb\u4f55\u5c5e\u6027\u662f\u5426\u5339\u914d\u3002 26.2 \u67e5\u8be2\u7edf\u8ba1 \u6709\u65f6\u9700\u8981\u77e5\u9053\u4ece\u67e5\u8be2\u8fd4\u56de\u7684\u603b\u7ed3\u679c\u6570\u91cf\uff0c\u800c\u65e0\u9700\u68c0\u7d22\u6240\u6709\u7ed3\u679c\u3002\u5e78\u8fd0\u7684\u662f\uff0cElasticsearch\u548cSolr\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e0d\u6d89\u53ca\u68c0\u7d22\u548c\u6392\u540d\u6240\u6709\u6587\u6863\u7684\u5feb\u6377\u65b9\u5f0f\u3002\u6b64\u5feb\u6377\u65b9\u5f0f\u901a\u8fc7\".vertexTotals()\", \".edgeTotals()\", and \".propertyTotals()\"\u65b9\u6cd5\u5bf9\u5916\u63d0\u4f9b\u3002 \u53ef\u4ee5\u4f7f\u7528\u4e0eindexQuery\u6784\u5efa\u5668\u76f8\u540c\u7684\u67e5\u8be2\u8bed\u6cd5\u68c0\u7d22\u603b\u8ba1\uff0c\u4f46\u662f\u5927\u5c0f\u5c06\u88ab\u8986\u76d6\u4e3a0\u3002 graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertexTotals() 26.3 \u9677\u9631 26.3.1 \u5c5e\u6027\u5efa\u540d\u79f0 \u5fc5\u987b\u5c06\u5305\u542b\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\u7684\u5c5e\u6027\u952e\u7684\u540d\u79f0\u653e\u5728\u5f15\u53f7\u4e2d\uff0c\u4ee5\u786e\u4fdd\u6b63\u786e\u5206\u6790\u67e5\u8be2\u3002 graph.indexQuery( vertexByText , v.\\ first_name\\ :john ).vertices() \u4e00\u4e9b\u5c5e\u6027\u952e\u540d\u79f0\u53ef\u4ee5\u901a\u8fc7JanusGraph\u7d22\u5f15\u540e\u7aef\u5b9e\u73b0\u8fdb\u884c\u8f6c\u6362\u3002\u7d22\u5f15\u540e\u7aef\u5b57\u6bb5\u540d\u79f0\u4e0d\u652f\u6301\u7a7a\u683c\uff0c\u53ef\u80fd\u4f1a\u5c06 \"My Field Name\"\u66ff\u6362\u6210\"My\u2022Field\u2022Name\",\u6216\u8005\u50cfSolr\u8fd9\u6837\u7684\u7d22\u5f15\u540e\u7aef\u53ef\u4ee5\u5c06\u7c7b\u578b\u4fe1\u606f\u9644\u52a0\u5230\u540d\u79f0\uff0c\u5c06 \"myBooleanField\"\u66ff\u6362\u6210\"myBooleanField_b\".\u8fd9\u4e9b\u8f6c\u6362\u53d1\u751f\u5728\u7d22\u5f15\u540e\u7aef\u7684IndexProvider\u5b9e\u73b0\u4e2d\uff0c\u5728\u201cmapKey2Field\u201d\u65b9\u6cd5\u4e2d\u3002\u7d22\u5f15\u540e\u7aef\u53ef\u4ee5\u4fdd\u7559\u7279\u6b8a\u5b57\u7b26\uff08\u4f8b\u5982\u2022\uff09\u5e76\u7981\u6b62\u5bf9\u5305\u542b\u5b83\u4eec\u7684\u5b57\u6bb5\u5efa\u7acb\u7d22\u5f15\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u907f\u514d\u4f7f\u7528\u5c5e\u6027\u540d\u79f0\u4e2d\u7684\u7a7a\u683c\u548c\u7279\u6b8a\u5b57\u7b26\u3002 \u901a\u5e38\uff0c\u8fdb\u884c\u76f4\u63a5\u7d22\u5f15\u67e5\u8be2\u53d6\u51b3\u4e8e\u901a\u5e38\u5bf9\u7528\u6237\u9690\u85cf\u7684JanusGraph\u7d22\u5f15\u540e\u7aef\u7684\u5b9e\u73b0\u7ec6\u8282\uff0c\u56e0\u6b64\u6700\u597d\u6839\u636e\u4f7f\u7528\u4e2d\u7684\u7d22\u5f15\u540e\u7aef\u9a8c\u8bc1\u67e5\u8be2\u3002 26.3.2 \u5143\u7d20\u6807\u8bc6\u7b26\u78b0\u649e \u5b57\u7b26\u4e32\u201cv.\u201d\uff0c\u201ce.\u201d\u548c\u201cp.\u201d \u7528\u4e8e\u5206\u522b\u5728\u67e5\u8be2\u4e2d\u6807\u8bc6\u9876\u70b9\uff0c\u8fb9\u6216\u5c5e\u6027\u5143\u7d20\u3002\u5982\u679c\u5b57\u6bb5\u540d\u79f0\u6216\u67e5\u8be2\u503c\u5305\u542b\u76f8\u540c\u7684\u5b57\u7b26\u5e8f\u5217\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u7684\u51b2\u7a81\u5e76\u89e3\u6790\u9519\u8bef\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a graph.indexQuery( vertexByText , v.name:v.john ).vertices() //DOES NOT WORK! \u8981\u907f\u514d\u6b64\u7c7b\u6807\u8bc6\u7b26\u51b2\u7a81\uff0c\u8bf7\u4f7f\u7528setElementIdentifier\u65b9\u6cd5\u5b9a\u4e49\u5728\u67e5\u8be2\u7684\u4efb\u4f55\u5176\u4ed6\u90e8\u5206\u4e2d\u4e0d\u51fa\u73b0\u7684\u552f\u4e00\u5143\u7d20\u6807\u8bc6\u7b26\u5b57\u7b26\u4e32\uff1a graph.indexQuery( vertexByText , $v$name:v.john ).setElementIdentifier( $v$ ).vertices() 26.3.3 \u6df7\u5408\u7d22\u5f15\u53ef\u7528\u6027\u5ef6\u8fdf \u63d2\u5165\u6570\u636e\u540e\uff0c\u5982\u679c\u67e5\u8be2\u7acb\u5373\u904d\u5386\u6df7\u5408\u7d22\u5f15\uff0c\u5219\u66f4\u6539\u53ef\u80fd\u4e0d\u53ef\u89c1\u3002\u5728Elasticsearch\u4e2d\uff0c\u786e\u5b9a\u6b64\u5ef6\u8fdf\u7684\u914d\u7f6e\u9009\u9879\u662f\u7d22\u5f15\u5237\u65b0\u95f4\u9694\u3002\u5728Solr\u4e2d\uff0c\u4e3b\u8981\u914d\u7f6e\u9009\u9879\u662f\u6700\u957f\u65f6\u95f4\u3002","title":"26.\u76f4\u63a5\u7d22\u5f15\u67e5\u8be2"},{"location":"index_backends/direct_index_query/#26","text":"JanusGraph\u7684\u6807\u51c6\u5168\u5c40\u56fe\u67e5\u8be2\u673a\u5236\u652f\u6301\u9876\u70b9\u6216\u8fb9\u7684\u5e03\u5c14\u67e5\u8be2\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5143\u7d20\u8981\u4e48\u4e0e\u67e5\u8be2\u5339\u914d\uff0c\u8981\u4e48\u4e0d\u5339\u914d\u3002\u6ca1\u6709\u90e8\u5206\u5339\u914d\u6216\u7ed3\u679c\u8bc4\u5206\u3002 \u4e00\u4e9b\u7d22\u5f15\u540e\u7aef\u8fd8\u652f\u6301\u6a21\u7cca\u641c\u7d22\u67e5\u8be2\u3002\u5bf9\u4e8e\u90a3\u4e9b\u67e5\u8be2\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u5339\u914d\u7684\u5206\u6570\u4ee5\u6307\u793a\u5339\u914d\u7684\u201c\u826f\u597d\u6027\u201d\uff0c\u5e76\u4e14\u4ee5\u5176\u5206\u6570\u7684\u987a\u5e8f\u8fd4\u56de\u7ed3\u679c\u3002\u6a21\u7cca\u641c\u7d22\u5728\u5904\u7406\u5168\u6587\u641c\u7d22\u67e5\u8be2\u65f6\u7279\u522b\u6709\u7528\uff0c\u5176\u4e2d\u5339\u914d\u66f4\u591a\u5355\u8bcd\u88ab\u8ba4\u4e3a\u66f4\u597d\u3002 \u7531\u4e8e\u6a21\u7cca\u641c\u7d22\u5b9e\u73b0\u548c\u8bc4\u5206\u7b97\u6cd5\u5728\u7d22\u5f15\u540e\u7aef\u4e4b\u95f4\u5b58\u5728\u663e\u7740\u5dee\u5f02\uff0c\u56e0\u6b64JanusGraph\u672c\u8eab\u4e0d\u652f\u6301\u6a21\u7cca\u641c\u7d22\u3002\u4f46\u662f\uff0cJanusGraph\u63d0\u4f9b\u4e86\u4e00\u79cd\u76f4\u63a5\u7d22\u5f15\u67e5\u8be2\u673a\u5236\uff0c\u5141\u8bb8\u5c06\u641c\u7d22\u67e5\u8be2\u76f4\u63a5\u53d1\u9001\u5230\u7d22\u5f15\u540e\u7aef\u8fdb\u884c\u8bc4\u4f30\uff08\u5bf9\u4e8e\u90a3\u4e9b\u652f\u6301\u5b83\u7684\u540e\u7aef\uff09\u3002 \u4f7f\u7528Graph.indexQuery()\u64b0\u5199\u662f\u76f4\u63a5\u9488\u5bf9\u67d0\u4e2a\u7d22\u5f15\u540e\u7aef\u6267\u884c\u67e5\u8be2\u3002\u6b64\u67e5\u8be2\u6784\u5efa\u5668\u9700\u8981\u4e24\u4e2a\u53c2\u6570\uff1a 1. \u8981\u67e5\u8be2\u7684\u7d22\u5f15\u540e\u7aef\u7684\u540d\u79f0\u3002\u8fd9\u5fc5\u987b\u662f\u5728JanusGraph\u914d\u7f6e\u4e2d\u914d\u7f6e\u7684\u540d\u79f0\uff0c\u5e76\u5728\u5c5e\u6027\u952e\u7d22\u5f15\u5b9a\u4e49\u4e2d\u4f7f\u7528 2. \u67e5\u8be2\u5b57\u7b26\u4e32 \u6784\u5efa\u5668\u5141\u8bb8\u901a\u8fc7\u5176limit(int)\u65b9\u6cd5\u914d\u7f6e\u8981\u8fd4\u56de\u7684\u6700\u5927\u5143\u7d20\u6570\u3002\u6784\u5efa\u5668offset(int)\u63a7\u5236\u8981\u8df3\u8fc7\u7684\u7ed3\u679c\u96c6\u4e2d\u7684\u521d\u59cb\u5339\u914d\u6570\u3002\u8981\u68c0\u7d22\u4e0e\u6307\u5b9a\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u7ed9\u5b9a\u67e5\u8be2\u5339\u914d\u7684\u6240\u6709\u9876\u70b9\u6216\u8fb9\uff0c\u8bf7\u5206\u522b\u8c03\u7528vertices()\u6216edges()\u3002\u65e0\u6cd5\u540c\u65f6\u67e5\u8be2\u9876\u70b9\u548c\u8fb9\u3002\u8fd9\u4e9b\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2aIterableover Result\u5bf9\u8c61\u3002\u7ed3\u679c\u5bf9\u8c61\u5305\u542b\u5339\u914d\u7684\u53e5\u67c4\uff0c\u53ef\u68c0\u7d22\u7684getElement()\u548c\u76f8\u5173\u7684\u5206\u6570 - getScore()\u3002 \u8bf7\u8003\u8651\u4ee5\u4e0b\u793a\u4f8b\uff1a ManagementSystem mgmt = graph.openManagement(); PropertyKey text = mgmt.makePropertyKey( text ).dataType(String.class).make(); mgmt.buildIndex( vertexByText , Vertex.class).addKey(text).buildMixedIndex( search ); mgmt.commit(); // ... Load vertices ... for (Result Vertex result : graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertices()) { System.out.println(result.getElement() + : + result.getScore()); }","title":"26\u3001 \u76f4\u63a5\u7d22\u5f15\u67e5\u8be2"},{"location":"index_backends/direct_index_query/#261","text":"\u67e5\u8be2\u5b57\u7b26\u4e32\u76f4\u63a5\u4f20\u9012\u7ed9\u7d22\u5f15\u540e\u7aef\u8fdb\u884c\u5904\u7406\uff0c\u56e0\u6b64\u67e5\u8be2\u5b57\u7b26\u4e32\u8bed\u6cd5\u53d6\u51b3\u4e8e\u7d22\u5f15\u540e\u7aef\u652f\u6301\u7684\u5185\u5bb9\u3002\u5bf9\u4e8e\u9876\u70b9\u67e5\u8be2\uff0cJanusGraph\u5c06\u5206\u6790\u4ee5\u201cv.\u201d\u5f00\u5934\u7684\u5c5e\u6027\u952e\u5f15\u7528\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u3002\u5e76\u901a\u8fc7\u53e5\u67c4\u66ff\u6362\u90a3\u4e9b\u4e0e\u5c5e\u6027\u952e\u5bf9\u5e94\u7684\u7d22\u5f15\u5b57\u6bb5\u3002\u540c\u6837\uff0c\u5bf9\u4e8e\u8fb9\u7f18\u67e5\u8be2\uff0cJanusGraph\u5c06\u66ff\u6362\u4ee5\u201ce.\u201d\u5f00\u5934\u7684\u5c5e\u6027\u952e\u5f15\u7528\u3002\u56e0\u6b64\uff0c\u8981\u5f15\u7528\u9876\u70b9\u7684\u5c5e\u6027\uff0c\u8bf7\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528\u201cv.[KEY_NAME]\u201d\u3002\u540c\u6837\uff0c\u5bf9\u4e8e\u8fb9\u7f18\u5199\u201ce.[KEY_NAME]\u201d\u3002 Elasticsearch\u548cLucene\u652f\u6301Lucene\u67e5\u8be2\u8bed\u6cd5\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Lucene\u6587\u6863\u6216Elasticsearch\u6587\u6863\u3002\u4e0a\u9762\u793a\u4f8b\u4e2d\u4f7f\u7528\u7684\u67e5\u8be2\u9075\u5faaLucene\u67e5\u8be2\u8bed\u6cd5\u3002 graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertices() \u6b64\u67e5\u8be2\u5339\u914d\u6240\u6709\u9876\u70b9\uff0c\u5176\u4e2d\u6587\u672c\u5305\u542b\u4e09\u4e2a\u5355\u8bcd\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff08\u6309\u62ec\u53f7\u5206\u7ec4\uff09\uff0c\u5206\u6570\u5339\u914d\u8d8a\u9ad8\uff0c\u6587\u672c\u4e2d\u5339\u914d\u7684\u5355\u8bcd\u8d8a\u591a\u3002 \u6b64\u5916\uff0cElasticsearch\u652f\u6301\u901a\u914d\u7b26\u67e5\u8be2\uff0c\u5728\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u4f7f\u7528\u201cv. \u201d\u6216\u201ce. \u201d\u6765\u67e5\u8be2\u5143\u7d20\u4e0a\u7684\u4efb\u4f55\u5c5e\u6027\u662f\u5426\u5339\u914d\u3002","title":"26.1 \u8bf7\u6c42\u53c2\u6570"},{"location":"index_backends/direct_index_query/#262","text":"\u6709\u65f6\u9700\u8981\u77e5\u9053\u4ece\u67e5\u8be2\u8fd4\u56de\u7684\u603b\u7ed3\u679c\u6570\u91cf\uff0c\u800c\u65e0\u9700\u68c0\u7d22\u6240\u6709\u7ed3\u679c\u3002\u5e78\u8fd0\u7684\u662f\uff0cElasticsearch\u548cSolr\u63d0\u4f9b\u4e86\u4e00\u79cd\u4e0d\u6d89\u53ca\u68c0\u7d22\u548c\u6392\u540d\u6240\u6709\u6587\u6863\u7684\u5feb\u6377\u65b9\u5f0f\u3002\u6b64\u5feb\u6377\u65b9\u5f0f\u901a\u8fc7\".vertexTotals()\", \".edgeTotals()\", and \".propertyTotals()\"\u65b9\u6cd5\u5bf9\u5916\u63d0\u4f9b\u3002 \u53ef\u4ee5\u4f7f\u7528\u4e0eindexQuery\u6784\u5efa\u5668\u76f8\u540c\u7684\u67e5\u8be2\u8bed\u6cd5\u68c0\u7d22\u603b\u8ba1\uff0c\u4f46\u662f\u5927\u5c0f\u5c06\u88ab\u8986\u76d6\u4e3a0\u3002 graph.indexQuery( vertexByText , v.text:(farm uncle berry) ).vertexTotals()","title":"26.2 \u67e5\u8be2\u7edf\u8ba1"},{"location":"index_backends/direct_index_query/#263","text":"","title":"26.3 \u9677\u9631"},{"location":"index_backends/direct_index_query/#2631","text":"\u5fc5\u987b\u5c06\u5305\u542b\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\u7684\u5c5e\u6027\u952e\u7684\u540d\u79f0\u653e\u5728\u5f15\u53f7\u4e2d\uff0c\u4ee5\u786e\u4fdd\u6b63\u786e\u5206\u6790\u67e5\u8be2\u3002 graph.indexQuery( vertexByText , v.\\ first_name\\ :john ).vertices() \u4e00\u4e9b\u5c5e\u6027\u952e\u540d\u79f0\u53ef\u4ee5\u901a\u8fc7JanusGraph\u7d22\u5f15\u540e\u7aef\u5b9e\u73b0\u8fdb\u884c\u8f6c\u6362\u3002\u7d22\u5f15\u540e\u7aef\u5b57\u6bb5\u540d\u79f0\u4e0d\u652f\u6301\u7a7a\u683c\uff0c\u53ef\u80fd\u4f1a\u5c06 \"My Field Name\"\u66ff\u6362\u6210\"My\u2022Field\u2022Name\",\u6216\u8005\u50cfSolr\u8fd9\u6837\u7684\u7d22\u5f15\u540e\u7aef\u53ef\u4ee5\u5c06\u7c7b\u578b\u4fe1\u606f\u9644\u52a0\u5230\u540d\u79f0\uff0c\u5c06 \"myBooleanField\"\u66ff\u6362\u6210\"myBooleanField_b\".\u8fd9\u4e9b\u8f6c\u6362\u53d1\u751f\u5728\u7d22\u5f15\u540e\u7aef\u7684IndexProvider\u5b9e\u73b0\u4e2d\uff0c\u5728\u201cmapKey2Field\u201d\u65b9\u6cd5\u4e2d\u3002\u7d22\u5f15\u540e\u7aef\u53ef\u4ee5\u4fdd\u7559\u7279\u6b8a\u5b57\u7b26\uff08\u4f8b\u5982\u2022\uff09\u5e76\u7981\u6b62\u5bf9\u5305\u542b\u5b83\u4eec\u7684\u5b57\u6bb5\u5efa\u7acb\u7d22\u5f15\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u907f\u514d\u4f7f\u7528\u5c5e\u6027\u540d\u79f0\u4e2d\u7684\u7a7a\u683c\u548c\u7279\u6b8a\u5b57\u7b26\u3002 \u901a\u5e38\uff0c\u8fdb\u884c\u76f4\u63a5\u7d22\u5f15\u67e5\u8be2\u53d6\u51b3\u4e8e\u901a\u5e38\u5bf9\u7528\u6237\u9690\u85cf\u7684JanusGraph\u7d22\u5f15\u540e\u7aef\u7684\u5b9e\u73b0\u7ec6\u8282\uff0c\u56e0\u6b64\u6700\u597d\u6839\u636e\u4f7f\u7528\u4e2d\u7684\u7d22\u5f15\u540e\u7aef\u9a8c\u8bc1\u67e5\u8be2\u3002","title":"26.3.1 \u5c5e\u6027\u5efa\u540d\u79f0"},{"location":"index_backends/direct_index_query/#2632","text":"\u5b57\u7b26\u4e32\u201cv.\u201d\uff0c\u201ce.\u201d\u548c\u201cp.\u201d \u7528\u4e8e\u5206\u522b\u5728\u67e5\u8be2\u4e2d\u6807\u8bc6\u9876\u70b9\uff0c\u8fb9\u6216\u5c5e\u6027\u5143\u7d20\u3002\u5982\u679c\u5b57\u6bb5\u540d\u79f0\u6216\u67e5\u8be2\u503c\u5305\u542b\u76f8\u540c\u7684\u5b57\u7b26\u5e8f\u5217\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u7684\u51b2\u7a81\u5e76\u89e3\u6790\u9519\u8bef\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a graph.indexQuery( vertexByText , v.name:v.john ).vertices() //DOES NOT WORK! \u8981\u907f\u514d\u6b64\u7c7b\u6807\u8bc6\u7b26\u51b2\u7a81\uff0c\u8bf7\u4f7f\u7528setElementIdentifier\u65b9\u6cd5\u5b9a\u4e49\u5728\u67e5\u8be2\u7684\u4efb\u4f55\u5176\u4ed6\u90e8\u5206\u4e2d\u4e0d\u51fa\u73b0\u7684\u552f\u4e00\u5143\u7d20\u6807\u8bc6\u7b26\u5b57\u7b26\u4e32\uff1a graph.indexQuery( vertexByText , $v$name:v.john ).setElementIdentifier( $v$ ).vertices()","title":"26.3.2 \u5143\u7d20\u6807\u8bc6\u7b26\u78b0\u649e"},{"location":"index_backends/direct_index_query/#2633","text":"\u63d2\u5165\u6570\u636e\u540e\uff0c\u5982\u679c\u67e5\u8be2\u7acb\u5373\u904d\u5386\u6df7\u5408\u7d22\u5f15\uff0c\u5219\u66f4\u6539\u53ef\u80fd\u4e0d\u53ef\u89c1\u3002\u5728Elasticsearch\u4e2d\uff0c\u786e\u5b9a\u6b64\u5ef6\u8fdf\u7684\u914d\u7f6e\u9009\u9879\u662f\u7d22\u5f15\u5237\u65b0\u95f4\u9694\u3002\u5728Solr\u4e2d\uff0c\u4e3b\u8981\u914d\u7f6e\u9009\u9879\u662f\u6700\u957f\u65f6\u95f4\u3002","title":"26.3.3 \u6df7\u5408\u7d22\u5f15\u53ef\u7528\u6027\u5ef6\u8fdf"},{"location":"index_backends/elasticsearch/","text":"27. Elasticsearch Elasticsearch\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u3001RESTful\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u591f\u89e3\u51b3\u8d8a\u6765\u8d8a\u591a\u7684\u7528\u4f8b\u3002\u4f5c\u4e3a\u5f39\u6027\u5806\u6808\u7684\u6838\u5fc3\uff0c\u5b83\u96c6\u4e2d\u5b58\u50a8\u60a8\u7684\u6570\u636e\uff0c\u4ee5\u4fbf\u60a8\u80fd\u591f\u53d1\u73b0\u9884\u671f\u7684\u6570\u636e\u5e76\u53d1\u73b0\u610f\u5916\u7684\u6570\u636e\u3002 -Elasticsearch\u6982\u8ff0 JanusGraph\u652f\u6301Elasticsearch\u4f5c\u4e3a\u7d22\u5f15\u540e\u7aef\u3002\u4ee5\u4e0b\u662fJanusGraph\u652f\u6301\u7684\u4e00\u4e9bElasticsearch\u529f\u80fd\uff1a - \u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 - Geo\uff1a\u652f\u6301\u6240\u6709Geo\u8c13\u8bcd\uff0c\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4f53\u4e2d\u76f8\u4ea4\uff0c\u5185\u90e8\uff0c\u4e0d\u76f8\u4ea4\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u5706\uff0c\u6846\u548c\u591a\u8fb9\u5f62\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u548c\u6240\u6709\u5f62\u72b6\u4ee5\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u3002 - \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 - \u7075\u6d3b\u914d\u7f6e\uff1a\u652f\u6301\u8fdc\u7a0b\u64cd\u4f5c\u548c\u5f00\u653e\u5f0f\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u3002 - \u96c6\u5408\uff1a\u652f\u6301\u7d22\u5f15SET\u548cLIST\u57fa\u6570\u5c5e\u6027\u3002 - \u65f6\u95f4\uff1a\u7eb3\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 - \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668\u3002 - Not Query-normal-form\uff1a\u652f\u6301Query-normal-form\uff08QNF\uff09\u4ee5\u5916\u7684\u67e5\u8be2\u3002JanusGraph\u7684QNF\u662fCNF\uff08\u8054\u5408\u6b63\u5e38\u5f62\u5f0f\uff09\u7684\u53d8\u4f53\uff0c\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u5185\u8054\u5426\u5b9a\u3002 \u6709\u5173\u54ea\u4e9b\u7248\u672c\u7684Elasticsearch\u53ef\u4e0eJanusGraph\u914d\u5408\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55B Version Compatibility\u3002 \u91cd\u70b9\uff1a\u4eceElasticsearch 5.0\u5f00\u59cb\uff0cJanusGraph\u4f7f\u7528\u6c99\u76d2 Painless scripts \u8fdb\u884c\u5185\u8054\u66f4\u65b0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728Elasticsearch 5.x\u4e2d\u542f\u7528\u3002 \u5c06JanusGraph\u4e0eElasticsearch 2.x\u4e00\u8d77\u4f7f\u7528\u9700\u8981\u901a\u8fc7\u8bbe\u7f6escript.engine.groovy.inline.update\u4e3atrueElasticsearch\u96c6\u7fa4\u6765\u542f\u7528Groovy\u5185\u8054\u811a\u672c\uff08\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u52a8\u6001\u811a\u672c\u6587\u6863 \uff09\u3002 27.1 \u8fd0\u884c Elasticsearch JanusGraph\u652f\u6301\u4e0e\u6b63\u5728\u8fd0\u884c\u7684Elasticsearch\u96c6\u7fa4\u7684\u8fde\u63a5\u3002JanusGraph\u63d0\u4f9b\u4e86\u4e24\u4e2a\u9009\u9879\u6765\u8fd0\u884c\u672c\u5730Elasticsearch\u5b9e\u4f8b\u4ee5\u4fbf\u5feb\u901f\u5165\u95e8\u3002JanusGraph\u670d\u52a1\u5668\uff08\u53c2\u89c1\u7b2c7.1\u8282 \u5165\u95e8(https://docs.janusgraph.org/latest/server.html#server-getting-started) \u201d\uff09\u81ea\u52a8\u542f\u52a8\u672c\u5730Elasticsearch\u5b9e\u4f8b\u3002\u53e6\u5916\uff0cJanusGraph\u7248\u672c\u5305\u542b\u4e00\u4e2a\u5b8c\u6574\u7684Elasticsearch\u53d1\u884c\u7248\uff0c\u5141\u8bb8\u7528\u6237\u624b\u52a8\u542f\u52a8\u672c\u5730Elasticsearch\u5b9e\u4f8b,\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6b64 \u9875\u9762 \u3002 $ elasticsearch/bin/elasticsearch \u6ce8\u610f: \u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c 27.2 Elasticsearch\u914d\u7f6e\u6982\u8ff0 JanusGraph\u652f\u6301\u4e0e\u6b63\u5728\u8fd0\u884c\u7684Elasticsearch\u96c6\u7fa4\u7684HTTP(S)\u5ba2\u6237\u7aef\u8fde\u63a5\u3002\u6709\u5173\u54ea\u4e9b\u7248\u672c\u7684Elasticsearch\u5c06\u4e0eJanusGraph\u4e2d\u7684\u4e0d\u540c\u5ba2\u6237\u7aef\u7c7b\u578b\u4e00\u8d77\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u9644\u5f55B\uff0c\u7248\u672c\u517c\u5bb9\u6027 \u3002 \u6ce8\u610f: JanusGraph\u7684\u7d22\u5f15\u9009\u9879\u4ee5\u5b57\u7b26\u4e32\u201c index.[X].\u201d \u5f00\u5934\uff0c\u5176\u4e2d\u201c [X]\u201d\u662f\u540e\u7aef\u7684\u7528\u6237\u5b9a\u4e49\u540d\u79f0\u3002\u5728\u6784\u5efa\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u5c06\u6b64\u7528\u6237\u5b9a\u4e49\u7684\u540d\u79f0\u4f20\u9012\u7ed9JanusGraph\u7684ManagementSystem\u63a5\u53e3\uff0c\u5982 \u7b2c11.1.2\u8282\u201c\u6df7\u5408\u7d22\u5f15\u201d \u4e2d\u6240\u8ff0\uff0c\u4ee5\u4fbfJanusGraph\u77e5\u9053\u53ef\u80fd\u4f7f\u7528\u591a\u4e2a\u5df2\u914d\u7f6e\u7684\u7d22\u5f15\u540e\u7aef\u3002\u672c\u7ae0\u4e2d\u7684\u914d\u7f6e\u7247\u6bb5\u4f7f\u7528\u540d\u79f0\u641c\u7d22\uff0c\u800c\u5bf9\u9009\u9879\u7684\u8be6\u7ec6\u8ba8\u8bba\u901a\u5e38\u5c06[X]\u5199\u5728\u76f8\u540c\u7684\u4f4d\u7f6e\u3002\u53ea\u8981\u5728janusgraph\u7684\u914d\u7f6e\u4e2d\u548c\u7ba1\u7406\u7d22\u5f15\u65f6\u4e00\u81f4\u5730\u4f7f\u7528\u7d22\u5f15\u540d\uff0c\u90a3\u4e48\u786e\u5207\u7684\u7d22\u5f15\u540d\u5c31\u4e0d\u91cd\u8981\u3002 \u63d0\u793a\uff1a \u5efa\u8bae\u7d22\u5f15\u540d\u79f0\u4ec5\u5305\u542b\u5b57\u6bcd\u6570\u5b57\u5c0f\u5199\u5b57\u7b26\u548c\u8fde\u5b57\u7b26\uff0c\u5e76\u4e14\u5b83\u4eec\u4ee5\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\u3002 27.2.1 \u8fde\u63a5\u5230Elasticsearch Elasticsearch\u5ba2\u6237\u7aef\u6307\u5b9a\u5982\u4e0b\uff1a index.search.backend=elasticsearch \u8fde\u63a5\u5230Elasticsearch\u65f6\uff0c\u5fc5\u987b\u63d0\u4f9bElasticsearch\u5b9e\u4f8b\u7684\u5355\u4e2a\u6216\u4e3b\u673a\u540d\u5217\u8868\u3002\u8fd9\u4e9b\u662f\u901a\u8fc7JanusGraph\u7684index.[X].hostname\u5bc6\u94a5\u63d0\u4f9b\u7684\u3002 index.search.backend=elasticsearch index.search.hostname=10.0.0.10:9200 \u8fd9\u91cc\u6307\u5b9a\u7684\u6bcf\u4e2a\u4e3b\u673a\u6216\u4e3b\u673a:\u7aef\u53e3\u5bf9\u5c06\u88ab\u6dfb\u52a0\u5230HTTP\u5ba2\u6237\u673a\u7684\u8bf7\u6c42\u76ee\u6807\u8f6e\u8be2\u5217\u8868\u4e2d\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u6700\u5c0f\u914d\u7f6e\uff0c\u5b83\u5c06\u5728\u9ed8\u8ba4\u7684Elasticsearch HTTP\u7aef\u53e3(9200)\u548c\u7aef\u53e37777\u4e0a\u8f6e\u8be210.0.0.10\u548c10.0.0.20: index.search.backend=elasticsearch index.search.hostname=10.0.0.10, 10.0.0.20:7777 27.2.1.1 JanusGraph index.[X]\u548cindex.[X].elasticsearch\u9009\u9879 JanusGraph\u53ea\u4f7f\u7528\u9ed8\u8ba4\u503cindex-name\u548chealth-request-timeout\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u53ca\u5176\u53ef\u63a5\u53d7\u503c\u7684\u8bf4\u660e\uff0c\u8bf7\u53c2\u89c1\u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 - index.[X].elasticsearch.index-name - index.[X].elasticsearch.health-request-timeout 27.2.2. REST \u5ba2\u6237\u7aef\u9009\u9879 REST\u5ba2\u6237\u7aef\u63a5\u53d7\u8be5index.[X].bulk-refresh\u9009\u9879\u3002\u6b64\u9009\u9879\u63a7\u5236\u4f55\u65f6\u4f7f\u66f4\u6539\u5bf9\u641c\u7d22\u53ef\u89c1\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\uff1f refresh\u6587\u6863 27.2.3 REST\u5ba2\u6237\u7aefHTTPS\u914d\u7f6e \u5c06index.[X].elasticsearch.ssl.enabled\u9009\u9879\u8bbe\u7f6e\u4e3atrue\u6765\u542f\u7528HTTP\u7684SSL\u3002\u6ce8\u610f\uff0c\u6839\u636e\u60a8\u7684\u914d\u7f6e\uff0c\u5982\u679c\u60a8\u60a8\u7684HTTPS\u7aef\u53e3\u53f7\u4e0eREST API(9200)\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\u4e0d\u540c)\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u6539 index.[X].port\u3002 \u542f\u7528SSL\u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u914d\u7f6e\u4fe1\u4efb\u5e93\u7684\u4f4d\u7f6e\u548c\u5bc6\u7801\u3002\u8fd9\u53ef\u4ee5\u6309\u5982\u4e0b\u65b9\u5f0f\u5b8c\u6210\uff1a index.search.elasticsearch.ssl.truststore.location=/path/to/your/truststore.jks index.search.elasticsearch.ssl.truststore.password=truststorepwd \u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8eElasticsearch REST\u5ba2\u6237\u7aef\uff0c\u4e0d\u4f1a\u5f71\u54cdJanusGraph\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6SSL\u8fde\u63a5\u3002 \u8fd8\u652f\u6301\u5ba2\u6237\u7aef\u5bc6\u94a5\u5e93\u7684\u914d\u7f6e\uff1a index.search.elasticsearch.ssl.keystore.location=/path/to/your/keystore.jks index.search.elasticsearch.ssl.keystore.storepassword=keystorepwd index.search.elasticsearch.ssl.keystore.keypassword=keypwd \u4efb\u4f55\u5bc6\u7801\u90fd\u53ef\u4ee5\u4e3a\u7a7a\u3002 \u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06index.[X].elasticsearch.ssl.disable-hostname-verification\u5c5e\u6027\u503c\u8bbe\u7f6e\u4e3atrue\u6765\u7981\u7528SSL\u4e3b\u673a\u540d\u9a8c\u8bc1\uff0c\u5e76\u901a\u8fc7\u5c06index.[X].elasticsearch.ssl.allow-self-signed-certificates\u5c5e\u6027\u503c\u8bbe\u7f6e\u4e3atrue\u6765\u542f\u7528\u5bf9\u81ea\u7b7e\u540dSSL\u8bc1\u4e66\u7684\u652f\u6301\u3002 \u63d0\u793a: \u4e0d\u5efa\u8bae\u4f9d\u8d56\u81ea\u7b7e\u540dSSL\u8bc1\u4e66\u6216\u7981\u7528\u751f\u4ea7\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u9a8c\u8bc1\uff0c\u56e0\u4e3a\u8fd9\u5927\u5927\u9650\u5236\u4e86\u5ba2\u6237\u7aef\u5411Elasticsearch\u670d\u52a1\u5668\u63d0\u4f9b\u5b89\u5168\u901a\u4fe1\u901a\u9053\u7684\u80fd\u529b\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6cc4\u6f0f\u673a\u5bc6\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u53ef\u80fd\u662fJanusGraph\u7d22\u5f15\u7684\u4e00\u90e8\u5206\u3002 27.2.4 REST\u5ba2\u6237\u7aefHTTP\u8eab\u4efd\u9a8c\u8bc1 REST\u5ba2\u6237\u7aef\u652f\u6301\u4ee5\u4e0b\u8eab\u4efd\u9a8c\u8bc1\u9009\u9879\uff1a\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1\uff08\u7528\u6237\u540d/\u5bc6\u7801\uff09\u548c\u57fa\u4e8e\u7528\u6237\u63d0\u4f9b\u7684\u5b9e\u73b0\u7684\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u3002 \u8fd9\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u72ec\u7acb\u4e8e\u4e0a\u8ff0SSL\u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1\u3002 27.2.4.1 REST\u5ba2\u6237\u7aef\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1 \u65e0\u8bbaSSL\u652f\u6301\u7684\u72b6\u6001\u5982\u4f55\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1\u3002\u53ef\u9009\u5730\uff0c\u53ef\u4ee5\u901a\u8fc7index.[X].elasticsearch.http.auth.basic.realm\u5c5e\u6027\u6307\u5b9a\u8ba4\u8bc1\u9886\u57df\u3002 index.search.elasticsearch.http.auth.type=basic index.search.elasticsearch.http.auth.basic.username=httpuser index.search.elasticsearch.http.auth.basic.password=httppassword \u63d0\u793a\uff1a \u5f3a\u70c8\u5efa\u8bae\u5728\u4f7f\u7528\u6b64\u9009\u9879\u65f6\u4f7f\u7528SSL\uff08\u4f8b\u5982\u8bbe\u7f6eindex.[X].elasticsearch.ssl.enabled\u4e3atrue\uff09\uff0c\u56e0\u4e3a\u5728\u901a\u8fc7\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u53d1\u9001\u65f6\u53ef\u4ee5\u62e6\u622a\u51ed\u636e\uff01 27.2.4.2 REST\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49HTTP\u8eab\u4efd\u9a8c\u8bc1 \u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u81ea\u5df1\u7684\u5b9e\u73b0\u6765\u5b9e\u73b0\u5176\u4ed6\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u914d\u7f6e\u5982\u4e0b\uff1a index.search.elasticsearch.http.auth.custom.authenticator-class=fully.qualified.class.Name index.search.elasticsearch.elasticsearch.http.auth.custom.authenticator-args=arg1,arg2,... \u53c2\u6570\u5217\u8868\u662f\u53ef\u9009\u7684\uff0c\u53ef\u4ee5\u4e3a\u7a7a\u3002 \u6307\u5b9a\u7684\u7c7b\u5fc5\u987b\u5b9e\u73b0org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticator\u63a5\u53e3\u6216\u6269\u5c55org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticatorBase\u5de5\u5177\u7c7b\u3002\u8be5\u5b9e\u73b0\u53ef\u4ee5\u8bbf\u95eeHTTP\u5ba2\u6237\u7aef\u914d\u7f6e\uff0c\u5e76\u53ef\u4ee5\u6839\u636e\u9700\u8981\u81ea\u5b9a\u4e49\u5ba2\u6237\u7aef\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55A\uff0c API\u6587\u6863\uff08JavaDoc\uff09 \u3002 \u4f8b\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u6bb5\u5b9e\u73b0\u4e86\u4e00\u4e2a\u8eab\u4efd\u9a8c\u8bc1\u5668\uff0c\u5141\u8bb8Elasticsearch REST\u5ba2\u6237\u7aef\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u5e76\u83b7\u5f97\u9488\u5bf9AWS IAM\u7684\u6388\u6743\uff1a import java.io.IOException; import java.time.LocalDateTime; import java.time.ZoneOffset; import org.apache.http.HttpRequestInterceptor; import org.apache.http.impl.nio.client.HttpAsyncClientBuilder; import org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticatorBase; import com.amazonaws.auth.DefaultAWSCredentialsProviderChain; import com.amazonaws.regions.DefaultAwsRegionProviderChain; import com.google.common.base.Supplier; import vc.inreach.aws.request.AWSSigner; import vc.inreach.aws.request.AWSSigningRequestInterceptor; /** * p * Elasticsearch REST HTTP(S) client callback implementing AWS request signing. * /p * p * The signer is based on AWS SDK default provider chain, allowing multiple options for providing * the caller credentials. See {@link DefaultAWSCredentialsProviderChain} documentation for the details. * /p */ public class AWSV4AuthHttpClientConfigCallback extends RestClientAuthenticatorBase { private static final String AWS_SERVICE_NAME = es ; private HttpRequestInterceptor awsSigningInterceptor; public AWSV4AuthHttpClientConfigCallback(final String[] args) { // does not require any configuration } @Override public void init() throws IOException { DefaultAWSCredentialsProviderChain awsCredentialsProvider = new DefaultAWSCredentialsProviderChain(); final Supplier LocalDateTime clock = () - LocalDateTime.now(ZoneOffset.UTC); // using default region provider chain // (http://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/java-dg-region-selection.html) DefaultAwsRegionProviderChain regionProviderChain = new DefaultAwsRegionProviderChain(); final String awsRegion = regionProviderChain.getRegion(); final AWSSigner awsSigner = new AWSSigner(awsCredentialsProvider, awsRegion, AWS_SERVICE_NAME, clock); this.awsSigningInterceptor = new AWSSigningRequestInterceptor(awsSigner); } @Override public HttpAsyncClientBuilder customizeHttpClient(HttpAsyncClientBuilder httpClientBuilder) { return httpClientBuilder.addInterceptorLast(awsSigningInterceptor);/ } } \u6b64\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u4e0d\u4f7f\u7528\u4efb\u4f55\u6784\u9020\u51fd\u6570\u53c2\u6570\u3002 27.2.5 \u6444\u53d6\u7ba1\u9053 \u5982\u679c\u4f7f\u7528Elasticsearch 5.0\u6216\u66f4\u9ad8\u7248\u672c\uff0c\u5219\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u6df7\u5408\u7d22\u5f15\u8bbe\u7f6e\u4e0d\u540c\u7684\u6444\u53d6\u7ba1\u9053\u3002\u53ef\u4ee5\u4f7f\u7528\u6444\u53d6\u7ba1\u9053\u5728\u7d22\u5f15\u4e4b\u524d\u9884\u5904\u7406\u6587\u6863\u3002\u7ba1\u9053\u7531\u4e00\u7cfb\u5217\u5904\u7406\u5668\u7ec4\u6210\u3002\u6bcf\u4e2a\u5904\u7406\u5668\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8f6c\u6362\u6587\u6863\u3002\u4f8b\u5982\uff0c \u65e5\u671f\u5904\u7406\u5668 \u53ef\u4ee5\u4ece\u6587\u672c\u63d0\u53d6\u65e5\u671f\u5230\u65e5\u671f\u5b57\u6bb5\u3002\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528JanusGraph\u67e5\u8be2\u6b64\u65e5\u671f\uff0c\u800c\u4e0d\u4f1a\u5c06\u5176\u7269\u7406\u5b58\u50a8\u5728\u4e3b\u5b58\u50a8\u4e2d\u3002 - index.[X].elasticsearch.ingest-pipeline.[mixedIndexName] = pipeline_id \u6709\u5173\u6444\u53d6\u5904\u7406\u7a0b\u5e8f\u7ba1\u9053\u548c \u5904\u7406\u5668 \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u6444\u53d6\u6587\u6863 \u3002 27.3 \u5b89\u5168\u7684Elasticsearch Elasticsearch\u4e0d\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u6388\u6743\u3002Elasticsearch\u4fe1\u4efb\u53ef\u4ee5\u8fde\u63a5\u5230Elasticsearch\u7684\u5ba2\u6237\u7aef\u3002\u5f53Elasticsearch\u5728\u4e0d\u5b89\u5168\u6216\u516c\u5171\u7f51\u7edc\uff08\u5c24\u5176\u662fInternet\uff09\u4e0a\u8fd0\u884c\u65f6\uff0c\u5e94\u4f7f\u7528\u67d0\u79cd\u7c7b\u578b\u7684\u5916\u90e8\u5b89\u5168\u6027\u8fdb\u884c\u90e8\u7f72\u3002\u8fd9\u901a\u5e38\u901a\u8fc7\u9632\u706b\u5899\uff0cElasticsearch\u7aef\u53e3\u7684\u96a7\u9053\u6216\u4f7f\u7528Elasticsearch\u6269\u5c55\uff08\u5982X-Pack\uff09\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u3002Elasticsearch\u6709\u4e24\u4e2a\u9762\u5411\u5ba2\u6237\u7aef\u7684\u7aef\u53e3\u9700\u8981\u8003\u8651\uff1a - HTTP REST API\uff0c\u901a\u5e38\u5728\u7aef\u53e39200\u4e0a - \u672c\u5730\u201c\u4f20\u8f93\u201d\u534f\u8bae\uff0c\u901a\u5e38\u5728\u7aef\u53e39300\u4e0a \u5ba2\u6237\u7aef\u4f7f\u7528\u4e00\u4e2a\u534f\u8bae/\u7aef\u53e3\u6216\u53e6\u4e00\u4e2a\uff0c\u4f46\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528\u3002\u4fdd\u62a4HTTP\u534f\u8bae\u7aef\u53e3\u901a\u5e38\u4f7f\u7528\u9632\u706b\u5899\u548c\u5177\u6709SSL\u52a0\u5bc6\u548cHTTP\u8eab\u4efd\u9a8c\u8bc1\u7684\u53cd\u5411\u4ee3\u7406\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5728\u672c\u673a\u201c\u4f20\u8f93\u201d\u534f\u8bae\u7aef\u53e3\u4e0a\u5b9e\u73b0\u5b89\u5168\u6027\uff1a \u9664\u6b64\u4e4b\u5916\uff0c\u4e00\u4e9b\u6258\u7ba1\u7684Elasticsearch\u670d\u52a1\u8fd8\u63d0\u4f9b\u5176\u4ed6\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u6cd5\u3002\u4f8b\u5982\uff0cAWS Elasticsearch Service\u9700\u8981\u4f7f\u7528HTTPS\u5e76\u63d0\u4f9b\u4f7f\u7528\u57fa\u4e8eIAM\u7684\u8bbf\u95ee\u63a7\u5236\u7684\u9009\u9879\u3002\u4e3a\u6b64\uff0c\u5fc5\u987b\u7b7e\u7f72\u53d1\u9001\u5230\u6b64\u670d\u52a1\u7684\u8bf7\u6c42\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u6765\u5b9e\u73b0\uff08\u53c2\u89c1\u4e0a\u6587\uff09\u3002 \u96a7\u9053Elasticsearch\u7684\u672c\u5730\u201c\u4f20\u8f93\u201d\u534f\u8bae \u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u901a\u8fc7SSL / TLS\u96a7\u9053\uff08\u4f8b\u5982\u901a\u8fc7stunnel\uff09\uff0cVPN\u6216SSH\u7aef\u53e3\u8f6c\u53d1\u6765\u5b9e\u73b0\u3002SSL / TLS\u96a7\u9053\u9700\u8981\u975e\u5e38\u7b80\u5355\u7684\u8bbe\u7f6e\u548c\u76d1\u63a7\uff1a\u96a7\u9053\u7684\u4e00\u7aef\u6216\u4e24\u7aef\u9700\u8981\u8bc1\u4e66\uff0c\u5e76\u4e14\u9700\u8981\u914d\u7f6e\u5e76\u8fde\u7eed\u8fd0\u884cstunnel\u8fdb\u7a0b\u3002\u5927\u591a\u6570\u5b89\u5168VPN\u7684\u8bbe\u7f6e\u540c\u6837\u91cd\u8981\u3002\u4e00\u4e9bElasticsearch\u670d\u52a1\u63d0\u4f9b\u5546\u5904\u7406\u670d\u52a1\u5668\u7aef\u96a7\u9053\u7ba1\u7406\u5e76\u63d0\u4f9b\u81ea\u5b9a\u4e49Elasticsearch transport.type\u4ee5\u7b80\u5316\u5ba2\u6237\u7aef\u8bbe\u7f6e\u3002 \u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\uff0c\u8be5\u89c4\u5219\u4ec5\u5141\u8bb8\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u5728Elasticsearch\u7684\u672c\u673a\u534f\u8bae\u7aef\u53e3\u4e0a\u8fdb\u884c\u8fde\u63a5 \u8fd9\u901a\u5e38\u5728\u4e3b\u673a\u9632\u706b\u5899\u7ea7\u522b\u5b8c\u6210\u3002\u6613\u4e8e\u914d\u7f6e\uff0c\u4f46\u672c\u8eab\u5b89\u5168\u6027\u975e\u5e38\u5dee\u3002 27.4 \u7d22\u5f15\u521b\u5efa\u9009\u9879 JanusGraph\u652f\u6301\u81ea\u5b9a\u4e49\u521b\u5efaElasticsearch\u7d22\u5f15\u65f6\u4f7f\u7528\u7684\u7d22\u5f15\u8bbe\u7f6e\u3002\u5b83\u5141\u8bb8settings\u5728JanusGraph\u53d1\u51fa\u7684Elasticsearch create index\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u5bf9\u8c61\u4e0a\u7684\u4efb\u610f\u952e\u503c\u5bf9\u3002\u4ee5\u4e0b\u662f\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\u81ea\u5b9a\u4e49\u7684Elasticsearch\u7d22\u5f15\u8bbe\u7f6e\u7684\u975e\u8be6\u5c3d\u793a\u4f8b\uff1a - index.number_of_replicas - index.number_of_shards - index.refresh_interval \u901a\u8fc7\u6b64\u673a\u5236\u81ea\u5b9a\u4e49\u7684\u8bbe\u7f6e\u4ec5\u5728JanusGraph\u5c1d\u8bd5\u5728Elasticsearch\u4e2d\u521b\u5efa\u5176\u7d22\u5f15\u65f6\u5e94\u7528\u3002\u5982\u679cJanusGraph\u53d1\u73b0\u5176\u7d22\u5f15\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u5b83\u4e0d\u4f1a\u5c1d\u8bd5\u91cd\u65b0\u521b\u5efa\u5b83\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8bbe\u7f6e\u65e0\u6548\u3002 27.4.1 \u5d4c\u5165Elasticsearch\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6ecreate.ext Janusgraph\u8fed\u4ee3\u6240\u6709\u524d\u7f00\u4e3aindex.[x].elasticsearch.create.ext.\u7684\u5c5e\u6027\uff0c\u5176\u4e2d[x]\u662f\u7d22\u5f15\u540d\uff0c\u5982search\u3002\u5b83\u4ece\u6bcf\u4e2a\u5c5e\u6027\u952e\u4e2d\u53bb\u6389\u524d\u7f00\u3002\u5265\u79bb\u7684\u952e\u7684\u5176\u4f59\u90e8\u5206\u5c06\u88ab\u89e3\u91ca\u4e3aElasticSearch\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u3002\u672a\u4fee\u6539\u4e0e\u952e\u5173\u8054\u7684\u503c\u3002\u5265\u79bb\u7684\u952e\u548c\u672a\u4fee\u6539\u7684\u503c\u4f5c\u4e3aElasticSearch\u521b\u5efa\u7d22\u5f15\u8bf7\u6c42\u4e2d\u7684\u8bbe\u7f6e\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\u4f20\u9012\uff0c\u8be5\u8bf7\u6c42\u662fJanusgraph\u5728ElasticSearch\u4e0a\u5f15\u5bfc\u65f6\u53d1\u51fa\u7684\u3002\u8fd9\u5141\u8bb8\u5728Janusgraph\u7684\u5c5e\u6027\u4e2d\u5d4c\u5165\u4efb\u610f\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u914d\u7f6e\u7247\u6bb5\u793a\u4f8b\uff0c\u5b83\u4f7f\u7528create.ext\u914d\u7f6e\u673a\u5236\u81ea\u5b9a\u4e49\u4e09\u4e2aElasticSearch\u7d22\u5f15\u8bbe\u7f6e\uff1a index.search.backend=elasticsearch index.search.elasticsearch.create.ext.number_of_shards=15 index.search.elasticsearch.create.ext.number_of_replicas=3 index.search.elasticsearch.create.ext.shard.check_on_startup=true \u4e0a\u9762\u5217\u51fa\u7684\u914d\u7f6e\u7247\u6bb5\u5229\u7528\u4e86Elasticsearch\u5728\u670d\u52a1\u5668\u7aef\u5b9e\u73b0\u7684\u5047\u8bbe\uff0c\u5373\u4e0d\u5408\u683c\u7684create index\u8bbe\u7f6e\u5bc6\u94a5\u5177\u6709index.\u524d\u7f00\u3002\u4e5f\u53ef\u4ee5\u660e\u786e\u5730\u62fc\u51fa\u7d22\u5f15\u524d\u7f00\u3002\u8fd9\u662f\u4e00\u4e2aJanusGraph\u914d\u7f6e\u6587\u4ef6\uff0c\u529f\u80fd\u4e0a\u4e0e\u4e0a\u9762\u5217\u51fa\u7684\u76f8\u540c\uff0c\u53ea\u662findex.\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u524d\u7684\u524d\u7f00\u662f\u663e\u5f0f\u7684\uff1a index.search.backend=elasticsearch index.search.elasticsearch.create.ext.index.number_of_shards=15 index.search.elasticsearch.create.ext.index.number_of_replicas=3 index.search.elasticsearch.create.ext.index.shard.check_on_startup=false \u63d0\u793a create.ext\u6307\u5b9a\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u7684\u673a\u5236\u4e0eJanusGraph\u7684Elasticsearch\u914d\u7f6e\u517c\u5bb9\u3002 27.5 \u6545\u969c\u6392\u9664 27.5.1 \u8fde\u63a5\u5230\u8fdc\u7a0bElasticsearch\u96c6\u7fa4\u95ee\u9898 \u68c0\u67e5\u6765\u81eaJanusGraph\u8282\u70b9\u7684HTTP\u534f\u8bae\u7aef\u53e3\u4e0a\u662f\u5426\u53ef\u4ee5\u8bbf\u95eeElasticsearch\u96c6\u7fa4\u8282\u70b9\u3002\u901a\u8fc7\u68c0\u67e5Elasticsearch\u8282\u70b9\u914d\u7f6e\u65e5\u5fd7\u6216\u4f7f\u7528\u5e38\u89c4\u8bca\u65ad\u5b9e\u7528\u7a0b\u5e8fnetstat\u6765\u68c0\u67e5\u8282\u70b9\u4fa6\u542c\u7aef\u53e3\u3002\u68c0\u67e5JanusGraph\u914d\u7f6e\u3002 27.6 \u4f18\u5316Elasticsearch 27.6.1 \u5199\u4f18\u5316 \u5bf9\u4e8e \u6279\u91cf\u52a0\u8f7d \u6216\u5176\u4ed6\u5199\u5165\u5bc6\u96c6\u578b\u5e94\u7528\u7a0b\u5e8f\uff0c\u8bf7\u8003\u8651\u589e\u52a0Elasticsearch\u7684\u5237\u65b0\u95f4\u9694\u3002\u8bf7\u53c2\u9605 \u6b64\u8ba8\u8bba \uff0c\u4e86\u89e3\u5982\u4f55\u589e\u52a0\u5237\u65b0\u95f4\u9694\u53ca\u5176\u5bf9\u5199\u5165\u6027\u80fd\u7684\u5f71\u54cd\u3002\u8bf7\u6ce8\u610f\uff0c\u66f4\u9ad8\u7684\u5237\u65b0\u95f4\u9694\u610f\u5473\u7740\u56fe\u5f62\u7a81\u53d8\u5728\u7d22\u5f15\u4e2d\u53ef\u7528\u7684\u65f6\u95f4\u66f4\u957f\u3002 \u6709\u5173\u5982\u4f55\u5728Elasticsearch\u4e2d\u63d0\u9ad8\u5199\u5165\u6027\u80fd\u7684\u5176\u4ed6\u5efa\u8bae\u4ee5\u53ca\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u9605\u8bfb \u6b64\u535a\u5ba2\u6587\u7ae0 \u3002 27.6.2 \u8fdb\u4e00\u6b65\u9605\u8bfb \u6709\u5173Elasticsearch\u4ee5\u53ca\u5982\u4f55\u8bbe\u7f6eElasticsearch\u96c6\u7fa4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Elasticsearch\u4e3b\u9875\u548c\u53ef\u7528\u6587\u6863\u3002","title":"27.Elasticsearch"},{"location":"index_backends/elasticsearch/#27-elasticsearch","text":"Elasticsearch\u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u3001RESTful\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce\uff0c\u80fd\u591f\u89e3\u51b3\u8d8a\u6765\u8d8a\u591a\u7684\u7528\u4f8b\u3002\u4f5c\u4e3a\u5f39\u6027\u5806\u6808\u7684\u6838\u5fc3\uff0c\u5b83\u96c6\u4e2d\u5b58\u50a8\u60a8\u7684\u6570\u636e\uff0c\u4ee5\u4fbf\u60a8\u80fd\u591f\u53d1\u73b0\u9884\u671f\u7684\u6570\u636e\u5e76\u53d1\u73b0\u610f\u5916\u7684\u6570\u636e\u3002 -Elasticsearch\u6982\u8ff0 JanusGraph\u652f\u6301Elasticsearch\u4f5c\u4e3a\u7d22\u5f15\u540e\u7aef\u3002\u4ee5\u4e0b\u662fJanusGraph\u652f\u6301\u7684\u4e00\u4e9bElasticsearch\u529f\u80fd\uff1a - \u5168\u6587\uff1a\u652f\u6301\u6240\u6709Text\u8c13\u8bcd\u4ee5\u641c\u7d22\u4e0e\u7ed9\u5b9a\u5355\u8bcd\uff0c\u524d\u7f00\u6216\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u7684\u6587\u672c\u5c5e\u6027\u3002 - Geo\uff1a\u652f\u6301\u6240\u6709Geo\u8c13\u8bcd\uff0c\u4ee5\u641c\u7d22\u5728\u7ed9\u5b9a\u67e5\u8be2\u51e0\u4f55\u4f53\u4e2d\u76f8\u4ea4\uff0c\u5185\u90e8\uff0c\u4e0d\u76f8\u4ea4\u6216\u5305\u542b\u7684\u5730\u7406\u5c5e\u6027\u3002\u652f\u6301\u7528\u4e8e\u7d22\u5f15\u7684\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u652f\u6301\u5706\uff0c\u6846\u548c\u591a\u8fb9\u5f62\u7528\u4e8e\u67e5\u8be2\u70b9\u5c5e\u6027\u548c\u6240\u6709\u5f62\u72b6\u4ee5\u67e5\u8be2\u975e\u70b9\u5c5e\u6027\u3002 - \u6570\u5b57\u8303\u56f4\uff1a\u652f\u6301\u6240\u6709\u6570\u5b57\u6bd4\u8f83Compare\u3002 - \u7075\u6d3b\u914d\u7f6e\uff1a\u652f\u6301\u8fdc\u7a0b\u64cd\u4f5c\u548c\u5f00\u653e\u5f0f\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u3002 - \u96c6\u5408\uff1a\u652f\u6301\u7d22\u5f15SET\u548cLIST\u57fa\u6570\u5c5e\u6027\u3002 - \u65f6\u95f4\uff1a\u7eb3\u79d2\u7c92\u5ea6\u65f6\u95f4\u7d22\u5f15\u3002 - \u81ea\u5b9a\u4e49\u5206\u6790\u5668\uff1a\u9009\u62e9\u4f7f\u7528\u81ea\u5b9a\u4e49\u5206\u6790\u5668\u3002 - Not Query-normal-form\uff1a\u652f\u6301Query-normal-form\uff08QNF\uff09\u4ee5\u5916\u7684\u67e5\u8be2\u3002JanusGraph\u7684QNF\u662fCNF\uff08\u8054\u5408\u6b63\u5e38\u5f62\u5f0f\uff09\u7684\u53d8\u4f53\uff0c\u5728\u53ef\u80fd\u7684\u60c5\u51b5\u4e0b\u5185\u8054\u5426\u5b9a\u3002 \u6709\u5173\u54ea\u4e9b\u7248\u672c\u7684Elasticsearch\u53ef\u4e0eJanusGraph\u914d\u5408\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55B Version Compatibility\u3002 \u91cd\u70b9\uff1a\u4eceElasticsearch 5.0\u5f00\u59cb\uff0cJanusGraph\u4f7f\u7528\u6c99\u76d2 Painless scripts \u8fdb\u884c\u5185\u8054\u66f4\u65b0\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728Elasticsearch 5.x\u4e2d\u542f\u7528\u3002 \u5c06JanusGraph\u4e0eElasticsearch 2.x\u4e00\u8d77\u4f7f\u7528\u9700\u8981\u901a\u8fc7\u8bbe\u7f6escript.engine.groovy.inline.update\u4e3atrueElasticsearch\u96c6\u7fa4\u6765\u542f\u7528Groovy\u5185\u8054\u811a\u672c\uff08\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u52a8\u6001\u811a\u672c\u6587\u6863 \uff09\u3002","title":"27. Elasticsearch"},{"location":"index_backends/elasticsearch/#271-elasticsearch","text":"JanusGraph\u652f\u6301\u4e0e\u6b63\u5728\u8fd0\u884c\u7684Elasticsearch\u96c6\u7fa4\u7684\u8fde\u63a5\u3002JanusGraph\u63d0\u4f9b\u4e86\u4e24\u4e2a\u9009\u9879\u6765\u8fd0\u884c\u672c\u5730Elasticsearch\u5b9e\u4f8b\u4ee5\u4fbf\u5feb\u901f\u5165\u95e8\u3002JanusGraph\u670d\u52a1\u5668\uff08\u53c2\u89c1\u7b2c7.1\u8282 \u5165\u95e8(https://docs.janusgraph.org/latest/server.html#server-getting-started) \u201d\uff09\u81ea\u52a8\u542f\u52a8\u672c\u5730Elasticsearch\u5b9e\u4f8b\u3002\u53e6\u5916\uff0cJanusGraph\u7248\u672c\u5305\u542b\u4e00\u4e2a\u5b8c\u6574\u7684Elasticsearch\u53d1\u884c\u7248\uff0c\u5141\u8bb8\u7528\u6237\u624b\u52a8\u542f\u52a8\u672c\u5730Elasticsearch\u5b9e\u4f8b,\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6b64 \u9875\u9762 \u3002 $ elasticsearch/bin/elasticsearch \u6ce8\u610f: \u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c","title":"27.1 \u8fd0\u884c Elasticsearch"},{"location":"index_backends/elasticsearch/#272-elasticsearch","text":"JanusGraph\u652f\u6301\u4e0e\u6b63\u5728\u8fd0\u884c\u7684Elasticsearch\u96c6\u7fa4\u7684HTTP(S)\u5ba2\u6237\u7aef\u8fde\u63a5\u3002\u6709\u5173\u54ea\u4e9b\u7248\u672c\u7684Elasticsearch\u5c06\u4e0eJanusGraph\u4e2d\u7684\u4e0d\u540c\u5ba2\u6237\u7aef\u7c7b\u578b\u4e00\u8d77\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u9644\u5f55B\uff0c\u7248\u672c\u517c\u5bb9\u6027 \u3002 \u6ce8\u610f: JanusGraph\u7684\u7d22\u5f15\u9009\u9879\u4ee5\u5b57\u7b26\u4e32\u201c index.[X].\u201d \u5f00\u5934\uff0c\u5176\u4e2d\u201c [X]\u201d\u662f\u540e\u7aef\u7684\u7528\u6237\u5b9a\u4e49\u540d\u79f0\u3002\u5728\u6784\u5efa\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u5fc5\u987b\u5c06\u6b64\u7528\u6237\u5b9a\u4e49\u7684\u540d\u79f0\u4f20\u9012\u7ed9JanusGraph\u7684ManagementSystem\u63a5\u53e3\uff0c\u5982 \u7b2c11.1.2\u8282\u201c\u6df7\u5408\u7d22\u5f15\u201d \u4e2d\u6240\u8ff0\uff0c\u4ee5\u4fbfJanusGraph\u77e5\u9053\u53ef\u80fd\u4f7f\u7528\u591a\u4e2a\u5df2\u914d\u7f6e\u7684\u7d22\u5f15\u540e\u7aef\u3002\u672c\u7ae0\u4e2d\u7684\u914d\u7f6e\u7247\u6bb5\u4f7f\u7528\u540d\u79f0\u641c\u7d22\uff0c\u800c\u5bf9\u9009\u9879\u7684\u8be6\u7ec6\u8ba8\u8bba\u901a\u5e38\u5c06[X]\u5199\u5728\u76f8\u540c\u7684\u4f4d\u7f6e\u3002\u53ea\u8981\u5728janusgraph\u7684\u914d\u7f6e\u4e2d\u548c\u7ba1\u7406\u7d22\u5f15\u65f6\u4e00\u81f4\u5730\u4f7f\u7528\u7d22\u5f15\u540d\uff0c\u90a3\u4e48\u786e\u5207\u7684\u7d22\u5f15\u540d\u5c31\u4e0d\u91cd\u8981\u3002 \u63d0\u793a\uff1a \u5efa\u8bae\u7d22\u5f15\u540d\u79f0\u4ec5\u5305\u542b\u5b57\u6bcd\u6570\u5b57\u5c0f\u5199\u5b57\u7b26\u548c\u8fde\u5b57\u7b26\uff0c\u5e76\u4e14\u5b83\u4eec\u4ee5\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934\u3002","title":"27.2 Elasticsearch\u914d\u7f6e\u6982\u8ff0"},{"location":"index_backends/elasticsearch/#2721-elasticsearch","text":"Elasticsearch\u5ba2\u6237\u7aef\u6307\u5b9a\u5982\u4e0b\uff1a index.search.backend=elasticsearch \u8fde\u63a5\u5230Elasticsearch\u65f6\uff0c\u5fc5\u987b\u63d0\u4f9bElasticsearch\u5b9e\u4f8b\u7684\u5355\u4e2a\u6216\u4e3b\u673a\u540d\u5217\u8868\u3002\u8fd9\u4e9b\u662f\u901a\u8fc7JanusGraph\u7684index.[X].hostname\u5bc6\u94a5\u63d0\u4f9b\u7684\u3002 index.search.backend=elasticsearch index.search.hostname=10.0.0.10:9200 \u8fd9\u91cc\u6307\u5b9a\u7684\u6bcf\u4e2a\u4e3b\u673a\u6216\u4e3b\u673a:\u7aef\u53e3\u5bf9\u5c06\u88ab\u6dfb\u52a0\u5230HTTP\u5ba2\u6237\u673a\u7684\u8bf7\u6c42\u76ee\u6807\u8f6e\u8be2\u5217\u8868\u4e2d\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u6700\u5c0f\u914d\u7f6e\uff0c\u5b83\u5c06\u5728\u9ed8\u8ba4\u7684Elasticsearch HTTP\u7aef\u53e3(9200)\u548c\u7aef\u53e37777\u4e0a\u8f6e\u8be210.0.0.10\u548c10.0.0.20: index.search.backend=elasticsearch index.search.hostname=10.0.0.10, 10.0.0.20:7777","title":"27.2.1 \u8fde\u63a5\u5230Elasticsearch"},{"location":"index_backends/elasticsearch/#27211-janusgraph-indexxindexxelasticsearch","text":"JanusGraph\u53ea\u4f7f\u7528\u9ed8\u8ba4\u503cindex-name\u548chealth-request-timeout\u3002\u6709\u5173\u8fd9\u4e9b\u9009\u9879\u53ca\u5176\u53ef\u63a5\u53d7\u503c\u7684\u8bf4\u660e\uff0c\u8bf7\u53c2\u89c1\u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 - index.[X].elasticsearch.index-name - index.[X].elasticsearch.health-request-timeout","title":"27.2.1.1 JanusGraph index.[X]\u548cindex.[X].elasticsearch\u9009\u9879"},{"location":"index_backends/elasticsearch/#2722-rest","text":"REST\u5ba2\u6237\u7aef\u63a5\u53d7\u8be5index.[X].bulk-refresh\u9009\u9879\u3002\u6b64\u9009\u9879\u63a7\u5236\u4f55\u65f6\u4f7f\u66f4\u6539\u5bf9\u641c\u7d22\u53ef\u89c1\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\uff1f refresh\u6587\u6863","title":"27.2.2. REST \u5ba2\u6237\u7aef\u9009\u9879"},{"location":"index_backends/elasticsearch/#2723-resthttps","text":"\u5c06index.[X].elasticsearch.ssl.enabled\u9009\u9879\u8bbe\u7f6e\u4e3atrue\u6765\u542f\u7528HTTP\u7684SSL\u3002\u6ce8\u610f\uff0c\u6839\u636e\u60a8\u7684\u914d\u7f6e\uff0c\u5982\u679c\u60a8\u60a8\u7684HTTPS\u7aef\u53e3\u53f7\u4e0eREST API(9200)\u7684\u9ed8\u8ba4\u7aef\u53e3\u53f7\u4e0d\u540c)\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u6539 index.[X].port\u3002 \u542f\u7528SSL\u540e\uff0c\u60a8\u8fd8\u53ef\u4ee5\u914d\u7f6e\u4fe1\u4efb\u5e93\u7684\u4f4d\u7f6e\u548c\u5bc6\u7801\u3002\u8fd9\u53ef\u4ee5\u6309\u5982\u4e0b\u65b9\u5f0f\u5b8c\u6210\uff1a index.search.elasticsearch.ssl.truststore.location=/path/to/your/truststore.jks index.search.elasticsearch.ssl.truststore.password=truststorepwd \u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u8bbe\u7f6e\u4ec5\u9002\u7528\u4e8eElasticsearch REST\u5ba2\u6237\u7aef\uff0c\u4e0d\u4f1a\u5f71\u54cdJanusGraph\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6SSL\u8fde\u63a5\u3002 \u8fd8\u652f\u6301\u5ba2\u6237\u7aef\u5bc6\u94a5\u5e93\u7684\u914d\u7f6e\uff1a index.search.elasticsearch.ssl.keystore.location=/path/to/your/keystore.jks index.search.elasticsearch.ssl.keystore.storepassword=keystorepwd index.search.elasticsearch.ssl.keystore.keypassword=keypwd \u4efb\u4f55\u5bc6\u7801\u90fd\u53ef\u4ee5\u4e3a\u7a7a\u3002 \u5982\u679c\u9700\u8981\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06index.[X].elasticsearch.ssl.disable-hostname-verification\u5c5e\u6027\u503c\u8bbe\u7f6e\u4e3atrue\u6765\u7981\u7528SSL\u4e3b\u673a\u540d\u9a8c\u8bc1\uff0c\u5e76\u901a\u8fc7\u5c06index.[X].elasticsearch.ssl.allow-self-signed-certificates\u5c5e\u6027\u503c\u8bbe\u7f6e\u4e3atrue\u6765\u542f\u7528\u5bf9\u81ea\u7b7e\u540dSSL\u8bc1\u4e66\u7684\u652f\u6301\u3002 \u63d0\u793a: \u4e0d\u5efa\u8bae\u4f9d\u8d56\u81ea\u7b7e\u540dSSL\u8bc1\u4e66\u6216\u7981\u7528\u751f\u4ea7\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\u9a8c\u8bc1\uff0c\u56e0\u4e3a\u8fd9\u5927\u5927\u9650\u5236\u4e86\u5ba2\u6237\u7aef\u5411Elasticsearch\u670d\u52a1\u5668\u63d0\u4f9b\u5b89\u5168\u901a\u4fe1\u901a\u9053\u7684\u80fd\u529b\u3002\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6cc4\u6f0f\u673a\u5bc6\u6570\u636e\uff0c\u8fd9\u4e9b\u6570\u636e\u53ef\u80fd\u662fJanusGraph\u7d22\u5f15\u7684\u4e00\u90e8\u5206\u3002","title":"27.2.3 REST\u5ba2\u6237\u7aefHTTPS\u914d\u7f6e"},{"location":"index_backends/elasticsearch/#2724-resthttp","text":"REST\u5ba2\u6237\u7aef\u652f\u6301\u4ee5\u4e0b\u8eab\u4efd\u9a8c\u8bc1\u9009\u9879\uff1a\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1\uff08\u7528\u6237\u540d/\u5bc6\u7801\uff09\u548c\u57fa\u4e8e\u7528\u6237\u63d0\u4f9b\u7684\u5b9e\u73b0\u7684\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u3002 \u8fd9\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u72ec\u7acb\u4e8e\u4e0a\u8ff0SSL\u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1\u3002","title":"27.2.4 REST\u5ba2\u6237\u7aefHTTP\u8eab\u4efd\u9a8c\u8bc1"},{"location":"index_backends/elasticsearch/#27241-resthttp","text":"\u65e0\u8bbaSSL\u652f\u6301\u7684\u72b6\u6001\u5982\u4f55\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1\u3002\u53ef\u9009\u5730\uff0c\u53ef\u4ee5\u901a\u8fc7index.[X].elasticsearch.http.auth.basic.realm\u5c5e\u6027\u6307\u5b9a\u8ba4\u8bc1\u9886\u57df\u3002 index.search.elasticsearch.http.auth.type=basic index.search.elasticsearch.http.auth.basic.username=httpuser index.search.elasticsearch.http.auth.basic.password=httppassword \u63d0\u793a\uff1a \u5f3a\u70c8\u5efa\u8bae\u5728\u4f7f\u7528\u6b64\u9009\u9879\u65f6\u4f7f\u7528SSL\uff08\u4f8b\u5982\u8bbe\u7f6eindex.[X].elasticsearch.ssl.enabled\u4e3atrue\uff09\uff0c\u56e0\u4e3a\u5728\u901a\u8fc7\u672a\u52a0\u5bc6\u7684\u8fde\u63a5\u53d1\u9001\u65f6\u53ef\u4ee5\u62e6\u622a\u51ed\u636e\uff01","title":"27.2.4.1 REST\u5ba2\u6237\u7aef\u57fa\u672cHTTP\u8eab\u4efd\u9a8c\u8bc1"},{"location":"index_backends/elasticsearch/#27242-resthttp","text":"\u53ef\u4ee5\u901a\u8fc7\u63d0\u4f9b\u81ea\u5df1\u7684\u5b9e\u73b0\u6765\u5b9e\u73b0\u5176\u4ed6\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6cd5\u3002\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u914d\u7f6e\u5982\u4e0b\uff1a index.search.elasticsearch.http.auth.custom.authenticator-class=fully.qualified.class.Name index.search.elasticsearch.elasticsearch.http.auth.custom.authenticator-args=arg1,arg2,... \u53c2\u6570\u5217\u8868\u662f\u53ef\u9009\u7684\uff0c\u53ef\u4ee5\u4e3a\u7a7a\u3002 \u6307\u5b9a\u7684\u7c7b\u5fc5\u987b\u5b9e\u73b0org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticator\u63a5\u53e3\u6216\u6269\u5c55org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticatorBase\u5de5\u5177\u7c7b\u3002\u8be5\u5b9e\u73b0\u53ef\u4ee5\u8bbf\u95eeHTTP\u5ba2\u6237\u7aef\u914d\u7f6e\uff0c\u5e76\u53ef\u4ee5\u6839\u636e\u9700\u8981\u81ea\u5b9a\u4e49\u5ba2\u6237\u7aef\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u9644\u5f55A\uff0c API\u6587\u6863\uff08JavaDoc\uff09 \u3002 \u4f8b\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u6bb5\u5b9e\u73b0\u4e86\u4e00\u4e2a\u8eab\u4efd\u9a8c\u8bc1\u5668\uff0c\u5141\u8bb8Elasticsearch REST\u5ba2\u6237\u7aef\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u5e76\u83b7\u5f97\u9488\u5bf9AWS IAM\u7684\u6388\u6743\uff1a import java.io.IOException; import java.time.LocalDateTime; import java.time.ZoneOffset; import org.apache.http.HttpRequestInterceptor; import org.apache.http.impl.nio.client.HttpAsyncClientBuilder; import org.janusgraph.diskstorage.es.rest.util.RestClientAuthenticatorBase; import com.amazonaws.auth.DefaultAWSCredentialsProviderChain; import com.amazonaws.regions.DefaultAwsRegionProviderChain; import com.google.common.base.Supplier; import vc.inreach.aws.request.AWSSigner; import vc.inreach.aws.request.AWSSigningRequestInterceptor; /** * p * Elasticsearch REST HTTP(S) client callback implementing AWS request signing. * /p * p * The signer is based on AWS SDK default provider chain, allowing multiple options for providing * the caller credentials. See {@link DefaultAWSCredentialsProviderChain} documentation for the details. * /p */ public class AWSV4AuthHttpClientConfigCallback extends RestClientAuthenticatorBase { private static final String AWS_SERVICE_NAME = es ; private HttpRequestInterceptor awsSigningInterceptor; public AWSV4AuthHttpClientConfigCallback(final String[] args) { // does not require any configuration } @Override public void init() throws IOException { DefaultAWSCredentialsProviderChain awsCredentialsProvider = new DefaultAWSCredentialsProviderChain(); final Supplier LocalDateTime clock = () - LocalDateTime.now(ZoneOffset.UTC); // using default region provider chain // (http://docs.aws.amazon.com/sdk-for-java/v2/developer-guide/java-dg-region-selection.html) DefaultAwsRegionProviderChain regionProviderChain = new DefaultAwsRegionProviderChain(); final String awsRegion = regionProviderChain.getRegion(); final AWSSigner awsSigner = new AWSSigner(awsCredentialsProvider, awsRegion, AWS_SERVICE_NAME, clock); this.awsSigningInterceptor = new AWSSigningRequestInterceptor(awsSigner); } @Override public HttpAsyncClientBuilder customizeHttpClient(HttpAsyncClientBuilder httpClientBuilder) { return httpClientBuilder.addInterceptorLast(awsSigningInterceptor);/ } } \u6b64\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u4e0d\u4f7f\u7528\u4efb\u4f55\u6784\u9020\u51fd\u6570\u53c2\u6570\u3002","title":"27.2.4.2 REST\u5ba2\u6237\u7aef\u81ea\u5b9a\u4e49HTTP\u8eab\u4efd\u9a8c\u8bc1"},{"location":"index_backends/elasticsearch/#2725","text":"\u5982\u679c\u4f7f\u7528Elasticsearch 5.0\u6216\u66f4\u9ad8\u7248\u672c\uff0c\u5219\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u6df7\u5408\u7d22\u5f15\u8bbe\u7f6e\u4e0d\u540c\u7684\u6444\u53d6\u7ba1\u9053\u3002\u53ef\u4ee5\u4f7f\u7528\u6444\u53d6\u7ba1\u9053\u5728\u7d22\u5f15\u4e4b\u524d\u9884\u5904\u7406\u6587\u6863\u3002\u7ba1\u9053\u7531\u4e00\u7cfb\u5217\u5904\u7406\u5668\u7ec4\u6210\u3002\u6bcf\u4e2a\u5904\u7406\u5668\u4ee5\u67d0\u79cd\u65b9\u5f0f\u8f6c\u6362\u6587\u6863\u3002\u4f8b\u5982\uff0c \u65e5\u671f\u5904\u7406\u5668 \u53ef\u4ee5\u4ece\u6587\u672c\u63d0\u53d6\u65e5\u671f\u5230\u65e5\u671f\u5b57\u6bb5\u3002\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528JanusGraph\u67e5\u8be2\u6b64\u65e5\u671f\uff0c\u800c\u4e0d\u4f1a\u5c06\u5176\u7269\u7406\u5b58\u50a8\u5728\u4e3b\u5b58\u50a8\u4e2d\u3002 - index.[X].elasticsearch.ingest-pipeline.[mixedIndexName] = pipeline_id \u6709\u5173\u6444\u53d6\u5904\u7406\u7a0b\u5e8f\u7ba1\u9053\u548c \u5904\u7406\u5668 \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u6444\u53d6\u6587\u6863 \u3002","title":"27.2.5 \u6444\u53d6\u7ba1\u9053"},{"location":"index_backends/elasticsearch/#273-elasticsearch","text":"Elasticsearch\u4e0d\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u6216\u6388\u6743\u3002Elasticsearch\u4fe1\u4efb\u53ef\u4ee5\u8fde\u63a5\u5230Elasticsearch\u7684\u5ba2\u6237\u7aef\u3002\u5f53Elasticsearch\u5728\u4e0d\u5b89\u5168\u6216\u516c\u5171\u7f51\u7edc\uff08\u5c24\u5176\u662fInternet\uff09\u4e0a\u8fd0\u884c\u65f6\uff0c\u5e94\u4f7f\u7528\u67d0\u79cd\u7c7b\u578b\u7684\u5916\u90e8\u5b89\u5168\u6027\u8fdb\u884c\u90e8\u7f72\u3002\u8fd9\u901a\u5e38\u901a\u8fc7\u9632\u706b\u5899\uff0cElasticsearch\u7aef\u53e3\u7684\u96a7\u9053\u6216\u4f7f\u7528Elasticsearch\u6269\u5c55\uff08\u5982X-Pack\uff09\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u3002Elasticsearch\u6709\u4e24\u4e2a\u9762\u5411\u5ba2\u6237\u7aef\u7684\u7aef\u53e3\u9700\u8981\u8003\u8651\uff1a - HTTP REST API\uff0c\u901a\u5e38\u5728\u7aef\u53e39200\u4e0a - \u672c\u5730\u201c\u4f20\u8f93\u201d\u534f\u8bae\uff0c\u901a\u5e38\u5728\u7aef\u53e39300\u4e0a \u5ba2\u6237\u7aef\u4f7f\u7528\u4e00\u4e2a\u534f\u8bae/\u7aef\u53e3\u6216\u53e6\u4e00\u4e2a\uff0c\u4f46\u4e0d\u80fd\u540c\u65f6\u4f7f\u7528\u3002\u4fdd\u62a4HTTP\u534f\u8bae\u7aef\u53e3\u901a\u5e38\u4f7f\u7528\u9632\u706b\u5899\u548c\u5177\u6709SSL\u52a0\u5bc6\u548cHTTP\u8eab\u4efd\u9a8c\u8bc1\u7684\u53cd\u5411\u4ee3\u7406\u7684\u7ec4\u5408\u6765\u5b8c\u6210\u3002\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5728\u672c\u673a\u201c\u4f20\u8f93\u201d\u534f\u8bae\u7aef\u53e3\u4e0a\u5b9e\u73b0\u5b89\u5168\u6027\uff1a \u9664\u6b64\u4e4b\u5916\uff0c\u4e00\u4e9b\u6258\u7ba1\u7684Elasticsearch\u670d\u52a1\u8fd8\u63d0\u4f9b\u5176\u4ed6\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u65b9\u6cd5\u3002\u4f8b\u5982\uff0cAWS Elasticsearch Service\u9700\u8981\u4f7f\u7528HTTPS\u5e76\u63d0\u4f9b\u4f7f\u7528\u57fa\u4e8eIAM\u7684\u8bbf\u95ee\u63a7\u5236\u7684\u9009\u9879\u3002\u4e3a\u6b64\uff0c\u5fc5\u987b\u7b7e\u7f72\u53d1\u9001\u5230\u6b64\u670d\u52a1\u7684\u8bf7\u6c42\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u81ea\u5b9a\u4e49\u8eab\u4efd\u9a8c\u8bc1\u5668\u6765\u5b9e\u73b0\uff08\u53c2\u89c1\u4e0a\u6587\uff09\u3002 \u96a7\u9053Elasticsearch\u7684\u672c\u5730\u201c\u4f20\u8f93\u201d\u534f\u8bae \u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u901a\u8fc7SSL / TLS\u96a7\u9053\uff08\u4f8b\u5982\u901a\u8fc7stunnel\uff09\uff0cVPN\u6216SSH\u7aef\u53e3\u8f6c\u53d1\u6765\u5b9e\u73b0\u3002SSL / TLS\u96a7\u9053\u9700\u8981\u975e\u5e38\u7b80\u5355\u7684\u8bbe\u7f6e\u548c\u76d1\u63a7\uff1a\u96a7\u9053\u7684\u4e00\u7aef\u6216\u4e24\u7aef\u9700\u8981\u8bc1\u4e66\uff0c\u5e76\u4e14\u9700\u8981\u914d\u7f6e\u5e76\u8fde\u7eed\u8fd0\u884cstunnel\u8fdb\u7a0b\u3002\u5927\u591a\u6570\u5b89\u5168VPN\u7684\u8bbe\u7f6e\u540c\u6837\u91cd\u8981\u3002\u4e00\u4e9bElasticsearch\u670d\u52a1\u63d0\u4f9b\u5546\u5904\u7406\u670d\u52a1\u5668\u7aef\u96a7\u9053\u7ba1\u7406\u5e76\u63d0\u4f9b\u81ea\u5b9a\u4e49Elasticsearch transport.type\u4ee5\u7b80\u5316\u5ba2\u6237\u7aef\u8bbe\u7f6e\u3002 \u6dfb\u52a0\u9632\u706b\u5899\u89c4\u5219\uff0c\u8be5\u89c4\u5219\u4ec5\u5141\u8bb8\u53d7\u4fe1\u4efb\u7684\u5ba2\u6237\u7aef\u5728Elasticsearch\u7684\u672c\u673a\u534f\u8bae\u7aef\u53e3\u4e0a\u8fdb\u884c\u8fde\u63a5 \u8fd9\u901a\u5e38\u5728\u4e3b\u673a\u9632\u706b\u5899\u7ea7\u522b\u5b8c\u6210\u3002\u6613\u4e8e\u914d\u7f6e\uff0c\u4f46\u672c\u8eab\u5b89\u5168\u6027\u975e\u5e38\u5dee\u3002","title":"27.3 \u5b89\u5168\u7684Elasticsearch"},{"location":"index_backends/elasticsearch/#274","text":"JanusGraph\u652f\u6301\u81ea\u5b9a\u4e49\u521b\u5efaElasticsearch\u7d22\u5f15\u65f6\u4f7f\u7528\u7684\u7d22\u5f15\u8bbe\u7f6e\u3002\u5b83\u5141\u8bb8settings\u5728JanusGraph\u53d1\u51fa\u7684Elasticsearch create index\u8bf7\u6c42\u4e2d\u8bbe\u7f6e\u5bf9\u8c61\u4e0a\u7684\u4efb\u610f\u952e\u503c\u5bf9\u3002\u4ee5\u4e0b\u662f\u53ef\u4ee5\u4f7f\u7528\u6b64\u673a\u5236\u81ea\u5b9a\u4e49\u7684Elasticsearch\u7d22\u5f15\u8bbe\u7f6e\u7684\u975e\u8be6\u5c3d\u793a\u4f8b\uff1a - index.number_of_replicas - index.number_of_shards - index.refresh_interval \u901a\u8fc7\u6b64\u673a\u5236\u81ea\u5b9a\u4e49\u7684\u8bbe\u7f6e\u4ec5\u5728JanusGraph\u5c1d\u8bd5\u5728Elasticsearch\u4e2d\u521b\u5efa\u5176\u7d22\u5f15\u65f6\u5e94\u7528\u3002\u5982\u679cJanusGraph\u53d1\u73b0\u5176\u7d22\u5f15\u5df2\u7ecf\u5b58\u5728\uff0c\u90a3\u4e48\u5b83\u4e0d\u4f1a\u5c1d\u8bd5\u91cd\u65b0\u521b\u5efa\u5b83\uff0c\u5e76\u4e14\u8fd9\u4e9b\u8bbe\u7f6e\u65e0\u6548\u3002","title":"27.4 \u7d22\u5f15\u521b\u5efa\u9009\u9879"},{"location":"index_backends/elasticsearch/#2741-elasticsearchcreateext","text":"Janusgraph\u8fed\u4ee3\u6240\u6709\u524d\u7f00\u4e3aindex.[x].elasticsearch.create.ext.\u7684\u5c5e\u6027\uff0c\u5176\u4e2d[x]\u662f\u7d22\u5f15\u540d\uff0c\u5982search\u3002\u5b83\u4ece\u6bcf\u4e2a\u5c5e\u6027\u952e\u4e2d\u53bb\u6389\u524d\u7f00\u3002\u5265\u79bb\u7684\u952e\u7684\u5176\u4f59\u90e8\u5206\u5c06\u88ab\u89e3\u91ca\u4e3aElasticSearch\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u3002\u672a\u4fee\u6539\u4e0e\u952e\u5173\u8054\u7684\u503c\u3002\u5265\u79bb\u7684\u952e\u548c\u672a\u4fee\u6539\u7684\u503c\u4f5c\u4e3aElasticSearch\u521b\u5efa\u7d22\u5f15\u8bf7\u6c42\u4e2d\u7684\u8bbe\u7f6e\u5bf9\u8c61\u7684\u4e00\u90e8\u5206\u4f20\u9012\uff0c\u8be5\u8bf7\u6c42\u662fJanusgraph\u5728ElasticSearch\u4e0a\u5f15\u5bfc\u65f6\u53d1\u51fa\u7684\u3002\u8fd9\u5141\u8bb8\u5728Janusgraph\u7684\u5c5e\u6027\u4e2d\u5d4c\u5165\u4efb\u610f\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u914d\u7f6e\u7247\u6bb5\u793a\u4f8b\uff0c\u5b83\u4f7f\u7528create.ext\u914d\u7f6e\u673a\u5236\u81ea\u5b9a\u4e49\u4e09\u4e2aElasticSearch\u7d22\u5f15\u8bbe\u7f6e\uff1a index.search.backend=elasticsearch index.search.elasticsearch.create.ext.number_of_shards=15 index.search.elasticsearch.create.ext.number_of_replicas=3 index.search.elasticsearch.create.ext.shard.check_on_startup=true \u4e0a\u9762\u5217\u51fa\u7684\u914d\u7f6e\u7247\u6bb5\u5229\u7528\u4e86Elasticsearch\u5728\u670d\u52a1\u5668\u7aef\u5b9e\u73b0\u7684\u5047\u8bbe\uff0c\u5373\u4e0d\u5408\u683c\u7684create index\u8bbe\u7f6e\u5bc6\u94a5\u5177\u6709index.\u524d\u7f00\u3002\u4e5f\u53ef\u4ee5\u660e\u786e\u5730\u62fc\u51fa\u7d22\u5f15\u524d\u7f00\u3002\u8fd9\u662f\u4e00\u4e2aJanusGraph\u914d\u7f6e\u6587\u4ef6\uff0c\u529f\u80fd\u4e0a\u4e0e\u4e0a\u9762\u5217\u51fa\u7684\u76f8\u540c\uff0c\u53ea\u662findex.\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u524d\u7684\u524d\u7f00\u662f\u663e\u5f0f\u7684\uff1a index.search.backend=elasticsearch index.search.elasticsearch.create.ext.index.number_of_shards=15 index.search.elasticsearch.create.ext.index.number_of_replicas=3 index.search.elasticsearch.create.ext.index.shard.check_on_startup=false \u63d0\u793a create.ext\u6307\u5b9a\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6e\u7684\u673a\u5236\u4e0eJanusGraph\u7684Elasticsearch\u914d\u7f6e\u517c\u5bb9\u3002","title":"27.4.1 \u5d4c\u5165Elasticsearch\u7d22\u5f15\u521b\u5efa\u8bbe\u7f6ecreate.ext"},{"location":"index_backends/elasticsearch/#275","text":"","title":"27.5 \u6545\u969c\u6392\u9664"},{"location":"index_backends/elasticsearch/#2751-elasticsearch","text":"\u68c0\u67e5\u6765\u81eaJanusGraph\u8282\u70b9\u7684HTTP\u534f\u8bae\u7aef\u53e3\u4e0a\u662f\u5426\u53ef\u4ee5\u8bbf\u95eeElasticsearch\u96c6\u7fa4\u8282\u70b9\u3002\u901a\u8fc7\u68c0\u67e5Elasticsearch\u8282\u70b9\u914d\u7f6e\u65e5\u5fd7\u6216\u4f7f\u7528\u5e38\u89c4\u8bca\u65ad\u5b9e\u7528\u7a0b\u5e8fnetstat\u6765\u68c0\u67e5\u8282\u70b9\u4fa6\u542c\u7aef\u53e3\u3002\u68c0\u67e5JanusGraph\u914d\u7f6e\u3002","title":"27.5.1 \u8fde\u63a5\u5230\u8fdc\u7a0bElasticsearch\u96c6\u7fa4\u95ee\u9898"},{"location":"index_backends/elasticsearch/#276-elasticsearch","text":"","title":"27.6 \u4f18\u5316Elasticsearch"},{"location":"index_backends/elasticsearch/#2761","text":"\u5bf9\u4e8e \u6279\u91cf\u52a0\u8f7d \u6216\u5176\u4ed6\u5199\u5165\u5bc6\u96c6\u578b\u5e94\u7528\u7a0b\u5e8f\uff0c\u8bf7\u8003\u8651\u589e\u52a0Elasticsearch\u7684\u5237\u65b0\u95f4\u9694\u3002\u8bf7\u53c2\u9605 \u6b64\u8ba8\u8bba \uff0c\u4e86\u89e3\u5982\u4f55\u589e\u52a0\u5237\u65b0\u95f4\u9694\u53ca\u5176\u5bf9\u5199\u5165\u6027\u80fd\u7684\u5f71\u54cd\u3002\u8bf7\u6ce8\u610f\uff0c\u66f4\u9ad8\u7684\u5237\u65b0\u95f4\u9694\u610f\u5473\u7740\u56fe\u5f62\u7a81\u53d8\u5728\u7d22\u5f15\u4e2d\u53ef\u7528\u7684\u65f6\u95f4\u66f4\u957f\u3002 \u6709\u5173\u5982\u4f55\u5728Elasticsearch\u4e2d\u63d0\u9ad8\u5199\u5165\u6027\u80fd\u7684\u5176\u4ed6\u5efa\u8bae\u4ee5\u53ca\u8be6\u7ec6\u8bf4\u660e\uff0c\u8bf7\u9605\u8bfb \u6b64\u535a\u5ba2\u6587\u7ae0 \u3002","title":"27.6.1 \u5199\u4f18\u5316"},{"location":"index_backends/elasticsearch/#2762","text":"\u6709\u5173Elasticsearch\u4ee5\u53ca\u5982\u4f55\u8bbe\u7f6eElasticsearch\u96c6\u7fa4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Elasticsearch\u4e3b\u9875\u548c\u53ef\u7528\u6587\u6863\u3002","title":"27.6.2 \u8fdb\u4e00\u6b65\u9605\u8bfb"},{"location":"index_backends/field_mapping/","text":"\u7b2c25\u7ae0 \u5b57\u6bb5\u6620\u5c04 25.1 \u5355\u4e2a\u5b57\u6bb5\u6620\u5c04 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u5c06\u5bf9\u5c5e\u6027\u952e\u8fdb\u884c\u7f16\u7801\uff0c\u4ee5\u4fbf\u4e3a\u6df7\u5408\u7d22\u5f15\u4e2d\u7684\u5c5e\u6027\u952e\u751f\u6210\u552f\u4e00\u7684\u5b57\u6bb5\u540d\u79f0\u3002\u5982\u679c\u60f3\u8981\u5728\u5916\u90e8\u7d22\u5f15\u540e\u7aef\u76f4\u63a5\u67e5\u8be2\u6df7\u5408\u7d22\u5f15\uff0c\u5219\u540e\u7aef\u5f88\u96be\u5904\u7406\u5e76\u4e14\u96be\u4ee5\u8fa8\u8ba4\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u663e\u5f0f\u6307\u5b9a\u5b57\u6bb5\u540d\u79f0\u3002 mgmt = graph.openManagement() name = mgmt.makePropertyKey('bookname').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(name, Parameter.of('mapped-name', 'bookname')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u5c06\u6b64\u5b57\u6bb5\u6620\u5c04\u5b9a\u4e49\u4e3a\u53c2\u6570\uff0cJanusGraph\u5c06\u4f7f\u7528\u4e0ebooksBySummary\u5916\u90e8\u7d22\u5f15\u7cfb\u7edf\u4e2d\u521b\u5efa\u7684\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u76f8\u540c\u7684\u540d\u79f0\u4f5c\u4e3a\u5c5e\u6027\u952e\u3002\u8bf7\u6ce8\u610f\uff0c\u5fc5\u987b\u786e\u4fdd\u7ed9\u5b9a\u7684\u5b57\u6bb5\u540d\u79f0\u5728\u7d22\u5f15\u4e2d\u662f\u552f\u4e00\u7684\u3002 25.2 \u5168\u5c40\u5b57\u6bb5\u6620\u5c04 \u53ef\u4ee5\u6307\u793aJanusGraph\u59cb\u7ec8\u5c06\u5916\u90e8\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u8bbe\u7f6e\u4e3a\u4e0e\u5c5e\u6027\u952e\u540d\u79f0\u76f8\u540c\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u8c03\u6574\u6dfb\u52a0\u5230\u6df7\u5408\u7d22\u5f15\u7684\u6bcf\u4e2a\u952e\u7684\u5b57\u6bb5\u6620\u5c04\u3002\u8fd9\u662f\u901a\u8fc7\u542f\u7528map-name\u4e3a\u6bcf\u4e2a\u7d22\u5f15\u540e\u7aef\u914d\u7f6e\u7684\u914d\u7f6e\u9009\u9879\u6765\u5b8c\u6210\u7684\u3002\u5982\u679c\u4e3a\u7279\u5b9a\u7d22\u5f15\u540e\u7aef\u542f\u7528\u6b64\u9009\u9879\uff0c\u5219\u9488\u5bf9\u6240\u8ff0\u540e\u7aef\u5b9a\u4e49\u7684\u6240\u6709\u6df7\u5408\u7d22\u5f15\u5c06\u4f7f\u7528\u4e0e\u5c5e\u6027\u952e\u540d\u79f0\u76f8\u540c\u7684\u5b57\u6bb5\u540d\u79f0\u3002 \u4f46\u662f\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6709\u4e24\u4e2a\u9650\u5236\uff1a1\uff09\u7528\u6237\u5fc5\u987b\u786e\u4fdd\u5c5e\u6027\u952e\u540d\u79f0\u662f\u7d22\u5f15\u540e\u7aef\u7684\u6709\u6548\u5b57\u6bb5\u540d\u79f0\uff0c2\uff09\u91cd\u547d\u540d\u5c5e\u6027\u952e\u4e0d\u4f1a\u91cd\u547d\u540d\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u547d\u540d\u51b2\u7a81\uff0c\u7528\u6237\u5fc5\u987b\u77e5\u9053\u5e76\u907f\u514d\u3002 25.2.1 \u5b9a\u5236\u5206\u6790\u5668 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u5c06\u4f7f\u7528\u7d22\u5f15\u540e\u7aef\u7684\u9ed8\u8ba4\u5206\u6790\u5668\u6765\u83b7\u53d6Mapping.TEXT\u7684\u5c5e\u6027\uff0c\u800c\u4e0d\u4f7f\u7528Mapping.STRING\u5c5e\u6027\u7684\u5206\u6790\u5668\u3002\u5982\u679c\u60f3\u8981\u4f7f\u7528\u53e6\u4e00\u4e2a\u5206\u6790\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u663e\u5f0f\u6307\u5b9a\uff1aMapping.TEXT\u7684ParameterType.TEXT_ANALYZER\u548cMapping.STRING\u7684ParameterType.STRING_ANALYZER\u3002 25.2.1.1 \u5bf9\u4e8eElasticsearch \u5fc5\u987b\u5c06\u5206\u6790\u4eea\u7684\u540d\u79f0\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c\u3002 mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() textString = mgmt.makePropertyKey('textString').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'standard')).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'english')).buildMixedIndex( search ) mgmt.buildIndex('textString', Vertex.class).addKey(text, Mapping.TEXTSTRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'standard'), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'english')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\u7684\u6807\u51c6\u5206\u6790\u5668\u548c\u5c5e\u6027\u952e\u6587\u672c\u7684\u82f1\u8bed\u5206\u6790\u5668\u3002 25.2.1.2 \u5bf9\u4e8esolr \u5fc5\u987b\u5c06tokenizer\u7684\u7c7b\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'org.apache.lucene.analysis.standard.StandardTokenizer')).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'org.apache.lucene.analysis.core.WhitespaceTokenizer')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\u7684\u6807\u51c6\u6807\u8bb0\u5316\u5668\u548c\u5c5e\u6027\u952e\u6587\u672c\u7684\u7a7a\u767d\u6807\u8bb0\u5668\u3002 25.2.1.2 \u5bf9\u4e8eLucene \u5fc5\u987b\u5c06\u5206\u6790\u5668\u7684\u540d\u79f0\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c\uff0c\u6216\u8005\u9ed8\u8ba4\u4e3aMapping.STRING\u7684KeywordAnalyzer\u548cMapping.TEXT\u7684StandardAnalyzer\u3002 mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() name = mgmt.makePropertyKey('name').dataType(String.class).make() document = mgmt.makePropertyKey('document').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), org.apache.lucene.analysis.core.SimpleAnalyzer.class.getName())).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), org.apache.lucene.analysis.en.EnglishAnalyzer.class.getName())).buildMixedIndex( search ) mgmt.buildIndex('name', Vertex.class).addKey(string, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.buildIndex('document', Vertex.class).addKey(text, Mapping.TEXT.asParameter()).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528SimpleAnalyzer\u5206\u6790\u5668\u4f5c\u4e3a\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528EnglishAnalyzer \u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u952e\u6587\u672c\uff0c\u4f7f\u7528KeywordAnalyzer\u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u540d\u79f0\uff0c\u4f7f\u7528StandardAnalyzer\u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u6587\u6863\u3002 25.2.2 \u81ea\u5b9a\u4e49\u53c2\u6570 \u6709\u65f6\u9700\u8981\u5728\u6620\u5c04\u4e0a\u8bbe\u7f6e\u5176\u4ed6\u53c2\u6570\uff08\u6620\u5c04\u7c7b\u578b\uff0c\u6620\u5c04\u540d\u79f0\u548c\u5206\u6790\u5668\u9664\u5916\uff09\u3002\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u4e0d\u540c\u7684\u76f8\u4f3c\u5ea6\u7b97\u6cd5\uff08\u4fee\u6539\u5168\u6587\u641c\u7d22\u7684\u8bc4\u5206\u7b97\u6cd5\uff09\u6216\u8005\u5982\u679c\u6211\u4eec\u60f3\u5728Elasticsearch\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\u4e0a\u4f7f\u7528\u81ea\u5b9a\u4e49\u63d0\u5347\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u53c2\u6570\uff08\u73b0\u5728\u53ea\u6709Elasticsearch\u652f\u6301\u81ea\u5b9a\u4e49\u53c2\u6570\uff09\u3002\u5fc5\u987b\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u53c2\u6570\u7684\u540d\u79f0ParameterType.customParameterName(\"yourProperty\")\u3002 25.2.2.1 \u5bf9\u4e8eElasticsearch mgmt = graph.openManagement() myProperty = mgmt.makePropertyKey('my_property').dataType(String.class).make() mgmt.buildIndex('custom_property_test', Vertex.class).addKey(myProperty, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.customParameterName( boost ), 5), Parameter.of(ParameterType.customParameterName( similarity ), boolean )).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952emy_property\u7684boost 5\u548c\u5e03\u5c14\u76f8\u4f3c\u6027\u7b97\u6cd5\u3002\u53ef\u80fd\u7684\u6620\u5c04\u53c2\u6570\u53d6\u51b3\u4e8eElasticsearch\u7248\u672c\u3002\u8bf7\u53c2\u9605\u5f53\u524dElasticsearch\u7248\u672c\u7684\u6620\u5c04\u53c2\u6570\u3002","title":"25.\u5b57\u6bb5\u6620\u5c04"},{"location":"index_backends/field_mapping/#25","text":"","title":"\u7b2c25\u7ae0 \u5b57\u6bb5\u6620\u5c04"},{"location":"index_backends/field_mapping/#251","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u5c06\u5bf9\u5c5e\u6027\u952e\u8fdb\u884c\u7f16\u7801\uff0c\u4ee5\u4fbf\u4e3a\u6df7\u5408\u7d22\u5f15\u4e2d\u7684\u5c5e\u6027\u952e\u751f\u6210\u552f\u4e00\u7684\u5b57\u6bb5\u540d\u79f0\u3002\u5982\u679c\u60f3\u8981\u5728\u5916\u90e8\u7d22\u5f15\u540e\u7aef\u76f4\u63a5\u67e5\u8be2\u6df7\u5408\u7d22\u5f15\uff0c\u5219\u540e\u7aef\u5f88\u96be\u5904\u7406\u5e76\u4e14\u96be\u4ee5\u8fa8\u8ba4\u3002\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u663e\u5f0f\u6307\u5b9a\u5b57\u6bb5\u540d\u79f0\u3002 mgmt = graph.openManagement() name = mgmt.makePropertyKey('bookname').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(name, Parameter.of('mapped-name', 'bookname')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u5c06\u6b64\u5b57\u6bb5\u6620\u5c04\u5b9a\u4e49\u4e3a\u53c2\u6570\uff0cJanusGraph\u5c06\u4f7f\u7528\u4e0ebooksBySummary\u5916\u90e8\u7d22\u5f15\u7cfb\u7edf\u4e2d\u521b\u5efa\u7684\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u76f8\u540c\u7684\u540d\u79f0\u4f5c\u4e3a\u5c5e\u6027\u952e\u3002\u8bf7\u6ce8\u610f\uff0c\u5fc5\u987b\u786e\u4fdd\u7ed9\u5b9a\u7684\u5b57\u6bb5\u540d\u79f0\u5728\u7d22\u5f15\u4e2d\u662f\u552f\u4e00\u7684\u3002","title":"25.1 \u5355\u4e2a\u5b57\u6bb5\u6620\u5c04"},{"location":"index_backends/field_mapping/#252","text":"\u53ef\u4ee5\u6307\u793aJanusGraph\u59cb\u7ec8\u5c06\u5916\u90e8\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u8bbe\u7f6e\u4e3a\u4e0e\u5c5e\u6027\u952e\u540d\u79f0\u76f8\u540c\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u8c03\u6574\u6dfb\u52a0\u5230\u6df7\u5408\u7d22\u5f15\u7684\u6bcf\u4e2a\u952e\u7684\u5b57\u6bb5\u6620\u5c04\u3002\u8fd9\u662f\u901a\u8fc7\u542f\u7528map-name\u4e3a\u6bcf\u4e2a\u7d22\u5f15\u540e\u7aef\u914d\u7f6e\u7684\u914d\u7f6e\u9009\u9879\u6765\u5b8c\u6210\u7684\u3002\u5982\u679c\u4e3a\u7279\u5b9a\u7d22\u5f15\u540e\u7aef\u542f\u7528\u6b64\u9009\u9879\uff0c\u5219\u9488\u5bf9\u6240\u8ff0\u540e\u7aef\u5b9a\u4e49\u7684\u6240\u6709\u6df7\u5408\u7d22\u5f15\u5c06\u4f7f\u7528\u4e0e\u5c5e\u6027\u952e\u540d\u79f0\u76f8\u540c\u7684\u5b57\u6bb5\u540d\u79f0\u3002 \u4f46\u662f\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6709\u4e24\u4e2a\u9650\u5236\uff1a1\uff09\u7528\u6237\u5fc5\u987b\u786e\u4fdd\u5c5e\u6027\u952e\u540d\u79f0\u662f\u7d22\u5f15\u540e\u7aef\u7684\u6709\u6548\u5b57\u6bb5\u540d\u79f0\uff0c2\uff09\u91cd\u547d\u540d\u5c5e\u6027\u952e\u4e0d\u4f1a\u91cd\u547d\u540d\u7d22\u5f15\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u547d\u540d\u51b2\u7a81\uff0c\u7528\u6237\u5fc5\u987b\u77e5\u9053\u5e76\u907f\u514d\u3002","title":"25.2 \u5168\u5c40\u5b57\u6bb5\u6620\u5c04"},{"location":"index_backends/field_mapping/#2521","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u5c06\u4f7f\u7528\u7d22\u5f15\u540e\u7aef\u7684\u9ed8\u8ba4\u5206\u6790\u5668\u6765\u83b7\u53d6Mapping.TEXT\u7684\u5c5e\u6027\uff0c\u800c\u4e0d\u4f7f\u7528Mapping.STRING\u5c5e\u6027\u7684\u5206\u6790\u5668\u3002\u5982\u679c\u60f3\u8981\u4f7f\u7528\u53e6\u4e00\u4e2a\u5206\u6790\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u663e\u5f0f\u6307\u5b9a\uff1aMapping.TEXT\u7684ParameterType.TEXT_ANALYZER\u548cMapping.STRING\u7684ParameterType.STRING_ANALYZER\u3002","title":"25.2.1 \u5b9a\u5236\u5206\u6790\u5668"},{"location":"index_backends/field_mapping/#25211-elasticsearch","text":"\u5fc5\u987b\u5c06\u5206\u6790\u4eea\u7684\u540d\u79f0\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c\u3002 mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() textString = mgmt.makePropertyKey('textString').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'standard')).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'english')).buildMixedIndex( search ) mgmt.buildIndex('textString', Vertex.class).addKey(text, Mapping.TEXTSTRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'standard'), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'english')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\u7684\u6807\u51c6\u5206\u6790\u5668\u548c\u5c5e\u6027\u952e\u6587\u672c\u7684\u82f1\u8bed\u5206\u6790\u5668\u3002","title":"25.2.1.1 \u5bf9\u4e8eElasticsearch"},{"location":"index_backends/field_mapping/#25212-solr","text":"\u5fc5\u987b\u5c06tokenizer\u7684\u7c7b\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), 'org.apache.lucene.analysis.standard.StandardTokenizer')).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), 'org.apache.lucene.analysis.core.WhitespaceTokenizer')).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\u7684\u6807\u51c6\u6807\u8bb0\u5316\u5668\u548c\u5c5e\u6027\u952e\u6587\u672c\u7684\u7a7a\u767d\u6807\u8bb0\u5668\u3002","title":"25.2.1.2 \u5bf9\u4e8esolr"},{"location":"index_backends/field_mapping/#25212-lucene","text":"\u5fc5\u987b\u5c06\u5206\u6790\u5668\u7684\u540d\u79f0\u8bbe\u7f6e\u4e3a\u53c2\u6570\u503c\uff0c\u6216\u8005\u9ed8\u8ba4\u4e3aMapping.STRING\u7684KeywordAnalyzer\u548cMapping.TEXT\u7684StandardAnalyzer\u3002 mgmt = graph.openManagement() string = mgmt.makePropertyKey('string').dataType(String.class).make() text = mgmt.makePropertyKey('text').dataType(String.class).make() name = mgmt.makePropertyKey('name').dataType(String.class).make() document = mgmt.makePropertyKey('document').dataType(String.class).make() mgmt.buildIndex('string', Vertex.class).addKey(string, Mapping.STRING.asParameter(), Parameter.of(ParameterType.STRING_ANALYZER.getName(), org.apache.lucene.analysis.core.SimpleAnalyzer.class.getName())).buildMixedIndex( search ) mgmt.buildIndex('text', Vertex.class).addKey(text, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.TEXT_ANALYZER.getName(), org.apache.lucene.analysis.en.EnglishAnalyzer.class.getName())).buildMixedIndex( search ) mgmt.buildIndex('name', Vertex.class).addKey(string, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.buildIndex('document', Vertex.class).addKey(text, Mapping.TEXT.asParameter()).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528SimpleAnalyzer\u5206\u6790\u5668\u4f5c\u4e3a\u5c5e\u6027\u952e\u5b57\u7b26\u4e32\uff0c\u4f7f\u7528EnglishAnalyzer \u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u952e\u6587\u672c\uff0c\u4f7f\u7528KeywordAnalyzer\u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u540d\u79f0\uff0c\u4f7f\u7528StandardAnalyzer\u5206\u6790\u5668\u83b7\u53d6\u5c5e\u6027\u6587\u6863\u3002","title":"25.2.1.2 \u5bf9\u4e8eLucene"},{"location":"index_backends/field_mapping/#2522","text":"\u6709\u65f6\u9700\u8981\u5728\u6620\u5c04\u4e0a\u8bbe\u7f6e\u5176\u4ed6\u53c2\u6570\uff08\u6620\u5c04\u7c7b\u578b\uff0c\u6620\u5c04\u540d\u79f0\u548c\u5206\u6790\u5668\u9664\u5916\uff09\u3002\u4f8b\u5982\uff0c\u5f53\u6211\u4eec\u60f3\u8981\u4f7f\u7528\u4e0d\u540c\u7684\u76f8\u4f3c\u5ea6\u7b97\u6cd5\uff08\u4fee\u6539\u5168\u6587\u641c\u7d22\u7684\u8bc4\u5206\u7b97\u6cd5\uff09\u6216\u8005\u5982\u679c\u6211\u4eec\u60f3\u5728Elasticsearch\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\u4e0a\u4f7f\u7528\u81ea\u5b9a\u4e49\u63d0\u5347\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u53c2\u6570\uff08\u73b0\u5728\u53ea\u6709Elasticsearch\u652f\u6301\u81ea\u5b9a\u4e49\u53c2\u6570\uff09\u3002\u5fc5\u987b\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u53c2\u6570\u7684\u540d\u79f0ParameterType.customParameterName(\"yourProperty\")\u3002","title":"25.2.2 \u81ea\u5b9a\u4e49\u53c2\u6570"},{"location":"index_backends/field_mapping/#25221-elasticsearch","text":"mgmt = graph.openManagement() myProperty = mgmt.makePropertyKey('my_property').dataType(String.class).make() mgmt.buildIndex('custom_property_test', Vertex.class).addKey(myProperty, Mapping.TEXT.asParameter(), Parameter.of(ParameterType.customParameterName( boost ), 5), Parameter.of(ParameterType.customParameterName( similarity ), boolean )).buildMixedIndex( search ) mgmt.commit() \u901a\u8fc7\u8fd9\u4e9b\u8bbe\u7f6e\uff0cJanusGraph\u5c06\u4f7f\u7528\u5c5e\u6027\u952emy_property\u7684boost 5\u548c\u5e03\u5c14\u76f8\u4f3c\u6027\u7b97\u6cd5\u3002\u53ef\u80fd\u7684\u6620\u5c04\u53c2\u6570\u53d6\u51b3\u4e8eElasticsearch\u7248\u672c\u3002\u8bf7\u53c2\u9605\u5f53\u524dElasticsearch\u7248\u672c\u7684\u6620\u5c04\u53c2\u6570\u3002","title":"25.2.2.1 \u5bf9\u4e8eElasticsearch"},{"location":"index_backends/index_parameters_and_full-text_search/","text":"24 \u7d22\u5f15\u53c2\u6570\u548c\u5168\u6587\u68c0\u7d22 \u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u53ef\u4ee5\u4e3a\u6dfb\u52a0\u5230\u7d22\u5f15\u7684\u6bcf\u4e2a\u5c5e\u6027\u952e\u9009\u62e9\u6027\u5730\u6307\u5b9a\u53c2\u6570\u5217\u8868\u3002 \u8fd9\u4e9b\u53c2\u6570\u63a7\u5236\u7279\u5b9a\u952e\u7684\u7d22\u5f15\u65b9\u5f0f\u3002JanusGraph\u8bc6\u522b\u4ee5\u4e0b\u7d22\u5f15\u53c2\u6570\u3002 \u662f\u5426\u652f\u6301\u8fd9\u4e9b\u53d6\u51b3\u4e8e\u914d\u7f6e\u7684\u7d22\u5f15\u540e\u7aef\u3002 \u9664\u4e86\u6b64\u5904\u5217\u51fa\u7684\u53c2\u6570\u4e4b\u5916\uff0c\u7279\u5b9a\u7d22\u5f15\u540e\u7aef\u8fd8\u53ef\u80fd\u652f\u6301\u81ea\u5b9a\u4e49\u53c2\u6570\u3002 24.1 \u5168\u6587\u68c0\u7d22 \u7d22\u5f15\u5b57\u7b26\u4e32\u503c\uff08\u5373\u5177\u6709String.class\u6570\u636e\u7c7b\u578b\u7684\u5c5e\u6027\u952e\uff09\u65f6\uff0c \u53ef\u4ee5\u9009\u62e9\u5c06\u8fd9\u4e9b\u503c\u7d22\u5f15\u4e3a\u7531mapping\u53c2\u6570\u7c7b\u578b\u63a7\u5236\u7684\u6587\u672c\u6216\u5b57\u7b26\u4e32\u3002 \u5f53\u8be5\u503c\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u8be5\u5b57\u7b26\u4e32\u88ab\u6807\u8bb0\u4e3a\u4e00\u4e2a\u5355\u8bcd\u5305\uff0c \u5176\u5141\u8bb8\u7528\u6237\u6709\u6548\u5730\u67e5\u8be2\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd\u7684\u6240\u6709\u5339\u914d\u3002 \u8fd9\u901a\u5e38\u79f0\u4e3a\u5168\u6587\u641c\u7d22\u3002\u5f53\u8be5\u503c\u88ab\u7d22\u5f15\u4e3a\u5b57\u7b26\u4e32\u65f6\uff0c \u8be5\u5b57\u7b26\u4e32\u662f\u7d22\u5f15\u201cas-is\u201d\u800c\u6ca1\u6709\u4efb\u4f55\u8fdb\u4e00\u6b65\u7684\u5206\u6790\u6216\u6807\u8bb0\u5316\u3002 \u8fd9\u6709\u52a9\u4e8e\u67e5\u8be2\u7cbe\u786e\u7684\u5b57\u7b26\u5e8f\u5217\u5339\u914d\u3002\u8fd9\u901a\u5e38\u79f0\u4e3a\u5b57\u7b26\u4e32\u641c\u7d22\u3002 24.1.1 \u5168\u6587\u68c0\u7d22 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u3002\u8981\u4f7f\u6b64\u7d22\u5f15\u9009\u9879\u663e\u5f0f\uff0c\u53ef\u4ee5\u5728\u5c06\u5c5e\u6027\u952e\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\u5b9a\u4e49\u6620\u5c04\u3002 mgmt = graph.openManagement() summary = mgmt.makePropertyKey('booksummary').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(summary, Mapping.TEXT.asParameter()).buildMixedIndex( search ) mgmt.commit() \u8fd9\u4e0e\u6807\u51c6\u7684\u6df7\u5408\u7d22\u5f15\u5b9a\u4e49\u76f8\u540c\uff0c\u53ea\u6dfb\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684\u53c2\u6570\u6765\u6307\u5b9a\u7d22\u5f15\u4e2d\u7684\u6620\u5c04 - \u5728\u672c\u4f8b\u4e2dMapping.TEXT\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u5b57\u7b26\u4e32\u503c\u88ab\u6807\u8bb0\u5316\u4e3a\u4e00\u5305\u4ee4\u724c\u3002 \u786e\u5207\u7684\u6807\u8bb0\u5316\u53d6\u51b3\u4e8e\u7d22\u5f15\u540e\u7aef\u53ca\u5176\u914d\u7f6e\u3002JanusGraph\u7684\u9ed8\u8ba4\u6807\u8bb0\u5316\u5c06\u5b57\u7b26\u4e32\u62c6\u5206\u4e3a\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\uff0c \u5e76\u5220\u9664\u5c11\u4e8e2\u4e2a\u5b57\u7b26\u7684\u4efb\u4f55\u6807\u8bb0\u3002\u7d22\u5f15\u540e\u7aef\u4f7f\u7528\u7684\u6807\u8bb0\u5316\u53ef\u80fd\u4e0d\u540c\uff08\u4f8b\u5982\uff0c\u5220\u9664\u4e86\u505c\u7528\u8bcd\uff09\uff0c \u8fd9\u53ef\u80fd\u5bfc\u81f4\u5728\u4e8b\u52a1\u5185\u90e8\u7684\u4fee\u6539\u548c\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u5df2\u63d0\u4ea4\u6570\u636e\u5904\u7406\u5168\u6587\u641c\u7d22\u67e5\u8be2\u7684\u65b9\u5f0f\u65b9\u9762\u5b58\u5728\u7ec6\u5fae\u5dee\u522b\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u7d22\u5f15\u540e\u7aef\u4ec5\u5728\u56fe\u5f62\u67e5\u8be2\u4e2d\u652f\u6301\u5168\u6587\u641c\u7d22\u8c13\u8bcd\u3002\u5168\u6587\u641c\u7d22\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002 textContains\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5219\u4e3atrue textContainsPrefix\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4ee5\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u5219\u4e3atrue textContainsRegex\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u4e3atrue textContainsFuzzy\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u4f3c\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09\uff0c\u5219\u4e3atrue import static org.janusgraph.core.attribute.Text.* g.V().has('booksummary', textContains('unicorns')) g.V().has('booksummary', textContainsPrefix('uni')) g.V().has('booksummary', textContainsRegex('.*corn.*')) g.V().has('booksummary', textContainsFuzzy('unicorn')) \u5b57\u7b26\u4e32\u641c\u7d22\u8c13\u8bcd\uff08\u89c1\u4e0b\u6587\uff09\u53ef\u7528\u4e8e\u67e5\u8be2\uff0c\u4f46\u90a3\u9700\u8981\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u8fd9\u53ef\u80fd\u975e\u5e38\u6602\u8d35\u3002 24.1.2 \u5b57\u7b26\u4e32\u641c\u7d22 \u8981\u5c06\u5b57\u7b26\u4e32\u5c5e\u6027\u7d22\u5f15\u4e3a\u5b57\u7b26\u5e8f\u5217\u800c\u4e0d\u8fdb\u884c\u4efb\u4f55\u5206\u6790\u6216\u6807\u8bb0\u5316\uff0c\u8bf7\u5c06\u6620\u5c04\u6307\u5b9a\u4e3aMapping.STRING\uff1a mgmt = graph.openManagement() name = mgmt.makePropertyKey('bookname').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(name, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.commit() \u914d\u7f6e\u5b57\u7b26\u4e32\u6620\u5c04\u540e\uff0c\u5b57\u7b26\u4e32\u503c\u5c06\u88ab\u7f16\u5165\u7d22\u5f15\uff0c\u5e76\u4e14\u53ef\u4ee5\u201cas-is\u201d\u67e5\u8be2 ,\u5305\u62ec\u505c\u7528\u8bcd\u548c\u975e\u5b57\u6bcd\u5b57\u7b26\u3002\u4f46\u662f\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u5fc5\u987b\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\u503c\u3002 \u56e0\u6b64\uff0c\u5728\u7d22\u5f15\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u4ee4\u724c\u7684\u77ed\u5b57\u7b26\u5e8f\u5217\u65f6\uff0c\u5b57\u7b26\u4e32\u6620\u5c04\u5f88\u6709\u7528\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u5b57\u7b26\u4e32\u65f6\uff0c\u7d22\u5f15\u540e\u7aef\u5728\u56fe\u5f62\u67e5\u8be2\u4e2d\u4ec5\u652f\u6301\u4ee5\u4e0b\u8c13\u8bcd\u3002\u5b57\u7b26\u4e32\u641c\u7d22\u533a\u5206\u5927\u5c0f\u5199\u3002 eq\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u540c neq\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u540c\u4e8e\u67e5\u8be2\u5b57\u7b26\u4e32 textPrefix\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4ee5\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934 textRegex\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5b8c\u5168\u5339\u914d textFuzzy\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u7c7b\u4f3c\u4e8e\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09 import static org.apache.tinkerpop.gremlin.process.traversal.P.* import static org.janusgraph.core.attribute.Text.* g.V().has('bookname', eq('unicorns')) g.V().has('bookname', neq('unicorns')) g.V().has('bookname', textPrefix('uni')) g.V().has('bookname', textRegex('.*corn.*')) g.V().has('bookname', textFuzzy('unicorn')) \u53ef\u4ee5\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528\u5168\u6587\u641c\u7d22\u8c13\u8bcd\uff0c\u4f46\u662f\u90a3\u4e9b\u9700\u8981\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u8fd9\u53ef\u80fd\u662f\u975e\u5e38\u6602\u8d35\u7684\u3002 24.1.3 \u5168\u6587\u548c\u5b57\u7b26\u4e32\u641c\u7d22 \u5982\u679c\u60a8\u4f7f\u7528Elasticsearch\uff0c\u5219\u53ef\u4ee5\u5c06\u5c5e\u6027\u7d22\u5f15\u4e3a\u6587\u672c\u548c\u5b57\u7b26\u4e32\uff0c\u4ece\u800c\u5141\u8bb8\u60a8\u4f7f\u7528\u6240\u6709\u8c13\u8bcd\u8fdb\u884c\u7cbe\u786e\u5339\u914d\u548c\u6a21\u7cca\u5339\u914d\u3002 mgmt = graph.openManagement() summary = mgmt.makePropertyKey('booksummary').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(summary, Mapping.TEXTSTRING.asParameter()).buildMixedIndex( search ) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u6570\u636e\u5c06\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\u4e24\u6b21\uff0c\u4e00\u6b21\u7528\u4e8e\u7cbe\u786e\u5339\u914d\uff0c\u4e00\u6b21\u7528\u4e8e\u6a21\u7cca\u5339\u914d\u3002 24.2 \u5730\u7406\u6620\u5c04 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u652f\u6301\u4f7f\u7528\u70b9\u7c7b\u578b\u7d22\u5f15\u5730\u7406\u5c5e\u6027\u5e76\u901a\u8fc7\u5706\u6216\u6846\u67e5\u8be2\u5730\u7406\u5c5e\u6027\u3002 \u8981\u7d22\u5f15\u652f\u6301\u6309\u4efb\u4f55\u5730\u7406\u4f4d\u7f6e\u7c7b\u578b\u67e5\u8be2\u7684\u975e\u70b9\u5730\u7406\u5c5e\u6027\uff0c\u8bf7\u5c06\u6620\u5c04\u6307\u5b9a\u4e3aMapping.PREFIX_TREE\uff1a mgmt = graph.openManagement() name = mgmt.makePropertyKey('border').dataType(Geoshape.class).make() mgmt.buildIndex('borderIndex', Vertex.class).addKey(name, Mapping.PREFIX_TREE.asParameter()).buildMixedIndex( search ) mgmt.commit() \u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u53c2\u6570\u6765\u8c03\u6574\u57fa\u7840\u524d\u7f00\u6811\u6620\u5c04\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u53ef\u9009\u53c2\u6570\u5305\u62ec\u524d\u7f00\u6811\u4e2d\u4f7f\u7528\u7684\u7ea7\u522b\u6570\u4ee5\u53ca\u76f8\u5173\u7684\u7cbe\u5ea6\u3002 mgmt = graph.openManagement() name = mgmt.makePropertyKey('border').dataType(Geoshape.class).make() mgmt.buildIndex('borderIndex', Vertex.class).addKey(name, Mapping.PREFIX_TREE.asParameter(), Parameter.of( index-geo-max-levels , 18), Parameter.of( index-geo-dist-error-pct , 0.0125)).buildMixedIndex( search ) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u67d0\u4e9b\u7d22\u5f15\u540e\u7aef\uff08\u4f8b\u5982Solr\uff09\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u5916\u90e8\u67b6\u6784\u914d\u7f6e\u6765\u652f\u6301\u548c\u8c03\u6574\u7d22\u5f15\u975e\u70b9\u5c5e\u6027\u3002","title":"24.\u7d22\u5f15\u53c2\u6570\u548c\u5168\u6587\u641c\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#24","text":"\u5b9a\u4e49\u6df7\u5408\u7d22\u5f15\u65f6\uff0c\u53ef\u4ee5\u4e3a\u6dfb\u52a0\u5230\u7d22\u5f15\u7684\u6bcf\u4e2a\u5c5e\u6027\u952e\u9009\u62e9\u6027\u5730\u6307\u5b9a\u53c2\u6570\u5217\u8868\u3002 \u8fd9\u4e9b\u53c2\u6570\u63a7\u5236\u7279\u5b9a\u952e\u7684\u7d22\u5f15\u65b9\u5f0f\u3002JanusGraph\u8bc6\u522b\u4ee5\u4e0b\u7d22\u5f15\u53c2\u6570\u3002 \u662f\u5426\u652f\u6301\u8fd9\u4e9b\u53d6\u51b3\u4e8e\u914d\u7f6e\u7684\u7d22\u5f15\u540e\u7aef\u3002 \u9664\u4e86\u6b64\u5904\u5217\u51fa\u7684\u53c2\u6570\u4e4b\u5916\uff0c\u7279\u5b9a\u7d22\u5f15\u540e\u7aef\u8fd8\u53ef\u80fd\u652f\u6301\u81ea\u5b9a\u4e49\u53c2\u6570\u3002","title":"24 \u7d22\u5f15\u53c2\u6570\u548c\u5168\u6587\u68c0\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#241","text":"\u7d22\u5f15\u5b57\u7b26\u4e32\u503c\uff08\u5373\u5177\u6709String.class\u6570\u636e\u7c7b\u578b\u7684\u5c5e\u6027\u952e\uff09\u65f6\uff0c \u53ef\u4ee5\u9009\u62e9\u5c06\u8fd9\u4e9b\u503c\u7d22\u5f15\u4e3a\u7531mapping\u53c2\u6570\u7c7b\u578b\u63a7\u5236\u7684\u6587\u672c\u6216\u5b57\u7b26\u4e32\u3002 \u5f53\u8be5\u503c\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u8be5\u5b57\u7b26\u4e32\u88ab\u6807\u8bb0\u4e3a\u4e00\u4e2a\u5355\u8bcd\u5305\uff0c \u5176\u5141\u8bb8\u7528\u6237\u6709\u6548\u5730\u67e5\u8be2\u5305\u542b\u4e00\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd\u7684\u6240\u6709\u5339\u914d\u3002 \u8fd9\u901a\u5e38\u79f0\u4e3a\u5168\u6587\u641c\u7d22\u3002\u5f53\u8be5\u503c\u88ab\u7d22\u5f15\u4e3a\u5b57\u7b26\u4e32\u65f6\uff0c \u8be5\u5b57\u7b26\u4e32\u662f\u7d22\u5f15\u201cas-is\u201d\u800c\u6ca1\u6709\u4efb\u4f55\u8fdb\u4e00\u6b65\u7684\u5206\u6790\u6216\u6807\u8bb0\u5316\u3002 \u8fd9\u6709\u52a9\u4e8e\u67e5\u8be2\u7cbe\u786e\u7684\u5b57\u7b26\u5e8f\u5217\u5339\u914d\u3002\u8fd9\u901a\u5e38\u79f0\u4e3a\u5b57\u7b26\u4e32\u641c\u7d22\u3002","title":"24.1 \u5168\u6587\u68c0\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#2411","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b57\u7b26\u4e32\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u3002\u8981\u4f7f\u6b64\u7d22\u5f15\u9009\u9879\u663e\u5f0f\uff0c\u53ef\u4ee5\u5728\u5c06\u5c5e\u6027\u952e\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\u5b9a\u4e49\u6620\u5c04\u3002 mgmt = graph.openManagement() summary = mgmt.makePropertyKey('booksummary').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(summary, Mapping.TEXT.asParameter()).buildMixedIndex( search ) mgmt.commit() \u8fd9\u4e0e\u6807\u51c6\u7684\u6df7\u5408\u7d22\u5f15\u5b9a\u4e49\u76f8\u540c\uff0c\u53ea\u6dfb\u52a0\u4e86\u4e00\u4e2a\u989d\u5916\u7684\u53c2\u6570\u6765\u6307\u5b9a\u7d22\u5f15\u4e2d\u7684\u6620\u5c04 - \u5728\u672c\u4f8b\u4e2dMapping.TEXT\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u5b57\u7b26\u4e32\u503c\u88ab\u6807\u8bb0\u5316\u4e3a\u4e00\u5305\u4ee4\u724c\u3002 \u786e\u5207\u7684\u6807\u8bb0\u5316\u53d6\u51b3\u4e8e\u7d22\u5f15\u540e\u7aef\u53ca\u5176\u914d\u7f6e\u3002JanusGraph\u7684\u9ed8\u8ba4\u6807\u8bb0\u5316\u5c06\u5b57\u7b26\u4e32\u62c6\u5206\u4e3a\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\uff0c \u5e76\u5220\u9664\u5c11\u4e8e2\u4e2a\u5b57\u7b26\u7684\u4efb\u4f55\u6807\u8bb0\u3002\u7d22\u5f15\u540e\u7aef\u4f7f\u7528\u7684\u6807\u8bb0\u5316\u53ef\u80fd\u4e0d\u540c\uff08\u4f8b\u5982\uff0c\u5220\u9664\u4e86\u505c\u7528\u8bcd\uff09\uff0c \u8fd9\u53ef\u80fd\u5bfc\u81f4\u5728\u4e8b\u52a1\u5185\u90e8\u7684\u4fee\u6539\u548c\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u5df2\u63d0\u4ea4\u6570\u636e\u5904\u7406\u5168\u6587\u641c\u7d22\u67e5\u8be2\u7684\u65b9\u5f0f\u65b9\u9762\u5b58\u5728\u7ec6\u5fae\u5dee\u522b\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u6587\u672c\u65f6\uff0c\u7d22\u5f15\u540e\u7aef\u4ec5\u5728\u56fe\u5f62\u67e5\u8be2\u4e2d\u652f\u6301\u5168\u6587\u641c\u7d22\u8c13\u8bcd\u3002\u5168\u6587\u641c\u7d22\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002 textContains\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5219\u4e3atrue textContainsPrefix\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4ee5\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u5219\u4e3atrue textContainsRegex\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u4e3atrue textContainsFuzzy\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u4f3c\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09\uff0c\u5219\u4e3atrue import static org.janusgraph.core.attribute.Text.* g.V().has('booksummary', textContains('unicorns')) g.V().has('booksummary', textContainsPrefix('uni')) g.V().has('booksummary', textContainsRegex('.*corn.*')) g.V().has('booksummary', textContainsFuzzy('unicorn')) \u5b57\u7b26\u4e32\u641c\u7d22\u8c13\u8bcd\uff08\u89c1\u4e0b\u6587\uff09\u53ef\u7528\u4e8e\u67e5\u8be2\uff0c\u4f46\u90a3\u9700\u8981\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u8fd9\u53ef\u80fd\u975e\u5e38\u6602\u8d35\u3002","title":"24.1.1 \u5168\u6587\u68c0\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#2412","text":"\u8981\u5c06\u5b57\u7b26\u4e32\u5c5e\u6027\u7d22\u5f15\u4e3a\u5b57\u7b26\u5e8f\u5217\u800c\u4e0d\u8fdb\u884c\u4efb\u4f55\u5206\u6790\u6216\u6807\u8bb0\u5316\uff0c\u8bf7\u5c06\u6620\u5c04\u6307\u5b9a\u4e3aMapping.STRING\uff1a mgmt = graph.openManagement() name = mgmt.makePropertyKey('bookname').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(name, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.commit() \u914d\u7f6e\u5b57\u7b26\u4e32\u6620\u5c04\u540e\uff0c\u5b57\u7b26\u4e32\u503c\u5c06\u88ab\u7f16\u5165\u7d22\u5f15\uff0c\u5e76\u4e14\u53ef\u4ee5\u201cas-is\u201d\u67e5\u8be2 ,\u5305\u62ec\u505c\u7528\u8bcd\u548c\u975e\u5b57\u6bcd\u5b57\u7b26\u3002\u4f46\u662f\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u67e5\u8be2\u5fc5\u987b\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\u503c\u3002 \u56e0\u6b64\uff0c\u5728\u7d22\u5f15\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u4ee4\u724c\u7684\u77ed\u5b57\u7b26\u5e8f\u5217\u65f6\uff0c\u5b57\u7b26\u4e32\u6620\u5c04\u5f88\u6709\u7528\u3002 \u5f53\u5b57\u7b26\u4e32\u5c5e\u6027\u88ab\u7d22\u5f15\u4e3a\u5b57\u7b26\u4e32\u65f6\uff0c\u7d22\u5f15\u540e\u7aef\u5728\u56fe\u5f62\u67e5\u8be2\u4e2d\u4ec5\u652f\u6301\u4ee5\u4e0b\u8c13\u8bcd\u3002\u5b57\u7b26\u4e32\u641c\u7d22\u533a\u5206\u5927\u5c0f\u5199\u3002 eq\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u540c neq\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u4e0d\u540c\u4e8e\u67e5\u8be2\u5b57\u7b26\u4e32 textPrefix\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4ee5\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934 textRegex\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5b8c\u5168\u5339\u914d textFuzzy\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u7c7b\u4f3c\u4e8e\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09 import static org.apache.tinkerpop.gremlin.process.traversal.P.* import static org.janusgraph.core.attribute.Text.* g.V().has('bookname', eq('unicorns')) g.V().has('bookname', neq('unicorns')) g.V().has('bookname', textPrefix('uni')) g.V().has('bookname', textRegex('.*corn.*')) g.V().has('bookname', textFuzzy('unicorn')) \u53ef\u4ee5\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528\u5168\u6587\u641c\u7d22\u8c13\u8bcd\uff0c\u4f46\u662f\u90a3\u4e9b\u9700\u8981\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u8fc7\u6ee4\uff0c\u8fd9\u53ef\u80fd\u662f\u975e\u5e38\u6602\u8d35\u7684\u3002","title":"24.1.2 \u5b57\u7b26\u4e32\u641c\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#2413","text":"\u5982\u679c\u60a8\u4f7f\u7528Elasticsearch\uff0c\u5219\u53ef\u4ee5\u5c06\u5c5e\u6027\u7d22\u5f15\u4e3a\u6587\u672c\u548c\u5b57\u7b26\u4e32\uff0c\u4ece\u800c\u5141\u8bb8\u60a8\u4f7f\u7528\u6240\u6709\u8c13\u8bcd\u8fdb\u884c\u7cbe\u786e\u5339\u914d\u548c\u6a21\u7cca\u5339\u914d\u3002 mgmt = graph.openManagement() summary = mgmt.makePropertyKey('booksummary').dataType(String.class).make() mgmt.buildIndex('booksBySummary', Vertex.class).addKey(summary, Mapping.TEXTSTRING.asParameter()).buildMixedIndex( search ) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u6570\u636e\u5c06\u5b58\u50a8\u5728\u7d22\u5f15\u4e2d\u4e24\u6b21\uff0c\u4e00\u6b21\u7528\u4e8e\u7cbe\u786e\u5339\u914d\uff0c\u4e00\u6b21\u7528\u4e8e\u6a21\u7cca\u5339\u914d\u3002","title":"24.1.3 \u5168\u6587\u548c\u5b57\u7b26\u4e32\u641c\u7d22"},{"location":"index_backends/index_parameters_and_full-text_search/#242","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cJanusGraph\u652f\u6301\u4f7f\u7528\u70b9\u7c7b\u578b\u7d22\u5f15\u5730\u7406\u5c5e\u6027\u5e76\u901a\u8fc7\u5706\u6216\u6846\u67e5\u8be2\u5730\u7406\u5c5e\u6027\u3002 \u8981\u7d22\u5f15\u652f\u6301\u6309\u4efb\u4f55\u5730\u7406\u4f4d\u7f6e\u7c7b\u578b\u67e5\u8be2\u7684\u975e\u70b9\u5730\u7406\u5c5e\u6027\uff0c\u8bf7\u5c06\u6620\u5c04\u6307\u5b9a\u4e3aMapping.PREFIX_TREE\uff1a mgmt = graph.openManagement() name = mgmt.makePropertyKey('border').dataType(Geoshape.class).make() mgmt.buildIndex('borderIndex', Vertex.class).addKey(name, Mapping.PREFIX_TREE.asParameter()).buildMixedIndex( search ) mgmt.commit() \u53ef\u4ee5\u6307\u5b9a\u5176\u4ed6\u53c2\u6570\u6765\u8c03\u6574\u57fa\u7840\u524d\u7f00\u6811\u6620\u5c04\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u53ef\u9009\u53c2\u6570\u5305\u62ec\u524d\u7f00\u6811\u4e2d\u4f7f\u7528\u7684\u7ea7\u522b\u6570\u4ee5\u53ca\u76f8\u5173\u7684\u7cbe\u5ea6\u3002 mgmt = graph.openManagement() name = mgmt.makePropertyKey('border').dataType(Geoshape.class).make() mgmt.buildIndex('borderIndex', Vertex.class).addKey(name, Mapping.PREFIX_TREE.asParameter(), Parameter.of( index-geo-max-levels , 18), Parameter.of( index-geo-dist-error-pct , 0.0125)).buildMixedIndex( search ) mgmt.commit() \u8bf7\u6ce8\u610f\uff0c\u67d0\u4e9b\u7d22\u5f15\u540e\u7aef\uff08\u4f8b\u5982Solr\uff09\u53ef\u80fd\u9700\u8981\u989d\u5916\u7684\u5916\u90e8\u67b6\u6784\u914d\u7f6e\u6765\u652f\u6301\u548c\u8c03\u6574\u7d22\u5f15\u975e\u70b9\u5c5e\u6027\u3002","title":"24.2 \u5730\u7406\u6620\u5c04"},{"location":"index_backends/search_predicates_and_data_types/","text":"23\u7ae0 \u641c\u7d22\u8c13\u8bcd\u548c\u6570\u636e\u7c7b\u578b \u8fd9\u4e2a\u9875\u9762\u5217\u51fa\u4e86\u6240\u6709\u7684\u6bd4\u8f83\u8c13\u8bcdJanusGraph\u652f\u6301\u5168\u5c40\u56fe\u641c\u7d22\u548c\u5c40\u90e8\u904d\u5386\u3002 23.1 \u6bd4\u8f83\u8c13\u8bcd \u4e0b\u5217\u6bd4\u8f83\u8c13\u8bcd\uff0c\u679a\u4e3e\u4e86\u7528\u4e8e\u7d22\u5f15\u67e5\u8be2\u5e76\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u4f7f\u7528\uff1a - eq (equal) - neq (not equal) - gt (greater than) - gte (greater than or equal) - lt (less than) - lte (less than or equal) \u6240\u6709\u7684\u6bd4\u8f83\u8c13\u8bcd\u81f4\u8f9eString,numeric,Date\u548c\u5373\u65f6\u7684\u6570\u636e\u7c7b\u578b\u3002 boolean\u548cuuid\u652f\u6301neq\u548ceq 23.2 \u6587\u672c\u8c13\u8bcd Text\u679a\u4e3e\u6307\u5b9a\u7528\u4e8e\u67e5\u8be2\u5339\u914d\u6587\u672c\u6216\u5b57\u7b26\u4e32\u503c\u7684\u641c\u7d22\u64cd\u4f5c\u7b26\u3002\u4e24\u79cd\u7c7b\u578b\u8c13\u8bcd\u533a\u522b\uff1a \u6587\u672c\u641c\u7d22\u8c13\u8bcd\u5728\u6587\u672c\u5b57\u7b26\u4e32\u88ab\u6807\u8bb0\u5316\u540e\u4e0e\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u5355\u4e2a\u5355\u8bcd\u5339\u914d\u3002\u8fd9\u4e9b\u8c13\u8bcd\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002 textContains\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5219\u4e3atrue textContainsPrefix\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4ee5\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u5219\u4e3atrue textContainsRegex\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u4e3atrue textContainsFuzzy\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u4f3c\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09\uff0c\u5219\u4e3atrue \u5b57\u7b26\u4e32\u641c\u7d22\u8c13\u8bcd\u4e0e\u6574\u4e2a\u5b57\u7b26\u4e32\u503c\u5339\u914d textPrefix\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4ee5\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934 textRegex\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5b8c\u5168\u5339\u914d textFuzzy\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u7c7b\u4f3c\u4e8e\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09 \u6709\u5173\u5168\u6587\u548c\u5b57\u7b26\u4e32\u641c\u7d22\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c24.1\u8282\u201c\u5168\u6587\u641c\u7d22\u201d\u3002 23.3 \u5730\u7406\u8c13\u8bcd \u4e0b\u9762\u5217\u4e3e\u4e86\u5730\u7406\u8c13\u8bcd\uff1a - geoIntersect\u5982\u679c\u4e24\u4e2a\u51e0\u4f55\u5bf9\u8c61\u5177\u6709\u81f3\u5c11\u4e00\u4e2a\u5171\u540c\u70b9\uff08\u76f8\u53cdgeoDisjoint\uff09\uff0c\u5219\u8fd9\u662f\u6b63\u786e\u7684\u3002 - geoWithin \u5982\u679c\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\u5305\u542b\u53e6\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\uff0c\u5219\u6210\u7acb - geoDisjoint\u5982\u679c\u4e24\u4e2a\u51e0\u4f55\u5bf9\u8c61\u6ca1\u6709\u5171\u540c\u7684\u70b9\uff08\u76f8\u53cdgeoIntersect\uff09\uff0c\u5219\u8fd9\u662f\u6b63\u786e\u7684\u3002 - geoContains \u5982\u679c\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\u88ab\u53e6\u4e00\u4e2a\u5305\u542b\uff0c\u5219\u8be5\u65b9\u6cd5\u6210\u7acb\u3002 \u6709\u5173\u5730\u7406\u641c\u7d22\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c24.2\u8282\u201c\u5730\u7406\u6620\u5c04\u201d\u3002 ### 23.4 \u67e5\u8be2\u793a\u4f8b \u4ee5\u4e0b\u67e5\u8be2\u793a\u4f8b\u6f14\u793a\u4e86\u6559\u7a0b\u4e0a\u7684\u4e00\u4e9b\u8c13\u8bcd: g.V().has( name , hercules ) // 2) Find all vertices with an age greater than 50 g.V().has( age , gt(50)) // or find all vertices between 1000 (inclusive) and 5000 (exclusive) years of age and order by increasing age g.V().has( age , inside(1000, 5000)).order().by( age , incr) // which returns the same result set as the following query but in reverse order g.V().has( age , inside(1000, 5000)).order().by( age , decr) // 3) Find all edges where the place is at most 50 kilometers from the given latitude-longitude pair g.E().has( place , geoWithin(Geoshape.circle(37.97, 23.72, 50))) // 4) Find all edges where reason contains the word loves g.E().has( reason , textContains( loves )) // or all edges which contain two words (need to chunk into individual words) g.E().has( reason , textContains( loves )).has( reason , textContains( breezes )) // or all edges which contain words that start with lov g.E().has( reason , textContainsPrefix( lov )) // or all edges which contain words that match the regular expression br[ez]*s in their entirety g.E().has( reason , textContainsRegex( br[ez]*s )) // or all edges which contain words similar to love g.E().has( reason , textContainsFuzzy( love )) // 5) Find all vertices older than a thousand years and named saturn g.V().has( age , gt(1000)).has( name , saturn ) 23.5 \u652f\u6301\u6570\u636e\u7c7b\u578b \u867d\u7136JanusGraph\u7684\u590d\u5408\u7d22\u5f15\uff08composite indexes\uff09\u652f\u6301\u53ef\u4ee5\u5b58\u50a8\u5728JanusGraph\u4e2d\u7684\u4efb\u4f55\u6570\u636e\u7c7b\u578b\uff0c \u4f46\u6df7\u5408\u7d22\u5f15\uff08mixed indexes \uff09\u4ec5\u9650\u4e8e\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b\u3002 Byte Short Integer Long Float Double String Geoshape Date Instant UUID \u5c06\u6765\u5c06\u652f\u6301\u5176\u4ed6\u6570\u636e\u7c7b\u578b\u3002 23.6 \u5730\u7406\u4f4d\u7f6e\u6570\u636e\u7c7b\u578b Geoshape\u6570\u636e\u7c7b\u578b\u652f\u6301\u8868\u793a\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\uff0c\u591a\u8fb9\u5f62\uff0c\u591a\u70b9\uff0c\u591a\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u7d22\u5f15\u540e\u7aef\u76ee\u524d\u652f\u6301\u7d22\u5f15\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\uff0c\u591a\u8fb9\u5f62\uff0c\u591a\u70b9\uff0c \u591a\u7ebf\uff0c\u591a\u8fb9\u5f62\u548c\u51e0\u4f55\u96c6\u5408\u3002\u4ec5\u901a\u8fc7\u6df7\u5408\u7d22\u5f15\u652f\u6301\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u67e5\u627e\u3002 \u8981\u6784\u5efaGeoshape\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a //lat, lng Geoshape.point(37.97, 23.72) //lat, lng, radius in km Geoshape.circle(37.97, 23.72, 50) //SW lat, SW lng, NE lat, NE lng Geoshape.box(37.97, 23.72, 38.97, 24.72) //WKT Geoshape.fromWkt( POLYGON ((35.4 48.9, 35.6 48.9, 35.6 49.1, 35.4 49.1, 35.4 48.9)) ) //MultiPoint Geoshape.geoshape(Geoshape.getShapeFactory().multiPoint().pointXY(60.0, 60.0).pointXY(120.0, 60.0) .build()) //MultiLine Geoshape.geoshape(Geoshape.getShapeFactory().multiLineString() .add(Geoshape.getShapeFactory().lineString().pointXY(59.0, 60.0).pointXY(61.0, 60.0)) .add(Geoshape.getShapeFactory().lineString().pointXY(119.0, 60.0).pointXY(121.0, 60.0)).build()) //MultiPolygon Geoshape.geoshape(Geoshape.getShapeFactory().multiPolygon() .add(Geoshape.getShapeFactory().polygon().pointXY(59.0, 59.0).pointXY(61.0, 59.0) .pointXY(61.0, 61.0).pointXY(59.0, 61.0).pointXY(59.0, 59.0)) .add(Geoshape.getShapeFactory().polygon().pointXY(119.0, 59.0).pointXY(121.0, 59.0) .pointXY(121.0, 61.0).pointXY(119.0, 61.0).pointXY(119.0, 59.0)).build()) //GeometryCollection Geoshape.geoshape(Geoshape.getGeometryCollectionBuilder() .add(Geoshape.getShapeFactory().pointXY(60.0, 60.0)) .add(Geoshape.getShapeFactory().lineString().pointXY(119.0, 60.0).pointXY(121.0, 60.0).build()) .add(Geoshape.getShapeFactory().polygon().pointXY(119.0, 59.0).pointXY(121.0, 59.0) .pointXY(121.0, 61.0).pointXY(119.0, 61.0).pointXY(119.0, 59.0)).build()) \u6b64\u5916\uff0c\u901a\u8fc7GraphSON\u5bfc\u5165\u56fe\u5f62\u65f6\uff0c\u51e0\u4f55\u4f53\u53ef\u80fd\u7531GeoJSON\u8868\u793a\uff1a //string 37.97, 23.72 //list [37.97, 23.72] //GeoJSON feature { type : Feature , geometry : { type : Point , coordinates : [125.6, 10.1] }, properties : { name : Dinagat Islands } } //GeoJSON geometry { type : Point , coordinates : [125.6, 10.1] } GeoJSON\u53ef\u4ee5\u6307\u5b9a\u4e3aPoint\uff0cCircle\uff0cLineString\u6216Polygon\u3002\u591a\u8fb9\u5f62\u5fc5\u987b\u5173\u95ed\u3002\u8bf7\u6ce8\u610f\uff0c \u4e0eJanusGraph API\u4e0d\u540c\uff0cGeoJSON\u5c06\u5750\u6807\u6307\u5b9a\u4e3alng lat\u3002 23.7 \u96c6\u5408 \u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fElasticsearch\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528SET\u548cLIST\u57fa\u6570\u5bf9\u5c5e\u6027\u8fdb\u884c\u7d22\u5f15\u3002\u4f8b\u5982\uff1a mgmt = graph.openManagement() nameProperty = mgmt.makePropertyKey( names ).dataType(String.class).cardinality(Cardinality.SET).make() mgmt.buildIndex( search , Vertex.class).addKey(nameProperty, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.commit() //Insert a vertex person = graph.addVertex() person.property( names , Robert ) person.property( names , Bob ) graph.tx().commit() //Now query it g.V().has( names , Bob ).count().next() //1 g.V().has( names , Robert ).count().next() //1","title":"23.\u67e5\u8be2\u8bed\u6cd5\u548c\u6570\u636e\u7c7b\u578b"},{"location":"index_backends/search_predicates_and_data_types/#23","text":"\u8fd9\u4e2a\u9875\u9762\u5217\u51fa\u4e86\u6240\u6709\u7684\u6bd4\u8f83\u8c13\u8bcdJanusGraph\u652f\u6301\u5168\u5c40\u56fe\u641c\u7d22\u548c\u5c40\u90e8\u904d\u5386\u3002","title":"23\u7ae0 \u641c\u7d22\u8c13\u8bcd\u548c\u6570\u636e\u7c7b\u578b"},{"location":"index_backends/search_predicates_and_data_types/#231","text":"\u4e0b\u5217\u6bd4\u8f83\u8c13\u8bcd\uff0c\u679a\u4e3e\u4e86\u7528\u4e8e\u7d22\u5f15\u67e5\u8be2\u5e76\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\u4f7f\u7528\uff1a - eq (equal) - neq (not equal) - gt (greater than) - gte (greater than or equal) - lt (less than) - lte (less than or equal) \u6240\u6709\u7684\u6bd4\u8f83\u8c13\u8bcd\u81f4\u8f9eString,numeric,Date\u548c\u5373\u65f6\u7684\u6570\u636e\u7c7b\u578b\u3002 boolean\u548cuuid\u652f\u6301neq\u548ceq","title":"23.1 \u6bd4\u8f83\u8c13\u8bcd"},{"location":"index_backends/search_predicates_and_data_types/#232","text":"Text\u679a\u4e3e\u6307\u5b9a\u7528\u4e8e\u67e5\u8be2\u5339\u914d\u6587\u672c\u6216\u5b57\u7b26\u4e32\u503c\u7684\u641c\u7d22\u64cd\u4f5c\u7b26\u3002\u4e24\u79cd\u7c7b\u578b\u8c13\u8bcd\u533a\u522b\uff1a \u6587\u672c\u641c\u7d22\u8c13\u8bcd\u5728\u6587\u672c\u5b57\u7b26\u4e32\u88ab\u6807\u8bb0\u5316\u540e\u4e0e\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u5355\u4e2a\u5355\u8bcd\u5339\u914d\u3002\u8fd9\u4e9b\u8c13\u8bcd\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002 textContains\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u5219\u4e3atrue textContainsPrefix\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4ee5\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u5219\u4e3atrue textContainsRegex\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u5219\u4e3atrue textContainsFuzzy\uff1a\u5982\u679c\uff08\u81f3\u5c11\uff09\u6587\u672c\u5b57\u7b26\u4e32\u4e2d\u7684\u4e00\u4e2a\u5355\u8bcd\u4e0e\u67e5\u8be2\u5b57\u7b26\u4e32\u76f8\u4f3c\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09\uff0c\u5219\u4e3atrue \u5b57\u7b26\u4e32\u641c\u7d22\u8c13\u8bcd\u4e0e\u6574\u4e2a\u5b57\u7b26\u4e32\u503c\u5339\u914d textPrefix\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4ee5\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\u5f00\u5934 textRegex\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u4e0e\u7ed9\u5b9a\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u5b8c\u5168\u5339\u914d textFuzzy\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u503c\u7c7b\u4f3c\u4e8e\u7ed9\u5b9a\u7684\u67e5\u8be2\u5b57\u7b26\u4e32\uff08\u57fa\u4e8eLevenshtein\u7f16\u8f91\u8ddd\u79bb\uff09 \u6709\u5173\u5168\u6587\u548c\u5b57\u7b26\u4e32\u641c\u7d22\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c24.1\u8282\u201c\u5168\u6587\u641c\u7d22\u201d\u3002","title":"23.2 \u6587\u672c\u8c13\u8bcd"},{"location":"index_backends/search_predicates_and_data_types/#233","text":"\u4e0b\u9762\u5217\u4e3e\u4e86\u5730\u7406\u8c13\u8bcd\uff1a - geoIntersect\u5982\u679c\u4e24\u4e2a\u51e0\u4f55\u5bf9\u8c61\u5177\u6709\u81f3\u5c11\u4e00\u4e2a\u5171\u540c\u70b9\uff08\u76f8\u53cdgeoDisjoint\uff09\uff0c\u5219\u8fd9\u662f\u6b63\u786e\u7684\u3002 - geoWithin \u5982\u679c\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\u5305\u542b\u53e6\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\uff0c\u5219\u6210\u7acb - geoDisjoint\u5982\u679c\u4e24\u4e2a\u51e0\u4f55\u5bf9\u8c61\u6ca1\u6709\u5171\u540c\u7684\u70b9\uff08\u76f8\u53cdgeoIntersect\uff09\uff0c\u5219\u8fd9\u662f\u6b63\u786e\u7684\u3002 - geoContains \u5982\u679c\u4e00\u4e2a\u51e0\u4f55\u5bf9\u8c61\u88ab\u53e6\u4e00\u4e2a\u5305\u542b\uff0c\u5219\u8be5\u65b9\u6cd5\u6210\u7acb\u3002 \u6709\u5173\u5730\u7406\u641c\u7d22\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1\u7b2c24.2\u8282\u201c\u5730\u7406\u6620\u5c04\u201d\u3002 ### 23.4 \u67e5\u8be2\u793a\u4f8b \u4ee5\u4e0b\u67e5\u8be2\u793a\u4f8b\u6f14\u793a\u4e86\u6559\u7a0b\u4e0a\u7684\u4e00\u4e9b\u8c13\u8bcd: g.V().has( name , hercules ) // 2) Find all vertices with an age greater than 50 g.V().has( age , gt(50)) // or find all vertices between 1000 (inclusive) and 5000 (exclusive) years of age and order by increasing age g.V().has( age , inside(1000, 5000)).order().by( age , incr) // which returns the same result set as the following query but in reverse order g.V().has( age , inside(1000, 5000)).order().by( age , decr) // 3) Find all edges where the place is at most 50 kilometers from the given latitude-longitude pair g.E().has( place , geoWithin(Geoshape.circle(37.97, 23.72, 50))) // 4) Find all edges where reason contains the word loves g.E().has( reason , textContains( loves )) // or all edges which contain two words (need to chunk into individual words) g.E().has( reason , textContains( loves )).has( reason , textContains( breezes )) // or all edges which contain words that start with lov g.E().has( reason , textContainsPrefix( lov )) // or all edges which contain words that match the regular expression br[ez]*s in their entirety g.E().has( reason , textContainsRegex( br[ez]*s )) // or all edges which contain words similar to love g.E().has( reason , textContainsFuzzy( love )) // 5) Find all vertices older than a thousand years and named saturn g.V().has( age , gt(1000)).has( name , saturn )","title":"23.3 \u5730\u7406\u8c13\u8bcd"},{"location":"index_backends/search_predicates_and_data_types/#235","text":"\u867d\u7136JanusGraph\u7684\u590d\u5408\u7d22\u5f15\uff08composite indexes\uff09\u652f\u6301\u53ef\u4ee5\u5b58\u50a8\u5728JanusGraph\u4e2d\u7684\u4efb\u4f55\u6570\u636e\u7c7b\u578b\uff0c \u4f46\u6df7\u5408\u7d22\u5f15\uff08mixed indexes \uff09\u4ec5\u9650\u4e8e\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b\u3002 Byte Short Integer Long Float Double String Geoshape Date Instant UUID \u5c06\u6765\u5c06\u652f\u6301\u5176\u4ed6\u6570\u636e\u7c7b\u578b\u3002","title":"23.5 \u652f\u6301\u6570\u636e\u7c7b\u578b"},{"location":"index_backends/search_predicates_and_data_types/#236","text":"Geoshape\u6570\u636e\u7c7b\u578b\u652f\u6301\u8868\u793a\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\uff0c\u591a\u8fb9\u5f62\uff0c\u591a\u70b9\uff0c\u591a\u7ebf\u548c\u591a\u8fb9\u5f62\u3002\u7d22\u5f15\u540e\u7aef\u76ee\u524d\u652f\u6301\u7d22\u5f15\u70b9\uff0c\u5706\uff0c\u6846\uff0c\u7ebf\uff0c\u591a\u8fb9\u5f62\uff0c\u591a\u70b9\uff0c \u591a\u7ebf\uff0c\u591a\u8fb9\u5f62\u548c\u51e0\u4f55\u96c6\u5408\u3002\u4ec5\u901a\u8fc7\u6df7\u5408\u7d22\u5f15\u652f\u6301\u5730\u7406\u7a7a\u95f4\u7d22\u5f15\u67e5\u627e\u3002 \u8981\u6784\u5efaGeoshape\uff0c\u8bf7\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a //lat, lng Geoshape.point(37.97, 23.72) //lat, lng, radius in km Geoshape.circle(37.97, 23.72, 50) //SW lat, SW lng, NE lat, NE lng Geoshape.box(37.97, 23.72, 38.97, 24.72) //WKT Geoshape.fromWkt( POLYGON ((35.4 48.9, 35.6 48.9, 35.6 49.1, 35.4 49.1, 35.4 48.9)) ) //MultiPoint Geoshape.geoshape(Geoshape.getShapeFactory().multiPoint().pointXY(60.0, 60.0).pointXY(120.0, 60.0) .build()) //MultiLine Geoshape.geoshape(Geoshape.getShapeFactory().multiLineString() .add(Geoshape.getShapeFactory().lineString().pointXY(59.0, 60.0).pointXY(61.0, 60.0)) .add(Geoshape.getShapeFactory().lineString().pointXY(119.0, 60.0).pointXY(121.0, 60.0)).build()) //MultiPolygon Geoshape.geoshape(Geoshape.getShapeFactory().multiPolygon() .add(Geoshape.getShapeFactory().polygon().pointXY(59.0, 59.0).pointXY(61.0, 59.0) .pointXY(61.0, 61.0).pointXY(59.0, 61.0).pointXY(59.0, 59.0)) .add(Geoshape.getShapeFactory().polygon().pointXY(119.0, 59.0).pointXY(121.0, 59.0) .pointXY(121.0, 61.0).pointXY(119.0, 61.0).pointXY(119.0, 59.0)).build()) //GeometryCollection Geoshape.geoshape(Geoshape.getGeometryCollectionBuilder() .add(Geoshape.getShapeFactory().pointXY(60.0, 60.0)) .add(Geoshape.getShapeFactory().lineString().pointXY(119.0, 60.0).pointXY(121.0, 60.0).build()) .add(Geoshape.getShapeFactory().polygon().pointXY(119.0, 59.0).pointXY(121.0, 59.0) .pointXY(121.0, 61.0).pointXY(119.0, 61.0).pointXY(119.0, 59.0)).build()) \u6b64\u5916\uff0c\u901a\u8fc7GraphSON\u5bfc\u5165\u56fe\u5f62\u65f6\uff0c\u51e0\u4f55\u4f53\u53ef\u80fd\u7531GeoJSON\u8868\u793a\uff1a //string 37.97, 23.72 //list [37.97, 23.72] //GeoJSON feature { type : Feature , geometry : { type : Point , coordinates : [125.6, 10.1] }, properties : { name : Dinagat Islands } } //GeoJSON geometry { type : Point , coordinates : [125.6, 10.1] } GeoJSON\u53ef\u4ee5\u6307\u5b9a\u4e3aPoint\uff0cCircle\uff0cLineString\u6216Polygon\u3002\u591a\u8fb9\u5f62\u5fc5\u987b\u5173\u95ed\u3002\u8bf7\u6ce8\u610f\uff0c \u4e0eJanusGraph API\u4e0d\u540c\uff0cGeoJSON\u5c06\u5750\u6807\u6307\u5b9a\u4e3alng lat\u3002","title":"23.6 \u5730\u7406\u4f4d\u7f6e\u6570\u636e\u7c7b\u578b"},{"location":"index_backends/search_predicates_and_data_types/#237","text":"\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662fElasticsearch\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528SET\u548cLIST\u57fa\u6570\u5bf9\u5c5e\u6027\u8fdb\u884c\u7d22\u5f15\u3002\u4f8b\u5982\uff1a mgmt = graph.openManagement() nameProperty = mgmt.makePropertyKey( names ).dataType(String.class).cardinality(Cardinality.SET).make() mgmt.buildIndex( search , Vertex.class).addKey(nameProperty, Mapping.STRING.asParameter()).buildMixedIndex( search ) mgmt.commit() //Insert a vertex person = graph.addVertex() person.property( names , Robert ) person.property( names , Bob ) graph.tx().commit() //Now query it g.V().has( names , Bob ).count().next() //1 g.V().has( names , Robert ).count().next() //1","title":"23.7 \u96c6\u5408"},{"location":"introduction/architectural_overview/","text":"JanusGraph\u662f\u4e00\u4e2a\u56fe\u5f62\u6570\u636e\u5e93\u5f15\u64ce\u3002 JanusGraph\u672c\u8eab\u4e13\u6ce8\u4e8e\u538b\u7f29\u56fe\u5e8f\u5217\u5316\u3001\u4e30\u5bcc\u56fe\u6570\u636e\u5efa\u6a21\u3001\u9ad8\u6548\u7684\u67e5\u8be2\u6267\u884c\u3002 \u6b64\u5916\uff0cJanusGraph\u5229\u7528Hadoop\u8fdb\u884c\u56fe\u5206\u6790\u548c\u6279\u5904\u7406\u3002JanusGraph\u4e3a\u6570\u636e\u6301\u4e45\u5316\uff0c\u6570\u636e\u7d22\u5f15\u548c\u5ba2\u6237\u7aef\u8bbf\u95ee\u5b9e\u73b0\u4e86\u5f3a\u5927\u7684\u6a21\u5757\u5316\u63a5\u53e3\u3002 JanusGraph\u7684\u6a21\u5757\u5316\u67b6\u6784\u4f7f\u5176\u80fd\u591f\u4e0e\u5404\u79cd\u5b58\u50a8\uff0c\u7d22\u5f15\u548c\u5ba2\u6237\u7aef\u6280\u672f\u8fdb\u884c\u4e92\u64cd\u4f5c; \u8fd9\u4e5f\u4f7f\u5f97JanusGraph\u5347\u7ea7\u5bf9\u5e94\u7684\u7ec4\u4ef6\u8fc7\u7a0b\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002 \u5728JanusGraph\u548c\u78c1\u76d8\u4e4b\u95f4\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5b58\u50a8\u548c\u7d22\u5f15\u9002\u914d\u5668\u3002 JanusGraph\u6807\u914d\u4ee5\u4e0b\u9002\u914d\u5668\uff0c\u4f46JanusGraph\u7684\u6a21\u5757\u5316\u67b6\u6784\u652f\u6301\u7b2c\u4e09\u65b9\u9002\u914d\u5668\u3002 \u6570\u636e\u5b58\u50a8: Apache Cassandra Apache HBase Oracle Berkeley DB Java\u4f01\u4e1a\u7248 \u7d22\u5f15\uff0c\u7528\u4e8e\u52a0\u5feb\u8bbf\u95ee\u901f\u5ea6\u5e76\u652f\u6301\u66f4\u590d\u6742\u7684\u67e5\u8be2\u8bed\u53e5: Elasticsearch Apache Solr Apache Lucene \u603b\u4f53\u6765\u8bb2\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u4e0eJanusGraph\u8fdb\u884c\u4ea4\u4e92\uff1a \u5d4c\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684JanusGraph\u5728\u540c\u4e00\u4e2aJVM\u4e2d\u6267\u884cGremlin\u8bed\u53e5\u3002 \u67e5\u8be2\u4efb\u52a1\u3001JanusGraph\u7f13\u5b58\u548c\u4e8b\u52a1\u5904\u7406\u90fd\u5728\u540c\u4e00\u4e2aJVM\u4e2d\uff0c\u800c\u540e\u7aef\u6570\u636e\u68c0\u7d22\u53ef\u80fd\u662f\u5728\u672c\u5730\u6216\u8fdc\u7a0b\u3002 \u901a\u8fc7\u5411\u670d\u52a1\u5668\u63d0\u4ea4Gremlin\u67e5\u8be2\u8bed\u53e5\u6765\u4e0e\u672c\u5730\u6216\u8fdc\u7a0bJanusGraph\u5b9e\u4f8b\u4ea4\u4e92\u3002 JanusGraph\u672c\u8eab\u652f\u6301Apache TinkerPop\u6808\u7684Gremlin Server\u7ec4\u4ef6\u3002 \u56fe 2.1.JanusGraph\u7cfb\u7edf\u67b6\u6784\u56fe","title":"2.\u67b6\u6784\u603b\u89c8"},{"location":"introduction/getting_started/","text":"3. \u5feb\u901f\u5f00\u59cb \u56fe3.1 \u795e\u7684\u56fe\u5173\u7cfb Above: Cupcake indexer in progress 3.1. \u4e0b\u8f7dJanusGraph\u548c\u8fd0\u884cGremlin\u63a7\u5236\u53f0 JanusGraph\u53ef\u4ee5\u4ece\u9879\u76ee\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u4e00\u4e2a\u53d1\u5e03\u7684 \u7248\u672c \u4e00\u65e6\u4e0b\u8f7d\u5e76\u89e3\u538b\uff0c\u4e00\u4e2aGremlin\u7684\u63a7\u5236\u53f0\b\u5c31\u53ef\u4ee5\u6253\u5f00\u3002Gremlin\u63a7\u5236\u53f0\u662f\u4e0eJanusGraph\u4e00\u8d77\u5206\u53d1\u7684 REPL \uff08\u5373\u4ea4\u4e92\u5f0fshell\uff09\uff0c\u5e76\u4e14\u4ec5\u4e0e\u6807\u51c6Gremlin\u63a7\u5236\u53f0\u4e0d\u540c\uff0c\u56e0\u4e3aJanusGraph\u662f\u9884\u5148\u5b89\u88c5\u548c\u9884\u52a0\u8f7d\u7684\u5305\u3002\u6216\u8005\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4ece\u4e2d\u592e\u5b58\u50a8\u5e93\u4e0b\u8f7dJanusGraph\u5305\u6765\u9009\u62e9\u5728\u73b0\u6709\u7684Gremlin\u63a7\u5236\u53f0\u4e2d\u5b89\u88c5\u548c\u6fc0\u6d3bJanusGraph\u3002\u4f46\u662f\uff0c\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u4f7f\u7528\u4e86 janusgraph.zip\uff0c\u8bf7\u786e\u4fdd\u89e3\u538b\u7f29\u4e86\u4e0b\u8f7d\u7684zip\u6587\u4ef6\u3002 \u91cd\u8981: JanusGraph\u4f9d\u8d56Java8\uff08\u6807\u51c6\u7248\uff09\u3002\u5efa\u8bae\u4f7f\u7528Oracle Java 8\u3002JanusGraph\u7684shell\u811a\u672c\u5e0c\u671b$JAVA_HOME\u73af\u5883\u53d8\u91cf\u6307\u5411\u5b89\u88c5JRE\u6216JDK\u7684\u76ee\u5f55\u3002 $ unzip janusgraph-0.3.1-hadoop2.zip Archive: janusgraph-0.3.1-hadoop2.zip creating: janusgraph-0.3.1-hadoop2/ ... $ cd janusgraph-0.3.1-hadoop2 $ bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- 09:12:24 INFO org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph - HADOOP_GREMLIN_LIBS is set to: /usr/local/janusgraph/lib plugin activated: tinkerpop.hadoop plugin activated: janusgraph.imports gremlin Gremlin\u63a7\u5236\u53f0\u4f7f\u7528 Apache Groovy \u89e3\u91ca\u547d\u4ee4\u3002Groovy\u662fJava\u7684\u8d85\u96c6\uff0c\u5b83\u5177\u6709\u5404\u79cd\u7b80\u5316\u6807\u8bb0\uff0c\u4f7f\u4ea4\u4e92\u7f16\u7a0b\u66f4\u5bb9\u6613\u3002\u540c\u6837\u5730\uff0cGremlin-Groovy\u662fGroovy\u7684\u8d85\u96c6\uff0c\u5177\u6709\u5404\u79cd\u901f\u8bb0\u7b26\u53f7\uff0c\u4f7f\u56fe\u5f62\u904d\u5386\u53d8\u5f97\u5bb9\u6613\u3002\u4e0b\u9762\u7684\u57fa\u672c\u793a\u4f8b\u6f14\u793a\u5904\u7406\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u548c\u6620\u5c04\u3002\u672c\u6559\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u8ba8\u8bba\u7279\u5b9a\u4e8e\u56fe\u5f62\u7684\u6784\u9020\u3002 gremlin 100-10 == 90 gremlin \"JanusGraph:\" + \" The Rise of Big Graph Data\" == JanusGraph: The Rise of Big Graph Data gremlin [name:'aurelius', vocation:['philosopher', 'emperor']] == name=aurelius == vocation=[philosopher, emperor] \u63d0\u793a \u5173\u4e8e Apache Tinkerpop , SQLEGremlin \u548c Gremlin R\becipes \u7684\u66f4\u591aGremlin\u7684\u4f7f\u7528\u4fe1\u606f\u3002 3.2. \u5c06Gods\u7684\u56fe\u5173\u7cfb\u5bfc\u5165\u5230JanusGraph \u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u6253\u5f00\u4e00\u4e2aJanusGraph\u56fe\u5f62\u5b9e\u4f8b\uff0c\u5e76\u52a0\u8f7d\u4e0a\u9762\u6240\u793a\u7684Gods\u6570\u636e\u96c6\u7684\u56fe\u3002JanusGraphFactory\u63d0\u4f9b\u4e86\u4e00\u7ec4\u9759\u6001\u6253\u5f00\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u91c7\u7528\u914d\u7f6e\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u56fe\u5f62\u5b9e\u4f8b\u3002\u672c\u6559\u7a0b\u5728\u4f7f\u7528BerkeleyDB\u5b58\u50a8\u540e\u7aef\u548cElasticsearch\u7d22\u5f15\u540e\u7aef\u7684\u914d\u7f6e\u4e0a\u8c03\u7528\u8fd9\u4e9b\u5f00\u653e\u65b9\u6cd5\uff0c\u7136\u540e\u4f7f\u7528\u5e2e\u52a9\u7c7bGraphOfTheGodsFactory\u52a0\u8f7dGods\u7684\u56fe\u3002\u672c\u8282\u8df3\u8fc7\u914d\u7f6e\u7ec6\u8282\uff0c\u4f46\u662f\u5173\u4e8e\u5b58\u50a8\u540e\u7aef\u3001\u7d22\u5f15\u540e\u7aef\u53ca\u5176\u914d\u7f6e\u7684\u9644\u52a0\u4fe1\u606f\u53ef\u5728Part III,\u201c\u5b58\u50a8\u540e\u7aef\u201d\u3001Part IV\u201c\u7d22\u5f15\u540e\u7aef\u201d\u548c\u7b2c15\u7ae0\u201c\u914d\u7f6e\u53c2\u8003\u201d\u4e2d\u83b7\u5f97\u3002 gremlin graph = JanusGraphFactory.open('conf/janusgraph-berkeleyje-es.properties') == standardjanusgraph[berkeleyje:../db/berkeley] gremlin GraphOfTheGodsFactory.load(graph) == null gremlin g = graph.traversal() == graphtraversalsource[standardjanusgraph[berkeleyje:../db/berkeley], standard] \u5728\u8fd4\u56de\u65b0\u6784\u9020\u7684\u56fe\u4e4b\u524d\uff0cJanusGraphFactory.open()\u548cGraphOfTheGodsFactory.load()\u65b9\u6cd5\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5728\u56fe\u4e0a\u521b\u5efa\u5168\u5c40\u548c\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u96c6\u5408\u3002 \u5c06\u6240\u6709\u9876\u70b9\u6dfb\u52a0\u5230\u56fe\u5f62\u4ee5\u53ca\u5b83\u4eec\u7684\u5c5e\u6027\u3002 \u5c06\u6240\u6709\u7684\u8fb9\u52a0\u4e0a\u5b83\u4eec\u7684\u5c5e\u6027\u3002 \u8be6\u60c5\u8bf7\u53c2\u9605 GraphOfTheGodsFactory source code \u6e90\u4ee3\u7801\u3002 \u5bf9\u4e8e\u90a3\u4e9b\u4f7f\u7528JanusGraph/Cassandra\uff08\u6216JanusGraph/HBase\uff09\u7684\u7528\u6237\uff0c\u8bf7\u786e\u4fdd\u4f7f\u7528conf/janus.-cql-es.properties\uff08\u6216conf/janus.-hbase-es.properties\uff09\u548cGraphOfTheGodsFactory.load()\u3002 gremlin graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') == standardjanusgraph[cql:[127.0.0.1]] gremlin GraphOfTheGodsFactory.load(graph) == null gremlin g = graph.traversal() == graphtraversalsource[standardjanusgraph[cql:[127.0.0.1]], standard] 3.3. \u5168\u5c40\u56fe\u7d22\u5f15 \u8bbf\u95ee\u56fe\u5f62\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u5178\u578b\u6a21\u5f0f\u662f\u9996\u5148\u4f7f\u7528\u56fe\u5f62\u7d22\u5f15\u5b9a\u4f4d\u5230\u56fe\u5f62\u4e2d\u7684\u5165\u53e3\u70b9\u3002\u8be5\u5165\u53e3\u70b9\u662f\u5143\u7d20\uff08\u6216\u4e00\u7ec4\u5143\u7d20\uff09-\u5373\u9876\u70b9\u6216\u8fb9\u3002\u4ece\u6761\u76ee\u5143\u7d20\u4e2d\uff0cGremlin\u8def\u5f84\u63cf\u8ff0\u63cf\u8ff0\u4e86\u5982\u4f55\u901a\u8fc7\u663e\u5f0f\u56fe\u7ed3\u6784\u904d\u5386\u5230\u56fe\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\u3002 \u7ed9\u5b9aname\u5c5e\u6027\u4e0a\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7d22\u5f15\uff0c\u53ef\u4ee5\u68c0\u7d22Saturn\u9876\u70b9\u3002\u7136\u540e\u53ef\u4ee5\u68c0\u67e5\u5c5e\u6027\u6620\u5c04\uff08\u5373Saturn\u7684\u5bc6\u94a5/\u503c\u5bf9\uff09\u3002\u6b63\u5982\u6240\u5c55\u793a\u7684\uff0c\u571f\u661f\u9876\u70b9\u7684\u540d\u5b57\u662f\u201cSaturn\u201d\uff0c\u5e74\u9f84\u4e3a10000\u5c81\uff0c\u662f\u4e00\u79cd\u201ctitan\u201d\u3002Saturn\u7684\u5b59\u5b50\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u904d\u5386\u8868\u8ff0\uff1a\u201c\u8c01\u662fSaturn\u7684\u5b59\u5b50\uff1f\u201d\u201c\u7236\u4eb2\u201d\u7684\u5012\u6570\u662f\u201c\u5b69\u5b50\u201d\u3002\u7ed3\u679c\u5c31\u662fHercules\u3002 gremlin saturn = g.V().has('name', 'saturn').next() == v[256] gremlin g.V(saturn).valueMap() == [name:[saturn], age:[10000]] gremlin g.V(saturn).in('father').in('father').values('name') == hercules \u5c5e\u6027\u4f4d\u7f6e\u4e5f\u5728\u56fe\u5f62\u7d22\u5f15\u4e2d\u3002\u5c5e\u6027\u4f4d\u7f6e\u662f\u4e00\u4e2a\u8fb9\u5c5e\u6027\u3002\u56e0\u6b64\uff0cJanusGraph\u53ef\u4ee5\u7d22\u5f15\u56fe\u7d22\u5f15\u4e2d\u7684\u8fb9\u3002\u53ef\u4ee5\u67e5\u8be2\u5728\u96c5\u517850\u516c\u91cc\u5185\u53d1\u751f\u7684\u6240\u6709\u4e8b\u4ef6\uff08\u7eac\u5ea6\uff1a37.97\u548c\u957f\u5ea6\uff1a23.72\uff09\u3002\u7136\u540e\uff0c\u7ed9\u5b9a\u8fd9\u4e9b\u4fe1\u606f\uff0c\u54ea\u4e9b\u9876\u70b9\u53c2\u4e0e\u4e86\u8fd9\u4e9b\u4e8b\u4ef6\u3002 gremlin g.E().has('place', geoWithin(Geoshape.circle(37.97, 23.72, 50))) == e[a9x-co8-9hx-39s][16424-battled- 4240] == e[9vp-co8-9hx-9ns][16424-battled- 12520] gremlin g.E().has('place', geoWithin(Geoshape.circle(37.97, 23.72, 50))).as('source').inV().as('god2').select('source').outV().as('god1').select('god1', 'god2').by('name') == [god1:hercules, god2:hydra] == [god1:hercules, god2:nemean] \u56fe\u7d22\u5f15\u662fJanusGraph\u4e2d\u7684\u4e00\u79cd\u7d22\u5f15\u7ed3\u6784\u3002JanusGraph\u81ea\u52a8\u9009\u62e9\u56fe\u5f62\u7d22\u5f15\uff0c\u4ee5\u56de\u7b54\u8981\u6c42\u6ee1\u8db3\u4e00\u4e2a\u6216\u591a\u4e2a\u7ea6\u675f\uff08\u4f8b\u5982\u6709\u6216\u95f4\u9694\uff09\u7684\u6240\u6709\u9876\u70b9\uff08g.V\uff09\u6216\u6240\u6709\u8fb9\uff08g.E\uff09\u7684\u95ee\u9898\u3002anusGraph\u4e2d\u7d22\u5f15\u7684\u7b2c\u4e8c\u4e2a\u65b9\u9762\u88ab\u79f0\u4e3a\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u3002\u9876\u70b9\u4e2d\u5fc3\u6307\u6570\u7528\u4e8e\u52a0\u901f\u56fe\u4e2d\u7684\u904d\u5386\u3002\u7a0d\u540e\u5c06\u63cf\u8ff0\u9876\u70b9\u4e2d\u5fc3\u6307\u6570\u3002 3.3.1 \u56fe\u904d\u5386\u5b9e\u4f8b Hercules\uff0cJupiter\u548cAlcmene\u7684\u513f\u5b50\uff0c\u201c\u8574\u85cf\u7740\u8d85\u4eba\u7684\u529b\u91cf\u201d\u3002Hercules\u662f\u4e2aDemigod(\u534a\u795e)\uff0c\u56e0\u4e3a\u4ed6\u7684\u7236\u4eb2\u662fGod\uff0c\u4ed6\u7684\u6bcd\u4eb2\u662f\u4eba\u7c7b\u3002Juno\uff0cJupiter\u7684\u59bb\u5b50\uff0c\u5bf9Jupiter\u7684\u4e0d\u5fe0\u611f\u5230\u6124\u6012\u3002\u4e3a\u4e86\u62a5\u4ec7\uff0c\u5979\u7528\u6682\u65f6\u7684\u7cbe\u795e\u9519\u4e71\u8499\u853d\u4e86Hercules\uff0c\u5e76\u5bfc\u81f4\u4ed6\u6740\u6b7b\u4ed6\u7684\u59bb\u5b50\u548c\u5b69\u5b50\u3002\u4e3a\u4e86\u8d4e\u7f6a\uff0c Oracle of Delphi\u7684\u795e\u8c15\u547d\u4ee4Hercules\u4e3aEurystheus\u670d\u52a1\u3002Eurystheus\u6307\u6d3e\u7ed9Hercules\u4e3a12\u540d\u52b3\u5de5\u3002 \u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u5b83\u8bc1\u660e\u4e86Saturn\u7684\u5b59\u5b50\u662fHercules\u3002\u8fd9\u53ef\u4ee5\u7528\u4e00\u4e2a\u5faa\u73af\u6765\u8868\u793a\u3002\u672c\u8d28\u4e0a\uff0cHercules\u662f\u6cbf\u7740\u201c\u7236\u4eb2\u201d\u8def\u5f84\u79bb\u5f00Hercules2\u6b65\u7684\u9876\u70b9\u3002 gremlin hercules = g.V(saturn).repeat(__.in('father')).times(2).next() == v[1536] Hercules\u662fdemigod(\u534a\u795e\u534a\u4eba)\u3002\u4e3a\u4e86\u8bc1\u660eHercules\u662f\u534a\u4eba\u534a\u795e\uff0c\u4ed6\u7236\u6bcd\u7684\u8d77\u6e90\u5fc5\u987b\u52a0\u4ee5\u8003\u8bc1\u3002\u6709\u53ef\u80fd\u4eceHercules\u9876\u70b9\u5230\u4ed6\u7684\u7236\u6bcd\u3002\u6700\u540e\uff0c\u53ef\u4ee5\u786e\u5b9a\u5b83\u4eec\u5206\u522b\u4ea7\u751f\u201c\u795e\u201d\u548c\u201c\u4eba\u201d\u7684\u7c7b\u578b\u3002 gremlin g.V(hercules).out('father', 'mother') == v[1024] == v[1792] gremlin g.V(hercules).out('father', 'mother').values('name') == jupiter == alcmene gremlin g.V(hercules).out('father', 'mother').label() == god == human gremlin hercules.label() == demigod \u8fc4\u4eca\u4e3a\u6b62\u7684\u4f8b\u5b50\u662f\u5173\u4e8e\u7f57\u9a6c\u4e07\u795e\u6bbf\u4e2d\u5404\u79cd\u89d2\u8272\u7684\u57fa\u56e0\u8c31\u7cfb\u3002 \u5c5e\u6027\u56fe\u6a21\u578b \u5177\u6709\u8db3\u591f\u7684\u8868\u8fbe\u80fd\u529b\uff0c\u53ef\u4ee5\u8868\u793a\u591a\u79cd\u7c7b\u578b\u7684\u4e8b\u7269\u548c\u5173\u7cfb\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u300a\u795e\u56fe\u300b\u8fd8\u786e\u5b9a\u4e86Hercules\u7684\u5404\u79cd\u82f1\u52c7\u4e8b\u8ff9\u2014\u2014\u4ed6\u8457\u540d\u768412\u9879\u52b3\u52a8\u3002\u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u4eba\u4eec\u53d1\u73b0Hercules\u53c2\u4e0e\u4e86\u96c5\u5178\u9644\u8fd1\u7684\u4e24\u573a\u6218\u5f79\u3002\u901a\u8fc7\u7a7f\u8d8aHercules\u9876\u70b9\u4e4b\u5916\u7684\u6218\u6597\u8fb9\u7f18\uff0c\u6709\u53ef\u80fd\u63a2\u7d22\u8fd9\u4e9b\u4e8b\u4ef6\u3002 gremlin g.V(hercules).out('battled') == v[2304] == v[2560] == v[2816] gremlin g.V(hercules).out('battled').valueMap() == [name:[nemean]] == [name:[hydra]] == [name:[cerberus]] gremlin g.V(hercules).outE('battled').has('time', gt(1)).inV().values('name') == cerberus == hydra \u6218\u6597\u8fb9\u7684\u5c5e\u6027time\u7531\u4e00\u4e2a\u9876\u70b9\u7684vertex-centric\u6307\u6570\u7d22\u5f15\u3002\u6839\u636e\u7ea6\u675f/\u6ee4\u6ce2\u5668\u6309\u65f6\u68c0\u7d22\u5165\u5c04\u5230Hercules\u7684\u6218\u6597\u8fb9\u7f18\u6bd4\u8fdb\u884c\u6240\u6709\u8fb9\u7f18\u7684\u7ebf\u6027\u626b\u63cf\u548c\u6ee4\u6ce2(\u901a\u5e38\u4e3aO(log n)\uff0c\u5176\u4e2dn\u662f\u5165\u5c04\u8fb9\u7684\u6570\u76ee)\u8981\u5feb\u3002JanusGraph\u8db3\u591f\u667a\u80fd\uff0c\u53ef\u4ee5\u5728\u4f7f\u7528\u65f6\u4f7f\u7528\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u3002Gremlin\u8868\u8fbe\u5f0f\u7684toString()\u663e\u793a\u5206\u89e3\u4e3a\u5404\u4e2a\u6b65\u9aa4\u3002 gremlin g.V(hercules).outE('battled').has('time', gt(1)).inV().values('name').toString() == [GraphStep([v[24744]],vertex), VertexStep(OUT,[battled],edge), HasStep([time.gt(1)]), EdgeVertexStep 3.3.2 \u66f4\u590d\u6742\u7684\u56fe\u904d\u5386\u793a\u4f8b \u51a5\u5e9c\u6df1\u5904\u7684\u51a5\u738b\u661f\u3002\u4ed6\u4e0eHercules\u7684\u5173\u7cfb\u56e0Hercules\u4e0e\u4ed6\u7684\u5ba0\u7269Cerberus\u640f\u6597\u800c\u7d27\u5f20\u3002\u7136\u800c\uff0cHercules\u662f\u4ed6\u7684\u4f84\u5b50\uff0c\u4ed6\u5e94\u8be5\u5982\u4f55\u8ba9Hercules\u4e3a\u4ed6\u7684\u50b2\u6162\u4ed8\u51fa\u4ee3\u4ef7\uff1f \u4e0b\u9762\u7684Gremlin\u904d\u5386\u5728Gods\u7684\u56fe\u4e0a\u63d0\u4f9b\u66f4\u591a\u7684\u4f8b\u5b50\u3002\u6bcf\u4e2a\u904d\u5386\u7684\u89e3\u91ca\u5728\u5148\u524d\u884c\u4e2d\u63d0\u4f9b\u4e3aa//\u6ce8\u91ca\u3002 3.3.2.1 Tartarus\u7684\u540c\u5c45\u8005 gremlin pluto = g.V().has('name', 'pluto').next() == v[2048] gremlin // who are pluto's cohabitants? gremlin g.V(pluto).out('lives').in('lives').values('name') == pluto == cerberus gremlin // pluto can't be his own cohabitant gremlin g.V(pluto).out('lives').in('lives').where(is(neq(pluto))).values('name') == cerberus gremlin g.V(pluto).as('x').out('lives').in('lives').where(neq('x')).values('name') == cerberus 3.3.2.2. Pluto\u7684\u5144\u5f1f gremlin // where do pluto's brothers live? gremlin g.V(pluto).out('brother').out('lives').values('name') == sky == sea gremlin // which brother lives in which place? gremlin g.V(pluto).out('brother').as('god').out('lives').as('place').select('god', 'place') == [god:v[1024], place:v[512]] == [god:v[1280], place:v[768]] gremlin // what is the name of the brother and the name of the place? gremlin g.V(pluto).out('brother').as('god').out('lives').as('place').select('god', 'place').by('name') == [god:jupiter, place:sky] == [god:neptune, place:sea] \u6700\u540e\uff0c\u51a5\u738b\u661f(pluto)\u751f\u6d3b\u5728Tartarus\uff0c\u56e0\u4e3a\u4ed6\u4e0d\u5173\u5fc3\u751f\u6b7b\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4ed6\u7684\u5144\u5f1f\u4eec\u57fa\u4e8e\u5bf9\u90a3\u4e9b\u5730\u65b9\u67d0\u4e9b\u54c1\u8d28\u7684\u7231\u6765\u9009\u62e9\u4ed6\u4eec\u7684\u4f4d\u7f6e gremlin g.V(pluto).outE('lives').values('reason') == no fear of death gremlin g.E().has('reason', textContains('loves')) == e[6xs-sg-m51-e8][1024-lives- 512] == e[70g-zk-m51-lc][1280-lives- 768] gremlin g.E().has('reason', textContains('loves')).as('source').values('reason').as('reason').select('source').outV().values('name').as('god').select('source').inV().values('name').as('thing').select('god', 'reason', 'thing') == [god:neptune, reason:loves waves, thing:sea] == [god:jupiter, reason:loves fresh breezes, thing:sky] \u672c\u8282\u6982\u8ff0JanusGraph\u7684\u67b6\u6784\u548c\u4f18\u70b9\uff0c\u7136\u540e\u4f7f\u7528\u5c0f\u6559\u7a0b\u6570\u636e\u96c6\u5feb\u901f\u6d4f\u89c8JanusGraph\u7279\u6027\u3002","title":"3.\u5f00\u59cb"},{"location":"introduction/getting_started/#3","text":"\u56fe3.1 \u795e\u7684\u56fe\u5173\u7cfb Above: Cupcake indexer in progress","title":"3. \u5feb\u901f\u5f00\u59cb"},{"location":"introduction/getting_started/#31-janusgraphgremlin","text":"JanusGraph\u53ef\u4ee5\u4ece\u9879\u76ee\u4ed3\u5e93\u4e2d\u4e0b\u8f7d\u4e00\u4e2a\u53d1\u5e03\u7684 \u7248\u672c \u4e00\u65e6\u4e0b\u8f7d\u5e76\u89e3\u538b\uff0c\u4e00\u4e2aGremlin\u7684\u63a7\u5236\u53f0\b\u5c31\u53ef\u4ee5\u6253\u5f00\u3002Gremlin\u63a7\u5236\u53f0\u662f\u4e0eJanusGraph\u4e00\u8d77\u5206\u53d1\u7684 REPL \uff08\u5373\u4ea4\u4e92\u5f0fshell\uff09\uff0c\u5e76\u4e14\u4ec5\u4e0e\u6807\u51c6Gremlin\u63a7\u5236\u53f0\u4e0d\u540c\uff0c\u56e0\u4e3aJanusGraph\u662f\u9884\u5148\u5b89\u88c5\u548c\u9884\u52a0\u8f7d\u7684\u5305\u3002\u6216\u8005\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4ece\u4e2d\u592e\u5b58\u50a8\u5e93\u4e0b\u8f7dJanusGraph\u5305\u6765\u9009\u62e9\u5728\u73b0\u6709\u7684Gremlin\u63a7\u5236\u53f0\u4e2d\u5b89\u88c5\u548c\u6fc0\u6d3bJanusGraph\u3002\u4f46\u662f\uff0c\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c\u4f7f\u7528\u4e86 janusgraph.zip\uff0c\u8bf7\u786e\u4fdd\u89e3\u538b\u7f29\u4e86\u4e0b\u8f7d\u7684zip\u6587\u4ef6\u3002 \u91cd\u8981: JanusGraph\u4f9d\u8d56Java8\uff08\u6807\u51c6\u7248\uff09\u3002\u5efa\u8bae\u4f7f\u7528Oracle Java 8\u3002JanusGraph\u7684shell\u811a\u672c\u5e0c\u671b$JAVA_HOME\u73af\u5883\u53d8\u91cf\u6307\u5411\u5b89\u88c5JRE\u6216JDK\u7684\u76ee\u5f55\u3002 $ unzip janusgraph-0.3.1-hadoop2.zip Archive: janusgraph-0.3.1-hadoop2.zip creating: janusgraph-0.3.1-hadoop2/ ... $ cd janusgraph-0.3.1-hadoop2 $ bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- 09:12:24 INFO org.apache.tinkerpop.gremlin.hadoop.structure.HadoopGraph - HADOOP_GREMLIN_LIBS is set to: /usr/local/janusgraph/lib plugin activated: tinkerpop.hadoop plugin activated: janusgraph.imports gremlin Gremlin\u63a7\u5236\u53f0\u4f7f\u7528 Apache Groovy \u89e3\u91ca\u547d\u4ee4\u3002Groovy\u662fJava\u7684\u8d85\u96c6\uff0c\u5b83\u5177\u6709\u5404\u79cd\u7b80\u5316\u6807\u8bb0\uff0c\u4f7f\u4ea4\u4e92\u7f16\u7a0b\u66f4\u5bb9\u6613\u3002\u540c\u6837\u5730\uff0cGremlin-Groovy\u662fGroovy\u7684\u8d85\u96c6\uff0c\u5177\u6709\u5404\u79cd\u901f\u8bb0\u7b26\u53f7\uff0c\u4f7f\u56fe\u5f62\u904d\u5386\u53d8\u5f97\u5bb9\u6613\u3002\u4e0b\u9762\u7684\u57fa\u672c\u793a\u4f8b\u6f14\u793a\u5904\u7406\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u548c\u6620\u5c04\u3002\u672c\u6559\u7a0b\u7684\u5176\u4f59\u90e8\u5206\u5c06\u8ba8\u8bba\u7279\u5b9a\u4e8e\u56fe\u5f62\u7684\u6784\u9020\u3002 gremlin 100-10 == 90 gremlin \"JanusGraph:\" + \" The Rise of Big Graph Data\" == JanusGraph: The Rise of Big Graph Data gremlin [name:'aurelius', vocation:['philosopher', 'emperor']] == name=aurelius == vocation=[philosopher, emperor] \u63d0\u793a \u5173\u4e8e Apache Tinkerpop , SQLEGremlin \u548c Gremlin R\becipes \u7684\u66f4\u591aGremlin\u7684\u4f7f\u7528\u4fe1\u606f\u3002","title":"3.1. \u4e0b\u8f7dJanusGraph\u548c\u8fd0\u884cGremlin\u63a7\u5236\u53f0"},{"location":"introduction/getting_started/#32-godsjanusgraph","text":"\u4e0b\u9762\u7684\u793a\u4f8b\u5c06\u6253\u5f00\u4e00\u4e2aJanusGraph\u56fe\u5f62\u5b9e\u4f8b\uff0c\u5e76\u52a0\u8f7d\u4e0a\u9762\u6240\u793a\u7684Gods\u6570\u636e\u96c6\u7684\u56fe\u3002JanusGraphFactory\u63d0\u4f9b\u4e86\u4e00\u7ec4\u9759\u6001\u6253\u5f00\u65b9\u6cd5\uff0c\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u91c7\u7528\u914d\u7f6e\u4f5c\u4e3a\u53c2\u6570\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u56fe\u5f62\u5b9e\u4f8b\u3002\u672c\u6559\u7a0b\u5728\u4f7f\u7528BerkeleyDB\u5b58\u50a8\u540e\u7aef\u548cElasticsearch\u7d22\u5f15\u540e\u7aef\u7684\u914d\u7f6e\u4e0a\u8c03\u7528\u8fd9\u4e9b\u5f00\u653e\u65b9\u6cd5\uff0c\u7136\u540e\u4f7f\u7528\u5e2e\u52a9\u7c7bGraphOfTheGodsFactory\u52a0\u8f7dGods\u7684\u56fe\u3002\u672c\u8282\u8df3\u8fc7\u914d\u7f6e\u7ec6\u8282\uff0c\u4f46\u662f\u5173\u4e8e\u5b58\u50a8\u540e\u7aef\u3001\u7d22\u5f15\u540e\u7aef\u53ca\u5176\u914d\u7f6e\u7684\u9644\u52a0\u4fe1\u606f\u53ef\u5728Part III,\u201c\u5b58\u50a8\u540e\u7aef\u201d\u3001Part IV\u201c\u7d22\u5f15\u540e\u7aef\u201d\u548c\u7b2c15\u7ae0\u201c\u914d\u7f6e\u53c2\u8003\u201d\u4e2d\u83b7\u5f97\u3002 gremlin graph = JanusGraphFactory.open('conf/janusgraph-berkeleyje-es.properties') == standardjanusgraph[berkeleyje:../db/berkeley] gremlin GraphOfTheGodsFactory.load(graph) == null gremlin g = graph.traversal() == graphtraversalsource[standardjanusgraph[berkeleyje:../db/berkeley], standard] \u5728\u8fd4\u56de\u65b0\u6784\u9020\u7684\u56fe\u4e4b\u524d\uff0cJanusGraphFactory.open()\u548cGraphOfTheGodsFactory.load()\u65b9\u6cd5\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5728\u56fe\u4e0a\u521b\u5efa\u5168\u5c40\u548c\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u96c6\u5408\u3002 \u5c06\u6240\u6709\u9876\u70b9\u6dfb\u52a0\u5230\u56fe\u5f62\u4ee5\u53ca\u5b83\u4eec\u7684\u5c5e\u6027\u3002 \u5c06\u6240\u6709\u7684\u8fb9\u52a0\u4e0a\u5b83\u4eec\u7684\u5c5e\u6027\u3002 \u8be6\u60c5\u8bf7\u53c2\u9605 GraphOfTheGodsFactory source code \u6e90\u4ee3\u7801\u3002 \u5bf9\u4e8e\u90a3\u4e9b\u4f7f\u7528JanusGraph/Cassandra\uff08\u6216JanusGraph/HBase\uff09\u7684\u7528\u6237\uff0c\u8bf7\u786e\u4fdd\u4f7f\u7528conf/janus.-cql-es.properties\uff08\u6216conf/janus.-hbase-es.properties\uff09\u548cGraphOfTheGodsFactory.load()\u3002 gremlin graph = JanusGraphFactory.open('conf/janusgraph-cql-es.properties') == standardjanusgraph[cql:[127.0.0.1]] gremlin GraphOfTheGodsFactory.load(graph) == null gremlin g = graph.traversal() == graphtraversalsource[standardjanusgraph[cql:[127.0.0.1]], standard]","title":"3.2. \u5c06Gods\u7684\u56fe\u5173\u7cfb\u5bfc\u5165\u5230JanusGraph"},{"location":"introduction/getting_started/#33","text":"\u8bbf\u95ee\u56fe\u5f62\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u5178\u578b\u6a21\u5f0f\u662f\u9996\u5148\u4f7f\u7528\u56fe\u5f62\u7d22\u5f15\u5b9a\u4f4d\u5230\u56fe\u5f62\u4e2d\u7684\u5165\u53e3\u70b9\u3002\u8be5\u5165\u53e3\u70b9\u662f\u5143\u7d20\uff08\u6216\u4e00\u7ec4\u5143\u7d20\uff09-\u5373\u9876\u70b9\u6216\u8fb9\u3002\u4ece\u6761\u76ee\u5143\u7d20\u4e2d\uff0cGremlin\u8def\u5f84\u63cf\u8ff0\u63cf\u8ff0\u4e86\u5982\u4f55\u901a\u8fc7\u663e\u5f0f\u56fe\u7ed3\u6784\u904d\u5386\u5230\u56fe\u4e2d\u7684\u5176\u4ed6\u5143\u7d20\u3002 \u7ed9\u5b9aname\u5c5e\u6027\u4e0a\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u7d22\u5f15\uff0c\u53ef\u4ee5\u68c0\u7d22Saturn\u9876\u70b9\u3002\u7136\u540e\u53ef\u4ee5\u68c0\u67e5\u5c5e\u6027\u6620\u5c04\uff08\u5373Saturn\u7684\u5bc6\u94a5/\u503c\u5bf9\uff09\u3002\u6b63\u5982\u6240\u5c55\u793a\u7684\uff0c\u571f\u661f\u9876\u70b9\u7684\u540d\u5b57\u662f\u201cSaturn\u201d\uff0c\u5e74\u9f84\u4e3a10000\u5c81\uff0c\u662f\u4e00\u79cd\u201ctitan\u201d\u3002Saturn\u7684\u5b59\u5b50\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u904d\u5386\u8868\u8ff0\uff1a\u201c\u8c01\u662fSaturn\u7684\u5b59\u5b50\uff1f\u201d\u201c\u7236\u4eb2\u201d\u7684\u5012\u6570\u662f\u201c\u5b69\u5b50\u201d\u3002\u7ed3\u679c\u5c31\u662fHercules\u3002 gremlin saturn = g.V().has('name', 'saturn').next() == v[256] gremlin g.V(saturn).valueMap() == [name:[saturn], age:[10000]] gremlin g.V(saturn).in('father').in('father').values('name') == hercules \u5c5e\u6027\u4f4d\u7f6e\u4e5f\u5728\u56fe\u5f62\u7d22\u5f15\u4e2d\u3002\u5c5e\u6027\u4f4d\u7f6e\u662f\u4e00\u4e2a\u8fb9\u5c5e\u6027\u3002\u56e0\u6b64\uff0cJanusGraph\u53ef\u4ee5\u7d22\u5f15\u56fe\u7d22\u5f15\u4e2d\u7684\u8fb9\u3002\u53ef\u4ee5\u67e5\u8be2\u5728\u96c5\u517850\u516c\u91cc\u5185\u53d1\u751f\u7684\u6240\u6709\u4e8b\u4ef6\uff08\u7eac\u5ea6\uff1a37.97\u548c\u957f\u5ea6\uff1a23.72\uff09\u3002\u7136\u540e\uff0c\u7ed9\u5b9a\u8fd9\u4e9b\u4fe1\u606f\uff0c\u54ea\u4e9b\u9876\u70b9\u53c2\u4e0e\u4e86\u8fd9\u4e9b\u4e8b\u4ef6\u3002 gremlin g.E().has('place', geoWithin(Geoshape.circle(37.97, 23.72, 50))) == e[a9x-co8-9hx-39s][16424-battled- 4240] == e[9vp-co8-9hx-9ns][16424-battled- 12520] gremlin g.E().has('place', geoWithin(Geoshape.circle(37.97, 23.72, 50))).as('source').inV().as('god2').select('source').outV().as('god1').select('god1', 'god2').by('name') == [god1:hercules, god2:hydra] == [god1:hercules, god2:nemean] \u56fe\u7d22\u5f15\u662fJanusGraph\u4e2d\u7684\u4e00\u79cd\u7d22\u5f15\u7ed3\u6784\u3002JanusGraph\u81ea\u52a8\u9009\u62e9\u56fe\u5f62\u7d22\u5f15\uff0c\u4ee5\u56de\u7b54\u8981\u6c42\u6ee1\u8db3\u4e00\u4e2a\u6216\u591a\u4e2a\u7ea6\u675f\uff08\u4f8b\u5982\u6709\u6216\u95f4\u9694\uff09\u7684\u6240\u6709\u9876\u70b9\uff08g.V\uff09\u6216\u6240\u6709\u8fb9\uff08g.E\uff09\u7684\u95ee\u9898\u3002anusGraph\u4e2d\u7d22\u5f15\u7684\u7b2c\u4e8c\u4e2a\u65b9\u9762\u88ab\u79f0\u4e3a\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u3002\u9876\u70b9\u4e2d\u5fc3\u6307\u6570\u7528\u4e8e\u52a0\u901f\u56fe\u4e2d\u7684\u904d\u5386\u3002\u7a0d\u540e\u5c06\u63cf\u8ff0\u9876\u70b9\u4e2d\u5fc3\u6307\u6570\u3002","title":"3.3. \u5168\u5c40\u56fe\u7d22\u5f15"},{"location":"introduction/getting_started/#331","text":"Hercules\uff0cJupiter\u548cAlcmene\u7684\u513f\u5b50\uff0c\u201c\u8574\u85cf\u7740\u8d85\u4eba\u7684\u529b\u91cf\u201d\u3002Hercules\u662f\u4e2aDemigod(\u534a\u795e)\uff0c\u56e0\u4e3a\u4ed6\u7684\u7236\u4eb2\u662fGod\uff0c\u4ed6\u7684\u6bcd\u4eb2\u662f\u4eba\u7c7b\u3002Juno\uff0cJupiter\u7684\u59bb\u5b50\uff0c\u5bf9Jupiter\u7684\u4e0d\u5fe0\u611f\u5230\u6124\u6012\u3002\u4e3a\u4e86\u62a5\u4ec7\uff0c\u5979\u7528\u6682\u65f6\u7684\u7cbe\u795e\u9519\u4e71\u8499\u853d\u4e86Hercules\uff0c\u5e76\u5bfc\u81f4\u4ed6\u6740\u6b7b\u4ed6\u7684\u59bb\u5b50\u548c\u5b69\u5b50\u3002\u4e3a\u4e86\u8d4e\u7f6a\uff0c Oracle of Delphi\u7684\u795e\u8c15\u547d\u4ee4Hercules\u4e3aEurystheus\u670d\u52a1\u3002Eurystheus\u6307\u6d3e\u7ed9Hercules\u4e3a12\u540d\u52b3\u5de5\u3002 \u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u5b83\u8bc1\u660e\u4e86Saturn\u7684\u5b59\u5b50\u662fHercules\u3002\u8fd9\u53ef\u4ee5\u7528\u4e00\u4e2a\u5faa\u73af\u6765\u8868\u793a\u3002\u672c\u8d28\u4e0a\uff0cHercules\u662f\u6cbf\u7740\u201c\u7236\u4eb2\u201d\u8def\u5f84\u79bb\u5f00Hercules2\u6b65\u7684\u9876\u70b9\u3002 gremlin hercules = g.V(saturn).repeat(__.in('father')).times(2).next() == v[1536] Hercules\u662fdemigod(\u534a\u795e\u534a\u4eba)\u3002\u4e3a\u4e86\u8bc1\u660eHercules\u662f\u534a\u4eba\u534a\u795e\uff0c\u4ed6\u7236\u6bcd\u7684\u8d77\u6e90\u5fc5\u987b\u52a0\u4ee5\u8003\u8bc1\u3002\u6709\u53ef\u80fd\u4eceHercules\u9876\u70b9\u5230\u4ed6\u7684\u7236\u6bcd\u3002\u6700\u540e\uff0c\u53ef\u4ee5\u786e\u5b9a\u5b83\u4eec\u5206\u522b\u4ea7\u751f\u201c\u795e\u201d\u548c\u201c\u4eba\u201d\u7684\u7c7b\u578b\u3002 gremlin g.V(hercules).out('father', 'mother') == v[1024] == v[1792] gremlin g.V(hercules).out('father', 'mother').values('name') == jupiter == alcmene gremlin g.V(hercules).out('father', 'mother').label() == god == human gremlin hercules.label() == demigod \u8fc4\u4eca\u4e3a\u6b62\u7684\u4f8b\u5b50\u662f\u5173\u4e8e\u7f57\u9a6c\u4e07\u795e\u6bbf\u4e2d\u5404\u79cd\u89d2\u8272\u7684\u57fa\u56e0\u8c31\u7cfb\u3002 \u5c5e\u6027\u56fe\u6a21\u578b \u5177\u6709\u8db3\u591f\u7684\u8868\u8fbe\u80fd\u529b\uff0c\u53ef\u4ee5\u8868\u793a\u591a\u79cd\u7c7b\u578b\u7684\u4e8b\u7269\u548c\u5173\u7cfb\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u300a\u795e\u56fe\u300b\u8fd8\u786e\u5b9a\u4e86Hercules\u7684\u5404\u79cd\u82f1\u52c7\u4e8b\u8ff9\u2014\u2014\u4ed6\u8457\u540d\u768412\u9879\u52b3\u52a8\u3002\u5728\u4e0a\u4e00\u8282\u4e2d\uff0c\u4eba\u4eec\u53d1\u73b0Hercules\u53c2\u4e0e\u4e86\u96c5\u5178\u9644\u8fd1\u7684\u4e24\u573a\u6218\u5f79\u3002\u901a\u8fc7\u7a7f\u8d8aHercules\u9876\u70b9\u4e4b\u5916\u7684\u6218\u6597\u8fb9\u7f18\uff0c\u6709\u53ef\u80fd\u63a2\u7d22\u8fd9\u4e9b\u4e8b\u4ef6\u3002 gremlin g.V(hercules).out('battled') == v[2304] == v[2560] == v[2816] gremlin g.V(hercules).out('battled').valueMap() == [name:[nemean]] == [name:[hydra]] == [name:[cerberus]] gremlin g.V(hercules).outE('battled').has('time', gt(1)).inV().values('name') == cerberus == hydra \u6218\u6597\u8fb9\u7684\u5c5e\u6027time\u7531\u4e00\u4e2a\u9876\u70b9\u7684vertex-centric\u6307\u6570\u7d22\u5f15\u3002\u6839\u636e\u7ea6\u675f/\u6ee4\u6ce2\u5668\u6309\u65f6\u68c0\u7d22\u5165\u5c04\u5230Hercules\u7684\u6218\u6597\u8fb9\u7f18\u6bd4\u8fdb\u884c\u6240\u6709\u8fb9\u7f18\u7684\u7ebf\u6027\u626b\u63cf\u548c\u6ee4\u6ce2(\u901a\u5e38\u4e3aO(log n)\uff0c\u5176\u4e2dn\u662f\u5165\u5c04\u8fb9\u7684\u6570\u76ee)\u8981\u5feb\u3002JanusGraph\u8db3\u591f\u667a\u80fd\uff0c\u53ef\u4ee5\u5728\u4f7f\u7528\u65f6\u4f7f\u7528\u9876\u70b9\u4e2d\u5fc3\u7d22\u5f15\u3002Gremlin\u8868\u8fbe\u5f0f\u7684toString()\u663e\u793a\u5206\u89e3\u4e3a\u5404\u4e2a\u6b65\u9aa4\u3002 gremlin g.V(hercules).outE('battled').has('time', gt(1)).inV().values('name').toString() == [GraphStep([v[24744]],vertex), VertexStep(OUT,[battled],edge), HasStep([time.gt(1)]), EdgeVertexStep","title":"3.3.1 \u56fe\u904d\u5386\u5b9e\u4f8b"},{"location":"introduction/getting_started/#332","text":"\u51a5\u5e9c\u6df1\u5904\u7684\u51a5\u738b\u661f\u3002\u4ed6\u4e0eHercules\u7684\u5173\u7cfb\u56e0Hercules\u4e0e\u4ed6\u7684\u5ba0\u7269Cerberus\u640f\u6597\u800c\u7d27\u5f20\u3002\u7136\u800c\uff0cHercules\u662f\u4ed6\u7684\u4f84\u5b50\uff0c\u4ed6\u5e94\u8be5\u5982\u4f55\u8ba9Hercules\u4e3a\u4ed6\u7684\u50b2\u6162\u4ed8\u51fa\u4ee3\u4ef7\uff1f \u4e0b\u9762\u7684Gremlin\u904d\u5386\u5728Gods\u7684\u56fe\u4e0a\u63d0\u4f9b\u66f4\u591a\u7684\u4f8b\u5b50\u3002\u6bcf\u4e2a\u904d\u5386\u7684\u89e3\u91ca\u5728\u5148\u524d\u884c\u4e2d\u63d0\u4f9b\u4e3aa//\u6ce8\u91ca\u3002","title":"3.3.2 \u66f4\u590d\u6742\u7684\u56fe\u904d\u5386\u793a\u4f8b"},{"location":"introduction/getting_started/#3321-tartarus","text":"gremlin pluto = g.V().has('name', 'pluto').next() == v[2048] gremlin // who are pluto's cohabitants? gremlin g.V(pluto).out('lives').in('lives').values('name') == pluto == cerberus gremlin // pluto can't be his own cohabitant gremlin g.V(pluto).out('lives').in('lives').where(is(neq(pluto))).values('name') == cerberus gremlin g.V(pluto).as('x').out('lives').in('lives').where(neq('x')).values('name') == cerberus","title":"3.3.2.1 Tartarus\u7684\u540c\u5c45\u8005"},{"location":"introduction/getting_started/#3322-pluto","text":"gremlin // where do pluto's brothers live? gremlin g.V(pluto).out('brother').out('lives').values('name') == sky == sea gremlin // which brother lives in which place? gremlin g.V(pluto).out('brother').as('god').out('lives').as('place').select('god', 'place') == [god:v[1024], place:v[512]] == [god:v[1280], place:v[768]] gremlin // what is the name of the brother and the name of the place? gremlin g.V(pluto).out('brother').as('god').out('lives').as('place').select('god', 'place').by('name') == [god:jupiter, place:sky] == [god:neptune, place:sea] \u6700\u540e\uff0c\u51a5\u738b\u661f(pluto)\u751f\u6d3b\u5728Tartarus\uff0c\u56e0\u4e3a\u4ed6\u4e0d\u5173\u5fc3\u751f\u6b7b\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u4ed6\u7684\u5144\u5f1f\u4eec\u57fa\u4e8e\u5bf9\u90a3\u4e9b\u5730\u65b9\u67d0\u4e9b\u54c1\u8d28\u7684\u7231\u6765\u9009\u62e9\u4ed6\u4eec\u7684\u4f4d\u7f6e gremlin g.V(pluto).outE('lives').values('reason') == no fear of death gremlin g.E().has('reason', textContains('loves')) == e[6xs-sg-m51-e8][1024-lives- 512] == e[70g-zk-m51-lc][1280-lives- 768] gremlin g.E().has('reason', textContains('loves')).as('source').values('reason').as('reason').select('source').outV().values('name').as('god').select('source').inV().values('name').as('thing').select('god', 'reason', 'thing') == [god:neptune, reason:loves waves, thing:sea] == [god:jupiter, reason:loves fresh breezes, thing:sky] \u672c\u8282\u6982\u8ff0JanusGraph\u7684\u67b6\u6784\u548c\u4f18\u70b9\uff0c\u7136\u540e\u4f7f\u7528\u5c0f\u6559\u7a0b\u6570\u636e\u96c6\u5feb\u901f\u6d4f\u89c8JanusGraph\u7279\u6027\u3002","title":"3.3.2.2. Pluto\u7684\u5144\u5f1f"},{"location":"introduction/the_benefits_of_janusgraph/","text":"JanusGraph\u8bbe\u8ba1\u7684\u76ee\u7684\u662f\u5904\u7406\u5927\u56fe\uff0c\u5355\u673a\u65e0\u8bba\u662f\u5728\u5b58\u50a8\u548c\u8ba1\u7b97\u80fd\u529b\u4e0a\u90fd\u65e0\u6cd5\u6ee1\u8db3\u5927\u56fe\u5904\u7406\u3002\u5927\u89c4\u6a21\u56fe\u5b9e\u65f6\u8ba1\u7b97\u548c\u5206\u6790\u662fJanusGraph\u6700\u57fa\u672c\u7684\u4f18\u52bf\u3002\u672c\u8282\u5c06\u8ba8\u8bba\u66f4\u591aJanusGraph\u7279\u6709\u7684\u4f18\u52bf\u4ee5\u53ca\u5b83\u5e95\u5c42\u652f\u6301\u7684\u5b58\u50a8\u65b9\u6848\u3002 1.1. JanusGraph\u7684\u4f18\u52bf \u652f\u6301\u975e\u5e38\u5927\u7684\u56fe\u3002JanusGraph\u901a\u8fc7\u6dfb\u52a0\u673a\u5668\u6a2a\u5411\u6269\u5c55\u96c6\u7fa4\u3002 \u652f\u6301\u5f88\u5927\u7684\u5e76\u53d1\u4e8b\u52a1\u5904\u7406\u548c\u56fe\u64cd\u4f5c\u5904\u7406\u3002\u901a\u8fc7\u6dfb\u52a0\u673a\u5668\u6a2a\u5411\u6269\u5c55JanusGraph\u7684\u4e8b\u52a1\u5904\u7406\u80fd\u529b\uff0c\u53ef\u4ee5\u5728\u6beb\u79d2\u7ea7\u522b\u76f8\u5e94\u5927\u56fe\u7684\u590d\u6742\u67e5\u8be2\u3002 \u652f\u6301\u4f7f\u7528Hadoop\u6846\u67b6\u8fdb\u884c\u5168\u5c40\u56fe\u5206\u6790\u548c\u6279\u91cf\u56fe\u5904\u7406\u3002 \u652f\u6301\u5728\u5f88\u5927\u7684\u56fe\u4e0a\u5bf9\u9876\u70b9\u548c\u8fb9\u8fdb\u884c\u5730\u7406\u4f4d\u7f6e\u3001\u6570\u503c\u8303\u56f4\u3001\u5168\u6587\u641c\u7d22\u3002 \u539f\u751f\u652f\u6301Apache TinkerPop \u63cf\u8ff0\u7684\u5f53\u524d\u6d41\u884c\u7684\u5c5e\u6027\u56fe\u6570\u636e\u6a21\u578b\u3002 \u539f\u751f\u652f\u6301\u56fe\u904d\u5386\u8bed\u8a00Gremlin\u3002 \u901a\u8fc7\u4f7f\u7528\u975e\u7f16\u7a0b\u7684\u65b9\u5f0f\u8fde\u63a5\u5f88\u5bb9\u6613\u4e0eGremlin Server\u96c6\u6210\u3002 \u63d0\u4f9b\u4e86\u5f88\u591a\u56fe\u7ea7\u522b\u914d\u7f6e\u9009\u9879\u7528\u4e8e\u8c03\u8282\u6027\u80fd\u3002 \u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u63d0\u4f9b\u9876\u70b9\u7ea7\u67e5\u8be2\uff0c\u4ee5\u7f13\u89e3\u81ed\u540d\u662d\u7740\u7684\u8d85\u7ea7\u8282\u70b9\u95ee\u9898\u3002 \u63d0\u4f9b\u4f18\u5316\u7684\u78c1\u76d8\u8868\u793a\uff0c\u4ece\u800c\u5141\u8bb8\u6709\u6548\u5730\u4f7f\u7528\u5b58\u50a8\u548c\u8bbf\u95ee\u901f\u5ea6\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002 1.2. JanusGraph \u4f7f\u7528 Apache Cassandra\u7684\u4f18\u52bf \u8fde\u7eed\u53ef\u7528\uff0c\u6ca1\u6709\u5355\u70b9\u6545\u969c\u3002 \u7531\u4e8e\u6ca1\u6709\u4e3b/\u4ece\u67b6\u6784\uff0c\u56e0\u6b64\u5bf9\u56fe\u7684\u8bfb/\u5199\u6ca1\u6709\u74f6\u9888\u3002 \u5f39\u6027\u53ef\u6269\u5c55\u6027\u5141\u8bb8\u52a0\u5165\u548c\u79fb\u9664\u673a\u5668\u3002 \u7f13\u5b58\u5c42\u786e\u4fdd\u5185\u5b58\u4e2d\u591a\u6b21\u8fde\u7eed\u8bbf\u95ee\u7684\u6570\u636e\u53ef\u7528\u3002 \u901a\u8fc7\u6dfb\u52a0\u96c6\u7fa4\u7684\u673a\u5668\u6765\u589e\u52a0\u7f13\u5b58\u7684\u5927\u5c0f\u3002 \u53ef\u4ee5\u4e0e Apache Hadoop\u96c6\u6210\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002 1.3. JanusGraph \u4f7f\u7528 HBase\u7684\u4f18\u52bf \u4e0eApache Hadoop\u751f\u6001\u7cfb\u7edf\u7d27\u5bc6\u96c6\u6210\u3002 \u539f\u751f\u652f\u6301\u5f3a\u4e00\u81f4\u6027\u3002 \u901a\u8fc7\u6dfb\u52a0\u66f4\u591a\u673a\u5668\u8fdb\u884c\u7ebf\u6027\u6269\u5c55\u3002 \u4e25\u683c\u7684\u4e00\u81f4\u6027\u8bfb\u5199\u64cd\u4f5c\u3002 \u65b9\u4fbf\u7684\u57fa\u7c7b\u7528\u4e8e\u652f\u6301Hadoop MapReduce\u4f5c\u4e1a\u64cd\u4f5cHBase\u8868\u3002 \u652f\u6301\u4f7f\u7528JMX\u5bfc\u51fa\u76d1\u63a7\u6307\u6807\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002 1.4. JanusGraph \u548c CAP \u7406\u8bba \u5c3d\u7ba1\u4f60\u4ed8\u51fa\u4e86\u6700\u5927\u7684\u52aa\u529b\uff0c\u4f60\u7684\u7cfb\u7edf\u4ecd\u4f1a\u9047\u5230\u5f88\u591a\u7684\u9519\u8bef\uff0c\u4ee5\u81f3\u4e8e\u5fc5\u987b\u5728\u51cf\u5c11\u8f93\u51fa\uff08\u5982\uff1a\u505c\u6b62\u54cd\u5e94\u8bf7\u6c42\uff09\u548c\u964d\u4f4e\u6536\u83b7\uff08\u5982\uff1a\u54cd\u5e94\u4e0d\u5b8c\u6574\u7684\u7b54\u6848\uff09\u4e4b\u95f4\u505a\u51fa\u9009\u62e9\u3002 \u6b64\u51b3\u5b9a\u5e94\u57fa\u4e8e\u4e1a\u52a1\u8981\u6c42\u3002 -- Coda Hale \u4f7f\u7528\u6570\u636e\u5e93\u65f6\uff0c\u5e94\u5145\u5206\u8003\u8651CAP\u5b9a\u7406\uff08C =\u4e00\u81f4\u6027\uff0cA =\u53ef\u7528\u6027\uff0cP =\u53ef\u5206\u533a\u6027\uff09\u3002 JanusGraph\u53d1\u5e03\u5305\u4e2d\u652f\u63013\u4e2a\u540e\u7aef\uff1aApache Cassandra\uff0cApache HBase\u548cOracle Berkeley DB Java \u4f01\u4e1a\u7248\u3002 \u8bf7\u6ce8\u610f\uff0cBerkeleyDB JE\u662f\u4e00\u4e2a\u975e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u901a\u5e38\u4ec5\u4e0eJanusGraph\u4e00\u8d77\u7528\u4e8e\u6d4b\u8bd5\u548c\u63a2\u7d22\u3002 HBase\u4ee5\u8f93\u51fa\u4e3a\u4ee3\u4ef7\u4f18\u5148\u8003\u8651\u4e00\u81f4\u6027\uff0c\u5373\u5b8c\u6210\u8bf7\u6c42\u7684\u6982\u7387\u3002 Cassandra\u4ee5\u6536\u83b7\u4e3a\u4ee3\u4ef7\u4f18\u5148\u8003\u8651\u53ef\u7528\u6027\uff0c\u5373\u54cd\u5e94\u7684\u5b8c\u6574\u6027\uff08\u6570\u636e\u53ef\u7528\u6027/\u5b8c\u6574\u6570\u636e\uff09\u3002","title":"1.JanusGraph\u4f18\u52bf"},{"location":"introduction/the_benefits_of_janusgraph/#11-janusgraph","text":"\u652f\u6301\u975e\u5e38\u5927\u7684\u56fe\u3002JanusGraph\u901a\u8fc7\u6dfb\u52a0\u673a\u5668\u6a2a\u5411\u6269\u5c55\u96c6\u7fa4\u3002 \u652f\u6301\u5f88\u5927\u7684\u5e76\u53d1\u4e8b\u52a1\u5904\u7406\u548c\u56fe\u64cd\u4f5c\u5904\u7406\u3002\u901a\u8fc7\u6dfb\u52a0\u673a\u5668\u6a2a\u5411\u6269\u5c55JanusGraph\u7684\u4e8b\u52a1\u5904\u7406\u80fd\u529b\uff0c\u53ef\u4ee5\u5728\u6beb\u79d2\u7ea7\u522b\u76f8\u5e94\u5927\u56fe\u7684\u590d\u6742\u67e5\u8be2\u3002 \u652f\u6301\u4f7f\u7528Hadoop\u6846\u67b6\u8fdb\u884c\u5168\u5c40\u56fe\u5206\u6790\u548c\u6279\u91cf\u56fe\u5904\u7406\u3002 \u652f\u6301\u5728\u5f88\u5927\u7684\u56fe\u4e0a\u5bf9\u9876\u70b9\u548c\u8fb9\u8fdb\u884c\u5730\u7406\u4f4d\u7f6e\u3001\u6570\u503c\u8303\u56f4\u3001\u5168\u6587\u641c\u7d22\u3002 \u539f\u751f\u652f\u6301Apache TinkerPop \u63cf\u8ff0\u7684\u5f53\u524d\u6d41\u884c\u7684\u5c5e\u6027\u56fe\u6570\u636e\u6a21\u578b\u3002 \u539f\u751f\u652f\u6301\u56fe\u904d\u5386\u8bed\u8a00Gremlin\u3002 \u901a\u8fc7\u4f7f\u7528\u975e\u7f16\u7a0b\u7684\u65b9\u5f0f\u8fde\u63a5\u5f88\u5bb9\u6613\u4e0eGremlin Server\u96c6\u6210\u3002 \u63d0\u4f9b\u4e86\u5f88\u591a\u56fe\u7ea7\u522b\u914d\u7f6e\u9009\u9879\u7528\u4e8e\u8c03\u8282\u6027\u80fd\u3002 \u4ee5\u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15\u63d0\u4f9b\u9876\u70b9\u7ea7\u67e5\u8be2\uff0c\u4ee5\u7f13\u89e3\u81ed\u540d\u662d\u7740\u7684\u8d85\u7ea7\u8282\u70b9\u95ee\u9898\u3002 \u63d0\u4f9b\u4f18\u5316\u7684\u78c1\u76d8\u8868\u793a\uff0c\u4ece\u800c\u5141\u8bb8\u6709\u6548\u5730\u4f7f\u7528\u5b58\u50a8\u548c\u8bbf\u95ee\u901f\u5ea6\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002","title":"1.1. JanusGraph\u7684\u4f18\u52bf"},{"location":"introduction/the_benefits_of_janusgraph/#12-janusgraph-apache-cassandra","text":"\u8fde\u7eed\u53ef\u7528\uff0c\u6ca1\u6709\u5355\u70b9\u6545\u969c\u3002 \u7531\u4e8e\u6ca1\u6709\u4e3b/\u4ece\u67b6\u6784\uff0c\u56e0\u6b64\u5bf9\u56fe\u7684\u8bfb/\u5199\u6ca1\u6709\u74f6\u9888\u3002 \u5f39\u6027\u53ef\u6269\u5c55\u6027\u5141\u8bb8\u52a0\u5165\u548c\u79fb\u9664\u673a\u5668\u3002 \u7f13\u5b58\u5c42\u786e\u4fdd\u5185\u5b58\u4e2d\u591a\u6b21\u8fde\u7eed\u8bbf\u95ee\u7684\u6570\u636e\u53ef\u7528\u3002 \u901a\u8fc7\u6dfb\u52a0\u96c6\u7fa4\u7684\u673a\u5668\u6765\u589e\u52a0\u7f13\u5b58\u7684\u5927\u5c0f\u3002 \u53ef\u4ee5\u4e0e Apache Hadoop\u96c6\u6210\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002","title":"1.2. JanusGraph \u4f7f\u7528 Apache Cassandra\u7684\u4f18\u52bf"},{"location":"introduction/the_benefits_of_janusgraph/#13-janusgraph-hbase","text":"\u4e0eApache Hadoop\u751f\u6001\u7cfb\u7edf\u7d27\u5bc6\u96c6\u6210\u3002 \u539f\u751f\u652f\u6301\u5f3a\u4e00\u81f4\u6027\u3002 \u901a\u8fc7\u6dfb\u52a0\u66f4\u591a\u673a\u5668\u8fdb\u884c\u7ebf\u6027\u6269\u5c55\u3002 \u4e25\u683c\u7684\u4e00\u81f4\u6027\u8bfb\u5199\u64cd\u4f5c\u3002 \u65b9\u4fbf\u7684\u57fa\u7c7b\u7528\u4e8e\u652f\u6301Hadoop MapReduce\u4f5c\u4e1a\u64cd\u4f5cHBase\u8868\u3002 \u652f\u6301\u4f7f\u7528JMX\u5bfc\u51fa\u76d1\u63a7\u6307\u6807\u3002 \u57fa\u4e8e Apache 2 \u8bb8\u53ef\u534f\u8bae\u5f00\u653e\u6e90\u7801\u3002","title":"1.3. JanusGraph \u4f7f\u7528 HBase\u7684\u4f18\u52bf"},{"location":"introduction/the_benefits_of_janusgraph/#14-janusgraph-cap","text":"\u5c3d\u7ba1\u4f60\u4ed8\u51fa\u4e86\u6700\u5927\u7684\u52aa\u529b\uff0c\u4f60\u7684\u7cfb\u7edf\u4ecd\u4f1a\u9047\u5230\u5f88\u591a\u7684\u9519\u8bef\uff0c\u4ee5\u81f3\u4e8e\u5fc5\u987b\u5728\u51cf\u5c11\u8f93\u51fa\uff08\u5982\uff1a\u505c\u6b62\u54cd\u5e94\u8bf7\u6c42\uff09\u548c\u964d\u4f4e\u6536\u83b7\uff08\u5982\uff1a\u54cd\u5e94\u4e0d\u5b8c\u6574\u7684\u7b54\u6848\uff09\u4e4b\u95f4\u505a\u51fa\u9009\u62e9\u3002 \u6b64\u51b3\u5b9a\u5e94\u57fa\u4e8e\u4e1a\u52a1\u8981\u6c42\u3002 -- Coda Hale \u4f7f\u7528\u6570\u636e\u5e93\u65f6\uff0c\u5e94\u5145\u5206\u8003\u8651CAP\u5b9a\u7406\uff08C =\u4e00\u81f4\u6027\uff0cA =\u53ef\u7528\u6027\uff0cP =\u53ef\u5206\u533a\u6027\uff09\u3002 JanusGraph\u53d1\u5e03\u5305\u4e2d\u652f\u63013\u4e2a\u540e\u7aef\uff1aApache Cassandra\uff0cApache HBase\u548cOracle Berkeley DB Java \u4f01\u4e1a\u7248\u3002 \u8bf7\u6ce8\u610f\uff0cBerkeleyDB JE\u662f\u4e00\u4e2a\u975e\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u901a\u5e38\u4ec5\u4e0eJanusGraph\u4e00\u8d77\u7528\u4e8e\u6d4b\u8bd5\u548c\u63a2\u7d22\u3002 HBase\u4ee5\u8f93\u51fa\u4e3a\u4ee3\u4ef7\u4f18\u5148\u8003\u8651\u4e00\u81f4\u6027\uff0c\u5373\u5b8c\u6210\u8bf7\u6c42\u7684\u6982\u7387\u3002 Cassandra\u4ee5\u6536\u83b7\u4e3a\u4ee3\u4ef7\u4f18\u5148\u8003\u8651\u53ef\u7528\u6027\uff0c\u5373\u54cd\u5e94\u7684\u5b8c\u6574\u6027\uff08\u6570\u636e\u53ef\u7528\u6027/\u5b8c\u6574\u6570\u636e\uff09\u3002","title":"1.4.\u00a0JanusGraph \u548c CAP \u7406\u8bba"},{"location":"janusgraph_basics/common_questions/","text":"","title":"16.\u5e38\u89c1\u95ee\u9898"},{"location":"janusgraph_basics/configuration/","text":"\u4e00\u4e2aJanusGraph\u56fe\u6570\u636e\u5e93\u96c6\u7fa4\u7531\u4e00\u4e2a\u6216\u591a\u4e2aJanusGraph\u5b9e\u4f8b\u7ec4\u6210\u3002\u4e3a\u4e86\u6253\u5f00\u4e00\u4e2aJanusGraph\u5b9e\u4f8b\uff0c\u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u914d\u7f6e\u6307\u5b9aJanusGraph\u5982\u4f55\u53bb\u8bbe\u7f6e\u3002 \u4e00\u4e2aJanusGraph\u914d\u7f6e\u9700\u8981\u6307\u5b9a\u90a3\u4e9b\u7ec4\u4ef6\u53ef\u4ee5\u4f7f\u7528\uff0c\u63a7\u5236JanusGraph\u90e8\u7f72\u548c\u64cd\u4f5c\u7684\u5404\u4e2a\u65b9\u9762\u3002\u5e76\u63d0\u4f9b\u4e00\u4e9b\u8c03\u4f18\u9009\u9879\u6765\u8fbe\u5230JanusGraph\u96c6\u7fa4\u7684\u6700\u5927\u4f7f\u7528\u6027\u80fd\u3002 \u4e00\u4e2a\u6700\u4f4e\u7684\u914d\u7f6e\uff0cJanusGraph\u914d\u7f6e\u5fc5\u987b\u5b9a\u4e49\u4e00\u4e2a\u6301\u4e45\u5316\u5f15\u64ce\u4e5f\u5c31\u662fJanusGraph\u5b58\u50a8\u540e\u7aef\u3002 \u7b2c\u4e09\u7ae0\uff0c\u5b58\u50a8\u540e\u7aef \u5217\u4e3e\u4e86\u6240\u6709\u652f\u6301\u7684\u6301\u4e45\u5316\u5f15\u64ce\u4ee5\u53ca\u5206\u522b\u5982\u4f55\u914d\u7f6e\u4ed6\u4eec\u3002\u5982\u679c\u9700\u8981\u652f\u6301\u56fe\u7684\u9ad8\u7ea7\u67e5\u8be2\uff08\u4f8b\u5982\uff1a\u5168\u6587\u68c0\u7d22\uff0cGEO\u68c0\u7d22\u6216\u8005\u8303\u56f4\u68c0\u7d22\uff09\uff0c\u5fc5\u987b\u589e\u52a0\u914d\u7f6e\u4e00\u4e2a\u7d22\u5f15\u540e\u7aef\u3002\u8be6\u7ec6\u53ef\u89c1 \u7b2cIV\u90e8\u5206\uff0c\"\u7d22\u5f15\u540e\u7aef\" \u3002\u5982\u679c\u5173\u6ce8\u67e5\u8be2\u6027\u80fd\uff0c\u9700\u8981\u652f\u6301\u7f13\u5b58\u3002\u7f13\u5b58\u7684\u8bbe\u7f6e\u548c\u8c03\u4f18\u5728 \u7b2c13\u7ae0 JanusGraph \u7f13\u5b58 \u6709\u8be6\u7ec6\u63cf\u8ff0\u3002 4.1. \u914d\u7f6e\u793a\u4f8b \u4ee5\u4e0b\u90e8\u5206\u662f\u4e00\u4e9b\u89e3\u91ca\u5982\u4f55\u5728\u4e00\u4e9b\u901a\u7528\u7684\u540e\u7aef\u5f15\u64ce\u8fdb\u884c\u914d\u7f6e\u7684\u793a\u4f8b\uff0c\u7d22\u5f15\u7cfb\u7edf\u548c\u6027\u80fd\u7ec4\u4ef6\uff0c\u8fd9\u53ea\u6d89\u53ca\u4e00\u5c0f\u90e8\u5206\u53ef\u7528\u7684\u914d\u7f6e\u9009\u9879\u3002\u53c2\u7167 \u7b2c15\u7ae0 \u914d\u7f6e\u6307\u5357 \u6709\u6240\u6709\u9009\u9879\u7684\u914d\u7f6e\u3002 4.1.1. Cassandra+Elasticsearch \u8bbe\u7f6eJanusGraph\u4f7f\u7528Cassandra\u5728\u672c\u5730\u8fd0\u884c\u7684\u6301\u4e45\u5316\u5f15\u64ce storage.backend=cql storage.hostname=localhost index.search.backend=elasticsearch index.search.hostname=100.100.101.1, 100.100.101.2 index.search.elasticsearch.client-only=true 4.1.2. HBase+Caching \u8bbe\u7f6eJanusGraph\u4f7f\u7528\u8fdc\u7a0b\u8fd0\u884c\u7684HBase\u5b58\u50a8\u5f15\u64ce\uff0c\u4e3a\u4e86\u83b7\u53d6\u66f4\u597d\u7684\u6027\u80fd\uff0c\u540c\u65f6\u4f7f\u7528JanusGraph\u7684\u7f13\u5b58\u7ec4\u4ef6\u3002 storage.hostname=100.100.101.1 storage.port=2181 cache.db-cache = true cache.db-cache-clean-wait = 20 cache.db-cache-time = 180000 cache.db-cache-size = 0.5 4.1.3. BerkeleyDB \u8bbe\u7f6eJanusGraph\u4f7f\u7528BerkeleyDB\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u5b58\u50a8\u5f15\u64ce\uff0c\u5c06Elasticsearch\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u7d22\u5f15\u7cfb\u7edf\u3002 storage.backend=berkeleyje storage.directory=/tmp/graph index.search.backend=elasticsearch index.search.directory=/tmp/searchindex index.search.elasticsearch.client-only=false index.search.elasticsearch.local-mode=true \u7b2c15\u7ae0\uff1a\u914d\u7f6e\u53c2\u8003 \u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6240\u6709\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 JanusGraph\u53d1\u884c\u7248\u7684conf\u76ee\u5f55\u5305\u542b\u5176\u4ed6\u914d\u7f6e\u793a\u4f8b\u3002 4.1.4. \u66f4\u591a\u793a\u4f8b conf/\u76ee\u5f55\u4e2d\u6709\u51e0\u4e2a\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u53ef\u7528\u4e8e\u5feb\u901f\u542f\u52a8JanusGraph\u3002 \u8fd9\u4e9b\u6587\u4ef6\u7684\u8def\u5f84\u53ef\u4ee5\u4f20\u9012\u7ed9JanusGraphFactory.open\uff08...\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff1a // Connect to Cassandra on localhost using a default configuration graph = JanusGraphFactory.open(\"conf/janusgraph-cql.properties\") // Connect to HBase on localhost using a default configuration graph = JanusGraphFactory.open(\"conf/janusgraph-hbase.properties\") 4.2. \u5e94\u7528\u914d\u7f6e \u5982\u4f55\u4e3aJanusGraph\u63d0\u4f9b\u914d\u7f6e\u53d6\u51b3\u4e8e\u5b9e\u4f8b\u5316\u6a21\u5f0f\u3002 4.2.1 JanusGraph\u5de5\u5382\u6a21\u5f0f 4.2.1.1. Gremlin\u63a7\u5236\u53f0 JanusGraph\u53d1\u884c\u7248\u5305\u542b\u4e00\u4e2a\u547d\u4ee4\u884cGremlin Console\uff0c\u5b83\u53ef\u4ee5\u8ba9\u60a8\u8f7b\u677e\u5165\u95e8\u5e76\u4e0eJanusGraph\u8fdb\u884c\u4ea4\u4e92\u3002 \u8c03\u7528bin/gremlin.sh\uff08Unix/Linux\u6216bin/gremlin.ba\uff08Windows)\u4ee5\u542f\u52a8\u63a7\u5236\u53f0\uff0c\u7136\u540e\u4f7f\u7528\u51fa\u5382\u6253\u5f00JanusGraph\u56fe\uff0c\u5176\u914d\u7f6e\u5b58\u50a8\u5728\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1a graph = JanusGraphFactory.open('path/to/configuration.properties') 4.2.1.2. JanusGraph\u5d4c\u5165 4.2.1.3. \u77ed\u4ee3\u7801 \u5982\u679c\u5148\u524d\u5df2\u914d\u7f6eJanusGraph\u56fe\u96c6\u7fa4\u548c/\u6216\u4ec5\u9700\u8981\u5b9a\u4e49\u5b58\u50a8\u540e\u7aef\uff0c\u5219JanusGraphFactory\u63a5\u53d7\u5b58\u50a8\u540e\u7aef\u540d\u79f0\u548c\u4e3b\u673a\u540d\u6216\u76ee\u5f55\u7684\u4ee5\u5192\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002 graph = JanusGraphFactory.open('cql:localhost') graph = JanusGraphFactory.open('berkeleyje:/tmp/graph') 4.2.2. JanusGraph\u670d\u52a1\u7aef JanusGraph\u672c\u8eab\u5c31\u662f\u4e00\u7ec4\u6ca1\u6709\u6267\u884c\u7ebf\u7a0b\u7684jar\u6587\u4ef6\u3002 \u8fde\u63a5\u548c\u4f7f\u7528JanusGraph\u6570\u636e\u5e93\u6709\u4e24\u79cd\u57fa\u672c\u6a21\u5f0f\uff1a \u6a21\u5f0f\uff1a \u53ef\u4ee5\u901a\u8fc7\u5728\u7a0b\u5e8f\u63d0\u4f9b\u6267\u884c\u7ebf\u7a0b\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\u4e2d\u5d4c\u5165JanusGraph\u8c03\u7528\u6765\u4f7f\u7528JanusGraph\u3002 JanusGraph\u6253\u5305\u4e86\u4e00\u4e2a\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u5668\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u5728\u542f\u52a8\u65f6\u5141\u8bb8\u8fdc\u7a0b\u5ba2\u6237\u7aef\u6216\u903b\u8f91\u5728\u5355\u72ec\u7684\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u4ee5\u8fdb\u884cJanusGraph\u8c03\u7528\u3002\u8fd9\u4e2a\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u5668\u8fdb\u7a0b\u79f0\u4e3aJanusGraph Server\u3002 \u5bf9\u4e8eJanusGraph\u670d\u52a1\u5668\uff0cJanusGraph\u4f7f\u7528Apache TinkerPop\u5806\u6808\u7684Gremlin Server\u6765\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\u3002 JanusGraph\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f00\u7bb1\u5373\u7528\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u5feb\u901f\u542f\u52a8JanusGraph Server\uff0c\u4f46\u53ef\u4ee5\u66f4\u6539\u914d\u7f6e\u4ee5\u63d0\u4f9b\u5e7f\u6cdb\u7684\u670d\u52a1\u5668\u529f\u80fd\u3002 \u914d\u7f6eJanusGraph Server\u662f\u901a\u8fc7\u4f4d\u4e8eJanusGraph\u53d1\u884c\u7248\u7684./conf/gremlin-server\u76ee\u5f55\u4e2d\u7684JanusGraph Server yaml\u914d\u7f6e\u6587\u4ef6\u5b8c\u6210\u7684\u3002\u8981\u4f7f\u7528\u56fe\u5f62\u5b9e\u4f8b\uff08JanusGraph\uff09\u914d\u7f6eJanusGraph Server\uff0cJanusGraph Server\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u4ee5\u4e0b\u8bbe\u7f6e\uff1a ... graphs: { graph: conf/janusgraph-berkeleyje.properties } scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} ... \u56fe\u8868\u6761\u76ee\u5b9a\u4e49\u4e86\u4e0e\u7279\u5b9aJanusGraph\u914d\u7f6e\u7684\u7ed1\u5b9a\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5b83\u5c06\u56fe\u5f62\u7ed1\u5b9a\u5230conf / janusgraph-berkeleyje.properties\u4e0a\u7684JanusGraph\u914d\u7f6e\u3002 \u63d2\u4ef6\u6761\u76ee\u542f\u7528\u4e86JanusGraph Gremlin\u63d2\u4ef6\uff0c\u8be5\u63d2\u4ef6\u652f\u6301\u81ea\u52a8\u5bfc\u5165JanusGraph\u7c7b\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5728\u8fdc\u7a0b\u63d0\u4ea4\u7684\u811a\u672c\u4e2d\u5f15\u7528\u5b83\u4eec\u3002 \u5728\u7b2c7\u7ae0JanusGraph Server\u4e2d\u4e86\u89e3\u6709\u5173\u914d\u7f6e\u548c\u4f7f\u7528JanusGraph Server\u7684\u66f4\u591a\u4fe1\u606f\u3002 4.2.2.1. \u5206\u5e03\u5f0f\u670d\u52a1 JanusGraph zip\u6587\u4ef6\u5305\u542b\u4e00\u4e2a\u5feb\u901f\u542f\u52a8\u670d\u52a1\u5668\u7ec4\u4ef6\uff0c\u6709\u52a9\u4e8e\u66f4\u8f7b\u677e\u5730\u5f00\u59cb\u4f7f\u7528Gremlin Server\u548cJanusGraph\u3002 \u8c03\u7528bin/janusgraph.sh start\u4ee5\u4f7f\u7528Cassandra\u548cElasticsearch\u542f\u52a8Gremlin Server\u3002 \u6ce8\u610f \u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u548cjanusgraph.sh\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c* 4.3. \u5168\u5c40\u914d\u7f6e JanusGraph\u533a\u5206\u672c\u5730\u548c\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u672c\u5730\u914d\u7f6e\u9009\u9879\u9002\u7528\u4e8e\u5355\u4e2aJanusGraph\u5b9e\u4f8b\u3002\u5168\u5c40\u914d\u7f6e\u9009\u9879\u9002\u7528\u4e8e\u7fa4\u96c6\u4e2d\u7684\u6240\u6709\u5b9e\u4f8b\u3002\u66f4\u5177\u4f53\u5730\u8bf4\uff0cJanusGraph\u533a\u5206\u4e86\u4ee5\u4e0b\u4e94\u4e2a\u914d\u7f6e\u9009\u9879\u8303\u56f4\uff1a LOCAL\uff1a\u8fd9\u4e9b\u9009\u9879\u4ec5\u9002\u7528\u4e8e\u5355\u4e2aJanusGraph\u5b9e\u4f8b\uff0c\u5e76\u5728\u521d\u59cb\u5316JanusGraph\u5b9e\u4f8b\u65f6\u63d0\u4f9b\u7684\u914d\u7f6e\u4e2d\u6307\u5b9a\u3002 MASKABLE\uff1a\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u4e3a\u5355\u4e2aJanusGraph\u5b9e\u4f8b\u8986\u76d6\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002\u5982\u679c\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u672a\u6307\u5b9a\u8be5\u9009\u9879\uff0c\u5219\u4ece\u5168\u5c40JanusGraph\u96c6\u7fa4\u914d\u7f6e\u4e2d\u8bfb\u53d6\u5176\u503c\u3002 GLOBAL\uff1a\u59cb\u7ec8\u4ece\u7fa4\u96c6\u914d\u7f6e\u4e2d\u8bfb\u53d6\u8fd9\u4e9b\u9009\u9879\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u5b9e\u4f8b\u7684\u57fa\u7840\u4e0a\u8986\u76d6\u8fd9\u4e9b\u9009\u9879\u3002 GLOBAL_OFFLINE\uff1a\u4e0eGLOBAL\u4e00\u6837\uff0c\u4f46\u66f4\u6539\u8fd9\u4e9b\u9009\u9879\u9700\u8981\u91cd\u65b0\u542f\u52a8\u7fa4\u96c6\u4ee5\u786e\u4fdd\u6574\u4e2a\u7fa4\u96c6\u4e2d\u7684\u503c\u76f8\u540c\u3002 FIXED\uff1a\u4e0eGLOBAL\u4e00\u6837\uff0c\u4f46\u662f\u4e00\u65e6\u521d\u59cb\u5316JanusGraph\u96c6\u7fa4\uff0c\u5c31\u65e0\u6cd5\u66f4\u6539\u8be5\u503c\u3002 \u542f\u52a8\u96c6\u7fa4\u4e2d\u7684\u7b2c\u4e00\u4e2aJanusGraph\u5b9e\u4f8b\u65f6\uff0c\u5c06\u4ece\u63d0\u4f9b\u7684\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u521d\u59cb\u5316\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u968f\u540e\uff0c\u901a\u8fc7JanusGraph\u7684\u7ba1\u7406API\u5b8c\u6210\u66f4\u6539\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u8981\u8bbf\u95ee\u7ba1\u7406API\uff0c\u8bf7\u5728\u6253\u5f00\u7684JanusGraph\u5b9e\u4f8b\u53e5\u67c4g\u4e0a\u8c03\u7528g.getManagementSystem()\u3002\u4f8b\u5982\uff0c\u8981\u66f4\u6539JanusGraph\u96c6\u7fa4\u4e0a\u7684\u9ed8\u8ba4\u7f13\u5b58\u884c\u4e3a\uff1a mgmt = graph.openManagement() mgmt.get('cache.db-cache') // Prints the current config setting mgmt.set('cache.db-cache', true) // Changes option mgmt.get('cache.db-cache') // Prints 'true' mgmt.commit() // Changes take effect 4.3.1. \u79bb\u7ebf\u9009\u9879\u914d\u7f6e \u66f4\u6539\u914d\u7f6e\u9009\u9879\u4e0d\u4f1a\u5f71\u54cd\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\uff0c\u4ec5\u9002\u7528\u4e8e\u65b0\u542f\u52a8\u7684\u5b9e\u4f8b\u3002 \u66f4\u6539GLOBAL_OFFLINE\u914d\u7f6e\u9009\u9879\u9700\u8981\u91cd\u65b0\u542f\u52a8\u96c6\u7fa4\uff0c\u4ee5\u4f7f\u66f4\u6539\u7acb\u5373\u5bf9\u6240\u6709\u5b9e\u4f8b\u751f\u6548\u3002 \u8981\u66f4\u6539GLOBAL_OFFLINE\u9009\u9879\uff0c\u8bf7\u6309\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a \u5173\u95ed\u96c6\u7fa4\u4e2d\u9664\u4e00\u4e2aJanusGraph\u5b9e\u4f8b\u5916\u7684\u6240\u6709\u5b9e\u4f8b \u8fde\u63a5\u5230\u5355\u4e2a\u5b9e\u4f8b \u786e\u4fdd\u5173\u95ed\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1 \u786e\u4fdd\u6ca1\u6709\u542f\u52a8\u65b0\u4e8b\u52a1\uff08\u5373\u7fa4\u96c6\u5fc5\u987b\u8131\u673a\uff09 \u6253\u5f00\u7ba1\u7406API \u66f4\u6539\u914d\u7f6e\u9009\u9879 \u8c03\u7528commit\u5c06\u81ea\u52a8\u5173\u95ed\u56fe\u5f62\u5b9e\u4f8b \u91cd\u542f\u6240\u6709\u5b9e\u4f8b \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff08\u5305\u62ec\u6bcf\u4e2a\u9009\u9879\u7684\u914d\u7f6e\u8303\u56f4\uff09\uff0c\u8bf7\u53c2\u9605\u7b2c15\u7ae0\u201c\u914d\u7f6e\u53c2\u8003\u201d\u4e2d\u7684\u5b8c\u6574\u914d\u7f6e\u9009\u9879\u5217\u8868\u3002","title":"4.\u57fa\u672c\u914d\u7f6e"},{"location":"janusgraph_basics/configuration/#41","text":"\u4ee5\u4e0b\u90e8\u5206\u662f\u4e00\u4e9b\u89e3\u91ca\u5982\u4f55\u5728\u4e00\u4e9b\u901a\u7528\u7684\u540e\u7aef\u5f15\u64ce\u8fdb\u884c\u914d\u7f6e\u7684\u793a\u4f8b\uff0c\u7d22\u5f15\u7cfb\u7edf\u548c\u6027\u80fd\u7ec4\u4ef6\uff0c\u8fd9\u53ea\u6d89\u53ca\u4e00\u5c0f\u90e8\u5206\u53ef\u7528\u7684\u914d\u7f6e\u9009\u9879\u3002\u53c2\u7167 \u7b2c15\u7ae0 \u914d\u7f6e\u6307\u5357 \u6709\u6240\u6709\u9009\u9879\u7684\u914d\u7f6e\u3002","title":"4.1. \u914d\u7f6e\u793a\u4f8b"},{"location":"janusgraph_basics/configuration/#411-cassandraelasticsearch","text":"\u8bbe\u7f6eJanusGraph\u4f7f\u7528Cassandra\u5728\u672c\u5730\u8fd0\u884c\u7684\u6301\u4e45\u5316\u5f15\u64ce storage.backend=cql storage.hostname=localhost index.search.backend=elasticsearch index.search.hostname=100.100.101.1, 100.100.101.2 index.search.elasticsearch.client-only=true","title":"4.1.1. Cassandra+Elasticsearch"},{"location":"janusgraph_basics/configuration/#412-hbasecaching","text":"\u8bbe\u7f6eJanusGraph\u4f7f\u7528\u8fdc\u7a0b\u8fd0\u884c\u7684HBase\u5b58\u50a8\u5f15\u64ce\uff0c\u4e3a\u4e86\u83b7\u53d6\u66f4\u597d\u7684\u6027\u80fd\uff0c\u540c\u65f6\u4f7f\u7528JanusGraph\u7684\u7f13\u5b58\u7ec4\u4ef6\u3002 storage.hostname=100.100.101.1 storage.port=2181 cache.db-cache = true cache.db-cache-clean-wait = 20 cache.db-cache-time = 180000 cache.db-cache-size = 0.5","title":"4.1.2. HBase+Caching"},{"location":"janusgraph_basics/configuration/#413-berkeleydb","text":"\u8bbe\u7f6eJanusGraph\u4f7f\u7528BerkeleyDB\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u5b58\u50a8\u5f15\u64ce\uff0c\u5c06Elasticsearch\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u7d22\u5f15\u7cfb\u7edf\u3002 storage.backend=berkeleyje storage.directory=/tmp/graph index.search.backend=elasticsearch index.search.directory=/tmp/searchindex index.search.elasticsearch.client-only=false index.search.elasticsearch.local-mode=true \u7b2c15\u7ae0\uff1a\u914d\u7f6e\u53c2\u8003 \u8be6\u7ec6\u4ecb\u7ecd\u4e86\u6240\u6709\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002 JanusGraph\u53d1\u884c\u7248\u7684conf\u76ee\u5f55\u5305\u542b\u5176\u4ed6\u914d\u7f6e\u793a\u4f8b\u3002","title":"4.1.3. BerkeleyDB"},{"location":"janusgraph_basics/configuration/#414","text":"conf/\u76ee\u5f55\u4e2d\u6709\u51e0\u4e2a\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6\u53ef\u7528\u4e8e\u5feb\u901f\u542f\u52a8JanusGraph\u3002 \u8fd9\u4e9b\u6587\u4ef6\u7684\u8def\u5f84\u53ef\u4ee5\u4f20\u9012\u7ed9JanusGraphFactory.open\uff08...\uff09\uff0c\u5982\u4e0b\u6240\u793a\uff1a // Connect to Cassandra on localhost using a default configuration graph = JanusGraphFactory.open(\"conf/janusgraph-cql.properties\") // Connect to HBase on localhost using a default configuration graph = JanusGraphFactory.open(\"conf/janusgraph-hbase.properties\")","title":"4.1.4. \u66f4\u591a\u793a\u4f8b"},{"location":"janusgraph_basics/configuration/#42","text":"\u5982\u4f55\u4e3aJanusGraph\u63d0\u4f9b\u914d\u7f6e\u53d6\u51b3\u4e8e\u5b9e\u4f8b\u5316\u6a21\u5f0f\u3002","title":"4.2. \u5e94\u7528\u914d\u7f6e"},{"location":"janusgraph_basics/configuration/#421-janusgraph","text":"","title":"4.2.1 JanusGraph\u5de5\u5382\u6a21\u5f0f"},{"location":"janusgraph_basics/configuration/#4211-gremlin","text":"JanusGraph\u53d1\u884c\u7248\u5305\u542b\u4e00\u4e2a\u547d\u4ee4\u884cGremlin Console\uff0c\u5b83\u53ef\u4ee5\u8ba9\u60a8\u8f7b\u677e\u5165\u95e8\u5e76\u4e0eJanusGraph\u8fdb\u884c\u4ea4\u4e92\u3002 \u8c03\u7528bin/gremlin.sh\uff08Unix/Linux\u6216bin/gremlin.ba\uff08Windows)\u4ee5\u542f\u52a8\u63a7\u5236\u53f0\uff0c\u7136\u540e\u4f7f\u7528\u51fa\u5382\u6253\u5f00JanusGraph\u56fe\uff0c\u5176\u914d\u7f6e\u5b58\u50a8\u5728\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u914d\u7f6e\u6587\u4ef6\u4e2d\uff1a graph = JanusGraphFactory.open('path/to/configuration.properties')","title":"4.2.1.1. Gremlin\u63a7\u5236\u53f0"},{"location":"janusgraph_basics/configuration/#4212-janusgraph","text":"","title":"4.2.1.2. JanusGraph\u5d4c\u5165"},{"location":"janusgraph_basics/configuration/#4213","text":"\u5982\u679c\u5148\u524d\u5df2\u914d\u7f6eJanusGraph\u56fe\u96c6\u7fa4\u548c/\u6216\u4ec5\u9700\u8981\u5b9a\u4e49\u5b58\u50a8\u540e\u7aef\uff0c\u5219JanusGraphFactory\u63a5\u53d7\u5b58\u50a8\u540e\u7aef\u540d\u79f0\u548c\u4e3b\u673a\u540d\u6216\u76ee\u5f55\u7684\u4ee5\u5192\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002 graph = JanusGraphFactory.open('cql:localhost') graph = JanusGraphFactory.open('berkeleyje:/tmp/graph')","title":"4.2.1.3. \u77ed\u4ee3\u7801"},{"location":"janusgraph_basics/configuration/#422-janusgraph","text":"JanusGraph\u672c\u8eab\u5c31\u662f\u4e00\u7ec4\u6ca1\u6709\u6267\u884c\u7ebf\u7a0b\u7684jar\u6587\u4ef6\u3002 \u8fde\u63a5\u548c\u4f7f\u7528JanusGraph\u6570\u636e\u5e93\u6709\u4e24\u79cd\u57fa\u672c\u6a21\u5f0f\uff1a \u6a21\u5f0f\uff1a \u53ef\u4ee5\u901a\u8fc7\u5728\u7a0b\u5e8f\u63d0\u4f9b\u6267\u884c\u7ebf\u7a0b\u7684\u5ba2\u6237\u7aef\u7a0b\u5e8f\u4e2d\u5d4c\u5165JanusGraph\u8c03\u7528\u6765\u4f7f\u7528JanusGraph\u3002 JanusGraph\u6253\u5305\u4e86\u4e00\u4e2a\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u5668\u8fdb\u7a0b\uff0c\u8be5\u8fdb\u7a0b\u5728\u542f\u52a8\u65f6\u5141\u8bb8\u8fdc\u7a0b\u5ba2\u6237\u7aef\u6216\u903b\u8f91\u5728\u5355\u72ec\u7684\u7a0b\u5e8f\u4e2d\u8fd0\u884c\u4ee5\u8fdb\u884cJanusGraph\u8c03\u7528\u3002\u8fd9\u4e2a\u957f\u65f6\u95f4\u8fd0\u884c\u7684\u670d\u52a1\u5668\u8fdb\u7a0b\u79f0\u4e3aJanusGraph Server\u3002 \u5bf9\u4e8eJanusGraph\u670d\u52a1\u5668\uff0cJanusGraph\u4f7f\u7528Apache TinkerPop\u5806\u6808\u7684Gremlin Server\u6765\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u63d0\u4f9b\u670d\u52a1\u3002 JanusGraph\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5f00\u7bb1\u5373\u7528\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u5feb\u901f\u542f\u52a8JanusGraph Server\uff0c\u4f46\u53ef\u4ee5\u66f4\u6539\u914d\u7f6e\u4ee5\u63d0\u4f9b\u5e7f\u6cdb\u7684\u670d\u52a1\u5668\u529f\u80fd\u3002 \u914d\u7f6eJanusGraph Server\u662f\u901a\u8fc7\u4f4d\u4e8eJanusGraph\u53d1\u884c\u7248\u7684./conf/gremlin-server\u76ee\u5f55\u4e2d\u7684JanusGraph Server yaml\u914d\u7f6e\u6587\u4ef6\u5b8c\u6210\u7684\u3002\u8981\u4f7f\u7528\u56fe\u5f62\u5b9e\u4f8b\uff08JanusGraph\uff09\u914d\u7f6eJanusGraph Server\uff0cJanusGraph Server\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u4ee5\u4e0b\u8bbe\u7f6e\uff1a ... graphs: { graph: conf/janusgraph-berkeleyje.properties } scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} ... \u56fe\u8868\u6761\u76ee\u5b9a\u4e49\u4e86\u4e0e\u7279\u5b9aJanusGraph\u914d\u7f6e\u7684\u7ed1\u5b9a\u3002 \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5b83\u5c06\u56fe\u5f62\u7ed1\u5b9a\u5230conf / janusgraph-berkeleyje.properties\u4e0a\u7684JanusGraph\u914d\u7f6e\u3002 \u63d2\u4ef6\u6761\u76ee\u542f\u7528\u4e86JanusGraph Gremlin\u63d2\u4ef6\uff0c\u8be5\u63d2\u4ef6\u652f\u6301\u81ea\u52a8\u5bfc\u5165JanusGraph\u7c7b\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5728\u8fdc\u7a0b\u63d0\u4ea4\u7684\u811a\u672c\u4e2d\u5f15\u7528\u5b83\u4eec\u3002 \u5728\u7b2c7\u7ae0JanusGraph Server\u4e2d\u4e86\u89e3\u6709\u5173\u914d\u7f6e\u548c\u4f7f\u7528JanusGraph Server\u7684\u66f4\u591a\u4fe1\u606f\u3002","title":"4.2.2. JanusGraph\u670d\u52a1\u7aef"},{"location":"janusgraph_basics/configuration/#4221","text":"JanusGraph zip\u6587\u4ef6\u5305\u542b\u4e00\u4e2a\u5feb\u901f\u542f\u52a8\u670d\u52a1\u5668\u7ec4\u4ef6\uff0c\u6709\u52a9\u4e8e\u66f4\u8f7b\u677e\u5730\u5f00\u59cb\u4f7f\u7528Gremlin Server\u548cJanusGraph\u3002 \u8c03\u7528bin/janusgraph.sh start\u4ee5\u4f7f\u7528Cassandra\u548cElasticsearch\u542f\u52a8Gremlin Server\u3002 \u6ce8\u610f \u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u548cjanusgraph.sh\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c*","title":"4.2.2.1. \u5206\u5e03\u5f0f\u670d\u52a1"},{"location":"janusgraph_basics/configuration/#43","text":"JanusGraph\u533a\u5206\u672c\u5730\u548c\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u672c\u5730\u914d\u7f6e\u9009\u9879\u9002\u7528\u4e8e\u5355\u4e2aJanusGraph\u5b9e\u4f8b\u3002\u5168\u5c40\u914d\u7f6e\u9009\u9879\u9002\u7528\u4e8e\u7fa4\u96c6\u4e2d\u7684\u6240\u6709\u5b9e\u4f8b\u3002\u66f4\u5177\u4f53\u5730\u8bf4\uff0cJanusGraph\u533a\u5206\u4e86\u4ee5\u4e0b\u4e94\u4e2a\u914d\u7f6e\u9009\u9879\u8303\u56f4\uff1a LOCAL\uff1a\u8fd9\u4e9b\u9009\u9879\u4ec5\u9002\u7528\u4e8e\u5355\u4e2aJanusGraph\u5b9e\u4f8b\uff0c\u5e76\u5728\u521d\u59cb\u5316JanusGraph\u5b9e\u4f8b\u65f6\u63d0\u4f9b\u7684\u914d\u7f6e\u4e2d\u6307\u5b9a\u3002 MASKABLE\uff1a\u53ef\u4ee5\u901a\u8fc7\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u4e3a\u5355\u4e2aJanusGraph\u5b9e\u4f8b\u8986\u76d6\u8fd9\u4e9b\u914d\u7f6e\u9009\u9879\u3002\u5982\u679c\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u672a\u6307\u5b9a\u8be5\u9009\u9879\uff0c\u5219\u4ece\u5168\u5c40JanusGraph\u96c6\u7fa4\u914d\u7f6e\u4e2d\u8bfb\u53d6\u5176\u503c\u3002 GLOBAL\uff1a\u59cb\u7ec8\u4ece\u7fa4\u96c6\u914d\u7f6e\u4e2d\u8bfb\u53d6\u8fd9\u4e9b\u9009\u9879\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u5b9e\u4f8b\u7684\u57fa\u7840\u4e0a\u8986\u76d6\u8fd9\u4e9b\u9009\u9879\u3002 GLOBAL_OFFLINE\uff1a\u4e0eGLOBAL\u4e00\u6837\uff0c\u4f46\u66f4\u6539\u8fd9\u4e9b\u9009\u9879\u9700\u8981\u91cd\u65b0\u542f\u52a8\u7fa4\u96c6\u4ee5\u786e\u4fdd\u6574\u4e2a\u7fa4\u96c6\u4e2d\u7684\u503c\u76f8\u540c\u3002 FIXED\uff1a\u4e0eGLOBAL\u4e00\u6837\uff0c\u4f46\u662f\u4e00\u65e6\u521d\u59cb\u5316JanusGraph\u96c6\u7fa4\uff0c\u5c31\u65e0\u6cd5\u66f4\u6539\u8be5\u503c\u3002 \u542f\u52a8\u96c6\u7fa4\u4e2d\u7684\u7b2c\u4e00\u4e2aJanusGraph\u5b9e\u4f8b\u65f6\uff0c\u5c06\u4ece\u63d0\u4f9b\u7684\u672c\u5730\u914d\u7f6e\u6587\u4ef6\u521d\u59cb\u5316\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u968f\u540e\uff0c\u901a\u8fc7JanusGraph\u7684\u7ba1\u7406API\u5b8c\u6210\u66f4\u6539\u5168\u5c40\u914d\u7f6e\u9009\u9879\u3002\u8981\u8bbf\u95ee\u7ba1\u7406API\uff0c\u8bf7\u5728\u6253\u5f00\u7684JanusGraph\u5b9e\u4f8b\u53e5\u67c4g\u4e0a\u8c03\u7528g.getManagementSystem()\u3002\u4f8b\u5982\uff0c\u8981\u66f4\u6539JanusGraph\u96c6\u7fa4\u4e0a\u7684\u9ed8\u8ba4\u7f13\u5b58\u884c\u4e3a\uff1a mgmt = graph.openManagement() mgmt.get('cache.db-cache') // Prints the current config setting mgmt.set('cache.db-cache', true) // Changes option mgmt.get('cache.db-cache') // Prints 'true' mgmt.commit() // Changes take effect","title":"4.3. \u5168\u5c40\u914d\u7f6e"},{"location":"janusgraph_basics/configuration/#431","text":"\u66f4\u6539\u914d\u7f6e\u9009\u9879\u4e0d\u4f1a\u5f71\u54cd\u6b63\u5728\u8fd0\u884c\u7684\u5b9e\u4f8b\uff0c\u4ec5\u9002\u7528\u4e8e\u65b0\u542f\u52a8\u7684\u5b9e\u4f8b\u3002 \u66f4\u6539GLOBAL_OFFLINE\u914d\u7f6e\u9009\u9879\u9700\u8981\u91cd\u65b0\u542f\u52a8\u96c6\u7fa4\uff0c\u4ee5\u4f7f\u66f4\u6539\u7acb\u5373\u5bf9\u6240\u6709\u5b9e\u4f8b\u751f\u6548\u3002 \u8981\u66f4\u6539GLOBAL_OFFLINE\u9009\u9879\uff0c\u8bf7\u6309\u4ee5\u4e0b\u6b65\u9aa4\u64cd\u4f5c\uff1a \u5173\u95ed\u96c6\u7fa4\u4e2d\u9664\u4e00\u4e2aJanusGraph\u5b9e\u4f8b\u5916\u7684\u6240\u6709\u5b9e\u4f8b \u8fde\u63a5\u5230\u5355\u4e2a\u5b9e\u4f8b \u786e\u4fdd\u5173\u95ed\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1 \u786e\u4fdd\u6ca1\u6709\u542f\u52a8\u65b0\u4e8b\u52a1\uff08\u5373\u7fa4\u96c6\u5fc5\u987b\u8131\u673a\uff09 \u6253\u5f00\u7ba1\u7406API \u66f4\u6539\u914d\u7f6e\u9009\u9879 \u8c03\u7528commit\u5c06\u81ea\u52a8\u5173\u95ed\u56fe\u5f62\u5b9e\u4f8b \u91cd\u542f\u6240\u6709\u5b9e\u4f8b \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff08\u5305\u62ec\u6bcf\u4e2a\u9009\u9879\u7684\u914d\u7f6e\u8303\u56f4\uff09\uff0c\u8bf7\u53c2\u9605\u7b2c15\u7ae0\u201c\u914d\u7f6e\u53c2\u8003\u201d\u4e2d\u7684\u5b8c\u6574\u914d\u7f6e\u9009\u9879\u5217\u8868\u3002","title":"4.3.1. \u79bb\u7ebf\u9009\u9879\u914d\u7f6e"},{"location":"janusgraph_basics/configuration_reference/","text":"","title":"15.\u914d\u7f6e\u624b\u518c"},{"location":"janusgraph_basics/configuredgraphfactory/","text":"Chapter 9. ConfiguredGraphFactory \u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory\u914d\u7f6eJanusGraph\u670d\u52a1\u3002ConfiguredGraphFactory\u662f\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\uff0c\u7c7b\u4f3c\u4e8eJanusGraphFactory\u3002\u8fd9\u4e9b\u56fe\u5f62\u5de5\u5382\u63d0\u4f9b\u4e86\u52a8\u6001\u7ba1\u7406\u9a7b\u7559\u5728\u670d\u52a1\u5668\u4e0a\u7684\u56fe\u5f62\u7684\u65b9\u6cd5\u3002 9.1 \u6982\u89c8 JanusGraphFactory\u662f\u4e00\u4e2a\u7c7b\uff0c\u5b83\u901a\u8fc7\u5728\u6bcf\u6b21\u8bbf\u95ee\u56fe\u5f62\u65f6\u63d0\u4f9b\u4e00\u4e2a\u914d\u7f6e\u5bf9\u8c61\u6765\u63d0\u4f9b\u5bf9\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\u3002 ConfiguredGraphFactory\u63d0\u4f9b\u4e86\u5bf9\u60a8\u4e4b\u524d\u4f7f\u7528ConfigurationManagementGraph\u4e3a\u5176\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\u3002\u5b83\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bbf\u95ee\u70b9\u6765\u7ba1\u7406\u56fe\u5f62\u914d\u7f6e\u3002 ConfigurationManagementGraph\u5141\u8bb8\u60a8\u7ba1\u7406\u56fe\u5f62\u914d\u7f6e\u3002 JanusGraphManager\u662f\u4e00\u4e2a\u8ddf\u8e2a\u56fe\u5f62\u5f15\u7528\u7684\u5185\u90e8\u670d\u52a1\u5668\u7ec4\u4ef6\uff0c\u524d\u63d0\u662f\u60a8\u7684\u56fe\u5f62\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528\u5b83\u3002 9.2 ConfiguredGraphFactory\u4e0eJanusGraphFactory \u7136\u800c\uff0c\u8fd9\u4e24\u4e2a\u56fe\u5f62\u5de5\u5382\u4e4b\u95f4\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u533a\u522b: 1\u3001\u53ea\u6709\u5c06\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u4f7f\u7528ConfigurationManagementGraph api\uff0c\u624d\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory\u3002 \u4f7f\u7528ConfiguredGraphFactory\u7684\u597d\u5904\u662f: 1\u3001\u6bcf\u6b21\u6253\u5f00\u56fe\u5f62\u65f6\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5b57\u7b26\u4e32\u6765\u8bbf\u95ee\u56fe\u5f62\uff0c\u800c\u4e0d\u662fJanusGraphFactory\u2014\u2014\u5b83\u8981\u6c42\u60a8\u6307\u5b9a\u8bbf\u95ee\u56fe\u5f62\u65f6\u5e0c\u671b\u4f7f\u7528\u7684\u540e\u7aef\u4fe1\u606f\u3002 2\u3001\u5982\u679c\u914d\u7f6e\u4e86\u5206\u5e03\u5f0f\u5b58\u50a8\u540e\u7aef\uff0c\u90a3\u4e48\u96c6\u7fa4\u4e2d\u7684\u6240\u6709JanusGraph\u8282\u70b9\u90fd\u53ef\u4ee5\u4f7f\u7528\u60a8\u7684\u56fe\u5f62\u914d\u7f6e\u3002 9.3 ConfiguredGraphFactory\u5982\u4f55\u5de5\u4f5c ConfiguredGraphFactory\u63d0\u4f9b\u4e86\u4e24\u4e2a\u573a\u666f\u4e0b\u7684\u56fe\u5f62\u8bbf\u95ee\u70b9: 1\u3001\u60a8\u5df2\u7ecf\u4f7f\u7528ConfigurationManagementGraph#createConfiguration\u4e3a\u7279\u5b9a\u7684\u56fe\u5f62\u5bf9\u8c61\u521b\u5efa\u4e86\u914d\u7f6e\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u60a8\u7684\u56fe\u4f7f\u7528\u4f7f\u7528\u524d\u9762\u7684\u914d\u7f6e\u6253\u5f00\u3002 2\u3001\u60a8\u5df2\u7ecf\u4f7f\u7528ConfigurationManagementGraph#createTemplateConfiguration\u521b\u5efa\u4e86\u4e00\u4e2a\u6a21\u677f\u914d\u7f6e\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u590d\u5236\u6a21\u677f\u914d\u7f6e\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u5c5e\u6027\u5e76\u9644\u52a0\u76f8\u5173\u7684graphName\u5c5e\u6027\uff0c\u4e3a\u60a8\u6b63\u5728\u521b\u5efa\u7684\u56fe\u5f62\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\uff0c\u7136\u540e\u6839\u636e\u8be5\u7279\u5b9a\u914d\u7f6e\u6253\u5f00\u56fe\u5f62\u3002 9.4 \u8bbf\u95ee\u56fe \u60a8\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory.create(\u201cgraphName\u201d)\u6216ConfiguredGraphFactory.open(\u201cgraphName\u201d)\u3002\u901a\u8fc7\u9605\u8bfb\u4e0b\u9762\u5173\u4e8eConfigurationManagementGraph\u7684\u90e8\u5206\uff0c\u4e86\u89e3\u8fd9\u4e24\u4e2a\u9009\u9879\u4e4b\u95f4\u7684\u533a\u522b\u3002 \u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7ed1\u5b9a\u6765\u8bbf\u95ee\u56fe\u5f62\u3002\u57289.10\u8282\u201c\u56fe\u548c\u904d\u5386\u7ed1\u5b9a\u201d\u4e00\u8282\u4e86\u89e3\u66f4\u591a\u3002 9.5 \u5217\u51fa\u56fe ConfiguredGraphFactory.getGraphNames()\u5c06\u8fd4\u56de\u4e00\u7ec4\u4f60\u4f7f\u7528 ConfigurationManagementGraph APIs\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u3002 \u53e6\u4e00\u65b9\u9762\uff0cJanusGraphFactory.getGraphNames()\u8fd4\u56de\u4e00\u7ec4\u5df2\u5b9e\u4f8b\u5316\u7684\u56fe\u5f62\u540d\u79f0\uff0c\u5f15\u7528\u5b58\u50a8\u5728JanusGraphManager\u4e2d\u3002 9.6 \u5220\u9664\u56fe ConfiguredGraphFactory.drop(\"graphName\")\u5c06\u5220\u9664\u56fe\u5f62\u6570\u636e\u5e93\uff0c\u5b58\u50a8\u548c\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002 important:\u8fd9\u662f\u4e00\u4e2a\u4e0d\u53ef\u9006\u64cd\u4f5c\uff0c\u5c06\u5220\u9664\u6240\u6709\u56fe\u5f62\u548c\u7d22\u5f15\u6570\u636e\u3002 important:\u4e3a\u4e86\u786e\u4fdd\u96c6\u7fa4\u4e2d\u6240\u6709JanusGraph\u8282\u70b9\u4e4b\u95f4\u7684\u6240\u6709\u56fe\u5f62\u8868\u793a\u90fd\u662f\u4e00\u81f4\u7684\uff0c\u8fd9\u5c06\u4ece\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684JanusGraphManager\u56fe\u5f62\u7f13\u5b58\u4e2d\u5220\u9664\u56fe\u5f62\uff0c\u5047\u8bbe\u6bcf\u4e2a\u8282\u70b9\u90fd\u5df2\u6b63\u786e\u914d\u7f6e\u4e3a\u4f7f\u7528JanusGraphManager\u3002\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u6b64\u7279\u6027\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u60a8\u7684\u670d\u52a1\u5668\u6765\u4f7f\u7528\u6b64\u7279\u6027(https://docs.janusgraph.org/latest/things-to-consider-in-a-multi-node-janusgraph-cluster.html#graph-reference-consistency)\u3002 9.7 \u4e3aConfiguredGraphFactory\u914d\u7f6eJanusGraph Server \u4e3a\u4e86\u80fd\u591f\u4f7f\u7528ConfiguredGraphFactory\uff0c\u5fc5\u987b\u5c06\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u4f7f\u7528ConfigurationManagementGraph api\u3002\u4e3a\u6b64\uff0c\u5fc5\u987b\u5728\u670d\u52a1\u5668\u7684YAML\u7684\u56fe\u5f62\u6620\u5c04\u4e2d\u6ce8\u5165\u540d\u4e3a\u201cConfigurationManagementGraph\u201d\u7684\u56fe\u5f62\u53d8\u91cf\u3002\u4f8b\u5982: graphManager: org.janusgraph.graphdb.management.JanusGraphManager graphs: { ConfigurationManagementGraph: conf/JanusGraph-configurationmanagement.properties } \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u7684ConfigurationManagementGraph\u56fe\u5c06\u4f7f\u7528\u5b58\u50a8\u5728conf/JanusGraph-configurationmanagement\u4e2d\u7684\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\u5c5e\u6027\uff0c\u4f8b\u5982: gremlin.graph=org.janusgraph.core.JanusGraphFactory storage.backend=cql graph.graphname=ConfigurationManagementGraph storage.hostname=127.0.0.1 \u5047\u8bbeGremlinServer\u6210\u529f\u542f\u52a8\uff0c\u5e76\u4e14\u6210\u529f\u5b9e\u4f8b\u5316\u4e86ConfigurationManagementGraph\uff0c\u90a3\u4e48ConfigurationManagementGraph Singleton\u4e0a\u53ef\u7528\u7684\u6240\u6709api\u4e5f\u5c06\u5bf9\u8be5\u56fe\u8fdb\u884c\u64cd\u4f5c\u3002\u6b64\u5916\uff0c\u8fd9\u4e2a\u56fe\u5c06\u7528\u4e8e\u8bbf\u95ee\u4f7f\u7528ConfiguredGraphFactory\u521b\u5efa/\u6253\u5f00\u56fe\u5f62\u7684\u914d\u7f6e\u3002 \u91cd\u70b9:JanusGraph\u53d1\u884c\u7248\u4e2d\u5305\u542b\u7684pom.xml\u5c06\u6b64\u4f9d\u8d56\u9879\u5217\u4e3a\u53ef\u9009\u9879\uff0c\u4f46ConfiguredGraphFactory\u4f7f\u7528\u4e86JanusGraphManager,\u5b83\u9700\u8981\u58f0\u660e\u5bf9org.apache.tinkerpop:gremlin-server\u7684\u4f9d\u8d56\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u9047\u5230NoClassDefFoundError\u9519\u8bef\uff0c\u90a3\u4e48\u8bf7\u786e\u4fdd\u6839\u636e\u6b64\u6d88\u606f\u8fdb\u884c\u66f4\u65b0\u3002 9.8 ConfigurationManagementGraph ConfigurationManagementGraph\u662f\u4e00\u4e2a\u5355\u4f8b\u5bf9\u8c61\uff0c\u5b83\u5141\u8bb8\u60a8\u521b\u5efa/\u66f4\u65b0/\u5220\u9664\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u4f7f\u7528ConfiguredGraphFactory\u8bbf\u95ee\u60a8\u7684\u56fe\u5f62\u3002\u8bf7\u53c2\u9605\u4e0a\u9762\u5173\u4e8e\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u542f\u7528\u8fd9\u4e9bapi\u7684\u4ecb\u7ecd\u3002 \u91cd\u70b9\uff1aConfiguredGraphFactory\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bbf\u95ee\u70b9\u6765\u7ba1\u7406\u7531ConfigurationManagementGraph\u7ba1\u7406\u7684\u56fe\u5f62\u914d\u7f6e\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5bf9\u76f8\u5e94\u7684ConfiguredGraphFactory\u9759\u6001\u65b9\u6cd5\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u5bf9Singleton\u672c\u8eab\u8fdb\u884c\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory.removeTemplateConfiguration()\u800c\u4e0d\u662fConfiguredGraphFactory.getInstance().removetemplateconfiguration()\u3002 9.8.1 Graph Configurations ConfigurationManagementGraph\u5355\u4f8b\u5141\u8bb8\u60a8\u521b\u5efa\u7528\u4e8e\u6253\u5f00\u7279\u5b9a\u56fe\u5f62\u7684\u914d\u7f6e\uff0c\u8be5\u56fe\u5f62\u5f15\u7528graph.graphname\u914d\u7f6e\u3002\u4f8b\u5982: map = new HashMap String, Object (); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); \u7136\u540e\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55JanusGraph\u8282\u70b9\u4e0a\u4f7f\u7528: ConfiguredGraphFactory.open( graph1 ); 9.8.2 \u6a21\u677f\u914d\u7f6e ConfigurationManagementGraph\u8fd8\u5141\u8bb8\u60a8\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8be5\u6a21\u677f\u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\u6a21\u677f\u521b\u5efa\u8bb8\u591a\u56fe\u5f62\u3002\u4f8b\u5982: map = new HashMap String, Object (); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); \u8fd9\u6837\u505a\u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u56fe\u5f62: ConfiguredGraphFactory.create( graph2 ); \u8be5\u65b9\u6cd5\u9996\u5148\u4e3a\u201cgraph2\u201d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\uff0c\u65b9\u6cd5\u662f\u590d\u5236\u4e0e\u6a21\u677f\u914d\u7f6e\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u8fd9\u4e2a\u7279\u5b9a\u56fe\u7684\u914d\u7f6e\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u672a\u6765\u53ef\u4ee5\u5728\u4efb\u4f55JanusGraph\u8282\u70b9\u4e0a\u901a\u8fc7\u4ee5\u4e0b\u64cd\u4f5c\u8bbf\u95ee\u6b64\u56fe: ConfiguredGraphFactory.open( graph2 ); 9.8.3 \u66f4\u65b0\u914d\u7f6e \u4e0eJanusGraphFactory\u548c\u4e0e\u5b9a\u4e49\u5c5e\u6027 graph.graphname \u7684\u914d\u7f6e\u4ea4\u4e92\u7684ConfiguredGraphFactory\u7684\u6240\u6709\u4ea4\u4e92\u90fd\u8981\u901a\u8fc7JanusGraphManager\u6765\u8ddf\u8e2a\u5728\u7ed9\u5b9aJVM\u4e0a\u521b\u5efa\u7684\u56fe\u5f62\u5f15\u7528\u3002\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c\u4e00\u4e2a\u56fe\u5f62\u7f13\u5b58\u3002\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0: \u91cd\u70b9\uff1a\u5bf9\u56fe\u5f62\u914d\u7f6e\u7684\u4efb\u4f55\u66f4\u65b0\u90fd\u4f1a\u5bfc\u81f4\u4eceJanusGraph\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684\u56fe\u5f62\u7f13\u5b58\u4e2d\u9010\u51fa\u76f8\u5173\u56fe\u5f62\uff0c\u5047\u8bbe\u6bcf\u4e2a\u8282\u70b9\u90fd\u5df2\u6b63\u786e\u914d\u7f6e\u4ee5\u4f7f\u7528JanusGraphManager\u3002\u8be6\u7ec6\u4e86\u89e3\u6b64\u529f\u80fd\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u4f7f\u7528 \u6b64 \u529f\u80fd\u3002 \u7531\u4e8e\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u56fe\u5f62\u9996\u5148\u4f7f\u7528\u590d\u5236\u548c\u521b\u5efa\u65b9\u6cd5\u4e3a\u8be5\u56fe\u5f62\u521b\u5efa\u914d\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\uff1a \u91cd\u70b9\uff1a\u5bf9\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u7279\u5b9a\u56fe\u8868\u7684\u4efb\u4f55\u66f4\u65b0\u90fd\u4e0d\u80fd\u4fdd\u8bc1\u5728\u7279\u5b9a\u56fe\u8868\u4e0a\u751f\u6548\uff0c\u76f4\u5230\uff1a - \u76f8\u5173\u914d\u7f6e\u5df2\u5220\u9664\uff1a ConfiguredGraphFactory.removeConfiguration(\"graph2\"); - \u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u91cd\u65b0\u521b\u5efa\u56fe\u8868\uff1a ConfiguredGraphFactory.create(\"graph2\"); 9.8.4 \u66f4\u65b0\u793a\u4f8b 1\uff09\u6211\u4eec\u5c06Cassandra\u6570\u636e\u8fc1\u79fb\u5230\u5177\u6709\u65b0IP\u5730\u5740\u7684\u65b0\u670d\u52a1\u5668\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.open( graph1 ); // Update configuration map = new HashMap(); map.put( storage.hostname , 10.0.0.1 ); ConfiguredGraphFactory.updateConfiguration( graph1 , map); // We are now guaranteed to use the updated configuration g1 = ConfiguredGraphFactory.open( graph1 ); 2\uff09\u6211\u4eec\u5728\u8bbe\u7f6e\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2aElasticsearch\u8282\u70b9\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.open( graph1 ); // Update configuration map = new HashMap(); map.put( index.search.backend , elasticsearch ); map.put( index.search.hostname , 127.0.0.1 ); map.put( index.search.elasticsearch.transport-scheme , http ); ConfiguredGraphFactory.updateConfiguration( graph1 , map); // We are now guaranteed to use the updated configuration g1 = ConfiguredGraphFactory.open( graph1 ); 3\uff09\u66f4\u65b0\u4f7f\u7528\u5df2\u66f4\u65b0\u7684\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u56fe\u5f62\u914d\u7f6e\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); // Update template configuration map = new HashMap(); map.put( index.search.backend , elasticsearch ); map.put( index.search.hostname , 127.0.0.1 ); map.put( index.search.elasticsearch.transport-scheme , http ); ConfiguredGraphFactory.updateTemplateConfiguration(new MapConfiguration(map)); // Remove Configuration ConfiguredGraphFactory.removeConfiguration( graph1 ); // Recreate ConfiguredGraphFactory.create( graph1 ); // Now this graph's configuration is guaranteed to be updated 9.9 JanusGraphManager JanusGraphManager\u662f\u4e00\u4e2a\u7b26\u5408TinkerPop graphManager\u89c4\u8303\u7684\u5355\u4f53\u3002 \u7279\u522b\u662f\uff0cJanusGraphManager\u63d0\u4f9b\uff1a \u4e00\u79cd\u534f\u8c03\u673a\u5236\uff0c\u7528\u4e8e\u5728\u7ed9\u5b9a\u7684JanusGraph\u8282\u70b9\u4e0a\u5b9e\u4f8b\u5316\u56fe\u5f15\u7528 \u56fe\u5f62\u53c2\u8003\u8ddf\u8e2a\u5668\uff08\u6216\u7f13\u5b58\uff09 \u60a8\u4f7f\u7528\u8be5graph.graphname\u5c5e\u6027\u521b\u5efa\u7684\u4efb\u4f55\u56fe\u5f62\u90fd\u5c06\u901a\u8fc7\u8be5\u56fe\u5f62JanusGraphManager\uff0c\u4ece\u800c\u4ee5\u534f\u8c03\u7684\u65b9\u5f0f\u5b9e\u4f8b\u5316\u3002\u56fe\u8868\u5f15\u7528\u4e5f\u5c06\u653e\u5728\u6709\u95ee\u9898\u7684JVM\u4e0a\u7684\u56fe\u5f62\u7f13\u5b58\u4e2d\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528JVM\u4e0a\u5df2\u7ecf\u5b9e\u4f8b\u5316\u7684graph.graphname\u5c5e\u6027\u6253\u5f00\u7684\u4efb\u4f55\u56fe\u5f62\u90fd\u5c06\u4ece\u56fe\u5f62\u7f13\u5b58\u4e2d\u68c0\u7d22\u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u66f4\u65b0\u914d\u7f6e\u9700\u8981\u51e0\u4e2a\u6b65\u9aa4\u6765\u4fdd\u8bc1\u6b63\u786e\u6027\u7684\u539f\u56e0\u3002 9.9.1 \u5982\u4f55\u4f7f\u7528JanusGraphManager \u5f53\u60a8\u5728\u914d\u7f6e\u4e2d\u5b9a\u4e49\u5b9a\u4e49\u5982\u4f55\u8bbf\u95ee\u56fe\u5f62\u7684\u5c5e\u6027\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u65b0\u914d\u7f6e\u9009\u9879\u3002\u5305\u542b\u6b64\u5c5e\u6027\u7684\u6240\u6709\u914d\u7f6e\u90fd\u5c06\u5bfc\u81f4\u56fe\u5f62\u5b9e\u4f8b\u5316\u901a\u8fc7JanusGraphManager(\u4e0a\u9762\u89e3\u91ca\u7684\u8fc7\u7a0b)\u8fdb\u884c\u3002 \u4e3a\u4e86\u5411\u540e\u517c\u5bb9\uff0c\u4efb\u4f55\u4e0d\u63d0\u4f9b\u6b64\u53c2\u6570\u4f46\u5728\u670d\u52a1\u5668\u4e0a\u63d0\u4f9b\u7684\u56fe\u90fd\u662f\u4ece.yaml\u6587\u4ef6\u4e2d\u7684graphs\u5bf9\u8c61\u4e2d\u5f00\u59cb\u7684\uff0c\u8fd9\u4e9b\u56fe\u5c06\u901a\u8fc7JanusGraphManager\u7ed1\u5b9a\uff0cJanusGraphManager\u7531\u4e3a\u8be5\u56fe\u63d0\u4f9b\u7684\u952e\u8868\u793a\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684.yaml graphs\u5bf9\u8c61\u770b\u8d77\u6765\u50cf: graphManager: org.janusgraph.graphdb.management.JanusGraphManager graphs { graph1: conf/graph1.properties, graph2: conf/graph2.properties } \u4f46conf/graph1.properties\u548cconf/graph2.properties\u4e0d\u5305\u62ec\u5c5e\u6027 graph.graphname\uff0c\u90a3\u4e48\u8fd9\u4e9b\u56fe\u5c06\u88ab\u50a8\u5b58\u5728JanusGraphManager\uff0c\u56e0\u6b64\u5728\u4f60\u7684gremlin\u811a\u672c\u6267\u884c\u6240\u7ed3\u5408graph1\u548cgraph2\u5206\u522b\u3002 9.9.2 \u91cd\u70b9 \u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5982\u679c\u7528\u4e8e\u6253\u5f00\u56fe\u5f62\u7684\u914d\u7f6e\u6307\u5b9agraph.graphname\u4f46\u672a\u6307\u5b9a\u540e\u7aef\u7684\u5b58\u50a8\u76ee\u5f55\uff0ctablename\u6216keyspacename\uff0c\u5219\u76f8\u5173\u53c2\u6570\u5c06\u81ea\u52a8\u8bbe\u7f6e\u4e3a\u503cgraph.graphname\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u63d0\u4f9b\u5176\u4e2d\u4e00\u4e2a\u53c2\u6570\uff0c\u5219\u8be5\u503c\u59cb\u7ec8\u4f18\u5148\u3002\u5982\u679c\u60a8\u4e0d\u63d0\u4f9b\uff0c\u5219\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u9009\u9879\u7684\u9ed8\u8ba4\u503c\u3002 \u4e00\u4e2a\u7279\u4f8b\u662fstorage.root\u914d\u7f6e\u9009\u9879\u3002\u8fd9\u662f\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\u9009\u9879\uff0c\u7528\u4e8e\u6307\u5b9a\u5c06\u7528\u4e8e\u9700\u8981\u672c\u5730\u5b58\u50a8\u76ee\u5f55\u8bbf\u95ee\u7684\u4efb\u4f55\u540e\u7aef\u7684\u76ee\u5f55\u5e93\u3002\u5982\u679c\u63d0\u4f9b\u6b64\u53c2\u6570\uff0c\u5219\u8fd8\u5fc5\u987b\u63d0\u4f9b\u8be5graph.graphname\u5c5e\u6027\uff0c\u7edd\u5bf9\u5b58\u50a8\u76ee\u5f55\u5c06\u7b49\u4e8egraph.graphname\u9644\u52a0\u5230\u5c5e\u6027\u503c\u7684storage.root\u5c5e\u6027\u503c\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\u7528\u4f8b\uff1a 1\uff09\u4e3a\u6211\u7684Cassandra\u540e\u7aef\u521b\u5efa\u6a21\u677f\u914d\u7f6e\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6b64\u914d\u7f6e\u521b\u5efa\u7684\u6bcf\u4e2a\u56fe\u5f62\u83b7\u5f97\u4e0e\u63d0\u4f9b\u7ed9\u5de5\u5382\u7684String graphName \u7b49\u6548\u7684\u552f\u4e00\u952e\u7a7a\u95f4\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); //keyspace === graph1 g2 = ConfiguredGraphFactory.create( graph2 ); //keyspace === graph2 g3 = ConfiguredGraphFactory.create( graph3 ); //keyspace === graph3 2\uff09\u4e3a\u6211\u7684BerkeleyJE\u540e\u7aef\u521b\u5efa\u6a21\u677f\u914d\u7f6e\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6b64\u914d\u7f6e\u521b\u5efa\u7684\u6bcf\u4e2a\u56fe\u5f62\u83b7\u5f97\u4e00\u4e2a\u7b49\u540c\u4e8e storage.root / graph.graphname \u7684\u552f\u4e00\u5b58\u50a8\u76ee\u5f55\uff1a map = new HashMap(); map.put( storage.backend , berkeleyje ); map.put( storage.root , /data/graphs ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); //storage directory === /data/graphs/graph1 g2 = ConfiguredGraphFactory.create( graph2 ); //storage directory === /data/graphs/graph2 g3 = ConfiguredGraphFactory.create( graph3 ); //storage directory === /data/graphs/graph3 9.10 \u56fe\u5f62\u548c\u904d\u5386\u7ed1\u5b9a \u4f7f\u7528ConfiguredGraphFactory\u521b\u5efa\u7684\u56fe\u5f62\u901a\u8fc7\u201cgraph.graphname\u201d\u5c5e\u6027\u7ed1\u5b9a\u5230Gremlin\u670d\u52a1\u5668\u4e0a\u7684\u6267\u884c\u7a0b\u5e8f\u4e0a\u4e0b\u6587\uff0c\u5e76\u4e14\u56fe\u5f62\u7684\u904d\u5386\u5f15\u7528\u901a\u8fc7 graphname _traversal \u7ed1\u5b9a\u5230\u4e0a\u4e0b\u6587\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5728\u7b2c\u4e00\u6b21\u521b\u5efa/\u6253\u5f00\u56fe\u5f62\u540e\uff0c\u5728\u540e\u7eed\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 graphname \u548c graphname _traversal \u5c5e\u6027\u8bbf\u95ee\u56fe\u5f62\u548c\u904d\u5386\u5f15\u7528\u3002 \u8be6\u7ec6\u4e86\u89e3\u6b64\u529f\u80fd\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u4f7f\u7528 \u6b64 \u529f\u80fd\u3002 \u91cd\u70b9\uff1a\u5982\u679c\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u548c\u4f1a\u8bdd\u8fde\u63a5\u8fde\u63a5\u5230\u8fdc\u7a0bGremlin\u670d\u52a1\u5668\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u8fde\u63a5\u5230\u670d\u52a1\u5668\u4ee5\u7ed1\u5b9a\u53d8\u91cf\u3002\u5bf9\u4e8e\u4efb\u4f55\u4f1a\u8bdd\u7684WebSocket\u8fde\u63a5\u4e5f\u662f\u5982\u6b64\u3002 JanusGraphManager\u6bcf20\u79d2\u91cd\u65b0\u7ed1\u5b9a\u5b58\u50a8\u5728ConfigurationManagementGraph\uff08\u6216\u60a8\u5df2\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u5f62\uff09\u4e0a\u7684\u6bcf\u4e2a\u56fe\u5f62\u3002\u8fd9\u610f\u5473\u7740\u4f7f\u7528ConfigredGraphFactory\u521b\u5efa\u7684\u56fe\u5f62\u7684\u56fe\u5f62\u548c\u904d\u5386\u7ed1\u5b9a\u5c06\u5728\u6240\u6709JanusGraph\u8282\u70b9\u4e0a\u53ef\u7528\uff0c\u6700\u591a\u5ef6\u8fdf20\u79d2\u3002\u5b83\u8fd8\u610f\u5473\u7740\u5728\u670d\u52a1\u5668\u91cd\u65b0\u542f\u52a8\u540e\uff0c\u8282\u70b9\u4e0a\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u7ed1\u5b9a\u3002 9.10.1 \u7ed1\u5b9a\u793a\u4f8b gremlin :remote connect tinkerpop.server conf/remote.yaml == Configured localhost/127.0.0.1:8182 gremlin :remote console == All scripts will now be sent to Gremlin Server - [localhost/127.0.0.1:8182] - type ':remote console' to return to local mode gremlin ConfiguredGraphFactory.open( graph1 ) == standardjanusgraph[cassandrathrift:[127.0.0.1]] gremlin graph1 == standardjanusgraph[cassandrathrift:[127.0.0.1]] gremlin graph1_traversal == graphtraversalsource[standardjanusgraph[cassandrathrift:[127.0.0.1]], standard] 9.11 \u4f8b\u5b50 \u5efa\u8bae\u5728\u521b\u5efaConfigured Graph Factory\u6a21\u677f\u65f6\u4f7f\u7528\u4f1a\u8bdd\u8fde\u63a5\u3002\u5982\u679c\u672a\u4f7f\u7528\u4f1a\u8bdd\u8fde\u63a5\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u5206\u53f7\u5c06\u914d\u7f6e\u7684\u56fe\u5f62\u5de5\u5382\u6a21\u677f\u521b\u5efa\u4f5c\u4e3a\u5355\u884c\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002\u6709\u5173\u4f1a\u8bdd\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c7.1.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin Server\u201d \u3002 gremlin :remote connect tinkerpop.server conf/remote.yaml session == Configured localhost/127.0.0.1:8182 gremlin :remote console == All scripts will now be sent to Gremlin Server - [localhost:8182]-[5206cdde-b231-41fa-9e6c-69feac0fe2b2] - type ':remote console' to return to local mode gremlin ConfiguredGraphFactory.open( graph ); Please create configuration for this graph using the ConfigurationManagementGraph API. gremlin ConfiguredGraphFactory.create( graph ); Please create a template Configuration using the ConfigurationManagementGraph API. gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); gremlin map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( GraphName , graph1 ); gremlin ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); Please include in your configuration the property graph.graphname . gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); gremlin map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( graph.graphname , graph1 ); gremlin ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); == null gremlin ConfiguredGraphFactory.open( graph1 ).vertices(); gremlin map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( graph.graphname , graph1 ); gremlin ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); Your template configuration may not contain the property graph.graphname . gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); gremlin ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); == null // Each graph is now acting in unique keyspaces equivalent to the graphnames. gremlin g1 = ConfiguredGraphFactory.open( graph1 ); gremlin g2 = ConfiguredGraphFactory.create( graph2 ); gremlin g3 = ConfiguredGraphFactory.create( graph3 ); gremlin g2.addVertex(); gremlin l = []; gremlin l g1.vertices().size(); == 0 gremlin l g2.vertices().size(); == 1 gremlin l g3.vertices().size(); == 0 // After a graph is created, you must access it using .open() gremlin g2 = ConfiguredGraphFactory.create( graph2 ); g2.vertices().size(); Configuration for graph graph2 already exists. gremlin g2 = ConfiguredGraphFactory.open( graph2 ); g2.vertices().size(); == 1","title":"9.\u914d\u7f6e\u56fe\u5de5\u5382"},{"location":"janusgraph_basics/configuredgraphfactory/#chapter-9-configuredgraphfactory","text":"\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory\u914d\u7f6eJanusGraph\u670d\u52a1\u3002ConfiguredGraphFactory\u662f\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\uff0c\u7c7b\u4f3c\u4e8eJanusGraphFactory\u3002\u8fd9\u4e9b\u56fe\u5f62\u5de5\u5382\u63d0\u4f9b\u4e86\u52a8\u6001\u7ba1\u7406\u9a7b\u7559\u5728\u670d\u52a1\u5668\u4e0a\u7684\u56fe\u5f62\u7684\u65b9\u6cd5\u3002","title":"Chapter 9. ConfiguredGraphFactory"},{"location":"janusgraph_basics/configuredgraphfactory/#91","text":"JanusGraphFactory\u662f\u4e00\u4e2a\u7c7b\uff0c\u5b83\u901a\u8fc7\u5728\u6bcf\u6b21\u8bbf\u95ee\u56fe\u5f62\u65f6\u63d0\u4f9b\u4e00\u4e2a\u914d\u7f6e\u5bf9\u8c61\u6765\u63d0\u4f9b\u5bf9\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\u3002 ConfiguredGraphFactory\u63d0\u4f9b\u4e86\u5bf9\u60a8\u4e4b\u524d\u4f7f\u7528ConfigurationManagementGraph\u4e3a\u5176\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u5f62\u7684\u8bbf\u95ee\u70b9\u3002\u5b83\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bbf\u95ee\u70b9\u6765\u7ba1\u7406\u56fe\u5f62\u914d\u7f6e\u3002 ConfigurationManagementGraph\u5141\u8bb8\u60a8\u7ba1\u7406\u56fe\u5f62\u914d\u7f6e\u3002 JanusGraphManager\u662f\u4e00\u4e2a\u8ddf\u8e2a\u56fe\u5f62\u5f15\u7528\u7684\u5185\u90e8\u670d\u52a1\u5668\u7ec4\u4ef6\uff0c\u524d\u63d0\u662f\u60a8\u7684\u56fe\u5f62\u88ab\u914d\u7f6e\u4e3a\u4f7f\u7528\u5b83\u3002","title":"9.1 \u6982\u89c8"},{"location":"janusgraph_basics/configuredgraphfactory/#92-configuredgraphfactoryjanusgraphfactory","text":"\u7136\u800c\uff0c\u8fd9\u4e24\u4e2a\u56fe\u5f62\u5de5\u5382\u4e4b\u95f4\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u533a\u522b: 1\u3001\u53ea\u6709\u5c06\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u5728\u670d\u52a1\u5668\u542f\u52a8\u65f6\u4f7f\u7528ConfigurationManagementGraph api\uff0c\u624d\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory\u3002 \u4f7f\u7528ConfiguredGraphFactory\u7684\u597d\u5904\u662f: 1\u3001\u6bcf\u6b21\u6253\u5f00\u56fe\u5f62\u65f6\uff0c\u60a8\u53ea\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u5b57\u7b26\u4e32\u6765\u8bbf\u95ee\u56fe\u5f62\uff0c\u800c\u4e0d\u662fJanusGraphFactory\u2014\u2014\u5b83\u8981\u6c42\u60a8\u6307\u5b9a\u8bbf\u95ee\u56fe\u5f62\u65f6\u5e0c\u671b\u4f7f\u7528\u7684\u540e\u7aef\u4fe1\u606f\u3002 2\u3001\u5982\u679c\u914d\u7f6e\u4e86\u5206\u5e03\u5f0f\u5b58\u50a8\u540e\u7aef\uff0c\u90a3\u4e48\u96c6\u7fa4\u4e2d\u7684\u6240\u6709JanusGraph\u8282\u70b9\u90fd\u53ef\u4ee5\u4f7f\u7528\u60a8\u7684\u56fe\u5f62\u914d\u7f6e\u3002","title":"9.2 ConfiguredGraphFactory\u4e0eJanusGraphFactory"},{"location":"janusgraph_basics/configuredgraphfactory/#93-configuredgraphfactory","text":"ConfiguredGraphFactory\u63d0\u4f9b\u4e86\u4e24\u4e2a\u573a\u666f\u4e0b\u7684\u56fe\u5f62\u8bbf\u95ee\u70b9: 1\u3001\u60a8\u5df2\u7ecf\u4f7f\u7528ConfigurationManagementGraph#createConfiguration\u4e3a\u7279\u5b9a\u7684\u56fe\u5f62\u5bf9\u8c61\u521b\u5efa\u4e86\u914d\u7f6e\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u60a8\u7684\u56fe\u4f7f\u7528\u4f7f\u7528\u524d\u9762\u7684\u914d\u7f6e\u6253\u5f00\u3002 2\u3001\u60a8\u5df2\u7ecf\u4f7f\u7528ConfigurationManagementGraph#createTemplateConfiguration\u521b\u5efa\u4e86\u4e00\u4e2a\u6a21\u677f\u914d\u7f6e\u3002\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u901a\u8fc7\u590d\u5236\u6a21\u677f\u914d\u7f6e\u4e2d\u5b58\u50a8\u7684\u6240\u6709\u5c5e\u6027\u5e76\u9644\u52a0\u76f8\u5173\u7684graphName\u5c5e\u6027\uff0c\u4e3a\u60a8\u6b63\u5728\u521b\u5efa\u7684\u56fe\u5f62\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\uff0c\u7136\u540e\u6839\u636e\u8be5\u7279\u5b9a\u914d\u7f6e\u6253\u5f00\u56fe\u5f62\u3002","title":"9.3 ConfiguredGraphFactory\u5982\u4f55\u5de5\u4f5c"},{"location":"janusgraph_basics/configuredgraphfactory/#94","text":"\u60a8\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory.create(\u201cgraphName\u201d)\u6216ConfiguredGraphFactory.open(\u201cgraphName\u201d)\u3002\u901a\u8fc7\u9605\u8bfb\u4e0b\u9762\u5173\u4e8eConfigurationManagementGraph\u7684\u90e8\u5206\uff0c\u4e86\u89e3\u8fd9\u4e24\u4e2a\u9009\u9879\u4e4b\u95f4\u7684\u533a\u522b\u3002 \u60a8\u8fd8\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u7ed1\u5b9a\u6765\u8bbf\u95ee\u56fe\u5f62\u3002\u57289.10\u8282\u201c\u56fe\u548c\u904d\u5386\u7ed1\u5b9a\u201d\u4e00\u8282\u4e86\u89e3\u66f4\u591a\u3002","title":"9.4 \u8bbf\u95ee\u56fe"},{"location":"janusgraph_basics/configuredgraphfactory/#95","text":"ConfiguredGraphFactory.getGraphNames()\u5c06\u8fd4\u56de\u4e00\u7ec4\u4f60\u4f7f\u7528 ConfigurationManagementGraph APIs\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u3002 \u53e6\u4e00\u65b9\u9762\uff0cJanusGraphFactory.getGraphNames()\u8fd4\u56de\u4e00\u7ec4\u5df2\u5b9e\u4f8b\u5316\u7684\u56fe\u5f62\u540d\u79f0\uff0c\u5f15\u7528\u5b58\u50a8\u5728JanusGraphManager\u4e2d\u3002","title":"9.5 \u5217\u51fa\u56fe"},{"location":"janusgraph_basics/configuredgraphfactory/#96","text":"ConfiguredGraphFactory.drop(\"graphName\")\u5c06\u5220\u9664\u56fe\u5f62\u6570\u636e\u5e93\uff0c\u5b58\u50a8\u548c\u7d22\u5f15\u540e\u7aef\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002 important:\u8fd9\u662f\u4e00\u4e2a\u4e0d\u53ef\u9006\u64cd\u4f5c\uff0c\u5c06\u5220\u9664\u6240\u6709\u56fe\u5f62\u548c\u7d22\u5f15\u6570\u636e\u3002 important:\u4e3a\u4e86\u786e\u4fdd\u96c6\u7fa4\u4e2d\u6240\u6709JanusGraph\u8282\u70b9\u4e4b\u95f4\u7684\u6240\u6709\u56fe\u5f62\u8868\u793a\u90fd\u662f\u4e00\u81f4\u7684\uff0c\u8fd9\u5c06\u4ece\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684JanusGraphManager\u56fe\u5f62\u7f13\u5b58\u4e2d\u5220\u9664\u56fe\u5f62\uff0c\u5047\u8bbe\u6bcf\u4e2a\u8282\u70b9\u90fd\u5df2\u6b63\u786e\u914d\u7f6e\u4e3a\u4f7f\u7528JanusGraphManager\u3002\u4e86\u89e3\u66f4\u591a\u5173\u4e8e\u6b64\u7279\u6027\u7684\u4fe1\u606f\uff0c\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u60a8\u7684\u670d\u52a1\u5668\u6765\u4f7f\u7528\u6b64\u7279\u6027(https://docs.janusgraph.org/latest/things-to-consider-in-a-multi-node-janusgraph-cluster.html#graph-reference-consistency)\u3002","title":"9.6 \u5220\u9664\u56fe"},{"location":"janusgraph_basics/configuredgraphfactory/#97-configuredgraphfactoryjanusgraph-server","text":"\u4e3a\u4e86\u80fd\u591f\u4f7f\u7528ConfiguredGraphFactory\uff0c\u5fc5\u987b\u5c06\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u4f7f\u7528ConfigurationManagementGraph api\u3002\u4e3a\u6b64\uff0c\u5fc5\u987b\u5728\u670d\u52a1\u5668\u7684YAML\u7684\u56fe\u5f62\u6620\u5c04\u4e2d\u6ce8\u5165\u540d\u4e3a\u201cConfigurationManagementGraph\u201d\u7684\u56fe\u5f62\u53d8\u91cf\u3002\u4f8b\u5982: graphManager: org.janusgraph.graphdb.management.JanusGraphManager graphs: { ConfigurationManagementGraph: conf/JanusGraph-configurationmanagement.properties } \u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u7684ConfigurationManagementGraph\u56fe\u5c06\u4f7f\u7528\u5b58\u50a8\u5728conf/JanusGraph-configurationmanagement\u4e2d\u7684\u5c5e\u6027\u8fdb\u884c\u914d\u7f6e\u5c5e\u6027\uff0c\u4f8b\u5982: gremlin.graph=org.janusgraph.core.JanusGraphFactory storage.backend=cql graph.graphname=ConfigurationManagementGraph storage.hostname=127.0.0.1 \u5047\u8bbeGremlinServer\u6210\u529f\u542f\u52a8\uff0c\u5e76\u4e14\u6210\u529f\u5b9e\u4f8b\u5316\u4e86ConfigurationManagementGraph\uff0c\u90a3\u4e48ConfigurationManagementGraph Singleton\u4e0a\u53ef\u7528\u7684\u6240\u6709api\u4e5f\u5c06\u5bf9\u8be5\u56fe\u8fdb\u884c\u64cd\u4f5c\u3002\u6b64\u5916\uff0c\u8fd9\u4e2a\u56fe\u5c06\u7528\u4e8e\u8bbf\u95ee\u4f7f\u7528ConfiguredGraphFactory\u521b\u5efa/\u6253\u5f00\u56fe\u5f62\u7684\u914d\u7f6e\u3002 \u91cd\u70b9:JanusGraph\u53d1\u884c\u7248\u4e2d\u5305\u542b\u7684pom.xml\u5c06\u6b64\u4f9d\u8d56\u9879\u5217\u4e3a\u53ef\u9009\u9879\uff0c\u4f46ConfiguredGraphFactory\u4f7f\u7528\u4e86JanusGraphManager,\u5b83\u9700\u8981\u58f0\u660e\u5bf9org.apache.tinkerpop:gremlin-server\u7684\u4f9d\u8d56\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60a8\u9047\u5230NoClassDefFoundError\u9519\u8bef\uff0c\u90a3\u4e48\u8bf7\u786e\u4fdd\u6839\u636e\u6b64\u6d88\u606f\u8fdb\u884c\u66f4\u65b0\u3002","title":"9.7 \u4e3aConfiguredGraphFactory\u914d\u7f6eJanusGraph Server"},{"location":"janusgraph_basics/configuredgraphfactory/#98-configurationmanagementgraph","text":"ConfigurationManagementGraph\u662f\u4e00\u4e2a\u5355\u4f8b\u5bf9\u8c61\uff0c\u5b83\u5141\u8bb8\u60a8\u521b\u5efa/\u66f4\u65b0/\u5220\u9664\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u914d\u7f6e\u6765\u4f7f\u7528ConfiguredGraphFactory\u8bbf\u95ee\u60a8\u7684\u56fe\u5f62\u3002\u8bf7\u53c2\u9605\u4e0a\u9762\u5173\u4e8e\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u542f\u7528\u8fd9\u4e9bapi\u7684\u4ecb\u7ecd\u3002 \u91cd\u70b9\uff1aConfiguredGraphFactory\u63d0\u4f9b\u4e86\u4e00\u4e2a\u8bbf\u95ee\u70b9\u6765\u7ba1\u7406\u7531ConfigurationManagementGraph\u7ba1\u7406\u7684\u56fe\u5f62\u914d\u7f6e\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5bf9\u76f8\u5e94\u7684ConfiguredGraphFactory\u9759\u6001\u65b9\u6cd5\u8fdb\u884c\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u5bf9Singleton\u672c\u8eab\u8fdb\u884c\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528ConfiguredGraphFactory.removeTemplateConfiguration()\u800c\u4e0d\u662fConfiguredGraphFactory.getInstance().removetemplateconfiguration()\u3002","title":"9.8 ConfigurationManagementGraph"},{"location":"janusgraph_basics/configuredgraphfactory/#981-graph-configurations","text":"ConfigurationManagementGraph\u5355\u4f8b\u5141\u8bb8\u60a8\u521b\u5efa\u7528\u4e8e\u6253\u5f00\u7279\u5b9a\u56fe\u5f62\u7684\u914d\u7f6e\uff0c\u8be5\u56fe\u5f62\u5f15\u7528graph.graphname\u914d\u7f6e\u3002\u4f8b\u5982: map = new HashMap String, Object (); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); \u7136\u540e\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55JanusGraph\u8282\u70b9\u4e0a\u4f7f\u7528: ConfiguredGraphFactory.open( graph1 );","title":"9.8.1  Graph Configurations"},{"location":"janusgraph_basics/configuredgraphfactory/#982","text":"ConfigurationManagementGraph\u8fd8\u5141\u8bb8\u60a8\u521b\u5efa\u4e00\u4e2a\u6a21\u677f\u914d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8be5\u6a21\u677f\u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\u6a21\u677f\u521b\u5efa\u8bb8\u591a\u56fe\u5f62\u3002\u4f8b\u5982: map = new HashMap String, Object (); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); \u8fd9\u6837\u505a\u4e4b\u540e\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u56fe\u5f62: ConfiguredGraphFactory.create( graph2 ); \u8be5\u65b9\u6cd5\u9996\u5148\u4e3a\u201cgraph2\u201d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\uff0c\u65b9\u6cd5\u662f\u590d\u5236\u4e0e\u6a21\u677f\u914d\u7f6e\u76f8\u5173\u7684\u6240\u6709\u5c5e\u6027\uff0c\u5e76\u5c06\u5176\u5b58\u50a8\u5728\u8fd9\u4e2a\u7279\u5b9a\u56fe\u7684\u914d\u7f6e\u4e2d\u3002\u8fd9\u610f\u5473\u7740\u672a\u6765\u53ef\u4ee5\u5728\u4efb\u4f55JanusGraph\u8282\u70b9\u4e0a\u901a\u8fc7\u4ee5\u4e0b\u64cd\u4f5c\u8bbf\u95ee\u6b64\u56fe: ConfiguredGraphFactory.open( graph2 );","title":"9.8.2 \u6a21\u677f\u914d\u7f6e"},{"location":"janusgraph_basics/configuredgraphfactory/#983","text":"\u4e0eJanusGraphFactory\u548c\u4e0e\u5b9a\u4e49\u5c5e\u6027 graph.graphname \u7684\u914d\u7f6e\u4ea4\u4e92\u7684ConfiguredGraphFactory\u7684\u6240\u6709\u4ea4\u4e92\u90fd\u8981\u901a\u8fc7JanusGraphManager\u6765\u8ddf\u8e2a\u5728\u7ed9\u5b9aJVM\u4e0a\u521b\u5efa\u7684\u56fe\u5f62\u5f15\u7528\u3002\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c\u4e00\u4e2a\u56fe\u5f62\u7f13\u5b58\u3002\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0: \u91cd\u70b9\uff1a\u5bf9\u56fe\u5f62\u914d\u7f6e\u7684\u4efb\u4f55\u66f4\u65b0\u90fd\u4f1a\u5bfc\u81f4\u4eceJanusGraph\u96c6\u7fa4\u4e2d\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7684\u56fe\u5f62\u7f13\u5b58\u4e2d\u9010\u51fa\u76f8\u5173\u56fe\u5f62\uff0c\u5047\u8bbe\u6bcf\u4e2a\u8282\u70b9\u90fd\u5df2\u6b63\u786e\u914d\u7f6e\u4ee5\u4f7f\u7528JanusGraphManager\u3002\u8be6\u7ec6\u4e86\u89e3\u6b64\u529f\u80fd\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u4f7f\u7528 \u6b64 \u529f\u80fd\u3002 \u7531\u4e8e\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u56fe\u5f62\u9996\u5148\u4f7f\u7528\u590d\u5236\u548c\u521b\u5efa\u65b9\u6cd5\u4e3a\u8be5\u56fe\u5f62\u521b\u5efa\u914d\u7f6e\uff0c\u8fd9\u610f\u5473\u7740\uff1a \u91cd\u70b9\uff1a\u5bf9\u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u7279\u5b9a\u56fe\u8868\u7684\u4efb\u4f55\u66f4\u65b0\u90fd\u4e0d\u80fd\u4fdd\u8bc1\u5728\u7279\u5b9a\u56fe\u8868\u4e0a\u751f\u6548\uff0c\u76f4\u5230\uff1a - \u76f8\u5173\u914d\u7f6e\u5df2\u5220\u9664\uff1a ConfiguredGraphFactory.removeConfiguration(\"graph2\"); - \u4f7f\u7528\u6a21\u677f\u914d\u7f6e\u91cd\u65b0\u521b\u5efa\u56fe\u8868\uff1a ConfiguredGraphFactory.create(\"graph2\");","title":"9.8.3 \u66f4\u65b0\u914d\u7f6e"},{"location":"janusgraph_basics/configuredgraphfactory/#984","text":"1\uff09\u6211\u4eec\u5c06Cassandra\u6570\u636e\u8fc1\u79fb\u5230\u5177\u6709\u65b0IP\u5730\u5740\u7684\u65b0\u670d\u52a1\u5668\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.open( graph1 ); // Update configuration map = new HashMap(); map.put( storage.hostname , 10.0.0.1 ); ConfiguredGraphFactory.updateConfiguration( graph1 , map); // We are now guaranteed to use the updated configuration g1 = ConfiguredGraphFactory.open( graph1 ); 2\uff09\u6211\u4eec\u5728\u8bbe\u7f6e\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2aElasticsearch\u8282\u70b9\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); map.put( graph.graphname , graph1 ); ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.open( graph1 ); // Update configuration map = new HashMap(); map.put( index.search.backend , elasticsearch ); map.put( index.search.hostname , 127.0.0.1 ); map.put( index.search.elasticsearch.transport-scheme , http ); ConfiguredGraphFactory.updateConfiguration( graph1 , map); // We are now guaranteed to use the updated configuration g1 = ConfiguredGraphFactory.open( graph1 ); 3\uff09\u66f4\u65b0\u4f7f\u7528\u5df2\u66f4\u65b0\u7684\u6a21\u677f\u914d\u7f6e\u521b\u5efa\u7684\u56fe\u5f62\u914d\u7f6e\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); // Update template configuration map = new HashMap(); map.put( index.search.backend , elasticsearch ); map.put( index.search.hostname , 127.0.0.1 ); map.put( index.search.elasticsearch.transport-scheme , http ); ConfiguredGraphFactory.updateTemplateConfiguration(new MapConfiguration(map)); // Remove Configuration ConfiguredGraphFactory.removeConfiguration( graph1 ); // Recreate ConfiguredGraphFactory.create( graph1 ); // Now this graph's configuration is guaranteed to be updated","title":"9.8.4 \u66f4\u65b0\u793a\u4f8b"},{"location":"janusgraph_basics/configuredgraphfactory/#99-janusgraphmanager","text":"JanusGraphManager\u662f\u4e00\u4e2a\u7b26\u5408TinkerPop graphManager\u89c4\u8303\u7684\u5355\u4f53\u3002 \u7279\u522b\u662f\uff0cJanusGraphManager\u63d0\u4f9b\uff1a \u4e00\u79cd\u534f\u8c03\u673a\u5236\uff0c\u7528\u4e8e\u5728\u7ed9\u5b9a\u7684JanusGraph\u8282\u70b9\u4e0a\u5b9e\u4f8b\u5316\u56fe\u5f15\u7528 \u56fe\u5f62\u53c2\u8003\u8ddf\u8e2a\u5668\uff08\u6216\u7f13\u5b58\uff09 \u60a8\u4f7f\u7528\u8be5graph.graphname\u5c5e\u6027\u521b\u5efa\u7684\u4efb\u4f55\u56fe\u5f62\u90fd\u5c06\u901a\u8fc7\u8be5\u56fe\u5f62JanusGraphManager\uff0c\u4ece\u800c\u4ee5\u534f\u8c03\u7684\u65b9\u5f0f\u5b9e\u4f8b\u5316\u3002\u56fe\u8868\u5f15\u7528\u4e5f\u5c06\u653e\u5728\u6709\u95ee\u9898\u7684JVM\u4e0a\u7684\u56fe\u5f62\u7f13\u5b58\u4e2d\u3002 \u56e0\u6b64\uff0c\u4f7f\u7528JVM\u4e0a\u5df2\u7ecf\u5b9e\u4f8b\u5316\u7684graph.graphname\u5c5e\u6027\u6253\u5f00\u7684\u4efb\u4f55\u56fe\u5f62\u90fd\u5c06\u4ece\u56fe\u5f62\u7f13\u5b58\u4e2d\u68c0\u7d22\u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u66f4\u65b0\u914d\u7f6e\u9700\u8981\u51e0\u4e2a\u6b65\u9aa4\u6765\u4fdd\u8bc1\u6b63\u786e\u6027\u7684\u539f\u56e0\u3002","title":"9.9  JanusGraphManager"},{"location":"janusgraph_basics/configuredgraphfactory/#991-janusgraphmanager","text":"\u5f53\u60a8\u5728\u914d\u7f6e\u4e2d\u5b9a\u4e49\u5b9a\u4e49\u5982\u4f55\u8bbf\u95ee\u56fe\u5f62\u7684\u5c5e\u6027\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u65b0\u914d\u7f6e\u9009\u9879\u3002\u5305\u542b\u6b64\u5c5e\u6027\u7684\u6240\u6709\u914d\u7f6e\u90fd\u5c06\u5bfc\u81f4\u56fe\u5f62\u5b9e\u4f8b\u5316\u901a\u8fc7JanusGraphManager(\u4e0a\u9762\u89e3\u91ca\u7684\u8fc7\u7a0b)\u8fdb\u884c\u3002 \u4e3a\u4e86\u5411\u540e\u517c\u5bb9\uff0c\u4efb\u4f55\u4e0d\u63d0\u4f9b\u6b64\u53c2\u6570\u4f46\u5728\u670d\u52a1\u5668\u4e0a\u63d0\u4f9b\u7684\u56fe\u90fd\u662f\u4ece.yaml\u6587\u4ef6\u4e2d\u7684graphs\u5bf9\u8c61\u4e2d\u5f00\u59cb\u7684\uff0c\u8fd9\u4e9b\u56fe\u5c06\u901a\u8fc7JanusGraphManager\u7ed1\u5b9a\uff0cJanusGraphManager\u7531\u4e3a\u8be5\u56fe\u63d0\u4f9b\u7684\u952e\u8868\u793a\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684.yaml graphs\u5bf9\u8c61\u770b\u8d77\u6765\u50cf: graphManager: org.janusgraph.graphdb.management.JanusGraphManager graphs { graph1: conf/graph1.properties, graph2: conf/graph2.properties } \u4f46conf/graph1.properties\u548cconf/graph2.properties\u4e0d\u5305\u62ec\u5c5e\u6027 graph.graphname\uff0c\u90a3\u4e48\u8fd9\u4e9b\u56fe\u5c06\u88ab\u50a8\u5b58\u5728JanusGraphManager\uff0c\u56e0\u6b64\u5728\u4f60\u7684gremlin\u811a\u672c\u6267\u884c\u6240\u7ed3\u5408graph1\u548cgraph2\u5206\u522b\u3002","title":"9.9.1 \u5982\u4f55\u4f7f\u7528JanusGraphManager"},{"location":"janusgraph_basics/configuredgraphfactory/#992","text":"\u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5982\u679c\u7528\u4e8e\u6253\u5f00\u56fe\u5f62\u7684\u914d\u7f6e\u6307\u5b9agraph.graphname\u4f46\u672a\u6307\u5b9a\u540e\u7aef\u7684\u5b58\u50a8\u76ee\u5f55\uff0ctablename\u6216keyspacename\uff0c\u5219\u76f8\u5173\u53c2\u6570\u5c06\u81ea\u52a8\u8bbe\u7f6e\u4e3a\u503cgraph.graphname\u3002\u4f46\u662f\uff0c\u5982\u679c\u60a8\u63d0\u4f9b\u5176\u4e2d\u4e00\u4e2a\u53c2\u6570\uff0c\u5219\u8be5\u503c\u59cb\u7ec8\u4f18\u5148\u3002\u5982\u679c\u60a8\u4e0d\u63d0\u4f9b\uff0c\u5219\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u9009\u9879\u7684\u9ed8\u8ba4\u503c\u3002 \u4e00\u4e2a\u7279\u4f8b\u662fstorage.root\u914d\u7f6e\u9009\u9879\u3002\u8fd9\u662f\u4e00\u4e2a\u65b0\u7684\u914d\u7f6e\u9009\u9879\uff0c\u7528\u4e8e\u6307\u5b9a\u5c06\u7528\u4e8e\u9700\u8981\u672c\u5730\u5b58\u50a8\u76ee\u5f55\u8bbf\u95ee\u7684\u4efb\u4f55\u540e\u7aef\u7684\u76ee\u5f55\u5e93\u3002\u5982\u679c\u63d0\u4f9b\u6b64\u53c2\u6570\uff0c\u5219\u8fd8\u5fc5\u987b\u63d0\u4f9b\u8be5graph.graphname\u5c5e\u6027\uff0c\u7edd\u5bf9\u5b58\u50a8\u76ee\u5f55\u5c06\u7b49\u4e8egraph.graphname\u9644\u52a0\u5230\u5c5e\u6027\u503c\u7684storage.root\u5c5e\u6027\u503c\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\u7528\u4f8b\uff1a 1\uff09\u4e3a\u6211\u7684Cassandra\u540e\u7aef\u521b\u5efa\u6a21\u677f\u914d\u7f6e\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6b64\u914d\u7f6e\u521b\u5efa\u7684\u6bcf\u4e2a\u56fe\u5f62\u83b7\u5f97\u4e0e\u63d0\u4f9b\u7ed9\u5de5\u5382\u7684String graphName \u7b49\u6548\u7684\u552f\u4e00\u952e\u7a7a\u95f4\uff1a map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); //keyspace === graph1 g2 = ConfiguredGraphFactory.create( graph2 ); //keyspace === graph2 g3 = ConfiguredGraphFactory.create( graph3 ); //keyspace === graph3 2\uff09\u4e3a\u6211\u7684BerkeleyJE\u540e\u7aef\u521b\u5efa\u6a21\u677f\u914d\u7f6e\uff0c\u4ee5\u4fbf\u4f7f\u7528\u6b64\u914d\u7f6e\u521b\u5efa\u7684\u6bcf\u4e2a\u56fe\u5f62\u83b7\u5f97\u4e00\u4e2a\u7b49\u540c\u4e8e storage.root / graph.graphname \u7684\u552f\u4e00\u5b58\u50a8\u76ee\u5f55\uff1a map = new HashMap(); map.put( storage.backend , berkeleyje ); map.put( storage.root , /data/graphs ); ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); g1 = ConfiguredGraphFactory.create( graph1 ); //storage directory === /data/graphs/graph1 g2 = ConfiguredGraphFactory.create( graph2 ); //storage directory === /data/graphs/graph2 g3 = ConfiguredGraphFactory.create( graph3 ); //storage directory === /data/graphs/graph3","title":"9.9.2 \u91cd\u70b9"},{"location":"janusgraph_basics/configuredgraphfactory/#910","text":"\u4f7f\u7528ConfiguredGraphFactory\u521b\u5efa\u7684\u56fe\u5f62\u901a\u8fc7\u201cgraph.graphname\u201d\u5c5e\u6027\u7ed1\u5b9a\u5230Gremlin\u670d\u52a1\u5668\u4e0a\u7684\u6267\u884c\u7a0b\u5e8f\u4e0a\u4e0b\u6587\uff0c\u5e76\u4e14\u56fe\u5f62\u7684\u904d\u5386\u5f15\u7528\u901a\u8fc7 graphname _traversal \u7ed1\u5b9a\u5230\u4e0a\u4e0b\u6587\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5728\u7b2c\u4e00\u6b21\u521b\u5efa/\u6253\u5f00\u56fe\u5f62\u540e\uff0c\u5728\u540e\u7eed\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7 graphname \u548c graphname _traversal \u5c5e\u6027\u8bbf\u95ee\u56fe\u5f62\u548c\u904d\u5386\u5f15\u7528\u3002 \u8be6\u7ec6\u4e86\u89e3\u6b64\u529f\u80fd\u4ee5\u53ca\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u4ee5\u4f7f\u7528 \u6b64 \u529f\u80fd\u3002 \u91cd\u70b9\uff1a\u5982\u679c\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u548c\u4f1a\u8bdd\u8fde\u63a5\u8fde\u63a5\u5230\u8fdc\u7a0bGremlin\u670d\u52a1\u5668\uff0c\u5219\u5fc5\u987b\u91cd\u65b0\u8fde\u63a5\u5230\u670d\u52a1\u5668\u4ee5\u7ed1\u5b9a\u53d8\u91cf\u3002\u5bf9\u4e8e\u4efb\u4f55\u4f1a\u8bdd\u7684WebSocket\u8fde\u63a5\u4e5f\u662f\u5982\u6b64\u3002 JanusGraphManager\u6bcf20\u79d2\u91cd\u65b0\u7ed1\u5b9a\u5b58\u50a8\u5728ConfigurationManagementGraph\uff08\u6216\u60a8\u5df2\u521b\u5efa\u914d\u7f6e\u7684\u56fe\u5f62\uff09\u4e0a\u7684\u6bcf\u4e2a\u56fe\u5f62\u3002\u8fd9\u610f\u5473\u7740\u4f7f\u7528ConfigredGraphFactory\u521b\u5efa\u7684\u56fe\u5f62\u7684\u56fe\u5f62\u548c\u904d\u5386\u7ed1\u5b9a\u5c06\u5728\u6240\u6709JanusGraph\u8282\u70b9\u4e0a\u53ef\u7528\uff0c\u6700\u591a\u5ef6\u8fdf20\u79d2\u3002\u5b83\u8fd8\u610f\u5473\u7740\u5728\u670d\u52a1\u5668\u91cd\u65b0\u542f\u52a8\u540e\uff0c\u8282\u70b9\u4e0a\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u7ed1\u5b9a\u3002","title":"9.10 \u56fe\u5f62\u548c\u904d\u5386\u7ed1\u5b9a"},{"location":"janusgraph_basics/configuredgraphfactory/#9101","text":"gremlin :remote connect tinkerpop.server conf/remote.yaml == Configured localhost/127.0.0.1:8182 gremlin :remote console == All scripts will now be sent to Gremlin Server - [localhost/127.0.0.1:8182] - type ':remote console' to return to local mode gremlin ConfiguredGraphFactory.open( graph1 ) == standardjanusgraph[cassandrathrift:[127.0.0.1]] gremlin graph1 == standardjanusgraph[cassandrathrift:[127.0.0.1]] gremlin graph1_traversal == graphtraversalsource[standardjanusgraph[cassandrathrift:[127.0.0.1]], standard]","title":"9.10.1 \u7ed1\u5b9a\u793a\u4f8b"},{"location":"janusgraph_basics/configuredgraphfactory/#911","text":"\u5efa\u8bae\u5728\u521b\u5efaConfigured Graph Factory\u6a21\u677f\u65f6\u4f7f\u7528\u4f1a\u8bdd\u8fde\u63a5\u3002\u5982\u679c\u672a\u4f7f\u7528\u4f1a\u8bdd\u8fde\u63a5\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u5206\u53f7\u5c06\u914d\u7f6e\u7684\u56fe\u5f62\u5de5\u5382\u6a21\u677f\u521b\u5efa\u4f5c\u4e3a\u5355\u884c\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002\u6709\u5173\u4f1a\u8bdd\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 \u7b2c7.1.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin Server\u201d \u3002 gremlin :remote connect tinkerpop.server conf/remote.yaml session == Configured localhost/127.0.0.1:8182 gremlin :remote console == All scripts will now be sent to Gremlin Server - [localhost:8182]-[5206cdde-b231-41fa-9e6c-69feac0fe2b2] - type ':remote console' to return to local mode gremlin ConfiguredGraphFactory.open( graph ); Please create configuration for this graph using the ConfigurationManagementGraph API. gremlin ConfiguredGraphFactory.create( graph ); Please create a template Configuration using the ConfigurationManagementGraph API. gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); gremlin map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( GraphName , graph1 ); gremlin ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); Please include in your configuration the property graph.graphname . gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); gremlin map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( graph.graphname , graph1 ); gremlin ConfiguredGraphFactory.createConfiguration(new MapConfiguration(map)); == null gremlin ConfiguredGraphFactory.open( graph1 ).vertices(); gremlin map = new HashMap(); map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); gremlin map.put( graph.graphname , graph1 ); gremlin ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); Your template configuration may not contain the property graph.graphname . gremlin map = new HashMap(); gremlin map.put( storage.backend , cql ); map.put( storage.hostname , 127.0.0.1 ); gremlin ConfiguredGraphFactory.createTemplateConfiguration(new MapConfiguration(map)); == null // Each graph is now acting in unique keyspaces equivalent to the graphnames. gremlin g1 = ConfiguredGraphFactory.open( graph1 ); gremlin g2 = ConfiguredGraphFactory.create( graph2 ); gremlin g3 = ConfiguredGraphFactory.create( graph3 ); gremlin g2.addVertex(); gremlin l = []; gremlin l g1.vertices().size(); == 0 gremlin l g2.vertices().size(); == 1 gremlin l g3.vertices().size(); == 0 // After a graph is created, you must access it using .open() gremlin g2 = ConfiguredGraphFactory.create( graph2 ); g2.vertices().size(); Configuration for graph graph2 already exists. gremlin g2 = ConfiguredGraphFactory.open( graph2 ); g2.vertices().size(); == 1","title":"9.11 \u4f8b\u5b50"},{"location":"janusgraph_basics/deployment_scenarios/","text":"8.\u90e8\u7f72\u65b9\u6848 JanusGraph\u63d0\u4f9b\u4e86\u591a\u79cd\u5b58\u50a8\u548c\u7d22\u5f15\u540e\u7aef\u9009\u9879\uff0c\u53ef\u4ee5\u7075\u6d3b\u5730\u90e8\u7f72\u5b83\u4eec\u3002\u672c\u7ae0\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u53ef\u80fd\u7684\u90e8\u7f72\u65b9\u6848\uff0c\u4ee5\u5e2e\u52a9\u89e3\u51b3\u8fd9\u79cd\u7075\u6d3b\u6027\u5e26\u6765\u7684\u590d\u6742\u6027\u3002 \u5728\u8ba8\u8bba\u4e0d\u540c\u7684\u90e8\u7f72\u65b9\u6848\u4e4b\u524d\uff0c\u4e86\u89e3JanusGraph\u672c\u8eab\u548c\u540e\u7aef\u7684\u89d2\u8272\u975e\u5e38\u91cd\u8981\u3002\u9996\u5148\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u4e0eJanusGraph\u76f4\u63a5\u901a\u4fe1\uff0c\u4e3b\u8981\u662f\u901a\u8fc7\u53d1\u9001Gremlin traversals\u6765\u6267\u884c\u3002JanusGraph\u7136\u540e\u4e0e\u914d\u7f6e\u7684\u540e\u7aef\u901a\u4fe1\u4ee5\u6267\u884c\u63a5\u6536\u7684traversals\u3002\u5f53JanusGraph\u4ee5JanusGraph Server\u7684\u5f62\u5f0f\u4f7f\u7528\u65f6\uff0c\u5c31\u6ca1\u6709\u50cfJanusGraph Server \u8fd9\u6837\u7684master\u8282\u70b9\u4e86\u3002\u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fde\u63a5\u5230\u4efb\u4f55JanusGraph Server\u5b9e\u4f8b\u3002\u4ed6\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u6765\u5b89\u6392\u5bf9\u4e0d\u540c\u5b9e\u4f8b\u7684\u8bf7\u6c42\u3002JanusGraph Server\u5b9e\u4f8b\u672c\u8eab\u4e0d\u76f4\u63a5\u76f8\u4e92\u901a\u4fe1\uff0c\u8fd9\u4f7f\u5f97\u5728\u9700\u8981\u5904\u7406\u66f4\u591atraversals\u65f6\u53ef\u4ee5\u8f7b\u677e\u6269\u5c55\u5b83\u4eec\u3002 \u6ce8\u610f:\u672c\u7ae0\u4e2d\u4ecb\u7ecd\u7684\u573a\u666f\u4ec5\u662fJanusGraph\u5982\u4f55\u90e8\u7f72\u7684\u793a\u4f8b\u3002\u6bcf\u4e2a\u90e8\u7f72\u90fd\u9700\u8981\u8003\u8651\u5177\u4f53\u7684\u7528\u4f8b\u548c\u751f\u4ea7\u9700\u6c42\u3002 8.1 \u5165\u95e8\u573a\u666f \u8fd9\u79cd\u60c5\u51b5\u662f\u5927\u591a\u6570\u7528\u6237\u5728\u521a\u521a\u5f00\u59cb\u4f7f\u7528JanusGraph\u65f6\u53ef\u80fd\u60f3\u8981\u9009\u62e9\u7684\u573a\u666f\u3002\u5b83\u63d0\u4f9b\u53ef\u6269\u5c55\u6027\u548c\u5bb9\u9519\u6027\uff0c\u5e76\u4e14\u6240\u9700\u670d\u52a1\u5668\u6570\u91cf\u6700\u5c11\u3002JanusGraph Server\u4e0e\u5b58\u50a8\u540e\u7aef\u7684\u5b9e\u4f8b\u4e00\u8d77\u8fd0\u884c\uff0c\u5e76\u4e14\u53ef\u4ee5\u9009\u62e9\u5728\u6bcf\u4e2a\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7d22\u5f15\u540e\u7aef\u7684\u5b9e\u4f8b\u3002 \u901a\u8fc7\u7b80\u5355\u5730\u6dfb\u52a0\u66f4\u591a\u76f8\u540c\u7c7b\u578b\u7684\u670d\u52a1\u5668\u6216\u5c06\u5176\u4e2d\u4e00\u4e2a\u7ec4\u4ef6\u79fb\u52a8\u5230\u4e13\u7528\u670d\u52a1\u5668\u4e0a\uff0c\u53ef\u4ee5\u6269\u5c55\u8fd9\u6837\u7684\u8bbe\u7f6e\u3002\u540e\u8005\u63cf\u8ff0\u4e86\u5c06\u90e8\u7f72\u8f6c\u6362\u4e3a\u9ad8\u7ea7\u573a\u666f\u7684\u65b9\u5f0f\u3002 \u4efb\u4f55\u53ef\u6269\u5c55\u5b58\u50a8\u540e\u7aef\u90fd\u53ef\u4ee5\u4e0e\u6b64\u65b9\u6848\u4e00\u8d77\u4f7f\u7528\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8eScylla\uff0c\u5f53\u6258\u7ba1\u4e0e\u6b64\u65b9\u6848\u4e2d\u7684\u5176\u4ed6\u670d\u52a1\u5171\u5b58\u65f6\uff0c\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\u3002\u5f53\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u8be5\u4f7f\u7528\u7d22\u5f15\u540e\u7aef\u65f6\uff0c\u5b83\u4e5f\u9700\u8981\u662f\u53ef\u6269\u5c55\u7684 8.2 \u9ad8\u7ea7\u573a\u666f \u9ad8\u7ea7\u65b9\u6848\u662f\u7b2c8.1\u8282\u201c\u5165\u95e8\u65b9\u6848\u201d\u7684\u6f14\u53d8\u3002\u5b83\u4eec\u4e0d\u662f\u5c06JanusGraph Server\u5b9e\u4f8b\u4e0e\u5b58\u50a8\u540e\u7aef\u4ee5\u53ca\u53ef\u9009\u7684\u7d22\u5f15\u540e\u7aef\u4e00\u8d77\u6258\u7ba1\uff0c\u800c\u662f\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5206\u5f00\u3002\u5728\u4e0d\u540c\u670d\u52a1\u5668\u4e0a\u6258\u7ba1\u4e0d\u540c\u7ec4\u4ef6\uff08JanusGraph\u670d\u52a1\u5668\uff0c\u5b58\u50a8/\u7d22\u5f15\u540e\u7aef\uff09\u7684\u4f18\u52bf\u5728\u4e8e\u5b83\u4eec\u53ef\u4ee5\u76f8\u4e92\u72ec\u7acb\u5730\u8fdb\u884c\u6269\u5c55\u548c\u7ba1\u7406\u3002\u8fd9\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u4ee3\u4ef7\u662f\u5fc5\u987b\u7ef4\u62a4\u66f4\u591a\u7684\u670d\u52a1\u5668\u3002 \u7531\u4e8e\u6b64\u65b9\u6848\u63d0\u4f9b\u4e86\u4e0d\u540c\u7ec4\u4ef6\u7684\u72ec\u7acb\u53ef\u4f38\u7f29\u6027\uff0c\u56e0\u6b64\u4f7f\u7528\u53ef\u6269\u5c55\u540e\u7aef\u5f53\u7136\u4e5f\u662f\u6700\u6709\u610f\u4e49\u7684\u3002 8.3 \u6781\u7b80\u4e3b\u4e49\u60c5\u666f \u53ef\u4ee5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5c06JanusGraph Server\u4e0e\u540e\u7aef\u4e00\u8d77\u7ba1\u7406\u3002\u8fd9\u5bf9\u4e8e\u6d4b\u8bd5\u76ee\u7684\u5c24\u5176\u6709\u5438\u5f15\u529b\uff0c\u4f8b\u5982\uff0c\u5f53JanusGraph\u53ea\u652f\u6301\u5355\u4e2a\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u5728\u540c\u4e00\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u3002 \u4e0e\u4e4b\u524d\u7684\u65b9\u6848\u76f8\u53cd\uff0c\u5bf9\u4e8e\u4e0d\u53ef\u6269\u5c55\u7684\u6b64\u65b9\u6848\u4f7f\u7528\u540e\u7aef\u662f\u6700\u6709\u610f\u4e49\u7684\u3002\u5185\u5b58\u540e\u7aef\u53ef\u7528\u4e8e\u6d4b\u8bd5\u76ee\u7684\uff0c\u6216Berkeley DB\u7528\u4e8e\u751f\u4ea7\uff0cLucene\u53ef\u7528\u4f5c\u53ef\u9009\u7d22\u5f15\u540e\u7aef\u3002 8.4 \u5d4c\u5165\u5f0fJanusGraph \u9664\u4e86\u4ece\u5e94\u7528\u7a0b\u5e8f\u8fde\u63a5\u5230JanusGraph\u670d\u52a1\u5668\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5c06JanusGraph\u4f5c\u4e3a\u5e93\u5d4c\u5165\u57fa\u4e8eJVM\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u867d\u7136\u8fd9\u51cf\u5c11\u4e86\u7ba1\u7406\u5f00\u9500\uff0c\u4f46\u5374\u65e0\u6cd5\u72ec\u7acb\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6269\u5c55JanusGraph\u3002\u5d4c\u5165\u5f0fJanusGraph\u53ef\u4ee5\u4f5c\u4e3a\u4efb\u4f55\u5176\u4ed6\u65b9\u6848\u7684\u53d8\u4f53\u8fdb\u884c\u90e8\u7f72\u3002JanusGraph\u53ea\u662f\u4ece\u670d\u52a1\u5668\u76f4\u63a5\u79fb\u52a8\u5230\u5e94\u7528\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u73b0\u5728\u53ea\u7528\u4f5c\u5e93\u800c\u4e0d\u662f\u72ec\u7acb\u670d\u52a1\u3002","title":"8.\u90e8\u7f72\u65b9\u6848"},{"location":"janusgraph_basics/deployment_scenarios/#8","text":"JanusGraph\u63d0\u4f9b\u4e86\u591a\u79cd\u5b58\u50a8\u548c\u7d22\u5f15\u540e\u7aef\u9009\u9879\uff0c\u53ef\u4ee5\u7075\u6d3b\u5730\u90e8\u7f72\u5b83\u4eec\u3002\u672c\u7ae0\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u53ef\u80fd\u7684\u90e8\u7f72\u65b9\u6848\uff0c\u4ee5\u5e2e\u52a9\u89e3\u51b3\u8fd9\u79cd\u7075\u6d3b\u6027\u5e26\u6765\u7684\u590d\u6742\u6027\u3002 \u5728\u8ba8\u8bba\u4e0d\u540c\u7684\u90e8\u7f72\u65b9\u6848\u4e4b\u524d\uff0c\u4e86\u89e3JanusGraph\u672c\u8eab\u548c\u540e\u7aef\u7684\u89d2\u8272\u975e\u5e38\u91cd\u8981\u3002\u9996\u5148\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ea\u4e0eJanusGraph\u76f4\u63a5\u901a\u4fe1\uff0c\u4e3b\u8981\u662f\u901a\u8fc7\u53d1\u9001Gremlin traversals\u6765\u6267\u884c\u3002JanusGraph\u7136\u540e\u4e0e\u914d\u7f6e\u7684\u540e\u7aef\u901a\u4fe1\u4ee5\u6267\u884c\u63a5\u6536\u7684traversals\u3002\u5f53JanusGraph\u4ee5JanusGraph Server\u7684\u5f62\u5f0f\u4f7f\u7528\u65f6\uff0c\u5c31\u6ca1\u6709\u50cfJanusGraph Server \u8fd9\u6837\u7684master\u8282\u70b9\u4e86\u3002\u56e0\u6b64\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fde\u63a5\u5230\u4efb\u4f55JanusGraph Server\u5b9e\u4f8b\u3002\u4ed6\u4eec\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8d1f\u8f7d\u5747\u8861\u6765\u5b89\u6392\u5bf9\u4e0d\u540c\u5b9e\u4f8b\u7684\u8bf7\u6c42\u3002JanusGraph Server\u5b9e\u4f8b\u672c\u8eab\u4e0d\u76f4\u63a5\u76f8\u4e92\u901a\u4fe1\uff0c\u8fd9\u4f7f\u5f97\u5728\u9700\u8981\u5904\u7406\u66f4\u591atraversals\u65f6\u53ef\u4ee5\u8f7b\u677e\u6269\u5c55\u5b83\u4eec\u3002 \u6ce8\u610f:\u672c\u7ae0\u4e2d\u4ecb\u7ecd\u7684\u573a\u666f\u4ec5\u662fJanusGraph\u5982\u4f55\u90e8\u7f72\u7684\u793a\u4f8b\u3002\u6bcf\u4e2a\u90e8\u7f72\u90fd\u9700\u8981\u8003\u8651\u5177\u4f53\u7684\u7528\u4f8b\u548c\u751f\u4ea7\u9700\u6c42\u3002","title":"8.\u90e8\u7f72\u65b9\u6848"},{"location":"janusgraph_basics/deployment_scenarios/#81","text":"\u8fd9\u79cd\u60c5\u51b5\u662f\u5927\u591a\u6570\u7528\u6237\u5728\u521a\u521a\u5f00\u59cb\u4f7f\u7528JanusGraph\u65f6\u53ef\u80fd\u60f3\u8981\u9009\u62e9\u7684\u573a\u666f\u3002\u5b83\u63d0\u4f9b\u53ef\u6269\u5c55\u6027\u548c\u5bb9\u9519\u6027\uff0c\u5e76\u4e14\u6240\u9700\u670d\u52a1\u5668\u6570\u91cf\u6700\u5c11\u3002JanusGraph Server\u4e0e\u5b58\u50a8\u540e\u7aef\u7684\u5b9e\u4f8b\u4e00\u8d77\u8fd0\u884c\uff0c\u5e76\u4e14\u53ef\u4ee5\u9009\u62e9\u5728\u6bcf\u4e2a\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u7d22\u5f15\u540e\u7aef\u7684\u5b9e\u4f8b\u3002 \u901a\u8fc7\u7b80\u5355\u5730\u6dfb\u52a0\u66f4\u591a\u76f8\u540c\u7c7b\u578b\u7684\u670d\u52a1\u5668\u6216\u5c06\u5176\u4e2d\u4e00\u4e2a\u7ec4\u4ef6\u79fb\u52a8\u5230\u4e13\u7528\u670d\u52a1\u5668\u4e0a\uff0c\u53ef\u4ee5\u6269\u5c55\u8fd9\u6837\u7684\u8bbe\u7f6e\u3002\u540e\u8005\u63cf\u8ff0\u4e86\u5c06\u90e8\u7f72\u8f6c\u6362\u4e3a\u9ad8\u7ea7\u573a\u666f\u7684\u65b9\u5f0f\u3002 \u4efb\u4f55\u53ef\u6269\u5c55\u5b58\u50a8\u540e\u7aef\u90fd\u53ef\u4ee5\u4e0e\u6b64\u65b9\u6848\u4e00\u8d77\u4f7f\u7528\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8eScylla\uff0c\u5f53\u6258\u7ba1\u4e0e\u6b64\u65b9\u6848\u4e2d\u7684\u5176\u4ed6\u670d\u52a1\u5171\u5b58\u65f6\uff0c\u9700\u8981\u8fdb\u884c\u4e00\u4e9b\u914d\u7f6e\u3002\u5f53\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e94\u8be5\u4f7f\u7528\u7d22\u5f15\u540e\u7aef\u65f6\uff0c\u5b83\u4e5f\u9700\u8981\u662f\u53ef\u6269\u5c55\u7684","title":"8.1 \u5165\u95e8\u573a\u666f"},{"location":"janusgraph_basics/deployment_scenarios/#82","text":"\u9ad8\u7ea7\u65b9\u6848\u662f\u7b2c8.1\u8282\u201c\u5165\u95e8\u65b9\u6848\u201d\u7684\u6f14\u53d8\u3002\u5b83\u4eec\u4e0d\u662f\u5c06JanusGraph Server\u5b9e\u4f8b\u4e0e\u5b58\u50a8\u540e\u7aef\u4ee5\u53ca\u53ef\u9009\u7684\u7d22\u5f15\u540e\u7aef\u4e00\u8d77\u6258\u7ba1\uff0c\u800c\u662f\u5728\u4e0d\u540c\u7684\u670d\u52a1\u5668\u4e0a\u5206\u5f00\u3002\u5728\u4e0d\u540c\u670d\u52a1\u5668\u4e0a\u6258\u7ba1\u4e0d\u540c\u7ec4\u4ef6\uff08JanusGraph\u670d\u52a1\u5668\uff0c\u5b58\u50a8/\u7d22\u5f15\u540e\u7aef\uff09\u7684\u4f18\u52bf\u5728\u4e8e\u5b83\u4eec\u53ef\u4ee5\u76f8\u4e92\u72ec\u7acb\u5730\u8fdb\u884c\u6269\u5c55\u548c\u7ba1\u7406\u3002\u8fd9\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7684\u7075\u6d3b\u6027\uff0c\u4f46\u4ee3\u4ef7\u662f\u5fc5\u987b\u7ef4\u62a4\u66f4\u591a\u7684\u670d\u52a1\u5668\u3002 \u7531\u4e8e\u6b64\u65b9\u6848\u63d0\u4f9b\u4e86\u4e0d\u540c\u7ec4\u4ef6\u7684\u72ec\u7acb\u53ef\u4f38\u7f29\u6027\uff0c\u56e0\u6b64\u4f7f\u7528\u53ef\u6269\u5c55\u540e\u7aef\u5f53\u7136\u4e5f\u662f\u6700\u6709\u610f\u4e49\u7684\u3002 8.3 \u6781\u7b80\u4e3b\u4e49\u60c5\u666f \u53ef\u4ee5\u5728\u4e00\u53f0\u670d\u52a1\u5668\u4e0a\u5c06JanusGraph Server\u4e0e\u540e\u7aef\u4e00\u8d77\u7ba1\u7406\u3002\u8fd9\u5bf9\u4e8e\u6d4b\u8bd5\u76ee\u7684\u5c24\u5176\u6709\u5438\u5f15\u529b\uff0c\u4f8b\u5982\uff0c\u5f53JanusGraph\u53ea\u652f\u6301\u5355\u4e2a\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u8be5\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u5728\u540c\u4e00\u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u3002 \u4e0e\u4e4b\u524d\u7684\u65b9\u6848\u76f8\u53cd\uff0c\u5bf9\u4e8e\u4e0d\u53ef\u6269\u5c55\u7684\u6b64\u65b9\u6848\u4f7f\u7528\u540e\u7aef\u662f\u6700\u6709\u610f\u4e49\u7684\u3002\u5185\u5b58\u540e\u7aef\u53ef\u7528\u4e8e\u6d4b\u8bd5\u76ee\u7684\uff0c\u6216Berkeley DB\u7528\u4e8e\u751f\u4ea7\uff0cLucene\u53ef\u7528\u4f5c\u53ef\u9009\u7d22\u5f15\u540e\u7aef\u3002","title":"8.2 \u9ad8\u7ea7\u573a\u666f"},{"location":"janusgraph_basics/deployment_scenarios/#84-janusgraph","text":"\u9664\u4e86\u4ece\u5e94\u7528\u7a0b\u5e8f\u8fde\u63a5\u5230JanusGraph\u670d\u52a1\u5668\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5c06JanusGraph\u4f5c\u4e3a\u5e93\u5d4c\u5165\u57fa\u4e8eJVM\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u3002\u867d\u7136\u8fd9\u51cf\u5c11\u4e86\u7ba1\u7406\u5f00\u9500\uff0c\u4f46\u5374\u65e0\u6cd5\u72ec\u7acb\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6269\u5c55JanusGraph\u3002\u5d4c\u5165\u5f0fJanusGraph\u53ef\u4ee5\u4f5c\u4e3a\u4efb\u4f55\u5176\u4ed6\u65b9\u6848\u7684\u53d8\u4f53\u8fdb\u884c\u90e8\u7f72\u3002JanusGraph\u53ea\u662f\u4ece\u670d\u52a1\u5668\u76f4\u63a5\u79fb\u52a8\u5230\u5e94\u7528\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u73b0\u5728\u53ea\u7528\u4f5c\u5e93\u800c\u4e0d\u662f\u72ec\u7acb\u670d\u52a1\u3002","title":"8.4 \u5d4c\u5165\u5f0fJanusGraph"},{"location":"janusgraph_basics/gremlin_query_language/","text":"Gremlin\u662fJanusGraph\u7684\u67e5\u8be2\u8bed\u8a00\uff0c\u7528\u4e8e\u4ece\u56fe\u4e2d\u68c0\u7d22\u6570\u636e\u548c\u66f4\u65b0\u6570\u636e\u3002 Gremlin\u662f\u4e00\u79cd\u9762\u5411\u8def\u5f84\u7684\u8bed\u8a00\uff0c\u5b83\u80fd\u591f\u7b80\u6d01\u5730\u8868\u793a\u590d\u6742\u7684\u56fe\u5f62\u904d\u5386\u548c\u591a\u6b65\u64cd\u4f5c\u3002 Gremlin\u662f\u4e00\u79cd\u51fd\u6570\u5f0f\u8bed\u8a00\uff0c\u904d\u5386\u8fd0\u7b97\u88ab\u94fe\u63a5\u5728\u4e00\u8d77\u5f62\u6210\u7c7b\u4f3c\u8def\u5f84\u7684\u8868\u8fbe\u5f0f\u3002 \u4f8b\u5982\uff0c\u201c\u4eceHercules\uff0c\u904d\u5386\u4ed6\u7684\u7236\u4eb2\uff0c\u7136\u540e\u4ed6\u7236\u4eb2\u7684\u7236\u4eb2\uff0c\u5e76\u8fd4\u56de\u7956\u7236\u7684\u540d\u5b57\u3002\u201d Gremlin\u662fApache TinkerPop\u7684\u4e00\u4e2a\u7ec4\u4ef6\u3002 \u5b83\u72ec\u7acb\u4e8eJanusGraph\u5f00\u53d1\uff0c\u5e76\u4e14\u652f\u6301\u5927\u591a\u6570\u7684\u56fe\u6570\u636e\u5e93\u3002 \u901a\u8fc7Gremlin\u67e5\u8be2\u8bed\u8a00\u5728JanusGraph\u57fa\u7840\u4e0a\u5f00\u53d1\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u7528\u6237\u53ef\u4ee5\u907f\u514d\u88ab\u6570\u636e\u5e93\u7ed1\u5b9a\uff0c\u56e0\u4e3a\u4ed6\u4eec\u7684\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fc1\u79fb\u5230\u652f\u6301Gremlin\u7684\u5176\u4ed6\u56fe\u6570\u636e\u5e93\u3002 \u672c\u8282\u662fGremlin\u67e5\u8be2\u8bed\u8a00\u7684\u7b80\u8981\u6982\u8ff0\u3002 \u6709\u5173Gremlin\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4ee5\u4e0b\u8d44\u6e90\uff1a Complete Gremlin Manual: Gremlin\u7684\u53c2\u8003\u624b\u518c\u3002 Gremlin Console Tutorial: \u5b66\u4e60\u5982\u4f55\u6709\u6548\u5730\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u4ee5\u4ea4\u4e92\u65b9\u5f0f\u904d\u5386\u548c\u5206\u6790\u56fe\u5f62\u3002 Practical Gremlin Book: \u56fe\u6570\u636e\u5e93\u548cGremlin\u67e5\u8be2\u8bed\u8a00\u7684\u5165\u95e8\u6307\u5357\u3002 Gremlin Recipes: Gremlin\u7684\u6700\u4f73\u5b9e\u8df5\u548c\u5e38\u89c1\u904d\u5386\u6a21\u5f0f\u7684\u96c6\u5408\u3002 Gremlin Language Drivers: \u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u8fde\u63a5\u5230Gremlin\u670d\u52a1\u5668\uff0c\u5305\u62ecGo\uff0cJavaScript\uff0c.NET / C\uff03\uff0cPHP\uff0cPython\uff0cRuby\uff0cScala\u548cTypeScript\u3002 Gremlin Language Variants: \u5b66\u4e60\u5982\u4f55\u5728\u7f16\u7a0b\u8bed\u8a00\u4e2d\u5d4c\u5165Gremlin\u3002 Gremlin for SQL developers: \u4f7f\u7528SQL\u67e5\u8be2\u6570\u636e\u7684\u65b9\u5f0f\u6765\u5b66\u4e60Gremlin\u3002 6.1. \u904d\u5386\u4ecb\u7ecd Gremlin\u67e5\u8be2\u662f\u4e00\u7cfb\u5217\u4ece\u5de6\u5230\u53f3\u7684\u8ba1\u7b97\u64cd\u4f5c/\u51fd\u6570\u3002 \u4e0b\u9762\u901a\u8fc7\u7b2c3\u7ae0\u201c\u5165\u95e8\u201d\u4e2d\u8ba8\u8bba\u7684Gods\u56fe\u6765\u5c55\u793a\u4e00\u4e2a\u7b80\u5355\u7684\u7956\u7236\u67e5\u8be2\u7684\u793a\u4f8b\u3002 gremlin g.V().has('name', hercules').out('father').out('father').values('name') == saturn \u4e0a\u9762\u67e5\u8be2\u7684\u89e3\u8bfb\uff1a g\uff1a\u5f53\u524d\u56fe\u7684\u904d\u5386\u53e5\u67c4\u3002 V\uff1a\u56fe\u4e2d\u6240\u6709\u7684\u9876\u70b9\u3002 has(\u2018name\u2019, \u2018hercules\u2019)\uff1a\u8fc7\u6ee4\u51fa\u9876\u70b9name\u4e3ahercules\u7684\u9876\u70b9\u3002 out(\u2018father\u2019)\uff1a\u4ecehercules\u9876\u70b9\u904d\u5386\u51fa\u8fb9\u4e3afather\u7684\u8fb9\u3002 out(\u2018father\u2019)\uff1a\u4ecehercules\u7684father\u9876\u70b9\u904d\u5386\u51fa\u8fb9\u4e3afather\u7684\u8fb9\u3002 name\uff1a\u83b7\u53d6hercules\u7956\u7236\u9876\u70b9\u7684name\u5c5e\u6027\u7684\u503c\u3002 \u603b\u4e4b\uff0c\u8fd9\u4e9b\u6b65\u9aa4\u6784\u6210\u4e86\u7c7b\u4f3c\u8def\u5f84\u7684\u904d\u5386\u67e5\u8be2\u3002 \u6bcf\u4e2a\u6b65\u9aa4\u90fd\u53ef\u4ee5\u5206\u89e3\u5e76\u663e\u793a\u5176\u7ed3\u679c\u3002 \u5728\u6784\u5efa\u66f4\u5927\uff0c\u66f4\u590d\u6742\u7684\u67e5\u8be2\u65f6\uff0c\u8fd9\u79cd\u6784\u5efa\u904d\u5386/\u67e5\u8be2\u7684\u65b9\u5f0f\u5f88\u6709\u7528\u3002 == graphtraversalsource[janusgraph[cql:127.0.0.1], standard] gremlin g.V().has('name', 'hercules') == v[24] gremlin g.V().has('name', 'hercules').out('father') == v[16] gremlin g.V().has('name', 'hercules').out('father').out('father') == v[20] gremlin g.V().has('name', 'hercules').out('father').out('father').values('name') == saturn \u5bf9\u4e8e\u6b63\u786e\u6027\u68c0\u67e5\uff0c\u901a\u5e38\u53ef\u4ee5\u67e5\u770b\u6bcf\u4e2a\u8fd4\u56de\u503c\u7684\u5c5e\u6027\u503c\uff0c\u800c\u4e0d\u662f\u67e5\u770b\u4ed6\u4eec\u7684id\u3002 gremlin g.V().has('name', 'hercules').values('name') == hercules gremlin g.V().has('name', 'hercules').out('father').values('name') == jupiter gremlin g.V().has('name', 'hercules').out('father').out('father').values('name') == saturn \u6ce8\u610f\u76f8\u5173\u7684\u904d\u5386\uff0c\u5c55\u793a\u4e86Hercules\u7684\u6574\u4e2a\u7236\u7cfb\u6811\u5206\u652f\u3002 \u63d0\u4f9b\u8fd9\u79cd\u66f4\u590d\u6742\u7684\u904d\u5386\u4ee5\u5c55\u793a\u8bed\u8a00\u7684\u7075\u6d3b\u6027\u548c\u53ef\u8bfb\u6027\u3002 \u5bf9Gremlin\u7684\u6709\u6548\u638c\u63e1\u4e3aJanusGraph\u7528\u6237\u63d0\u4f9b\u4e86\u5feb\u901f\u67e5\u8be2\u5e95\u5c42\u56fe\u7ed3\u6784\u904d\u5386\u7684\u80fd\u529b\u3002 gremlin g.V().has('name', 'hercules').repeat(out('father')).emit().values('name') == jupiter == saturn \u4e0b\u9762\u63d0\u4f9b\u4e86\u4e00\u4e9b\u904d\u5386\u793a\u4f8b\u3002 gremlin hercules = g.V().has('name', 'hercules').next() == v[1536] gremlin g.V(hercules).out('father', 'mother').label() == god == human gremlin g.V(hercules).out('battled').label() == monster == monster == monster gremlin g.V(hercules).out('battled').valueMap() == {name=nemean} == {name=hydra} == {name=cerberus} \u6bcf\u4e00\u6b65\uff08\u7531\u5206\u9694\u8868\u793a\uff09\u662f\u5bf9\u4e0a\u4e00\u6b65\u8ba1\u7b97\u51fa\u7684\u5bf9\u8c61\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570\u3002 Gremlin\u8bed\u8a00\u4e2d\u6709\u8bb8\u591a\u6b65\uff08\u53c2\u89c1Gremlin Steps\uff09\u3002 \u901a\u8fc7\u7b80\u5355\u5730\u6539\u53d8\u6b65\u9aa4\u6216\u7740\u6539\u53d8\u6b65\u9aa4\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u904d\u5386\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u8fd4\u56de\u6240\u6709\u4e0eHercules\u6218\u6597\u76f8\u540c\u602a\u7269\u7684\u4eba\u7684\u540d\u5b57\uff0c\u5e76\u4e14\u9664\u53bbHercules\u672c\u8eab\uff08\u5373\u201c\u5171\u540c\u6218\u58eb\u201d\u6216\u8005\u201c\u76df\u53cb\u201d\uff09\u3002 \u9274\u4e8e\u795e\u7684\u56fe\u5f62\u53ea\u6709\u4e00\u4e2a\u6218\u6597\u8005\uff08Hercules\uff09\uff0c\u53e6\u4e00\u4e2a\u6218\u6597\u8005\uff08\u4e3a\u4e86\u4e3e\u4f8b\uff09\u88ab\u6dfb\u52a0\u5230\u56fe\u4e2d\uff0cGremlin\u5c55\u793a\u4e86\u5982\u4f55\u5c06\u9876\u70b9\u548c\u8fb9\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\u3002 gremlin theseus = graph.addVertex('human') == v[3328] gremlin theseus.property('name', 'theseus') == null gremlin cerberus = g.V().has('name', 'cerberus').next() == v[2816] gremlin battle = theseus.addEdge('battled', cerberus, 'time', 22) == e[7eo-2kg-iz9-268][3328-battled- 2816] gremlin battle.values('time') == 22 \u6dfb\u52a0\u9876\u70b9\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u6307\u5b9a\u9876\u70b9\u6807\u7b7e\u3002 \u4f46\u662f\u6dfb\u52a0\u8fb9\u65f6\u5fc5\u987b\u6307\u5b9a\u8fb9\u6807\u7b7e\u3002 \u53ef\u4ee5\u5728\u9876\u70b9\u548c\u8fb9\u4e0a\u8bbe\u7f6e\u4f5c\u4e3a\u952e\u503c\u5bf9\u7684\u5c5e\u6027\u3002 \u4f7f\u7528SET\u6216LIST\u57fa\u6570\u5b9a\u4e49\u7684\u5c5e\u6027\u952e\uff0c\u5fc5\u987b\u4f7f\u7528addProperty\u5411\u9876\u70b9\u6dfb\u52a0\u6b64\u5c5e\u6027\u3002 gremlin g.V(hercules).as('h').out('battled').in('battled').where(neq('h')).values('name') == theseus \u4e0a\u9762\u7684\u4f8b\u5b50\u67094\u4e2a\u94fe\u63a5\u51fd\u6570\uff1aout\uff0cin\uff0cexcept\u548cvalues\uff08\u5373name\u662f\u503c\u7684\u7b80\u5199\uff08\u2019name\u2019\uff09\uff09\u3002 \u6bcf\u4e2a\u7684\u51fd\u6570\u5728\u4e0b\u9762\u9010\u6761\u5217\u51fa\uff0c\u5176\u4e2dV\u662f\u9876\u70b9\u800cU\u662f\u4efb\u4f55\u5bf9\u8c61\uff0c\u5176\u4e2dV\u662fU\u7684\u5b50\u96c6\u3002 out: V - V in: V - V except: U - U values: V - U \u5c06\u51fd\u6570\u94fe\u63a5\u5728\u4e00\u8d77\u65f6\uff0c\u4f20\u5165\u7c7b\u578b\u5fc5\u987b\u4e0e\u4f20\u51fa\u7c7b\u578b\u5339\u914d\uff0c\u5176\u4e2dU\u5339\u914d\u4efb\u4f55\u5185\u5bb9\u3002 \u56e0\u6b64\uff0c\u4e0a\u9762\u7684\u201c\u5171\u540c\u6218\u6597/\u76df\u53cb\u201d\u904d\u5386\u662f\u6b63\u786e\u7684\u3002 \u6ce8\u610f\uff1a\u672c\u8282\u4e2d\u4ecb\u7ecd\u7684Gremlin\u6982\u8ff0\u91cd\u70b9\u4ecb\u7ecd\u4e86\u5728Gremlin\u63a7\u5236\u53f0\u4e2dGremlin-Groovy\u8bed\u8a00\u5b9e\u73b0\u7248\u672c\u7684\u4f7f\u7528\u3002 Gremlin\u7684\u5176\u4ed6\u8bed\u8a00\u9a71\u52a8\u548c\u5b9e\u73b0\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002 6.2. \u904d\u5386\u8fed\u4ee3 Gremlin\u63a7\u5236\u53f0\u5176\u4e2d\u7684\u4e00\u4e2a\u7279\u6027\u662f\u5b83\u4ecegremlin prompt\u81ea\u52a8\u8fed\u4ee3\u6240\u6709\u7684\u67e5\u8be2\u7ed3\u679c\u3002 \u8fd9\u5728REPL\u73af\u5883\u4e2d\u5f88\u597d\u7528\uff0c\u800c\u4e14\u5b83\u5c06\u7ed3\u679c\u4f5c\u4e3aString\u7c7b\u578b\u6765\u5c55\u793a\u3002 \u5f53\u4f60\u5f00\u59cb\u7f16\u5199Gremlin\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u4e86\u89e3\u5982\u4f55\u663e\u5f0f\u8fed\u4ee3\u904d\u5386\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u904d\u5386\u4e0d\u4f1a\u81ea\u52a8\u8fed\u4ee3\u3002 \u4ee5\u4e0b\u662f\u8fed\u4ee3\u904d\u5386\u7684\u4e00\u4e9b\u5e38\u7528\u65b9\u6cd5\uff1a iterate() - \u9884\u671f\u6216\u8005\u53ef\u4ee5\u5ffd\u7565\u7a7a\u503c\u3002 next() - \u83b7\u53d6\u4e00\u4e2a\u7ed3\u679c\uff0c\u4e00\u5b9a\u8981\u5148\u901a\u8fc7hasNext()\u5224\u65ad\u3002 next(int n) - \u83b7\u53d6\u7b2cn\u4e2a\u7ed3\u679c\uff0c\u4e00\u5b9a\u8981\u5148\u901a\u8fc7hasNext()\u5224\u65ad\u3002 toList() - \u83b7\u53d6\u6240\u6709\u7684\u7ed3\u679c\u4f5c\u4e3a\u4e00\u4e2alist\uff0c\u5982\u679c\u6ca1\u6709\u7ed3\u679c\u5219\u8fd4\u56de\u7a7a\u5217\u8868\u3002 \u4e0b\u9762\u4f7f\u7528Java\u4ee3\u7801\u793a\u4f8b\u6765\u6f14\u793a\u8fd9\u4e9b\u6982\u5ff5\uff1a Traversal t = g.V().has(\"name\", \"pluto\"); // Define a traversal // Note the traversal is not executed/iterated yet if (t.hasNext()) { // Check if results are available pluto = g.V().has(\"name\", \"pluto\").next(); // Get one result g.V(pluto).drop().iterate(); // Execute a traversal to drop pluto from graph } // Note the traversal can be cloned for reuse Traversal tt = t.asAdmin().clone(); if (tt.hasNext()) { System.err.println(\"pluto was not dropped!\"); } List Vertex gods = g.V().hasLabel(\"god\").toList(); // Find all the gods","title":"6.Gremin\u67e5\u8be2\u8bed\u8a00"},{"location":"janusgraph_basics/gremlin_query_language/#61","text":"Gremlin\u67e5\u8be2\u662f\u4e00\u7cfb\u5217\u4ece\u5de6\u5230\u53f3\u7684\u8ba1\u7b97\u64cd\u4f5c/\u51fd\u6570\u3002 \u4e0b\u9762\u901a\u8fc7\u7b2c3\u7ae0\u201c\u5165\u95e8\u201d\u4e2d\u8ba8\u8bba\u7684Gods\u56fe\u6765\u5c55\u793a\u4e00\u4e2a\u7b80\u5355\u7684\u7956\u7236\u67e5\u8be2\u7684\u793a\u4f8b\u3002 gremlin g.V().has('name', hercules').out('father').out('father').values('name') == saturn \u4e0a\u9762\u67e5\u8be2\u7684\u89e3\u8bfb\uff1a g\uff1a\u5f53\u524d\u56fe\u7684\u904d\u5386\u53e5\u67c4\u3002 V\uff1a\u56fe\u4e2d\u6240\u6709\u7684\u9876\u70b9\u3002 has(\u2018name\u2019, \u2018hercules\u2019)\uff1a\u8fc7\u6ee4\u51fa\u9876\u70b9name\u4e3ahercules\u7684\u9876\u70b9\u3002 out(\u2018father\u2019)\uff1a\u4ecehercules\u9876\u70b9\u904d\u5386\u51fa\u8fb9\u4e3afather\u7684\u8fb9\u3002 out(\u2018father\u2019)\uff1a\u4ecehercules\u7684father\u9876\u70b9\u904d\u5386\u51fa\u8fb9\u4e3afather\u7684\u8fb9\u3002 name\uff1a\u83b7\u53d6hercules\u7956\u7236\u9876\u70b9\u7684name\u5c5e\u6027\u7684\u503c\u3002 \u603b\u4e4b\uff0c\u8fd9\u4e9b\u6b65\u9aa4\u6784\u6210\u4e86\u7c7b\u4f3c\u8def\u5f84\u7684\u904d\u5386\u67e5\u8be2\u3002 \u6bcf\u4e2a\u6b65\u9aa4\u90fd\u53ef\u4ee5\u5206\u89e3\u5e76\u663e\u793a\u5176\u7ed3\u679c\u3002 \u5728\u6784\u5efa\u66f4\u5927\uff0c\u66f4\u590d\u6742\u7684\u67e5\u8be2\u65f6\uff0c\u8fd9\u79cd\u6784\u5efa\u904d\u5386/\u67e5\u8be2\u7684\u65b9\u5f0f\u5f88\u6709\u7528\u3002 == graphtraversalsource[janusgraph[cql:127.0.0.1], standard] gremlin g.V().has('name', 'hercules') == v[24] gremlin g.V().has('name', 'hercules').out('father') == v[16] gremlin g.V().has('name', 'hercules').out('father').out('father') == v[20] gremlin g.V().has('name', 'hercules').out('father').out('father').values('name') == saturn \u5bf9\u4e8e\u6b63\u786e\u6027\u68c0\u67e5\uff0c\u901a\u5e38\u53ef\u4ee5\u67e5\u770b\u6bcf\u4e2a\u8fd4\u56de\u503c\u7684\u5c5e\u6027\u503c\uff0c\u800c\u4e0d\u662f\u67e5\u770b\u4ed6\u4eec\u7684id\u3002 gremlin g.V().has('name', 'hercules').values('name') == hercules gremlin g.V().has('name', 'hercules').out('father').values('name') == jupiter gremlin g.V().has('name', 'hercules').out('father').out('father').values('name') == saturn \u6ce8\u610f\u76f8\u5173\u7684\u904d\u5386\uff0c\u5c55\u793a\u4e86Hercules\u7684\u6574\u4e2a\u7236\u7cfb\u6811\u5206\u652f\u3002 \u63d0\u4f9b\u8fd9\u79cd\u66f4\u590d\u6742\u7684\u904d\u5386\u4ee5\u5c55\u793a\u8bed\u8a00\u7684\u7075\u6d3b\u6027\u548c\u53ef\u8bfb\u6027\u3002 \u5bf9Gremlin\u7684\u6709\u6548\u638c\u63e1\u4e3aJanusGraph\u7528\u6237\u63d0\u4f9b\u4e86\u5feb\u901f\u67e5\u8be2\u5e95\u5c42\u56fe\u7ed3\u6784\u904d\u5386\u7684\u80fd\u529b\u3002 gremlin g.V().has('name', 'hercules').repeat(out('father')).emit().values('name') == jupiter == saturn \u4e0b\u9762\u63d0\u4f9b\u4e86\u4e00\u4e9b\u904d\u5386\u793a\u4f8b\u3002 gremlin hercules = g.V().has('name', 'hercules').next() == v[1536] gremlin g.V(hercules).out('father', 'mother').label() == god == human gremlin g.V(hercules).out('battled').label() == monster == monster == monster gremlin g.V(hercules).out('battled').valueMap() == {name=nemean} == {name=hydra} == {name=cerberus} \u6bcf\u4e00\u6b65\uff08\u7531\u5206\u9694\u8868\u793a\uff09\u662f\u5bf9\u4e0a\u4e00\u6b65\u8ba1\u7b97\u51fa\u7684\u5bf9\u8c61\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570\u3002 Gremlin\u8bed\u8a00\u4e2d\u6709\u8bb8\u591a\u6b65\uff08\u53c2\u89c1Gremlin Steps\uff09\u3002 \u901a\u8fc7\u7b80\u5355\u5730\u6539\u53d8\u6b65\u9aa4\u6216\u7740\u6539\u53d8\u6b65\u9aa4\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u904d\u5386\u3002 \u4e0b\u9762\u7684\u4f8b\u5b50\u8fd4\u56de\u6240\u6709\u4e0eHercules\u6218\u6597\u76f8\u540c\u602a\u7269\u7684\u4eba\u7684\u540d\u5b57\uff0c\u5e76\u4e14\u9664\u53bbHercules\u672c\u8eab\uff08\u5373\u201c\u5171\u540c\u6218\u58eb\u201d\u6216\u8005\u201c\u76df\u53cb\u201d\uff09\u3002 \u9274\u4e8e\u795e\u7684\u56fe\u5f62\u53ea\u6709\u4e00\u4e2a\u6218\u6597\u8005\uff08Hercules\uff09\uff0c\u53e6\u4e00\u4e2a\u6218\u6597\u8005\uff08\u4e3a\u4e86\u4e3e\u4f8b\uff09\u88ab\u6dfb\u52a0\u5230\u56fe\u4e2d\uff0cGremlin\u5c55\u793a\u4e86\u5982\u4f55\u5c06\u9876\u70b9\u548c\u8fb9\u6dfb\u52a0\u5230\u56fe\u5f62\u4e2d\u3002 gremlin theseus = graph.addVertex('human') == v[3328] gremlin theseus.property('name', 'theseus') == null gremlin cerberus = g.V().has('name', 'cerberus').next() == v[2816] gremlin battle = theseus.addEdge('battled', cerberus, 'time', 22) == e[7eo-2kg-iz9-268][3328-battled- 2816] gremlin battle.values('time') == 22 \u6dfb\u52a0\u9876\u70b9\u65f6\uff0c\u53ef\u4ee5\u9009\u62e9\u662f\u5426\u6307\u5b9a\u9876\u70b9\u6807\u7b7e\u3002 \u4f46\u662f\u6dfb\u52a0\u8fb9\u65f6\u5fc5\u987b\u6307\u5b9a\u8fb9\u6807\u7b7e\u3002 \u53ef\u4ee5\u5728\u9876\u70b9\u548c\u8fb9\u4e0a\u8bbe\u7f6e\u4f5c\u4e3a\u952e\u503c\u5bf9\u7684\u5c5e\u6027\u3002 \u4f7f\u7528SET\u6216LIST\u57fa\u6570\u5b9a\u4e49\u7684\u5c5e\u6027\u952e\uff0c\u5fc5\u987b\u4f7f\u7528addProperty\u5411\u9876\u70b9\u6dfb\u52a0\u6b64\u5c5e\u6027\u3002 gremlin g.V(hercules).as('h').out('battled').in('battled').where(neq('h')).values('name') == theseus \u4e0a\u9762\u7684\u4f8b\u5b50\u67094\u4e2a\u94fe\u63a5\u51fd\u6570\uff1aout\uff0cin\uff0cexcept\u548cvalues\uff08\u5373name\u662f\u503c\u7684\u7b80\u5199\uff08\u2019name\u2019\uff09\uff09\u3002 \u6bcf\u4e2a\u7684\u51fd\u6570\u5728\u4e0b\u9762\u9010\u6761\u5217\u51fa\uff0c\u5176\u4e2dV\u662f\u9876\u70b9\u800cU\u662f\u4efb\u4f55\u5bf9\u8c61\uff0c\u5176\u4e2dV\u662fU\u7684\u5b50\u96c6\u3002 out: V - V in: V - V except: U - U values: V - U \u5c06\u51fd\u6570\u94fe\u63a5\u5728\u4e00\u8d77\u65f6\uff0c\u4f20\u5165\u7c7b\u578b\u5fc5\u987b\u4e0e\u4f20\u51fa\u7c7b\u578b\u5339\u914d\uff0c\u5176\u4e2dU\u5339\u914d\u4efb\u4f55\u5185\u5bb9\u3002 \u56e0\u6b64\uff0c\u4e0a\u9762\u7684\u201c\u5171\u540c\u6218\u6597/\u76df\u53cb\u201d\u904d\u5386\u662f\u6b63\u786e\u7684\u3002 \u6ce8\u610f\uff1a\u672c\u8282\u4e2d\u4ecb\u7ecd\u7684Gremlin\u6982\u8ff0\u91cd\u70b9\u4ecb\u7ecd\u4e86\u5728Gremlin\u63a7\u5236\u53f0\u4e2dGremlin-Groovy\u8bed\u8a00\u5b9e\u73b0\u7248\u672c\u7684\u4f7f\u7528\u3002 Gremlin\u7684\u5176\u4ed6\u8bed\u8a00\u9a71\u52a8\u548c\u5b9e\u73b0\u4e5f\u662f\u53ef\u4ee5\u4f7f\u7528\u7684\u3002","title":"6.1. \u904d\u5386\u4ecb\u7ecd"},{"location":"janusgraph_basics/gremlin_query_language/#62","text":"Gremlin\u63a7\u5236\u53f0\u5176\u4e2d\u7684\u4e00\u4e2a\u7279\u6027\u662f\u5b83\u4ecegremlin prompt\u81ea\u52a8\u8fed\u4ee3\u6240\u6709\u7684\u67e5\u8be2\u7ed3\u679c\u3002 \u8fd9\u5728REPL\u73af\u5883\u4e2d\u5f88\u597d\u7528\uff0c\u800c\u4e14\u5b83\u5c06\u7ed3\u679c\u4f5c\u4e3aString\u7c7b\u578b\u6765\u5c55\u793a\u3002 \u5f53\u4f60\u5f00\u59cb\u7f16\u5199Gremlin\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u4e86\u89e3\u5982\u4f55\u663e\u5f0f\u8fed\u4ee3\u904d\u5386\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u904d\u5386\u4e0d\u4f1a\u81ea\u52a8\u8fed\u4ee3\u3002 \u4ee5\u4e0b\u662f\u8fed\u4ee3\u904d\u5386\u7684\u4e00\u4e9b\u5e38\u7528\u65b9\u6cd5\uff1a iterate() - \u9884\u671f\u6216\u8005\u53ef\u4ee5\u5ffd\u7565\u7a7a\u503c\u3002 next() - \u83b7\u53d6\u4e00\u4e2a\u7ed3\u679c\uff0c\u4e00\u5b9a\u8981\u5148\u901a\u8fc7hasNext()\u5224\u65ad\u3002 next(int n) - \u83b7\u53d6\u7b2cn\u4e2a\u7ed3\u679c\uff0c\u4e00\u5b9a\u8981\u5148\u901a\u8fc7hasNext()\u5224\u65ad\u3002 toList() - \u83b7\u53d6\u6240\u6709\u7684\u7ed3\u679c\u4f5c\u4e3a\u4e00\u4e2alist\uff0c\u5982\u679c\u6ca1\u6709\u7ed3\u679c\u5219\u8fd4\u56de\u7a7a\u5217\u8868\u3002 \u4e0b\u9762\u4f7f\u7528Java\u4ee3\u7801\u793a\u4f8b\u6765\u6f14\u793a\u8fd9\u4e9b\u6982\u5ff5\uff1a Traversal t = g.V().has(\"name\", \"pluto\"); // Define a traversal // Note the traversal is not executed/iterated yet if (t.hasNext()) { // Check if results are available pluto = g.V().has(\"name\", \"pluto\").next(); // Get one result g.V(pluto).drop().iterate(); // Execute a traversal to drop pluto from graph } // Note the traversal can be cloned for reuse Traversal tt = t.asAdmin().clone(); if (tt.hasNext()) { System.err.println(\"pluto was not dropped!\"); } List Vertex gods = g.V().hasLabel(\"god\").toList(); // Find all the gods","title":"6.2. \u904d\u5386\u8fed\u4ee3"},{"location":"janusgraph_basics/indexing_for_better_performance/","text":"","title":"11.\u9ad8\u6027\u80fd\u7d22\u5f15"},{"location":"janusgraph_basics/janusgraph_cache/","text":"","title":"13.JanusGraph\u7f13\u5b58"},{"location":"janusgraph_basics/janusgraph_server/","text":"JanusGraph\u4f7f\u7528Gremlin Server\u5f15\u64ce\u4f5c\u4e3a\u670d\u52a1\u7ec4\u4ef6\u6765\u5904\u7406\u548c\u54cd\u5e94\u5ba2\u6237\u7aef\u67e5\u8be2\u3002 \u5f53\u6253\u5305\u5728JanusGraph\u4e2d\u65f6\uff0cGremlin Server\u88ab\u79f0\u4e3aJanusGraph Server\u3002 JanusGraph Server\u5fc5\u987b\u624b\u52a8\u542f\u52a8\u624d\u80fd\u4f7f\u7528\u3002 JanusGraph Server\u63d0\u4f9b\u4e86\u4e00\u79cd\u8fdc\u7a0b\u6267\u884cGremlin\u811a\u672c\u7684\u65b9\u6cd5\uff0c\u8be5\u811a\u672c\u9488\u5bf9\u6258\u7ba1\u5728\u5176\u4e2d\u7684\u4e00\u4e2a\u6216\u591a\u4e2aJanusGraph\u5b9e\u4f8b\u3002 \u672c\u8282\u5c06\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528WebSocket\u914d\u7f6e\uff0c\u4ee5\u53ca\u5982\u4f55\u914d\u7f6eJanusGraph Server\u6765\u5904\u7406HTTP\u7aef\u4ea4\u4e92\u3002 7.1. \u5165\u95e8 7.1.1. \u4f7f\u7528\u9884\u6253\u5305\u65b9\u5f0f\u5206\u53d1 JanusGraph release\u7248\u672c\u9ed8\u8ba4\u63d0\u4f9b\u4e86Cassandra\u548cElasticsearch\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884cJanusGraph Server\uff0c\u65b9\u4fbf\u7528\u6237\u5feb\u901f\u4f7f\u7528JanusGraph Server\u3002 \u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u6b64\u9ed8\u8ba4\u914d\u7f6e\u53ef\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684WebSocket\u534f\u8bae\u8fde\u63a5\u5230JanusGraph Server\u3002 \u6709\u8bb8\u591a\u4f7f\u7528\u4e0d\u540c\u8bed\u8a00\u5f00\u53d1\u7684\u5ba2\u6237\u7aef\u652f\u6301\u6b64\u534f\u8bae\u3002 \u4f7f\u7528WebSocket\u63a5\u53e3\u6700\u5e38\u7528\u7684\u5ba2\u6237\u7aef\u662fGremlin\u63a7\u5236\u53f0\u3002 \u5feb\u901f\u542f\u52a8\u6346\u7ed1\u5305\u4e0d\u4ee3\u8868\u751f\u4ea7\u5b89\u88c5\uff0c\u800c\u662f\u63d0\u4f9b\u4e86\u4e00\u79cd\u4f7f\u7528JanusGraph Server\u5f00\u53d1\uff0c\u6d4b\u8bd5\u4ee5\u53ca\u4e86\u89e3\u5404\u4e2a\u7ec4\u4ef6\u4e00\u8d77\u5de5\u4f5c\u7684\u65b9\u6cd5\u3002 \u4f7f\u7528\u6b64\u9ed8\u8ba4\u914d\u7f6e\uff1a \u4eceReleases\u9875\u9762\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684janusgraph-$VERSION.zip\u6587\u4ef6 \u89e3\u538b\u5e76\u8fdb\u5165janusgraph- $ VERSION\u76ee\u5f55 \u8fd0\u884cbin / janusgraph.sh start\u3002 \u8fd9\u4e00\u6b65\u5c06\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u4e2d\u57fa\u4e8eCassandra / ES\u914d\u7f6e\u542f\u52a8Gremlin Server\u3002 \u6ce8\u610f\u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u548cjanusgraph.sh\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c\u3002 $bin/janusgraph.sh start Forking Cassandra... Running `nodetool statusthrift`.. OK (returned exit status 0 and printed string \"running\"). Forking Elasticsearch... Connecting to Elasticsearch (127.0.0.1:9300)... OK (connected to 127.0.0.1:9300). Forking Gremlin-Server... Connecting to Gremlin-Server (127.0.0.1:8182)... OK (connected to 127.0.0.1:8182). Run gremlin.sh to connect. 7.1.1.1. \u8fde\u63a5\u5230Gremlin Server \u8fd0\u884cjanusgraph.sh\u540e\uff0cGremlin Server\u5c06\u5f00\u59cb\u76d1\u542cWebSocket\u8fde\u63a5\u3002 \u6d4b\u8bd5\u8fde\u63a5\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\u4f7f\u7528Gremlin Console\u3002 \u4f7f\u7528bin/gremlin.sh\u542f\u52a8Gremlin\u63a7\u5236\u53f0\u5e76\u4f7f\u7528 :remote \u548c : \u5411Gremlin Server\u53d1\u9001Gremlin\u547d\u4ee4\uff1a $ bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: tinkerpop.server plugin activated: tinkerpop.hadoop plugin activated: tinkerpop.utilities plugin activated: janusgraph.imports plugin activated: tinkerpop.tinkergraph gremlin :remote connect tinkerpop.server conf/remote.yaml == Connected - localhost/127.0.0.1:8182 gremlin : graph.addVertex(\"name\", \"stephen\") == v[256] gremlin : g.V().values('name') == stephen :remote\u547d\u4ee4\u544a\u8bc9\u63a7\u5236\u53f0\u4f7f\u7528conf/remote.yaml\u6587\u4ef6\u8fdc\u7a0b\u8fde\u63a5\u5230Gremlin Server\u3002 \u8be5\u6587\u4ef6\u6307\u5411\u5728\u672c\u5730\u8fd0\u884c\u7684Gremlin Server\u5b9e\u4f8b\u3002 : \u662f\u201csubmit\u201d\u547d\u4ee4\uff0c\u5b83\u5c06\u8be5\u884c\u7684Gremlin\u53d1\u9001\u5230\u5f53\u524d\u8fd0\u884c\u4e2d\u7684\u8fdc\u7aef\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u8fde\u63a5\u662f\u65e0\u4f1a\u8bdd\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5728\u63a7\u5236\u53f0\u4e2d\u53d1\u9001\u7684\u6bcf\u4e00\u884c\u90fd\u88ab\u89e3\u91ca\u4e3a\u5355\u4e2a\u8bf7\u6c42\u3002 \u53ef\u4ee5\u4f7f\u7528\u5206\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u5728\u4e00\u884c\u4e0a\u53d1\u9001\u591a\u4e2a\u8bed\u53e5\u3002 \u6216\u8005\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u521b\u5efa\u8fde\u63a5\u65f6\u6307\u5b9a\u4f1a\u8bdd\u6765\u5efa\u7acb\u5177\u6709\u4f1a\u8bdd\u7684\u63a7\u5236\u53f0\u3002 \u63a7\u5236\u53f0\u4f1a\u8bdd\u5141\u8bb8\u60a8\u8de8\u591a\u884c\u590d\u7528\u53d8\u91cf\u8f93\u5165\u3002 gremlin :remote connect tinkerpop.server conf/remote.yaml == Configured localhost/127.0.0.1:8182 gremlin graph == standardjanusgraph[cql:[127.0.0.1]] gremlin g == graphtraversalsource[standardjanusgraph[cql:[127.0.0.1]], standard] gremlin g.V() gremlin user = \"Chris\" == Chris gremlin graph.addVertex(\"name\", user) No such property: user for class: Script21 Type ':help' or ':h' for help. Display stack trace? [yN] gremlin :remote connect tinkerpop.server conf/remote.yaml session == Configured localhost/127.0.0.1:8182-[9acf239e-a3ed-4301-b33f-55c911e04052] gremlin g.V() gremlin user = \"Chris\" == Chris gremlin user == Chris gremlin graph.addVertex(\"name\", user) == v[4344] gremlin g.V().values('name') == Chris 7.2. \u9884\u5b89\u88c5\u5305\u4f7f\u7528\u540e\u6e05\u7406 \u5982\u679c\u60a8\u60f3\u91cd\u65b0\u5f00\u59cb\u5e76\u5220\u9664\u6570\u636e\u5e93\u548c\u65e5\u5fd7\uff0c\u53ef\u4ee5\u4f7f\u7528janusgraph.sh\u7684clean\u547d\u4ee4\u3002 \u5728\u8fd0\u884cclean\u64cd\u4f5c\u4e4b\u524d\u8981\u505c\u6b62\u670d\u52a1\u5668\u3002 $ cd /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/ $ ./bin/janusgraph.sh stop Killing Gremlin-Server (pid 91505)... Killing Elasticsearch (pid 91402)... Killing Cassandra (pid 91219)... $ ./bin/janusgraph.sh clean Are you sure you want to delete all stored data and logs? [y/N] y Deleted data in /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/db Deleted logs in /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/log 7.3. \u4f7f\u7528WebSocket\u8fde\u63a5 JanusGraph Server \u672c\u7ae0\u76841\u8282\u5165\u95e8\u90e8\u5206\u8bb2\u7684\u9ed8\u8ba4\u914d\u7f6e\u5c31\u662f\u4f7f\u7528\u7684WebSocket\u914d\u7f6e\u3002\u5982\u679c\u8981\u4f7f\u7528\u81ea\u5df1\u7684Cassandra\u6216HBase\u73af\u5883\uff0c\u9700\u8981\u66f4\u6539\u9ed8\u8ba4\u914d\u7f6e\u6765\u542f\u52a8\u73af\u5883\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u64cd\u4f5c\u6b65\u9aa4\uff1a \u9996\u5148\u6d4b\u8bd5\u672c\u5730\u8fde\u63a5\u5230JanusGraph\u6570\u636e\u5e93\u3002\u65e0\u8bba\u662f\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u8fd8\u662f\u7528\u7a0b\u5e8f\u6d4b\u8bd5\u8fde\u63a5\u90fd\u53ef\u4ee5\u3002\u5728JanusGraph\u7684./conf\u76ee\u5f55\u4e0b\u7684properties\u6587\u4ef6\u4e2d\u8fdb\u884c\u9002\u5f53\u7684\u66f4\u6539\u3002\u4f8b\u5982\uff0c\u7f16\u8f91./conf/janusgraph-hbase.properties\u5e76\u786e\u4fdd\u6b63\u786e\u6307\u5b9a\u4e86storage.backend\uff0cstorage.hostname\u548cstorage.hbase.table\u7b49\u53c2\u6570\u3002\u6709\u5173\u4e3a\u5404\u79cd\u540e\u7aef\u5b58\u50a8\u914d\u7f6eJanusGraph\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002\u786e\u4fddproperties\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u884c\uff1a gremlin.graph = org.janusgraph.core.JanusGraphFactory \u6d4b\u8bd5\u5b8c\u672c\u5730\u914d\u7f6e\u8fde\u63a5\u800c\u4e14\u4f60\u4e5f\u914d\u7f6e\u597d\u4e86properties\u6587\u4ef6\u540e\uff0c\u5c06properties\u6587\u4ef6\u4ece./conf\u76ee\u5f55\u590d\u5236\u5230./conf/gremlin-server\u76ee\u5f55\u3002 cp conf/janusgraph-hbase.properties conf/gremlin-server/socket-janusgraph-hbase-server.properties \u590d\u5236./conf/gremlin-server/gremlin-server.yaml\u6587\u4ef6\u5e76\u91cd\u65b0\u547d\u540d\u4e3asocket-gremlin-server.yaml\u3002\u5982\u679c\u60a8\u9700\u8981\u4fdd\u7559\u539f\u6765\u7684yaml\u6587\u4ef6\uff0c\u8bf7\u6267\u884c\u6b64\u64cd\u4f5c cp conf/gremlin-server/gremlin-server.yaml conf/gremlin-server/socket-gremlin-server.yaml \u7f16\u8f91socket-gremlin-server.yaml\u6587\u4ef6\u5e76\u8fdb\u884c\u4ee5\u4e0b\u66f4\u65b0\uff1a \u5982\u679c\u4f60\u8ba1\u5212\u8fde\u63a5\u5230\u5176\u4ed6\u7684JanusGraph Server\u800c\u4e0d\u662f\u672c\u5730\uff0c\u9700\u8981\u66f4\u65b0host\u7684IP\u5730\u5740\uff1a host\uff1a10.10.10.100 //\u670d\u52a1\u7684IP \u66f4\u65b0graphs\u914d\u7f6e\u6307\u5411\u4f60\u4f7f\u7528\u7684properties\u6587\u4ef6\uff0c\u4ee5\u4fbfJanusGraph Server\u53ef\u4ee5\u627e\u5230\u5e76\u8fde\u63a5\u5230\u4f60\u7684JanusGraph\u5b9e\u4f8b\uff1a graphs\uff1a{ graph\uff1aconf/gremlin-server/socket-janusgraph-hbase-server.properties } \u542f\u52a8JanusGraph\u670d\u52a1\uff0c\u5e76\u6307\u5b9a\u521a\u521a\u914d\u7f6e\u7684yaml\u6587\u4ef6\uff1a bin/gremlin-server.sh ./conf/gremlin-server/socket-gremlin-server.yaml \u6ce8\u610f\uff1a\u4e0d\u80fd\u53ea\u4f7f\u7528bin/janusgraph.sh\u3002\u8fd9\u5c06\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u542f\u52a8\uff0c\u4ece\u800c\u542f\u52a8Cassandra / Elasticsearch\u73af\u5883\u3002 JanusGraph Server\u5c06\u5728WebSocket\u6a21\u5f0f\u4e0b\u8fd0\u884c\uff0c\u53ef\u4ee5\u6309\u7167\u7b2c7\u7ae0\u76841.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin\u670d\u52a1\u201d\u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u6d4b\u8bd5\u3002 7.4. \u4f7f\u7528HTTP\u8fde\u63a5 JanusGraph Server \u7b2c7\u7ae01\u8282\u201c\u5165\u95e8\u201d\u4e2d\u63cf\u8ff0\u7684\u9ed8\u8ba4\u914d\u7f6e\u662fWebSocket\u914d\u7f6e\u3002\u5982\u679c\u8981\u66f4\u6539\u9ed8\u8ba4\u914d\u7f6e\u4ee5\u4f7f\u7528HTTP\u8fde\u63a5\u5230JanusGraph Server\uff0c\u8bf7\u6309\u7167\u4e0b\u5217\u6b65\u9aa4\u64cd\u4f5c\uff1a \u9996\u5148\u6d4b\u8bd5\u4e0eJanusGraph\u6570\u636e\u5e93\u7684\u672c\u5730\u8fde\u63a5\u3002\u65e0\u8bba\u662f\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u8fd8\u662f\u4f7f\u7528\u7a0b\u5e8f\u6d4b\u8bd5\u8fde\u63a5\u90fd\u53ef\u4ee5\u3002\u5728JanusGraph\u7684./conf\u76ee\u5f55\u4e2d\u7684properties\u6587\u4ef6\u4e2d\u8fdb\u884c\u9002\u5f53\u7684\u66f4\u6539\u3002\u4f8b\u5982\uff0c\u7f16\u8f91./conf/janusgraph-hbase.properties\u5e76\u786e\u4fdd\u6b63\u786e\u6307\u5b9a\u4e86storage.backend\uff0cstorage.hostname\u548cstorage.hbase.table\u53c2\u6570\u3002\u6709\u5173JanusGraph\u7684\u66f4\u591a\u540e\u7aef\u5b58\u50a8\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002\u786e\u4fddproperties\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u884c\uff1a gremlin.graph = org.janusgraph.core.JanusGraphFactory \u672c\u5730\u8fde\u63a5\u6d4b\u8bd5\u5b8c\u6210\u5e76\u4e14\u4f60\u7684properties\u6587\u4ef6\u786e\u5b9a\u53ef\u7528\u540e\uff0c\u5c06properties\u6587\u4ef6\u4ece./conf\u76ee\u5f55\u590d\u5236\u5230./conf/gremlin-server\u76ee\u5f55\u4e0b\u3002 cp conf/janusgraph-hbase.properties conf/gremlin-server/http-janusgraph-hbase-server.properties \u590d\u5236./conf/gremlin-server/gremlin-server.yaml\u6587\u4ef6\u66f4\u540d\u4e3ahttp-gremlin-server.yaml\u3002\u5982\u679c\u4f60\u9700\u8981\u53c2\u8003\u6587\u4ef6\u7684\u539f\u59cb\u7248\u672c\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 cp conf/gremlin-server/gremlin-server.yaml conf/gremlin-server/http-gremlin-server.yaml \u7f16\u8f91http-gremlin-server.yaml\u6587\u4ef6\u5e76\u8fdb\u884c\u4ee5\u4e0b\u4fee\u6539\uff1a \u5982\u679c\u4f60\u6253\u7b97\u8fde\u63a5\u5230\u5176\u4ed6\u7684JanusGraph Server\u800c\u4e0d\u662f\u672c\u5730\u670d\u52a1\uff0c\u8bf7\u4fee\u6539host IP\uff1a host\uff1a10.10.10.100 \u66f4\u65b0channelizer\u8bbe\u7f6e\u6765\u6307\u5b9aHttpChannelizer\uff1a channelizer\uff1aorg.apache.tinkerpop.gremlin.server.channel.HttpChannelizer \u66f4\u65b0graphs\u90e8\u5206\u6765\u6307\u5411\u65b0\u7684properties\u6587\u4ef6\uff0c\u4ee5\u4fbfJanusGraph Server\u53ef\u4ee5\u627e\u5230\u5e76\u8fde\u63a5\u5230\u4f60\u7684JanusGraph\u5b9e\u4f8b\uff1a graphs: { graph: conf/gremlin-server/http-janusgraph-hbase-server.properties } \u542f\u52a8JanusGraph\u670d\u52a1\u5668\uff0c\u6307\u5411\u521a\u521a\u914d\u7f6e\u7684yaml\u6587\u4ef6\uff1a bin/gremlin-server.sh ./conf/gremlin-server/http-gremlin-server.yaml JanusGraph Server\u73b0\u5728\u5e94\u8be5\u4ee5HTTP\u6a21\u5f0f\u8fd0\u884c\u5e76\u53ef\u7528\u4e8e\u6d4b\u8bd5\u3002 curl\u53ef\u7528\u4e8e\u9a8c\u8bc1\u670d\u52a1\u5668\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1a curl -XPOST -Hcontent-type:application/json -d '{\"gremlin\":\"g.V().count()\"}' http://[IP for JanusGraph server host]:8182 7.5. \u540c\u65f6\u4f7f\u7528WebSocket\u548cHTTP\u8fde\u63a5JanusGraph Server \u4eceJanusGraph 0.2.0\u5f00\u59cb\uff0c\u4f60\u53ef\u4ee5\u914d\u7f6egremlin-server.yaml\u4ee5\u901a\u8fc7\u540c\u4e00\u7aef\u53e3\u63a5\u53d7WebSocket\u548cHTTP\u8fde\u63a5\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5982\u4e0b\u914d\u7f6e\u3002 channelizer\uff1aorg.apache.tinkerpop.gremlin.server.channel.WsAndHttpChannelizer 7.6. JanusGraph Server\u9ad8\u7ea7\u914d\u7f6e 7.6.1. HTTP\u8eab\u4efd\u9a8c\u8bc1 \u6ce8\u610f\uff1a\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002 7.6.1.1. HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1 \u8981\u5728JanusGraph Server\u4e2d\u542f\u7528\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bf7\u5728gremlin-server.yaml\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\u3002 authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.JanusGraphSimpleAuthenticator, authenticationHandler: org.apache.tinkerpop.gremlin.server.handler.HttpBasicAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, credentialsDb: conf/janusgraph-credentials-server.properties } } \u9a8c\u8bc1\u662f\u5426\u6b63\u786e\u914d\u7f6e\u4e86\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u4f8b\u5982 curl -v -XPOST http://localhost:8182 -d '{\"gremlin\": \"g.V().count()\"}' \u5982\u679c\u8eab\u4efd\u9a8c\u8bc1\u914d\u7f6e\u6b63\u786e\uff0c\u5219\u5e94\u8fd4\u56de401 curl -v -XPOST http://localhost:8182 -d '{\"gremlin\": \"g.V().count()\"}' -u user:password \u5982\u679c\u9a8c\u8bc1\u914d\u7f6e\u6b63\u786e\uff0c\u5219\u5e94\u8fd4\u56de200\uff0c\u7ed3\u679c\u4e3a4\u3002 7.6.2. WebSocket\u8eab\u4efd\u9a8c\u8bc1 WebSocket\u8eab\u4efd\u9a8c\u8bc1\u901a\u8fc7\u7b80\u5355\u8eab\u4efd\u9a8c\u8bc1\u548c\u5b89\u5168\u5c42\uff08SASL\uff09\u673a\u5236\u8fdb\u884c\u3002 \u8981\u542f\u7528SASL\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bf7\u5728gremlin-server.yaml\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.JanusGraphSimpleAuthenticator, authenticationHandler: org.apache.tinkerpop.gremlin.server.handler.SaslAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, credentialsDb: conf/janusgraph-credentials-server.properties } } \u6ce8\u610f\uff1a\u5728\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002 \u5982\u679c\u4f60\u901a\u8fc7gremlin\u63a7\u5236\u53f0\u8fdb\u884c\u8fde\u63a5\uff0c\u5219\u4f60\u7684remote yaml\u6587\u4ef6\u5e94\u4f7f\u7528\u9002\u5f53\u7684\u503c\u6765\u914d\u7f6e\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002 username: user password: password 7.6.3. HTTP\u548cWebSocket\u8eab\u4efd\u9a8c\u8bc1 \u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528HTTP\u548cWebSocket\u7ec4\u5408\u7684\u65b9\u5f0f\u8fde\u63a5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528SaslAndHMACAuthenticator\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5305\u542bWebSocket\u7684SASL\uff0cHTTP\u7684\u57fa\u672c\u8ba4\u8bc1\uff0c\u548cHTTP\u57fa\u4e8e\u54c8\u5e0c\u7684\u6d88\u606f\u8eab\u4efd\u9a8c\u8bc1\u7801\uff08HMAC\uff09\u3002 HMAC\u662f\u57fa\u4e8etoken\u7684\u8eab\u4efd\u9a8c\u8bc1\uff0c\u901a\u8fc7HTTP\u4f7f\u7528\u3002 \u60a8\u9996\u5148\u901a\u8fc7/ session\u7aef\u70b9\u83b7\u53d6token\uff0c\u7136\u540e\u4f7f\u7528\u5b83\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u5b83\u7528\u4e8e\u8282\u7ea6\u4f7f\u7528\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u52a0\u5bc6\u5bc6\u7801\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u3002 gremlin-server.yaml\u5e94\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.SaslAndHMACAuthenticator, authenticationHandler: org.janusgraph.graphdb.tinkerpop.gremlin.server.handler.SaslAndHMACAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, hmacSecret: secret, credentialsDb: conf/janusgraph-credentials-server.properties } } \u6ce8\u610f\uff1a\u5728\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u60a8\u5e0c\u671b\u80fd\u591f\u5728\u6bcf\u53f0\u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u76f8\u540c\u7684HMAC\u4ee4\u724c\uff0c\u5219\u5728\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u670d\u52a1\u5668\u4e0a\u5e94\u8be5\u662f\u76f8\u540c\u7684\u3002 \u5bf9\u4e8eHTTP\u7684HMAC\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a/session\u7aef\u70b9\uff0c\u8be5\u7aef\u70b9\u63d0\u4f9b\u4e00\u4e2atoken\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728\u4e00\u5c0f\u65f6\u540e\u8fc7\u671f\u3002 token\u7684\u8d85\u65f6\u65f6\u95f4\u53ef\u4ee5\u5728authentication.config\u4e2d\u7684tokenTimeout\u6765\u914d\u7f6e\u3002 \u6b64\u503c\u4e3aLong\u503c\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528curl\u5411/ session\u7aef\u70b9\u53d1\u51faget\u8bf7\u6c42\u6765\u83b7\u53d6\u4ee4\u724c\u3002 \u4f8b\u5982 curl http://localhost:8182/session -XGET -u user:password {\"token\": \"dXNlcjoxNTA5NTQ2NjI0NDUzOkhrclhYaGhRVG9KTnVSRXJ5U2VpdndhalJRcVBtWEpSMzh5WldqRTM4MW89\"} \u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u201dAuthorization: Token\u201d\u7684header\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u3002 \u4f8b\u5982 curl -v http://localhost:8182/session -XPOST -d '{\"gremlin\": \"g.V().count()\"}' -H \"Authorization: Token dXNlcjoxNTA5NTQ2NjI0NDUzOkhrclhYaGhRVG9KTnVSRXJ5U2VpdndhalJRcVBtWEpSMzh5WldqRTM4MW89\" 7.6.4. JanusGraph\u4f7f\u7528TinkerPop Gremlin Server \u7531\u4e8eJanusGraph Server\u662f\u4e00\u4e2a\u5305\u542bJanusGraph\u914d\u7f6e\u6587\u4ef6\u7684TinkerPop Gremlin Server\uff0c\u56e0\u6b64\u53ef\u4ee5\u5355\u72ec\u4e0b\u8f7d\u517c\u5bb9\u7248\u672c\u7684TinkerPop Gremlin Server\u5e76\u4e0eJanusGraph\u4e00\u8d77\u4f7f\u7528\u3002 \u9996\u5148\u4e0b\u8f7d\u9002\u5f53\u7684Gremlin Server\u7248\u672c\uff0c\u5b83\u9700\u8981\u4e0e\u6b63\u5728\u4f7f\u7528\u7684JanusGraph\u7248\u672c(3.3.3)\u76f8\u5339\u914d\u3002 \u6ce8\u610f\uff1a\u9664\u975e\u7279\u522b\u8bf4\u660e\uff0c\u5426\u5219\u672c\u8282\u4e2d\u5bf9\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u5f15\u7528\u90fd\u662f\u6307Gremlin Server\u7684TinkerPop\u53d1\u884c\u7248\u4e0b\u7684\u8def\u5f84\uff0c\u800c\u4e0d\u662f\u5e26\u6709JanusGraph Server\u7684JanusGraph\u53d1\u884c\u7248\u3002 \u7528JanusGraph\u914d\u7f6e\u72ec\u7acb\u7684Gremlin Server\u8ddf\u4f7f\u7528\u6253\u5305\u7684JanusGraph Server\u662f\u7c7b\u4f3c\u7684\u3002 \u60a8\u5e94\u8be5\u719f\u6089graph\u914d\u7f6e\u3002 \u57fa\u672c\u4e0a\uff0cGremlin Server yaml\u6587\u4ef6\u6307\u5411\u7279\u5b9a\u7684\u56fe\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u7528\u4e8e\u5b9e\u4f8b\u5316\u5b83\u968f\u540e\u5c06\u4f7f\u7528\u7684JanusGraph\u5b9e\u4f8b\u3002 \u4e3a\u4e86\u5b9e\u4f8b\u5316\u8fd9\u4e9bGraph\u5b9e\u4f8b\uff0cGremlin Server\u8981\u6c42\u5728\u5176classpath\u4e0a\u63d0\u4f9bJanusGraph\u7684\u76f8\u5e94\u5e93\u548c\u4f9d\u8d56\u9879\u3002 \u4e3a\u4e86\u6f14\u793a\uff0c\u8fd9\u4e9b\u8bf4\u660e\u5c06\u5c55\u793a\u5982\u4f55\u5728Gremlin Server\u4e2d\u4e3aJanusGraph\u914d\u7f6eBerkeleyDB\u540e\u7aef\u3002 \u5982\u524d\u6240\u8ff0\uff0cGremlin Server\u9700\u8981JanusGraph\u5bf9\u5176\u7c7b\u8def\u5f84\u7684\u4f9d\u8d56\u3002 \u4f7f\u7528\u6b63\u5728\u4f7f\u7528\u7684JanusGraph\u7248\u672c\u53f7\u66ff\u6362\u4ee5\u4e0b\u547d\u4ee4\u4e2d\u7684$VERSION\uff1a bin/gremlin-server.sh -i org.janusgraph janusgraph-all $VERSION \u5f53\u6b64\u8fc7\u7a0b\u5b8c\u6210\u540e\uff0cGremlin Server\u5e94\u8be5\u5177\u6709\u6240\u6709\u53ef\u7528\u7684JanusGraph\u4f9d\u8d56\u9879\uff0c\u56e0\u6b64\u80fd\u591f\u5b9e\u4f8b\u5316JanusGraph\u5bf9\u8c61\u3002 \u6ce8\u610f\uff1a\u4e0a\u9762\u7684\u547d\u4ee4\u4f7f\u7528Groovy Grape\uff0c\u5982\u679c\u914d\u7f6e\u4e0d\u6b63\u786e\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0b\u8f7d\u9519\u8bef\u3002 \u6709\u5173\u8bbe\u7f6e\u301c/ .groovy / grapeConfig.xml\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605TinkerPop\u6587\u6863\u7684\u8fd9\u4e00\u90e8\u5206\u3002 \u4f7f\u7528\u4ee5\u4e0b\u5185\u5bb9\u521b\u5efa\u540d\u4e3aGREMLIN_SERVER_HOME/conf/janusgraph.properties\u7684\u6587\u4ef6\uff1a gremlin.graph=org.janusgraph.core.JanusGraphFactory storage.backend=berkeleyje storage.directory=db/berkeley \u5176\u4ed6\u7684\u540e\u7aef\u914d\u7f6e\u4e5f\u662f\u7c7b\u4f3c\u3002 \u8bf7\u53c2\u89c1\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002 \u5982\u679c\u4f7f\u7528Cassandra\uff0c\u5219\u5728janusgraph.properties\u6587\u4ef6\u4e2d\u4f7f\u7528Cassandra\u914d\u7f6e\u9009\u9879\u3002 \u552f\u4e00\u4fdd\u6301\u4e0d\u53d8\u7684\u91cd\u8981\u90e8\u5206\u662fgremlin.graph\u8bbe\u7f6e\uff0c\u5b83\u5e94\u8be5\u59cb\u7ec8\u4f7f\u7528JanusGraphFactory\u3002 \u6b64\u8bbe\u7f6e\u544a\u8bc9Gremlin Server\u5982\u4f55\u5b9e\u4f8b\u5316JanusGraph\u5b9e\u4f8b\u3002 \u63a5\u4e0b\u6765\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aGREMLIN_SERVER_HOME/conf/gremlin-server-janusgraph.yaml\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a host: localhost port: 8182 graphs: { graph: conf/janusgraph.properties} scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} serializers: - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }} - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { serializeResultToString: true }} - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerV3d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }} metrics: { slf4jReporter: {enabled: true, interval: 180000}} \u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u6709\u51e0\u4e2a\u91cd\u8981\u7684\u90e8\u5206\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0eJanusGraph\u6709\u5173: \u5728\u56fe\u4e2d\uff0c\u6709\u4e00\u4e2a\u540d\u4e3agraph\u7684\u952e\uff0c\u5176\u503c\u4e3aconf/janusgraph.properties\u3002 \u8fd9\u544a\u8bc9Gremlin Server\u5b9e\u4f8b\u5316\u4e00\u4e2a\u540d\u4e3a\u201cgraph\u201d\u7684Graph\u5b9e\u4f8b\uff0c\u5e76\u4f7f\u7528conf/janusgraph.properties\u6587\u4ef6\u5bf9\u5176\u8fdb\u884c\u914d\u7f6e\u3002 \u201cgraph\u201d\u952e\u6210\u4e3aGremlin Server\u4e2dGraph\u5b9e\u4f8b\u7684\u552f\u4e00\u540d\u79f0\uff0c\u53ef\u4ee5\u5728\u63d0\u4ea4\u7ed9\u5b83\u7684\u811a\u672c\u4e2d\u5f15\u7528\u5b83\u3002 \u5728\u63d2\u4ef6\u5217\u8868\u4e2d\uff0c\u6709\u4e00\u4e2a\u5bf9JanusGraphGremlinPlugin\u7684\u5f15\u7528\uff0c\u5b83\u544a\u8bc9Gremlin Server\u521d\u59cb\u5316\u201cJanusGraph\u63d2\u4ef6\u201d\u3002 \u201cJanusGraph\u63d2\u4ef6\u201d\u5c06\u81ea\u52a8\u5bfc\u5165JanusGraph\u7279\u5b9a\u7c7b\uff0c\u4ee5\u4fbf\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u3002 \u8bf7\u6ce8\u610f\u811a\u672c\u952e\u548c\u811a\u672c/janusgraph.groovy\u7684\u5f15\u7528\u3002 \u8fd9\u4e2aGroovy\u6587\u4ef6\u662fGremlin Server\u548c\u7279\u5b9aScriptEngine\u7684\u521d\u59cb\u5316\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u5185\u5bb9\u521b\u5efascripts/janusgraph.groovy\uff1a def globals = [:] globals [g : graph.traversal()] \u4e0a\u9762\u7684\u811a\u672c\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3aglobals\u7684Map\uff0c\u5e76\u4e3a\u5176\u5206\u914d\u4e00\u4e2a\u952e/\u503c\u5bf9\u3002 \u952e\u662fg\uff0c\u5b83\u7684\u503c\u662f\u4ece\u56fe\u751f\u6210\u7684TraversalSource\uff0c\u5b83\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e3aGremlin Server\u914d\u7f6e\u7684\u3002 \u6b64\u65f6\uff0c\u73b0\u5728\u4e3aGremlin Server\u63d0\u4f9b\u7684\u811a\u672c\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u5168\u5c40\u53d8\u91cf - graph\u548cg\u3002 \u6b64\u65f6\uff0cGremlin Server\u5df2\u914d\u7f6e\uff0c\u53ef\u7528\u4e8e\u8fde\u63a5\u5230\u65b0\u7684\u6216\u73b0\u6709\u7684JanusGraph\u6570\u636e\u5e93\u3002\u542f\u52a8server\uff1a $ bin/gremlin-server.sh conf/gremlin-server-janusgraph.yaml [INFO] GremlinServer - \\,,,/ (o o) -----oOOo-(3)-oOOo----- [INFO] GremlinServer - Configuring Gremlin Server from conf/gremlin-server-janusgraph.yaml [INFO] MetricManager - Configured Metrics Slf4jReporter configured with interval=180000ms and loggerName=org.apache.tinkerpop.gremlin.server.Settings$Slf4jReporterMetrics [INFO] GraphDatabaseConfiguration - Set default timestamp provider MICRO [INFO] GraphDatabaseConfiguration - Generated unique-instance-id=7f0000016240-ubuntu1 [INFO] Backend - Initiated backend operations thread pool of size 8 [INFO] KCVSLog$MessagePuller - Loaded unidentified ReadMarker start time 2015-10-02T12:28:24.411Z into org.janusgraph.diskstorage.log.kcvs.KCVSLog$MessagePuller@35399441 [INFO] GraphManager - Graph [graph] was successfully configured via [conf/janusgraph.properties]. [INFO] ServerGremlinExecutor - Initialized Gremlin thread pool. Threads in pool named with pattern gremlin-* [INFO] ScriptEngines - Loaded gremlin-groovy ScriptEngine [INFO] GremlinExecutor - Initialized gremlin-groovy ScriptEngine with scripts/janusgraph.groovy [INFO] ServerGremlinExecutor - Initialized GremlinExecutor and configured ScriptEngines. [INFO] ServerGremlinExecutor - A GraphTraversalSource is now bound to [g] with graphtraversalsource[standardjanusgraph[berkeleyje:db/berkeley], standard] INFO] AbstractChannelizer - Configured application/vnd.gremlin-v3.0+gryo with org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0 [INFO] AbstractChannelizer - Configured application/vnd.gremlin-v3.0+gryo-stringd with org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0 [INFO] GremlinServer$1 - Gremlin Server configured with worker thread pool of 1, gremlin pool of 8 and boss thread pool of 1. [INFO] GremlinServer$1 - Channel started at port 8182. \u4ee5\u4e0b\u90e8\u5206\u8bf4\u660e\u5982\u4f55\u8fde\u63a5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u3002 7.6.4.1. \u901a\u8fc7Gremlin Server\u8fde\u63a5\u5230JanusGraph Gremlin Server\u5c06\u5728\u542f\u52a8\u65f6\u51c6\u5907\u597d\u76d1\u542cWebSocket\u8fde\u63a5\u3002 \u6d4b\u8bd5\u8fde\u63a5\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4f7f\u7528Gremlin Console\u3002 \u6309\u7167\u7b2c7.1.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin\u670d\u52a1\u5668\u201d\u4e2d\u7684\u8bf4\u660e\u9a8c\u8bc1Gremlin\u670d\u52a1\u5668\u662f\u5426\u6b63\u5e38\u5de5\u4f5c \u6ce8\u610f\uff1a\u60a8\u5e94\u8be5\u4e86\u89e3\u7684\u4e00\u70b9\u662f\uff0c\u5728\u4f7f\u7528JanusGraph Server\u65f6\uff0cGremlin\u63a7\u5236\u53f0\u662f\u4eceJanusGraph\u53d1\u884c\u7248\u4e0b\u9762\u542f\u52a8\u7684\uff0c\u5f53\u4f7f\u7528\u5355\u72ec\u7684Gremlin Server\u7684\u6d4b\u8bd5\u65f6\uff0cGremlin\u63a7\u5236\u53f0\u662f\u4eceTinkerPop\u53d1\u884c\u7248\u4e0b\u542f\u52a8\u7684\u3002 GryoMapper mapper = GryoMapper.build().addRegistry(JanusGraphIoRegistry.INSTANCE).create(); Cluster cluster = Cluster.build().serializer(new GryoMessageSerializerV3d0(mapper)).create(); Client client = cluster.connect(); client.submit(\"g.V()\").all().get(); \u901a\u8fc7\u5c06JanusGraphIoRegistry\u6dfb\u52a0\u5230org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0\uff0c\u9a71\u52a8\u7a0b\u5e8f\u5c06\u77e5\u9053\u5982\u4f55\u6b63\u786e\u53cd\u5e8f\u5217\u5316JanusGraph\u8fd4\u56de\u7684\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3002 7.7. JanusGraph Server\u6269\u5c55 \u901a\u8fc7\u5b9e\u73b0Gremlin Server\u63d0\u4f9b\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u6269\u5c55Gremlin Server\u66f4\u591a\u7684\u4ea4\u4e92\u65b9\u5f0f\uff0c\u5e76\u5c06\u5176\u4e0eJanusGraph\u7ed3\u5408\u4f7f\u7528\u3002 \u8bf7\u53c2\u9605\u76f8\u5e94\u7684TinkerPop\u6587\u6863\u83b7\u53d6\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002","title":"7.JanusGraph\u670d\u52a1"},{"location":"janusgraph_basics/janusgraph_server/#71","text":"","title":"7.1. \u5165\u95e8"},{"location":"janusgraph_basics/janusgraph_server/#711","text":"JanusGraph release\u7248\u672c\u9ed8\u8ba4\u63d0\u4f9b\u4e86Cassandra\u548cElasticsearch\u7684\u914d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884cJanusGraph Server\uff0c\u65b9\u4fbf\u7528\u6237\u5feb\u901f\u4f7f\u7528JanusGraph Server\u3002 \u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u6b64\u9ed8\u8ba4\u914d\u7f6e\u53ef\u901a\u8fc7\u81ea\u5b9a\u4e49\u7684WebSocket\u534f\u8bae\u8fde\u63a5\u5230JanusGraph Server\u3002 \u6709\u8bb8\u591a\u4f7f\u7528\u4e0d\u540c\u8bed\u8a00\u5f00\u53d1\u7684\u5ba2\u6237\u7aef\u652f\u6301\u6b64\u534f\u8bae\u3002 \u4f7f\u7528WebSocket\u63a5\u53e3\u6700\u5e38\u7528\u7684\u5ba2\u6237\u7aef\u662fGremlin\u63a7\u5236\u53f0\u3002 \u5feb\u901f\u542f\u52a8\u6346\u7ed1\u5305\u4e0d\u4ee3\u8868\u751f\u4ea7\u5b89\u88c5\uff0c\u800c\u662f\u63d0\u4f9b\u4e86\u4e00\u79cd\u4f7f\u7528JanusGraph Server\u5f00\u53d1\uff0c\u6d4b\u8bd5\u4ee5\u53ca\u4e86\u89e3\u5404\u4e2a\u7ec4\u4ef6\u4e00\u8d77\u5de5\u4f5c\u7684\u65b9\u6cd5\u3002 \u4f7f\u7528\u6b64\u9ed8\u8ba4\u914d\u7f6e\uff1a \u4eceReleases\u9875\u9762\u4e0b\u8f7d\u6700\u65b0\u7248\u672c\u7684janusgraph-$VERSION.zip\u6587\u4ef6 \u89e3\u538b\u5e76\u8fdb\u5165janusgraph- $ VERSION\u76ee\u5f55 \u8fd0\u884cbin / janusgraph.sh start\u3002 \u8fd9\u4e00\u6b65\u5c06\u5728\u4e00\u4e2a\u5355\u72ec\u7684\u8fdb\u7a0b\u4e2d\u57fa\u4e8eCassandra / ES\u914d\u7f6e\u542f\u52a8Gremlin Server\u3002 \u6ce8\u610f\u51fa\u4e8e\u5b89\u5168\u539f\u56e0\uff0cElasticsearch\u548cjanusgraph.sh\u5fc5\u987b\u5728\u975eroot\u5e10\u6237\u4e0b\u8fd0\u884c\u3002 $bin/janusgraph.sh start Forking Cassandra... Running `nodetool statusthrift`.. OK (returned exit status 0 and printed string \"running\"). Forking Elasticsearch... Connecting to Elasticsearch (127.0.0.1:9300)... OK (connected to 127.0.0.1:9300). Forking Gremlin-Server... Connecting to Gremlin-Server (127.0.0.1:8182)... OK (connected to 127.0.0.1:8182). Run gremlin.sh to connect.","title":"7.1.1. \u4f7f\u7528\u9884\u6253\u5305\u65b9\u5f0f\u5206\u53d1"},{"location":"janusgraph_basics/janusgraph_server/#7111-gremlin-server","text":"\u8fd0\u884cjanusgraph.sh\u540e\uff0cGremlin Server\u5c06\u5f00\u59cb\u76d1\u542cWebSocket\u8fde\u63a5\u3002 \u6d4b\u8bd5\u8fde\u63a5\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\u4f7f\u7528Gremlin Console\u3002 \u4f7f\u7528bin/gremlin.sh\u542f\u52a8Gremlin\u63a7\u5236\u53f0\u5e76\u4f7f\u7528 :remote \u548c : \u5411Gremlin Server\u53d1\u9001Gremlin\u547d\u4ee4\uff1a $ bin/gremlin.sh \\,,,/ (o o) -----oOOo-(3)-oOOo----- plugin activated: tinkerpop.server plugin activated: tinkerpop.hadoop plugin activated: tinkerpop.utilities plugin activated: janusgraph.imports plugin activated: tinkerpop.tinkergraph gremlin :remote connect tinkerpop.server conf/remote.yaml == Connected - localhost/127.0.0.1:8182 gremlin : graph.addVertex(\"name\", \"stephen\") == v[256] gremlin : g.V().values('name') == stephen :remote\u547d\u4ee4\u544a\u8bc9\u63a7\u5236\u53f0\u4f7f\u7528conf/remote.yaml\u6587\u4ef6\u8fdc\u7a0b\u8fde\u63a5\u5230Gremlin Server\u3002 \u8be5\u6587\u4ef6\u6307\u5411\u5728\u672c\u5730\u8fd0\u884c\u7684Gremlin Server\u5b9e\u4f8b\u3002 : \u662f\u201csubmit\u201d\u547d\u4ee4\uff0c\u5b83\u5c06\u8be5\u884c\u7684Gremlin\u53d1\u9001\u5230\u5f53\u524d\u8fd0\u884c\u4e2d\u7684\u8fdc\u7aef\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8fdc\u7a0b\u8fde\u63a5\u662f\u65e0\u4f1a\u8bdd\u7684\uff0c\u8fd9\u610f\u5473\u7740\u5728\u63a7\u5236\u53f0\u4e2d\u53d1\u9001\u7684\u6bcf\u4e00\u884c\u90fd\u88ab\u89e3\u91ca\u4e3a\u5355\u4e2a\u8bf7\u6c42\u3002 \u53ef\u4ee5\u4f7f\u7528\u5206\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\u5728\u4e00\u884c\u4e0a\u53d1\u9001\u591a\u4e2a\u8bed\u53e5\u3002 \u6216\u8005\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u521b\u5efa\u8fde\u63a5\u65f6\u6307\u5b9a\u4f1a\u8bdd\u6765\u5efa\u7acb\u5177\u6709\u4f1a\u8bdd\u7684\u63a7\u5236\u53f0\u3002 \u63a7\u5236\u53f0\u4f1a\u8bdd\u5141\u8bb8\u60a8\u8de8\u591a\u884c\u590d\u7528\u53d8\u91cf\u8f93\u5165\u3002 gremlin :remote connect tinkerpop.server conf/remote.yaml == Configured localhost/127.0.0.1:8182 gremlin graph == standardjanusgraph[cql:[127.0.0.1]] gremlin g == graphtraversalsource[standardjanusgraph[cql:[127.0.0.1]], standard] gremlin g.V() gremlin user = \"Chris\" == Chris gremlin graph.addVertex(\"name\", user) No such property: user for class: Script21 Type ':help' or ':h' for help. Display stack trace? [yN] gremlin :remote connect tinkerpop.server conf/remote.yaml session == Configured localhost/127.0.0.1:8182-[9acf239e-a3ed-4301-b33f-55c911e04052] gremlin g.V() gremlin user = \"Chris\" == Chris gremlin user == Chris gremlin graph.addVertex(\"name\", user) == v[4344] gremlin g.V().values('name') == Chris","title":"7.1.1.1. \u8fde\u63a5\u5230Gremlin Server"},{"location":"janusgraph_basics/janusgraph_server/#72","text":"\u5982\u679c\u60a8\u60f3\u91cd\u65b0\u5f00\u59cb\u5e76\u5220\u9664\u6570\u636e\u5e93\u548c\u65e5\u5fd7\uff0c\u53ef\u4ee5\u4f7f\u7528janusgraph.sh\u7684clean\u547d\u4ee4\u3002 \u5728\u8fd0\u884cclean\u64cd\u4f5c\u4e4b\u524d\u8981\u505c\u6b62\u670d\u52a1\u5668\u3002 $ cd /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/ $ ./bin/janusgraph.sh stop Killing Gremlin-Server (pid 91505)... Killing Elasticsearch (pid 91402)... Killing Cassandra (pid 91219)... $ ./bin/janusgraph.sh clean Are you sure you want to delete all stored data and logs? [y/N] y Deleted data in /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/db Deleted logs in /Path/to/janusgraph/janusgraph-0.2.0-hadoop2/log","title":"7.2. \u9884\u5b89\u88c5\u5305\u4f7f\u7528\u540e\u6e05\u7406"},{"location":"janusgraph_basics/janusgraph_server/#73-websocket-janusgraph-server","text":"\u672c\u7ae0\u76841\u8282\u5165\u95e8\u90e8\u5206\u8bb2\u7684\u9ed8\u8ba4\u914d\u7f6e\u5c31\u662f\u4f7f\u7528\u7684WebSocket\u914d\u7f6e\u3002\u5982\u679c\u8981\u4f7f\u7528\u81ea\u5df1\u7684Cassandra\u6216HBase\u73af\u5883\uff0c\u9700\u8981\u66f4\u6539\u9ed8\u8ba4\u914d\u7f6e\u6765\u542f\u52a8\u73af\u5883\uff0c\u8bf7\u6309\u7167\u4ee5\u4e0b\u64cd\u4f5c\u6b65\u9aa4\uff1a \u9996\u5148\u6d4b\u8bd5\u672c\u5730\u8fde\u63a5\u5230JanusGraph\u6570\u636e\u5e93\u3002\u65e0\u8bba\u662f\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u8fd8\u662f\u7528\u7a0b\u5e8f\u6d4b\u8bd5\u8fde\u63a5\u90fd\u53ef\u4ee5\u3002\u5728JanusGraph\u7684./conf\u76ee\u5f55\u4e0b\u7684properties\u6587\u4ef6\u4e2d\u8fdb\u884c\u9002\u5f53\u7684\u66f4\u6539\u3002\u4f8b\u5982\uff0c\u7f16\u8f91./conf/janusgraph-hbase.properties\u5e76\u786e\u4fdd\u6b63\u786e\u6307\u5b9a\u4e86storage.backend\uff0cstorage.hostname\u548cstorage.hbase.table\u7b49\u53c2\u6570\u3002\u6709\u5173\u4e3a\u5404\u79cd\u540e\u7aef\u5b58\u50a8\u914d\u7f6eJanusGraph\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002\u786e\u4fddproperties\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u884c\uff1a gremlin.graph = org.janusgraph.core.JanusGraphFactory \u6d4b\u8bd5\u5b8c\u672c\u5730\u914d\u7f6e\u8fde\u63a5\u800c\u4e14\u4f60\u4e5f\u914d\u7f6e\u597d\u4e86properties\u6587\u4ef6\u540e\uff0c\u5c06properties\u6587\u4ef6\u4ece./conf\u76ee\u5f55\u590d\u5236\u5230./conf/gremlin-server\u76ee\u5f55\u3002 cp conf/janusgraph-hbase.properties conf/gremlin-server/socket-janusgraph-hbase-server.properties \u590d\u5236./conf/gremlin-server/gremlin-server.yaml\u6587\u4ef6\u5e76\u91cd\u65b0\u547d\u540d\u4e3asocket-gremlin-server.yaml\u3002\u5982\u679c\u60a8\u9700\u8981\u4fdd\u7559\u539f\u6765\u7684yaml\u6587\u4ef6\uff0c\u8bf7\u6267\u884c\u6b64\u64cd\u4f5c cp conf/gremlin-server/gremlin-server.yaml conf/gremlin-server/socket-gremlin-server.yaml \u7f16\u8f91socket-gremlin-server.yaml\u6587\u4ef6\u5e76\u8fdb\u884c\u4ee5\u4e0b\u66f4\u65b0\uff1a \u5982\u679c\u4f60\u8ba1\u5212\u8fde\u63a5\u5230\u5176\u4ed6\u7684JanusGraph Server\u800c\u4e0d\u662f\u672c\u5730\uff0c\u9700\u8981\u66f4\u65b0host\u7684IP\u5730\u5740\uff1a host\uff1a10.10.10.100 //\u670d\u52a1\u7684IP \u66f4\u65b0graphs\u914d\u7f6e\u6307\u5411\u4f60\u4f7f\u7528\u7684properties\u6587\u4ef6\uff0c\u4ee5\u4fbfJanusGraph Server\u53ef\u4ee5\u627e\u5230\u5e76\u8fde\u63a5\u5230\u4f60\u7684JanusGraph\u5b9e\u4f8b\uff1a graphs\uff1a{ graph\uff1aconf/gremlin-server/socket-janusgraph-hbase-server.properties } \u542f\u52a8JanusGraph\u670d\u52a1\uff0c\u5e76\u6307\u5b9a\u521a\u521a\u914d\u7f6e\u7684yaml\u6587\u4ef6\uff1a bin/gremlin-server.sh ./conf/gremlin-server/socket-gremlin-server.yaml \u6ce8\u610f\uff1a\u4e0d\u80fd\u53ea\u4f7f\u7528bin/janusgraph.sh\u3002\u8fd9\u5c06\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u542f\u52a8\uff0c\u4ece\u800c\u542f\u52a8Cassandra / Elasticsearch\u73af\u5883\u3002 JanusGraph Server\u5c06\u5728WebSocket\u6a21\u5f0f\u4e0b\u8fd0\u884c\uff0c\u53ef\u4ee5\u6309\u7167\u7b2c7\u7ae0\u76841.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin\u670d\u52a1\u201d\u4e2d\u7684\u5185\u5bb9\u8fdb\u884c\u6d4b\u8bd5\u3002","title":"7.3. \u4f7f\u7528WebSocket\u8fde\u63a5 JanusGraph Server"},{"location":"janusgraph_basics/janusgraph_server/#74-http-janusgraph-server","text":"\u7b2c7\u7ae01\u8282\u201c\u5165\u95e8\u201d\u4e2d\u63cf\u8ff0\u7684\u9ed8\u8ba4\u914d\u7f6e\u662fWebSocket\u914d\u7f6e\u3002\u5982\u679c\u8981\u66f4\u6539\u9ed8\u8ba4\u914d\u7f6e\u4ee5\u4f7f\u7528HTTP\u8fde\u63a5\u5230JanusGraph Server\uff0c\u8bf7\u6309\u7167\u4e0b\u5217\u6b65\u9aa4\u64cd\u4f5c\uff1a \u9996\u5148\u6d4b\u8bd5\u4e0eJanusGraph\u6570\u636e\u5e93\u7684\u672c\u5730\u8fde\u63a5\u3002\u65e0\u8bba\u662f\u4f7f\u7528Gremlin\u63a7\u5236\u53f0\u8fd8\u662f\u4f7f\u7528\u7a0b\u5e8f\u6d4b\u8bd5\u8fde\u63a5\u90fd\u53ef\u4ee5\u3002\u5728JanusGraph\u7684./conf\u76ee\u5f55\u4e2d\u7684properties\u6587\u4ef6\u4e2d\u8fdb\u884c\u9002\u5f53\u7684\u66f4\u6539\u3002\u4f8b\u5982\uff0c\u7f16\u8f91./conf/janusgraph-hbase.properties\u5e76\u786e\u4fdd\u6b63\u786e\u6307\u5b9a\u4e86storage.backend\uff0cstorage.hostname\u548cstorage.hbase.table\u53c2\u6570\u3002\u6709\u5173JanusGraph\u7684\u66f4\u591a\u540e\u7aef\u5b58\u50a8\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002\u786e\u4fddproperties\u6587\u4ef6\u5305\u542b\u4ee5\u4e0b\u884c\uff1a gremlin.graph = org.janusgraph.core.JanusGraphFactory \u672c\u5730\u8fde\u63a5\u6d4b\u8bd5\u5b8c\u6210\u5e76\u4e14\u4f60\u7684properties\u6587\u4ef6\u786e\u5b9a\u53ef\u7528\u540e\uff0c\u5c06properties\u6587\u4ef6\u4ece./conf\u76ee\u5f55\u590d\u5236\u5230./conf/gremlin-server\u76ee\u5f55\u4e0b\u3002 cp conf/janusgraph-hbase.properties conf/gremlin-server/http-janusgraph-hbase-server.properties \u590d\u5236./conf/gremlin-server/gremlin-server.yaml\u6587\u4ef6\u66f4\u540d\u4e3ahttp-gremlin-server.yaml\u3002\u5982\u679c\u4f60\u9700\u8981\u53c2\u8003\u6587\u4ef6\u7684\u539f\u59cb\u7248\u672c\uff0c\u8bf7\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4 cp conf/gremlin-server/gremlin-server.yaml conf/gremlin-server/http-gremlin-server.yaml \u7f16\u8f91http-gremlin-server.yaml\u6587\u4ef6\u5e76\u8fdb\u884c\u4ee5\u4e0b\u4fee\u6539\uff1a \u5982\u679c\u4f60\u6253\u7b97\u8fde\u63a5\u5230\u5176\u4ed6\u7684JanusGraph Server\u800c\u4e0d\u662f\u672c\u5730\u670d\u52a1\uff0c\u8bf7\u4fee\u6539host IP\uff1a host\uff1a10.10.10.100 \u66f4\u65b0channelizer\u8bbe\u7f6e\u6765\u6307\u5b9aHttpChannelizer\uff1a channelizer\uff1aorg.apache.tinkerpop.gremlin.server.channel.HttpChannelizer \u66f4\u65b0graphs\u90e8\u5206\u6765\u6307\u5411\u65b0\u7684properties\u6587\u4ef6\uff0c\u4ee5\u4fbfJanusGraph Server\u53ef\u4ee5\u627e\u5230\u5e76\u8fde\u63a5\u5230\u4f60\u7684JanusGraph\u5b9e\u4f8b\uff1a graphs: { graph: conf/gremlin-server/http-janusgraph-hbase-server.properties } \u542f\u52a8JanusGraph\u670d\u52a1\u5668\uff0c\u6307\u5411\u521a\u521a\u914d\u7f6e\u7684yaml\u6587\u4ef6\uff1a bin/gremlin-server.sh ./conf/gremlin-server/http-gremlin-server.yaml JanusGraph Server\u73b0\u5728\u5e94\u8be5\u4ee5HTTP\u6a21\u5f0f\u8fd0\u884c\u5e76\u53ef\u7528\u4e8e\u6d4b\u8bd5\u3002 curl\u53ef\u7528\u4e8e\u9a8c\u8bc1\u670d\u52a1\u5668\u662f\u5426\u6b63\u5e38\u5de5\u4f5c\uff1a curl -XPOST -Hcontent-type:application/json -d '{\"gremlin\":\"g.V().count()\"}' http://[IP for JanusGraph server host]:8182","title":"7.4. \u4f7f\u7528HTTP\u8fde\u63a5 JanusGraph Server"},{"location":"janusgraph_basics/janusgraph_server/#75-websockethttpjanusgraph-server","text":"\u4eceJanusGraph 0.2.0\u5f00\u59cb\uff0c\u4f60\u53ef\u4ee5\u914d\u7f6egremlin-server.yaml\u4ee5\u901a\u8fc7\u540c\u4e00\u7aef\u53e3\u63a5\u53d7WebSocket\u548cHTTP\u8fde\u63a5\u3002 \u8fd9\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5982\u4e0b\u914d\u7f6e\u3002 channelizer\uff1aorg.apache.tinkerpop.gremlin.server.channel.WsAndHttpChannelizer","title":"7.5. \u540c\u65f6\u4f7f\u7528WebSocket\u548cHTTP\u8fde\u63a5JanusGraph Server"},{"location":"janusgraph_basics/janusgraph_server/#76-janusgraph-server","text":"","title":"7.6. JanusGraph Server\u9ad8\u7ea7\u914d\u7f6e"},{"location":"janusgraph_basics/janusgraph_server/#761-http","text":"\u6ce8\u610f\uff1a\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002","title":"7.6.1. HTTP\u8eab\u4efd\u9a8c\u8bc1"},{"location":"janusgraph_basics/janusgraph_server/#7611-http","text":"\u8981\u5728JanusGraph Server\u4e2d\u542f\u7528\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bf7\u5728gremlin-server.yaml\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e\u3002 authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.JanusGraphSimpleAuthenticator, authenticationHandler: org.apache.tinkerpop.gremlin.server.handler.HttpBasicAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, credentialsDb: conf/janusgraph-credentials-server.properties } } \u9a8c\u8bc1\u662f\u5426\u6b63\u786e\u914d\u7f6e\u4e86\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u3002 \u4f8b\u5982 curl -v -XPOST http://localhost:8182 -d '{\"gremlin\": \"g.V().count()\"}' \u5982\u679c\u8eab\u4efd\u9a8c\u8bc1\u914d\u7f6e\u6b63\u786e\uff0c\u5219\u5e94\u8fd4\u56de401 curl -v -XPOST http://localhost:8182 -d '{\"gremlin\": \"g.V().count()\"}' -u user:password \u5982\u679c\u9a8c\u8bc1\u914d\u7f6e\u6b63\u786e\uff0c\u5219\u5e94\u8fd4\u56de200\uff0c\u7ed3\u679c\u4e3a4\u3002","title":"7.6.1.1. HTTP\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1"},{"location":"janusgraph_basics/janusgraph_server/#762-websocket","text":"WebSocket\u8eab\u4efd\u9a8c\u8bc1\u901a\u8fc7\u7b80\u5355\u8eab\u4efd\u9a8c\u8bc1\u548c\u5b89\u5168\u5c42\uff08SASL\uff09\u673a\u5236\u8fdb\u884c\u3002 \u8981\u542f\u7528SASL\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8bf7\u5728gremlin-server.yaml\u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.JanusGraphSimpleAuthenticator, authenticationHandler: org.apache.tinkerpop.gremlin.server.handler.SaslAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, credentialsDb: conf/janusgraph-credentials-server.properties } } \u6ce8\u610f\uff1a\u5728\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002 \u5982\u679c\u4f60\u901a\u8fc7gremlin\u63a7\u5236\u53f0\u8fdb\u884c\u8fde\u63a5\uff0c\u5219\u4f60\u7684remote yaml\u6587\u4ef6\u5e94\u4f7f\u7528\u9002\u5f53\u7684\u503c\u6765\u914d\u7f6e\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002 username: user password: password","title":"7.6.2. WebSocket\u8eab\u4efd\u9a8c\u8bc1"},{"location":"janusgraph_basics/janusgraph_server/#763-httpwebsocket","text":"\u5982\u679c\u4f60\u6b63\u5728\u4f7f\u7528HTTP\u548cWebSocket\u7ec4\u5408\u7684\u65b9\u5f0f\u8fde\u63a5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528SaslAndHMACAuthenticator\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5305\u542bWebSocket\u7684SASL\uff0cHTTP\u7684\u57fa\u672c\u8ba4\u8bc1\uff0c\u548cHTTP\u57fa\u4e8e\u54c8\u5e0c\u7684\u6d88\u606f\u8eab\u4efd\u9a8c\u8bc1\u7801\uff08HMAC\uff09\u3002 HMAC\u662f\u57fa\u4e8etoken\u7684\u8eab\u4efd\u9a8c\u8bc1\uff0c\u901a\u8fc7HTTP\u4f7f\u7528\u3002 \u60a8\u9996\u5148\u901a\u8fc7/ session\u7aef\u70b9\u83b7\u53d6token\uff0c\u7136\u540e\u4f7f\u7528\u5b83\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u5b83\u7528\u4e8e\u8282\u7ea6\u4f7f\u7528\u57fa\u672c\u8eab\u4efd\u9a8c\u8bc1\u52a0\u5bc6\u5bc6\u7801\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u3002 gremlin-server.yaml\u5e94\u6dfb\u52a0\u4ee5\u4e0b\u914d\u7f6e authentication: { authenticator: org.janusgraph.graphdb.tinkerpop.gremlin.server.auth.SaslAndHMACAuthenticator, authenticationHandler: org.janusgraph.graphdb.tinkerpop.gremlin.server.handler.SaslAndHMACAuthenticationHandler, config: { defaultUsername: user, defaultPassword: password, hmacSecret: secret, credentialsDb: conf/janusgraph-credentials-server.properties } } \u6ce8\u610f\uff1a\u5728\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0ccredentialsDb\u5e94\u4e0e\u4f60\u6b63\u5728\u4f7f\u7528\u7684graph\u662f\u4e0d\u540c\u7684\u3002 \u5b83\u5e94\u8be5\u4f7f\u7528\u5408\u9002\u7684\u540e\u7aef\u5b58\u50a8\u6765\u914d\u7f6e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u540e\u7aef\u5b58\u50a8\u4f7f\u7528\u4e0d\u540c\u5bc6\u94a5\u7a7a\u95f4\uff0c\u8868\u6216\u5b58\u50a8\u76ee\u5f55\u662f\u5408\u9002\u7684\u3002 \u6b64graph\u5c06\u901a\u8fc7\u7528\u6237\u540d\u548c\u5bc6\u7801\u6765\u4f7f\u7528\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u60a8\u5e0c\u671b\u80fd\u591f\u5728\u6bcf\u53f0\u670d\u52a1\u5668\u4e0a\u4f7f\u7528\u76f8\u540c\u7684HMAC\u4ee4\u724c\uff0c\u5219\u5728\u6240\u6709\u6b63\u5728\u8fd0\u884c\u7684JanusGraph\u670d\u52a1\u5668\u4e0a\u5e94\u8be5\u662f\u76f8\u540c\u7684\u3002 \u5bf9\u4e8eHTTP\u7684HMAC\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8fd9\u5c06\u521b\u5efa\u4e00\u4e2a/session\u7aef\u70b9\uff0c\u8be5\u7aef\u70b9\u63d0\u4f9b\u4e00\u4e2atoken\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5728\u4e00\u5c0f\u65f6\u540e\u8fc7\u671f\u3002 token\u7684\u8d85\u65f6\u65f6\u95f4\u53ef\u4ee5\u5728authentication.config\u4e2d\u7684tokenTimeout\u6765\u914d\u7f6e\u3002 \u6b64\u503c\u4e3aLong\u503c\uff0c\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\u3002 \u4f60\u53ef\u4ee5\u4f7f\u7528curl\u5411/ session\u7aef\u70b9\u53d1\u51faget\u8bf7\u6c42\u6765\u83b7\u53d6\u4ee4\u724c\u3002 \u4f8b\u5982 curl http://localhost:8182/session -XGET -u user:password {\"token\": \"dXNlcjoxNTA5NTQ2NjI0NDUzOkhrclhYaGhRVG9KTnVSRXJ5U2VpdndhalJRcVBtWEpSMzh5WldqRTM4MW89\"} \u7136\u540e\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u201dAuthorization: Token\u201d\u7684header\u7528\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u3002 \u4f8b\u5982 curl -v http://localhost:8182/session -XPOST -d '{\"gremlin\": \"g.V().count()\"}' -H \"Authorization: Token dXNlcjoxNTA5NTQ2NjI0NDUzOkhrclhYaGhRVG9KTnVSRXJ5U2VpdndhalJRcVBtWEpSMzh5WldqRTM4MW89\"","title":"7.6.3. HTTP\u548cWebSocket\u8eab\u4efd\u9a8c\u8bc1"},{"location":"janusgraph_basics/janusgraph_server/#764-janusgraphtinkerpop-gremlin-server","text":"\u7531\u4e8eJanusGraph Server\u662f\u4e00\u4e2a\u5305\u542bJanusGraph\u914d\u7f6e\u6587\u4ef6\u7684TinkerPop Gremlin Server\uff0c\u56e0\u6b64\u53ef\u4ee5\u5355\u72ec\u4e0b\u8f7d\u517c\u5bb9\u7248\u672c\u7684TinkerPop Gremlin Server\u5e76\u4e0eJanusGraph\u4e00\u8d77\u4f7f\u7528\u3002 \u9996\u5148\u4e0b\u8f7d\u9002\u5f53\u7684Gremlin Server\u7248\u672c\uff0c\u5b83\u9700\u8981\u4e0e\u6b63\u5728\u4f7f\u7528\u7684JanusGraph\u7248\u672c(3.3.3)\u76f8\u5339\u914d\u3002 \u6ce8\u610f\uff1a\u9664\u975e\u7279\u522b\u8bf4\u660e\uff0c\u5426\u5219\u672c\u8282\u4e2d\u5bf9\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u5f15\u7528\u90fd\u662f\u6307Gremlin Server\u7684TinkerPop\u53d1\u884c\u7248\u4e0b\u7684\u8def\u5f84\uff0c\u800c\u4e0d\u662f\u5e26\u6709JanusGraph Server\u7684JanusGraph\u53d1\u884c\u7248\u3002 \u7528JanusGraph\u914d\u7f6e\u72ec\u7acb\u7684Gremlin Server\u8ddf\u4f7f\u7528\u6253\u5305\u7684JanusGraph Server\u662f\u7c7b\u4f3c\u7684\u3002 \u60a8\u5e94\u8be5\u719f\u6089graph\u914d\u7f6e\u3002 \u57fa\u672c\u4e0a\uff0cGremlin Server yaml\u6587\u4ef6\u6307\u5411\u7279\u5b9a\u7684\u56fe\u914d\u7f6e\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u7528\u4e8e\u5b9e\u4f8b\u5316\u5b83\u968f\u540e\u5c06\u4f7f\u7528\u7684JanusGraph\u5b9e\u4f8b\u3002 \u4e3a\u4e86\u5b9e\u4f8b\u5316\u8fd9\u4e9bGraph\u5b9e\u4f8b\uff0cGremlin Server\u8981\u6c42\u5728\u5176classpath\u4e0a\u63d0\u4f9bJanusGraph\u7684\u76f8\u5e94\u5e93\u548c\u4f9d\u8d56\u9879\u3002 \u4e3a\u4e86\u6f14\u793a\uff0c\u8fd9\u4e9b\u8bf4\u660e\u5c06\u5c55\u793a\u5982\u4f55\u5728Gremlin Server\u4e2d\u4e3aJanusGraph\u914d\u7f6eBerkeleyDB\u540e\u7aef\u3002 \u5982\u524d\u6240\u8ff0\uff0cGremlin Server\u9700\u8981JanusGraph\u5bf9\u5176\u7c7b\u8def\u5f84\u7684\u4f9d\u8d56\u3002 \u4f7f\u7528\u6b63\u5728\u4f7f\u7528\u7684JanusGraph\u7248\u672c\u53f7\u66ff\u6362\u4ee5\u4e0b\u547d\u4ee4\u4e2d\u7684$VERSION\uff1a bin/gremlin-server.sh -i org.janusgraph janusgraph-all $VERSION \u5f53\u6b64\u8fc7\u7a0b\u5b8c\u6210\u540e\uff0cGremlin Server\u5e94\u8be5\u5177\u6709\u6240\u6709\u53ef\u7528\u7684JanusGraph\u4f9d\u8d56\u9879\uff0c\u56e0\u6b64\u80fd\u591f\u5b9e\u4f8b\u5316JanusGraph\u5bf9\u8c61\u3002 \u6ce8\u610f\uff1a\u4e0a\u9762\u7684\u547d\u4ee4\u4f7f\u7528Groovy Grape\uff0c\u5982\u679c\u914d\u7f6e\u4e0d\u6b63\u786e\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e0b\u8f7d\u9519\u8bef\u3002 \u6709\u5173\u8bbe\u7f6e\u301c/ .groovy / grapeConfig.xml\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605TinkerPop\u6587\u6863\u7684\u8fd9\u4e00\u90e8\u5206\u3002 \u4f7f\u7528\u4ee5\u4e0b\u5185\u5bb9\u521b\u5efa\u540d\u4e3aGREMLIN_SERVER_HOME/conf/janusgraph.properties\u7684\u6587\u4ef6\uff1a gremlin.graph=org.janusgraph.core.JanusGraphFactory storage.backend=berkeleyje storage.directory=db/berkeley \u5176\u4ed6\u7684\u540e\u7aef\u914d\u7f6e\u4e5f\u662f\u7c7b\u4f3c\u3002 \u8bf7\u53c2\u89c1\u7b2cIII\u90e8\u5206\u201c\u540e\u7aef\u5b58\u50a8\u201d\u3002 \u5982\u679c\u4f7f\u7528Cassandra\uff0c\u5219\u5728janusgraph.properties\u6587\u4ef6\u4e2d\u4f7f\u7528Cassandra\u914d\u7f6e\u9009\u9879\u3002 \u552f\u4e00\u4fdd\u6301\u4e0d\u53d8\u7684\u91cd\u8981\u90e8\u5206\u662fgremlin.graph\u8bbe\u7f6e\uff0c\u5b83\u5e94\u8be5\u59cb\u7ec8\u4f7f\u7528JanusGraphFactory\u3002 \u6b64\u8bbe\u7f6e\u544a\u8bc9Gremlin Server\u5982\u4f55\u5b9e\u4f8b\u5316JanusGraph\u5b9e\u4f8b\u3002 \u63a5\u4e0b\u6765\u521b\u5efa\u4e00\u4e2a\u540d\u4e3aGREMLIN_SERVER_HOME/conf/gremlin-server-janusgraph.yaml\u7684\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a host: localhost port: 8182 graphs: { graph: conf/janusgraph.properties} scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} serializers: - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }} - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { serializeResultToString: true }} - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerV3d0, config: { ioRegistries: [org.janusgraph.graphdb.tinkerpop.JanusGraphIoRegistry] }} metrics: { slf4jReporter: {enabled: true, interval: 180000}} \u8fd9\u4e2a\u914d\u7f6e\u6587\u4ef6\u6709\u51e0\u4e2a\u91cd\u8981\u7684\u90e8\u5206\uff0c\u56e0\u4e3a\u5b83\u4eec\u4e0eJanusGraph\u6709\u5173: \u5728\u56fe\u4e2d\uff0c\u6709\u4e00\u4e2a\u540d\u4e3agraph\u7684\u952e\uff0c\u5176\u503c\u4e3aconf/janusgraph.properties\u3002 \u8fd9\u544a\u8bc9Gremlin Server\u5b9e\u4f8b\u5316\u4e00\u4e2a\u540d\u4e3a\u201cgraph\u201d\u7684Graph\u5b9e\u4f8b\uff0c\u5e76\u4f7f\u7528conf/janusgraph.properties\u6587\u4ef6\u5bf9\u5176\u8fdb\u884c\u914d\u7f6e\u3002 \u201cgraph\u201d\u952e\u6210\u4e3aGremlin Server\u4e2dGraph\u5b9e\u4f8b\u7684\u552f\u4e00\u540d\u79f0\uff0c\u53ef\u4ee5\u5728\u63d0\u4ea4\u7ed9\u5b83\u7684\u811a\u672c\u4e2d\u5f15\u7528\u5b83\u3002 \u5728\u63d2\u4ef6\u5217\u8868\u4e2d\uff0c\u6709\u4e00\u4e2a\u5bf9JanusGraphGremlinPlugin\u7684\u5f15\u7528\uff0c\u5b83\u544a\u8bc9Gremlin Server\u521d\u59cb\u5316\u201cJanusGraph\u63d2\u4ef6\u201d\u3002 \u201cJanusGraph\u63d2\u4ef6\u201d\u5c06\u81ea\u52a8\u5bfc\u5165JanusGraph\u7279\u5b9a\u7c7b\uff0c\u4ee5\u4fbf\u5728\u811a\u672c\u4e2d\u4f7f\u7528\u3002 \u8bf7\u6ce8\u610f\u811a\u672c\u952e\u548c\u811a\u672c/janusgraph.groovy\u7684\u5f15\u7528\u3002 \u8fd9\u4e2aGroovy\u6587\u4ef6\u662fGremlin Server\u548c\u7279\u5b9aScriptEngine\u7684\u521d\u59cb\u5316\u811a\u672c\u3002 \u4f7f\u7528\u4ee5\u4e0b\u5185\u5bb9\u521b\u5efascripts/janusgraph.groovy\uff1a def globals = [:] globals [g : graph.traversal()] \u4e0a\u9762\u7684\u811a\u672c\u521b\u5efa\u4e86\u4e00\u4e2a\u540d\u4e3aglobals\u7684Map\uff0c\u5e76\u4e3a\u5176\u5206\u914d\u4e00\u4e2a\u952e/\u503c\u5bf9\u3002 \u952e\u662fg\uff0c\u5b83\u7684\u503c\u662f\u4ece\u56fe\u751f\u6210\u7684TraversalSource\uff0c\u5b83\u662f\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4e3aGremlin Server\u914d\u7f6e\u7684\u3002 \u6b64\u65f6\uff0c\u73b0\u5728\u4e3aGremlin Server\u63d0\u4f9b\u7684\u811a\u672c\u53ef\u4ee5\u4f7f\u7528\u4e24\u4e2a\u5168\u5c40\u53d8\u91cf - graph\u548cg\u3002 \u6b64\u65f6\uff0cGremlin Server\u5df2\u914d\u7f6e\uff0c\u53ef\u7528\u4e8e\u8fde\u63a5\u5230\u65b0\u7684\u6216\u73b0\u6709\u7684JanusGraph\u6570\u636e\u5e93\u3002\u542f\u52a8server\uff1a $ bin/gremlin-server.sh conf/gremlin-server-janusgraph.yaml [INFO] GremlinServer - \\,,,/ (o o) -----oOOo-(3)-oOOo----- [INFO] GremlinServer - Configuring Gremlin Server from conf/gremlin-server-janusgraph.yaml [INFO] MetricManager - Configured Metrics Slf4jReporter configured with interval=180000ms and loggerName=org.apache.tinkerpop.gremlin.server.Settings$Slf4jReporterMetrics [INFO] GraphDatabaseConfiguration - Set default timestamp provider MICRO [INFO] GraphDatabaseConfiguration - Generated unique-instance-id=7f0000016240-ubuntu1 [INFO] Backend - Initiated backend operations thread pool of size 8 [INFO] KCVSLog$MessagePuller - Loaded unidentified ReadMarker start time 2015-10-02T12:28:24.411Z into org.janusgraph.diskstorage.log.kcvs.KCVSLog$MessagePuller@35399441 [INFO] GraphManager - Graph [graph] was successfully configured via [conf/janusgraph.properties]. [INFO] ServerGremlinExecutor - Initialized Gremlin thread pool. Threads in pool named with pattern gremlin-* [INFO] ScriptEngines - Loaded gremlin-groovy ScriptEngine [INFO] GremlinExecutor - Initialized gremlin-groovy ScriptEngine with scripts/janusgraph.groovy [INFO] ServerGremlinExecutor - Initialized GremlinExecutor and configured ScriptEngines. [INFO] ServerGremlinExecutor - A GraphTraversalSource is now bound to [g] with graphtraversalsource[standardjanusgraph[berkeleyje:db/berkeley], standard] INFO] AbstractChannelizer - Configured application/vnd.gremlin-v3.0+gryo with org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0 [INFO] AbstractChannelizer - Configured application/vnd.gremlin-v3.0+gryo-stringd with org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0 [INFO] GremlinServer$1 - Gremlin Server configured with worker thread pool of 1, gremlin pool of 8 and boss thread pool of 1. [INFO] GremlinServer$1 - Channel started at port 8182. \u4ee5\u4e0b\u90e8\u5206\u8bf4\u660e\u5982\u4f55\u8fde\u63a5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u670d\u52a1\u5668\u3002","title":"7.6.4. JanusGraph\u4f7f\u7528TinkerPop Gremlin Server"},{"location":"janusgraph_basics/janusgraph_server/#7641-gremlin-serverjanusgraph","text":"Gremlin Server\u5c06\u5728\u542f\u52a8\u65f6\u51c6\u5907\u597d\u76d1\u542cWebSocket\u8fde\u63a5\u3002 \u6d4b\u8bd5\u8fde\u63a5\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4f7f\u7528Gremlin Console\u3002 \u6309\u7167\u7b2c7.1.1.1\u8282\u201c\u8fde\u63a5\u5230Gremlin\u670d\u52a1\u5668\u201d\u4e2d\u7684\u8bf4\u660e\u9a8c\u8bc1Gremlin\u670d\u52a1\u5668\u662f\u5426\u6b63\u5e38\u5de5\u4f5c \u6ce8\u610f\uff1a\u60a8\u5e94\u8be5\u4e86\u89e3\u7684\u4e00\u70b9\u662f\uff0c\u5728\u4f7f\u7528JanusGraph Server\u65f6\uff0cGremlin\u63a7\u5236\u53f0\u662f\u4eceJanusGraph\u53d1\u884c\u7248\u4e0b\u9762\u542f\u52a8\u7684\uff0c\u5f53\u4f7f\u7528\u5355\u72ec\u7684Gremlin Server\u7684\u6d4b\u8bd5\u65f6\uff0cGremlin\u63a7\u5236\u53f0\u662f\u4eceTinkerPop\u53d1\u884c\u7248\u4e0b\u542f\u52a8\u7684\u3002 GryoMapper mapper = GryoMapper.build().addRegistry(JanusGraphIoRegistry.INSTANCE).create(); Cluster cluster = Cluster.build().serializer(new GryoMessageSerializerV3d0(mapper)).create(); Client client = cluster.connect(); client.submit(\"g.V()\").all().get(); \u901a\u8fc7\u5c06JanusGraphIoRegistry\u6dfb\u52a0\u5230org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0\uff0c\u9a71\u52a8\u7a0b\u5e8f\u5c06\u77e5\u9053\u5982\u4f55\u6b63\u786e\u53cd\u5e8f\u5217\u5316JanusGraph\u8fd4\u56de\u7684\u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u3002","title":"7.6.4.1. \u901a\u8fc7Gremlin Server\u8fde\u63a5\u5230JanusGraph"},{"location":"janusgraph_basics/janusgraph_server/#77-janusgraph-server","text":"\u901a\u8fc7\u5b9e\u73b0Gremlin Server\u63d0\u4f9b\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u6269\u5c55Gremlin Server\u66f4\u591a\u7684\u4ea4\u4e92\u65b9\u5f0f\uff0c\u5e76\u5c06\u5176\u4e0eJanusGraph\u7ed3\u5408\u4f7f\u7528\u3002 \u8bf7\u53c2\u9605\u76f8\u5e94\u7684TinkerPop\u6587\u6863\u83b7\u53d6\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002","title":"7.7. JanusGraph Server\u6269\u5c55"},{"location":"janusgraph_basics/schema_and_data_modeling/","text":"\u6bcf\u4e2aJanusGraph\u90fd\u6709\u4e00\u4e2aschema\uff0c\u8be5schema\u7531edge labels\uff0cproperty keys,\u548cvertex\u7ec4\u6210.JanusGraph schema\u53ef\u4ee5\u663e\u793a\uff08\u660e\u786e\uff09\u5b9a\u4e49\uff0c\u4e5f\u53ef\u4ee5\u9690\u5f0f\u5b9a\u4e49\uff0c\u9f13\u52b1\u7528\u6237\u5728\u5f00\u53d1\u5e94\u7528\u7a0b\u5f0f\u65f6\u663e\u793a\u5b9a\u4e49schema\u3002 \u660e\u786e\u5b9a\u4e49\u7684schema\u662f\u4e00\u4e2a\u5065\u58ee\u7684\u56fe\u5e94\u7528\u7a0b\u5e8f\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0c\u5e76\u4e14\u6781\u5927\u7684\u6539\u5584\u8f6f\u4ef6\u7684\u534f\u540c\u5f00\u53d1\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0cJanusGraph schema\u4f1a\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u4e0d\u65ad\u6539\u53d8\uff0c\u5e76\u4e14\u4e0d\u4f1a\u4e2d\u65ad\u6b63\u5e38\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002\u6269\u5c55schema\u5e76\u4e0d\u4f1a\u62d6\u6162\u67e5\u8be2\u7684\u901f\u5ea6\uff0c\u4e5f\u4e0d\u9700\u8981\u6570\u636e\u5e93\u505c\u673a\u3002 5.1 Defining Edge Labels(\u5b9a\u4e49\u8fb9\u6807\u7b7e) \u94fe\u63a5\u4e24\u4e2a\u5b9a\u70b9\u7684\u8fb9\u90fd\u6709\u4e00\u4e2a\u5b9a\u4e49\u5173\u7cfb\u7684\u6807\u7b7e\u3002\u4f8b\u5982\uff0c\u9876\u70b9A\u548c\u9876\u70b9B\u4e4b\u95f4\u7684\u8fb9\u6807\u7b7efriend\u6807\u5fd7\u7740\u4e24\u4eba\u4e4b\u95f4\u7684\u53cb\u8c0a\u5173\u7cfb\u3002 \u8981\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u8bf7\u5728\u6253\u5f00\u7684\u56fe\u5f62\u6216\u7ba1\u7406\u4e8b\u52a1\u4e0a\u8c03\u7528MakeEdgeLabel ( String )\uff0c\u5e76\u63d0\u4f9b\u8fb9\u6807\u7b7e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u8fb9\u6807\u7b7e\u540d\u79f0\u5728\u56fe\u4e2d\u5fc5\u987b\u552f\u4e00\u3002\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5141\u8bb8\u5b9a\u4e49\u8fb9\u6807\u7b7e\u591a\u6837\u6027\u7684builder\u3002\u8fb9\u6807\u7b7e\u7684\u591a\u6837\u6027\u5b9a\u4e49\u4e86\u5177\u6709\u8be5\u6807\u7b7e\u7684\u8fb9\u7684\u591a\u6837\u6027\u7ea6\u675f\uff0c\u65e2\u4e00\u5bf9\u9876\u70b9\u95f4\u7684\u6700\u5927\u8fb9\u4e2a\u6570\u3002JanusGraph\u652f\u6301\u5982\u4e0b\u7684\u591a\u6837\u6027\u3002 5.1.1 Edge Lable Multiplicity\uff08\u8fb9\u6807\u7b7e\u7684\u591a\u6837\u6027\uff09 Multiplicity Settings\uff08\u591a\u6837\u6027\u8bbe\u7f6e\uff09 MULTI\uff1a\u4efb\u610f\u4e00\u5bf9\u7684\u9876\u70b9\u95f4\u5141\u8bb8\u591a\u4e2a\u6807\u7b7e\u76f8\u540c\u7684\u8fb9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u56fe\u662f\u5173\u4e8e\u8fd9\u79cd\u8fb9\u7f18\u6807\u7b7e\u7684\u591a\u56fe\u3002\u8fb9\u7684\u591a\u6837\u6027\u6ca1\u6709\u7ea6\u675f\u3002 SIMPLE\uff1a\u4efb\u610f\u4e00\u5bf9\u9876\u70b9\u4e4b\u95f4\u53ea\u5141\u8bb8\u4e00\u6761\u6b64\u7c7b\u6807\u7b7e\u7684\u8fb9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u56fe\u662f\u5173\u4e8e\u6807\u7b7e\u7684\u7b80\u5355\u56fe\u3002\u786e\u4fdd\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u6807\u7b7e\u548c\u4e00\u5bf9\u9876\u70b9\u8fb9\u662f\u552f\u4e00\u7684\u3002 MANY2ONE:\u5728\u56fe\u5f62\u4e2d\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u51fa\u8fb9\uff0c\u4f46\u4e0d\u9650\u5236\u8f93\u5165\u8fb9\u4e2a\u6570\u3002\u8fb9\u7f18\u6807\u7b7emother\u662fMANY2ONE\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u6bcd\u4eb2\uff0c\u4f46\u6bcd\u4eb2\u53ef\u4ee5\u6709\u591a\u4e2a\u5b69\u5b50\u3002 ONE2MANY\uff1a\u5728\u56fe\u5f62\u4e2d\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u5165\u8fb9\uff0c\u4f46\u4e0d\u9650\u5236\u8f93\u51fa\u8fb9\u3002\u8fb9\u6807\u7b7ewinnerOf\u662fONE2MANY\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6bd4\u8d5b\u6700\u591a\u53ea\u8d62\u4e00\u4e2a\u4eba\uff0c\u4f46\u4e00\u4e2a\u4eba\u53ef\u4ee5\u8d62\u5f97\u591a\u4e2a\u6bd4\u8d5b\u3002 ONE2ONE\uff1a\u5728\u56fe\u8868\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u5165\u8fb9\u548c\u4e00\u4e2a\u8f93\u51fa\u8fb9\u3002\u8fb9\u6807\u7b7emarried\u662fONE2ONE\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u4e00\u4e2a\u4eba\u4e0e\u53e6\u4e00\u4e2a\u4eba\u7ed3\u5a5a\u3002 \u9ed8\u8ba4\u7684\u591a\u6837\u6027\u662fMULTI\u3002\u901a\u8fc7\u8c03\u7528make()\u6784\u5efa\u5668\u4e0a\u7684\u65b9\u6cd5\u6765\u5b8c\u6210\u8fb9\u6807\u7b7e\u7684\u5b9a\u4e49\uff0c\u8be5\u6784\u5efa\u5668\u8fd4\u56de\u5b9a\u4e49\u7684\u8fb9\u6807\u7b7e\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\u3002 mgmt = graph.openManagement() follow = mgmt.makeEdgeLabel('follow').multiplicity(MULTI).make() mother = mgmt.makeEdgeLabel('mother').multiplicity(MANY2ONE).make() mgmt.commit() 5.2 Defining Property Keys (\u5b9a\u4e49\u5c5e\u6027\u952e) \u9876\u70b9\u548c\u8fb9\u7684\u5c5e\u6027\u662f\u952e\u503c\u5bf9.\u4f8b\u5982\uff0c\u5c5e\u6027name='Daniel'\u5177\u6709\u952ename\u548c\u503c'Daniel'\u3002 \u5c5e\u6027\u952e\u662fJanusGraph\u67b6\u6784\u7684\u4e00\u90e8\u5206\uff0c\u53ef\u4ee5\u7ea6\u675f\u5141\u8bb8\u7684\u6570\u636e\u7c7b\u578b\u548c\u503c\u7684Cardinality\uff08\u57fa\u6570\uff09\u3002 \u8981\u5b9a\u4e49\u5c5e\u6027\u952e\uff0c\u8bf7\u8c03\u7528makePropertyKey(String)\u6253\u5f00\u7684\u56fe\u6216\u7ba1\u7406\u4e8b\u52a1\u5668\uff08management transaction\uff09\uff0c\u5e76\u63d0\u4f9b\u5c5e\u6027\u952e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u5c5e\u6027\u952e\u540d\u79f0\u5728\u56fe\u5f62\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\uff0c\u5efa\u8bae\u907f\u514d\u4f7f\u7528\u5c5e\u6027\u540d\u79f0\u4e2d\u7684\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\u3002\u6b64\u65b9\u6cd5\u8fd4\u56de\u5c5e\u6027\u952e\u7684\u6784\u5efa\u5668\u3002 5.2.1 Property Key Data Type\uff08\u5c5e\u6027\u952e\u6570\u636e\u7c7b\u578b\uff09 \u4f7f\u7528dataType(Class)\u6765\u5b9a\u4e49\u5c5e\u6027\u952e\u7684\u6570\u636e\u7c7b\u578b\u3002JanusGraph\u5c06\u5f3a\u5236\u6267\u884c\u4e0e\u5173\u8054\u952e\u7684\u6240\u6709\u503c\uff0c\u786e\u4eba\u90fd\u5177\u6709\u5df2\u914d\u7f6e\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4ece\u800c\u786e\u4fdd\u6dfb\u52a0\u5230\u56fe\u4e2d\u7684\u6570\u636e\u6709\u6548\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e3aname\u952e\u5177\u6709String\u6570\u636e\u7c7b\u578b\u3002 \u5b9a\u4e49\u6570\u636e\u7c7b\u578bObject.class\uff0c\u4ee5\u4fbf\u5141\u8bb8\u4efb\u4f55\uff08\u53ef\u5e8f\u5217\u5316\uff09\u503c\u4e0e\u952e\u5173\u8054\u3002\u4f46\u662f\uff0c\u9f13\u52b1\u5c3d\u53ef\u80fd\u4f7f\u7528\u5177\u4f53\u7684\u6570\u636e\u7c7b\u578b\u3002\u914d\u7f6e\u7684\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u662f\u5b9e\u4f53\u7c7b\uff0c\u800c\u4e0d\u662f\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\u3002JanusGraph\u5f3a\u5236\u5b9e\u73b0\u7c7b\u76f8\u7b49\uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8\u6dfb\u52a0\u5df2\u914d\u7f6e\u6570\u636e\u7c7b\u578b\u7684\u5b50\u7c7b\u3002 JanusGraph\u652f\u6301\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b\u3002 \u88685.1 \u539f\u751fJanusGraph\u6570\u636e\u7c7b\u578b \u540d\u79f0 \u63cf\u8ff0 String \u5b57\u7b26\u4e32 Character \u5355\u4e2a\u5b57\u7b26 Boolean true\u6216false Byte byte\u503c Short short\u503c Integer integer\u503c Long long\u503c Float 4\u5b57\u8282\u6d6e\u70b9\u6570 Double 8\u5b57\u8282\u6d6e\u70b9\u6570 Date \u65f6\u95f4(java.util.Date) Geoshape \u5730\u7406\u5f62\u72b6\uff0c\u5982\u70b9\uff0c\u5706\u6216\u6846 UUID \u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26\uff08java.util.UUID\uff09 5.2.2 Property Key Cardinality\uff08\u5c5e\u6027\u952e\u7684\u57fa\u6570\uff09 \u4f7f\u7528cardinality(Cardinality)\u5b9a\u4e49\u4e0e\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u9876\u70b9\u7684\u952e\u5173\u8054\u7684\u503c\u5141\u8bb8\u7684\u57fa\u6570\u3002 \u57fa\u6570\u7684\u8bbe\u7f6e SINGLE:\u5bf9\u4e8e\u6b64\u952e\uff0c\u6bcf\u4e2a\u5143\u7d20\u6700\u591a\u5141\u8bb8\u4e00\u4e2a\u503c\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u2192\u503c\u6620\u5c04\u5bf9\u4e8e\u56fe\u4e2d\u7684\u6240\u6709\u5143\u7d20\u90fd\u662f\u552f\u4e00\u7684\u3002\u5c5e\u6027\u952ebirthDate\u662fSINGLE\u57fa\u6570\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u53ea\u6709\u4e00\u4e2a\u51fa\u751f\u65e5\u671f\u3002 LIST:\u5141\u8bb8\u6bcf\u4e2a\u5143\u7d20\u7684\u4efb\u610f\u6570\u91cf\u7684\u503c\u7528\u4e8e\u6b64\u7c7b\u952e\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u4e0e\u5141\u8bb8\u91cd\u590d\u503c\u7684\u503c\u5217\u8868\u76f8\u5173\u8054\u3002\u5047\u8bbe\u6211\u4eec\u5c06\u4f20\u611f\u5668\u5efa\u6a21\u4e3a\u56fe\u5f62\u4e2d\u7684\u9876\u70b9\uff0c\u5219\u5c5e\u6027\u952esensorReading\u662f\u5177\u6709LIST\u57fa\u6570\u7684\u793a\u4f8b\uff0c\u4ee5\u5141\u8bb8\u8bb0\u5f55\u5927\u91cf\uff08\u53ef\u80fd\u91cd\u590d\u7684\uff09\u4f20\u611f\u5668\u8bfb\u6570\u3002 SET:\u5141\u8bb8\u591a\u4e2a\u4f46\u4e0d\u91cd\u590d\u7684\u503c\u7528\u4e8e\u6b64\u7c7b\u952e\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u4e0e\u4e00\u7ec4\u4e0d\u91cd\u590d\u7684\u503c\u76f8\u5173\u8054\u3002name\u5982\u679c\u6211\u4eec\u60f3\u8981\u6355\u83b7\u4e2a\u4eba\u7684\u6240\u6709\u59d3\u540d\uff08\u5305\u62ec\u6635\u79f0\uff0c\u5a5a\u524d\u59d3\u540d\u7b49\uff09\uff0c\u5219\u5c5e\u6027\u952e\u5177\u6709SET\u57fa\u6570\u3002 \u9ed8\u8ba4\u7684\u57fa\u6570\u662fSINGLE\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fb9\u548c\u5c5e\u6027\u4f7f\u7528SINGLE\u4f5c\u4e3a\u57fa\u6570\uff0c\u662f\u4e0d\u652f\u6301\u4e3a\u4e3a\u8fb9\u6216\u5c5e\u6027\u9644\u52a0\u591a\u4e2a\u503c\u3002 mgmt = graph.openManagement() birthDate = mgmt.makePropertyKey('birthDate').dataType(Long.class).cardinality(Cardinality.SINGLE).make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() sensorReading = mgmt.makePropertyKey('sensorReading').dataType(Double.class).cardinality(Cardinality.LIST).make() mgmt.commit() 5.3 Relation Types\uff08\u5173\u7cfb\u7c7b\u578b\uff09 \u8fb9\u6807\u7b7e\u548c\u5c5e\u6027\u952e\u5171\u540c\u79f0\u4e3a\u5173\u7cfb\u7c7b\u578b\u3002\u5173\u7cfb\u7c7b\u578b\u7684\u540d\u79f0\u5728\u56fe\u4e2d\u5fc5\u987b\u552f\u4e00\uff0c\u8fd9\u610f\u5473\u7740\u5c5e\u6027\u952e\u548c\u8fb9\u7f18\u6807\u7b7e\u4e0d\u80fd\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002JanusGraph API\u4e2d\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u67e5\u8be2\u662f\u5426\u5b58\u5728\u6216\u68c0\u7d22\u5305\u542b\u5c5e\u6027\u952e\u548c\u8fb9\u6807\u7b7e\u7684\u5173\u7cfb\u7c7b\u578b\u3002 mgmt = graph.openManagement() if (mgmt.containsRelationType('name')) name = mgmt.getPropertyKey('name') mgmt.getRelationTypes(EdgeLabel.class) mgmt.commit() 5.4 Defining Vertex Labels\uff08\u5b9a\u4e49\u9876\u70b9\u6807\u7b7e\uff09 \u50cf\u8fb9\u4e00\u6837\uff0c\u9876\u70b9\u4e5f\u6709\u6807\u7b7e\u3002\u4f46\u4e0e\u8fb9\u7f18\u6807\u7b7e\u4e0d\u540c\uff0c\u9876\u70b9\u6807\u7b7e\u662f\u53ef\u9009\u7684\u3002\u9876\u70b9\u6807\u7b7e\u53ef\u7528\u4e8e\u533a\u5206\u4e0d\u540c\u7c7b\u578b\u7684\u9876\u70b9\uff0c\u4f8b\u5982\u7528\u6237\u9876\u70b9\u548c\u4ea7\u54c1\u9876\u70b9\u3002 \u5c3d\u7ba1\u6807\u7b7e\u5728\u6982\u5ff5\u548c\u6570\u636e\u6a21\u578b\u7ea7\u522b\u662f\u53ef\u9009\u7684\uff0c\u4f46JanusGraph\u5c06\u6807\u7b7e\u4f5c\u4e3a\u5185\u90e8\u5b9e\u73b0\u5206\u914d\u5404\u6bcf\u4e2a\u9876\u70b9\u3002\u7531AddVertex\u65b9\u6cd5\u521b\u5efa\u7684\u9876\u70b9\u4f7f\u7528JanuSgraph\u7684\u9ed8\u8ba4\u6807\u7b7e\u3002 \u8981\u521b\u5efa\u6807\u7b7e\uff0c\u8c03\u7528makeVertexLabel(String).make()\u6253\u5f00\u7684\u56fe\u5f62\u6216\u7ba1\u7406\u4e8b\u52a1\uff0c\u5e76\u63d0\u4f9b\u9876\u70b9\u6807\u7b7e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u9876\u70b9\u6807\u7b7e\u540d\u79f0\u5728\u56fe\u8868\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002 mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() mgmt.commit() // Create a labeled vertex person = graph.addVertex(label, 'person') // Create an unlabeled vertex v = graph.addVertex() graph.tx().commit() 5.5 Automatic Schema Maker\uff08\u81ea\u52a8\u521b\u5efaschema\uff09 \u5982\u679c\u6ca1\u6709\u660e\u786e\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7b7e\uff0c\u5219\u5728\u6dfb\u52a0\u8fb9\uff0c\u9876\u70b9\u6216\u5c5e\u6027\u8bbe\u7f6e\u671f\u95f4\u9996\u6b21\u4f7f\u7528\u65f6\uff0c\u5c06\u9690\u5f0f\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7b7e\u3002DefaultSchemaMaker\u914d\u7f6e\u7528\u4e8eJanusGraph\u56fe\u5b9a\u4e49\u8fd9\u6837\u7684\u7c7b\u578b\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u9690\u5f0f\u521b\u5efa\u7684\u8fb9\u6807\u7b7e\u5177\u6709\u591a\u6837\u6027MULTI\uff0c\u9690\u5f0f\u521b\u5efa\u7684\u5c5e\u6027\u952e\u5177\u6709\u57fa\u6570SINGLE\u548c\u6570\u636e\u7c7b\u578bObject.class\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u548c\u6ce8\u518c\u4ed6\u4eec\u81ea\u5df1\u7684DefaultSchemaMaker\u6765\u63a7\u5236schema\u5143\u7d20\u7684\u81ea\u52a8\u521b\u5efa\u3002 \u5f3a\u70c8\u5efa\u8bae\u901a\u8fc7schema.default=none\u5728JanusGraph\u56fe\u5f62\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\uff0c\u660e\u786e\u5b9a\u4e49\u6240\u6709schema\u5143\u7d20\u5e76\u7981\u7528\u81ea\u52a8schema\u521b\u5efa\u3002 5.6 Changing Schema Elements(\u66f4\u6539schema\u5143\u7d20) \u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7684\u5b9a\u4e49\u4e00\u65e6\u63d0\u4ea4\u5230\u56fe\uff0c\u5c31\u65e0\u6cd5\u66f4\u6539\u3002\u53ef\u4ee5\u901a\u8fc7JanusGraphManagement.changeName(JanusGraphSchemaElement, String) \u66f4\u6539\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff0c\u5982\u4e0b\u793a\u4f8b\u5c5e\u6027\u952eplace\u91cd\u547d\u540d\u4e3alocation. mgmt = graph.openManagement() place = mgmt.getPropertyKey('place') mgmt.changeName(place, 'location') mgmt.commit() \u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u5f53\u524d\u8fd0\u884c\u7684\u4e8b\u52a1\u548c\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6JanusGraph\u56fe\u5f62\u5b9e\u4f8b\u4e2d\uff0c\u6a21\u5f0f\u540d\u79f0\u66f4\u6539\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u53ef\u89c1\u3002\u5c3d\u7ba1\u5b58\u50a8\u540e\u7aef\u5411\u6240\u6709\u7684JanusGraph\u5b9e\u4f8b\u901a\u77e5schema\u540d\u79f0\u7684\u66f4\u6539\uff0c\u4f46\u6a21\u5f0fschema\u7684\u66f4\u6539\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u751f\u6548\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u6545\u969c\u60c5\u51b5\uff0c\u5982\u7f51\u7edc\u5206\u533a\uff0c\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u542f\u52a8\u5b9e\u4f8b\u3002\u5982\u679c\u8fd9\u4e9b\u4e0e\u91cd\u547d\u540d\u540c\u65f6\u53d1\u751f\u3002\u56e0\u6b64\uff0c\u7528\u6237\u5fc5\u987b\u786e\u4fdd\u6ee1\u8db3\u4ee5\u4e0b\u4efb\u4e00\u6761\u4ef6\uff1a \u91cd\u547d\u540d\u7684\u6807\u7b7e\u548c\u952e\u5f53\u524d\u672a\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\uff08\u65e2\u5199\u5165\u6216\u8bfb\u53d6\uff09\uff0c\u5e76\u4e14\u5728\u6240\u6709JanusGraph\u5e94\u7b54schema\u540d\u79f0\u66f4\u6539\u524d\u4e0d\u4f1a\u4f7f\u7528\u3002 \u8fd0\u884c\u4e8b\u52a1\u4f1a\u4e3b\u52a8\u9002\u5e94\u77ed\u6682\u7684\u4e2d\u95f4\u65f6\u671f\uff0c\u5728\u8fd9\u671f\u95f4\uff0c\u65e7\u540d\u79f0\u6216\u65b0\u540d\u79f0\u90fd\u662f\u6709\u6548\u7684\uff0c\u8fd9\u53d6\u51b3\u4e8eJanuSgraph\u5b9e\u4f8b\u548c\u540d\u79f0\u66f4\u6539\u516c\u544a\u7684\u72b6\u6001\u3002\u8fd9\u53ef\u80fd\u610f\u5473\u7740\u540c\u65f6\u5230\u67e5\u8be2\u4e24\u4e2a\u540d\u79f0\u7684schema\u3002 \u5982\u679c\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u73b0\u6709schema\u7c7b\u578b\uff0c\u5efa\u8bae\u5c06\u6b64\u7c7b\u578b\u7684\u540d\u79f0\u4fee\u6539\u6210\u73b0\u5728\u672a\u4f7f\u7528\uff08\u5e76\u4e14\u6c38\u4e0d\u4f7f\u7528\uff09\u3002\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u539f\u59cb\u540d\u79f0\u5b9a\u4e49\u65b0\u7684\u6807\u7b7e\u6216key\uff0c\u4ece\u800c\u6709\u6548\u7684\u66ff\u6362\u65e7\u6807\u7b7e\u6216\u952e\u3002\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u4ee5\u524d\u73b0\u6709\u7c7b\u578b\u5199\u5165\u7684\u9876\u70b9\u3001\u8fb9\u6216\u5c5e\u6027\u3002 \u4e0d\u652f\u6301\u5728\u7ebf\u91cd\u65b0\u5b9a\u4e49\u73b0\u6709\u56fe\u5f62\u5143\u7d20\uff0c\u5fc5\u987b\u901a\u8fc7\u6279\u91cf\u56fe\u5f62\u8f6c\u6362\u5b8c\u6210\u3002 5.7 Schema Constraints\uff08schema\u7ea6\u675f\uff09 \u6a21\u5f0f\u7684\u5b9a\u4e49\u5141\u8bb8\u7528\u6237\u914d\u7f6e\u663e\u5f0f\u5c5e\u6027\u548c\u8fde\u63a5\u7ea6\u675f\u3002\u5c5e\u6027\u53ef\u4ee5\u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u9876\u70b9\u6807\u7b7e\u548c\uff08\u6216\uff09\u8fb9\u6807\u7b7e\u3002\u6b64\u5916\uff0c\u94fe\u63a5\u7ea6\u675f\u5141\u8bb8\u7528\u6237\u660e\u786e\u5b9a\u4e49\u90a3\u4e24\u4e2a\u9876\u70b9\u6807\u7b7e\u5141\u8bb8\u53ef\u4ee5\u901a\u8fc7\u8fb9\u6807\u7b7e\u8fde\u63a5\u3002\u8fd9\u4e9b\u7ea6\u675f\u53ef\u7528\u4e8e\u786e\u4fdd\u56fe\u5f62\u4e0e\u7ed9\u5b9a\u7684\u57df\u6a21\u578b\u5339\u914d\u3002\u4f8b\u5982\u5728\u4f17\u795e\u56fe\uff0c\u4e00\u4e2agod\u53ef\u4ee5\u662f\u53e6\u4e00\u4e2a\u5144\u5f1f\u7684god\uff0c\u4e0d\u662f\u4e00\u4e2amonster\u7684\u5144\u5f1f\uff0c\u795e\u53ef\u4ee5\u6709\u5e74\u9f84\u5c5e\u6027\uff0c\u4f46\u662flocation\u4e0d\u80fd\u6709\u5e74\u9f84\u5c5e\u6027\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7981\u7528\u8fd9\u4e9b\u7ea6\u675f\u3002 \u542f\u7528\u8fd9\u4e9bschema\u7ea6\u675f\u9700\u8981\u8bbe\u7f6eschema.constraints=true\u3002\u6b64\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u8bbe\u7f6eschema.default\u3002\u5982\u679cschema.default\u8bbe\u7f6e\u6210none, \u5219\u8fdd\u53cdschema\u7ea6\u675f\u4f1a\u629b\u51faIllegalArgumentException\u3002\u5982\u679cschema.default\u6ca1\u6709\u8bbe\u7f6e\u6210none\uff0c\u5219\u4f1a\u81ea\u52a8\u521b\u5efaschema\u7ea6\u675f\uff0c\u4f46\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u6fc0\u6d3b\u6a21\u5f0f\u7ea6\u675f\u5bf9\u73b0\u6709\u6570\u636e\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u6a21\u5f0f\u7ea6\u675f\u4ec5\u4f5c\u7528\u5728\u63d2\u5165\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b\u7ea6\u675f\u5b8c\u5168\u4e0d\u4f1a\u5f71\u54cd\u6570\u636e\u7684\u8bfb\u53d6\u3002 \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addProperties(VertexLabel, PropertyKey...)\u7ed1\u5b9a\u591a\u4e2a\u5c5e\u6027\u5230\u9876\u70b9\uff0c\u4f8b\u5982\uff1a mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() birthDate = mgmt.makePropertyKey('birthDate').dataType(Long.class).cardinality(Cardinality.SINGLE).make() mgmt.addProperties(person, name, birthDate) mgmt.commit() \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addProperties(EdgeLabel, PropertyKey...)\u4e3a\u8fb9\u7ed1\u5b9a\u591a\u4e2a\u5c5e\u6027\u3002\u4f8b\u5982\uff1a mgmt = graph.openManagement() follow = mgmt.makeEdgeLabel('follow').multiplicity(MULTI).make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() mgmt.addProperties(follow, name) mgmt.commit() \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addConnection(EdgeLabel, VertexLabel out, VertexLabel in)\u5b9a\u4e49\u4f20\u51fa\uff0c\u4f20\u5165\u548c\u8fb9\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4f8b\u5982\uff1a mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() company = mgmt.makeVertexLabel('company').make() works = mgmt.makeEdgeLabel('works').multiplicity(MULTI).make() mgmt.addConnection(works, person, company) mgmt.commit()","title":"5.\u6570\u636e\u5b9e\u4f8b\u548c\u6570\u636e\u6a21\u578b"},{"location":"janusgraph_basics/schema_and_data_modeling/#51-defining-edge-labels","text":"\u94fe\u63a5\u4e24\u4e2a\u5b9a\u70b9\u7684\u8fb9\u90fd\u6709\u4e00\u4e2a\u5b9a\u4e49\u5173\u7cfb\u7684\u6807\u7b7e\u3002\u4f8b\u5982\uff0c\u9876\u70b9A\u548c\u9876\u70b9B\u4e4b\u95f4\u7684\u8fb9\u6807\u7b7efriend\u6807\u5fd7\u7740\u4e24\u4eba\u4e4b\u95f4\u7684\u53cb\u8c0a\u5173\u7cfb\u3002 \u8981\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u8bf7\u5728\u6253\u5f00\u7684\u56fe\u5f62\u6216\u7ba1\u7406\u4e8b\u52a1\u4e0a\u8c03\u7528MakeEdgeLabel ( String )\uff0c\u5e76\u63d0\u4f9b\u8fb9\u6807\u7b7e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u8fb9\u6807\u7b7e\u540d\u79f0\u5728\u56fe\u4e2d\u5fc5\u987b\u552f\u4e00\u3002\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5141\u8bb8\u5b9a\u4e49\u8fb9\u6807\u7b7e\u591a\u6837\u6027\u7684builder\u3002\u8fb9\u6807\u7b7e\u7684\u591a\u6837\u6027\u5b9a\u4e49\u4e86\u5177\u6709\u8be5\u6807\u7b7e\u7684\u8fb9\u7684\u591a\u6837\u6027\u7ea6\u675f\uff0c\u65e2\u4e00\u5bf9\u9876\u70b9\u95f4\u7684\u6700\u5927\u8fb9\u4e2a\u6570\u3002JanusGraph\u652f\u6301\u5982\u4e0b\u7684\u591a\u6837\u6027\u3002","title":"5.1 Defining Edge Labels(\u5b9a\u4e49\u8fb9\u6807\u7b7e)"},{"location":"janusgraph_basics/schema_and_data_modeling/#511-edge-lable-multiplicity","text":"Multiplicity Settings\uff08\u591a\u6837\u6027\u8bbe\u7f6e\uff09 MULTI\uff1a\u4efb\u610f\u4e00\u5bf9\u7684\u9876\u70b9\u95f4\u5141\u8bb8\u591a\u4e2a\u6807\u7b7e\u76f8\u540c\u7684\u8fb9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u56fe\u662f\u5173\u4e8e\u8fd9\u79cd\u8fb9\u7f18\u6807\u7b7e\u7684\u591a\u56fe\u3002\u8fb9\u7684\u591a\u6837\u6027\u6ca1\u6709\u7ea6\u675f\u3002 SIMPLE\uff1a\u4efb\u610f\u4e00\u5bf9\u9876\u70b9\u4e4b\u95f4\u53ea\u5141\u8bb8\u4e00\u6761\u6b64\u7c7b\u6807\u7b7e\u7684\u8fb9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u56fe\u662f\u5173\u4e8e\u6807\u7b7e\u7684\u7b80\u5355\u56fe\u3002\u786e\u4fdd\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u6807\u7b7e\u548c\u4e00\u5bf9\u9876\u70b9\u8fb9\u662f\u552f\u4e00\u7684\u3002 MANY2ONE:\u5728\u56fe\u5f62\u4e2d\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u51fa\u8fb9\uff0c\u4f46\u4e0d\u9650\u5236\u8f93\u5165\u8fb9\u4e2a\u6570\u3002\u8fb9\u7f18\u6807\u7b7emother\u662fMANY2ONE\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u6bcd\u4eb2\uff0c\u4f46\u6bcd\u4eb2\u53ef\u4ee5\u6709\u591a\u4e2a\u5b69\u5b50\u3002 ONE2MANY\uff1a\u5728\u56fe\u5f62\u4e2d\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u5165\u8fb9\uff0c\u4f46\u4e0d\u9650\u5236\u8f93\u51fa\u8fb9\u3002\u8fb9\u6807\u7b7ewinnerOf\u662fONE2MANY\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6bd4\u8d5b\u6700\u591a\u53ea\u8d62\u4e00\u4e2a\u4eba\uff0c\u4f46\u4e00\u4e2a\u4eba\u53ef\u4ee5\u8d62\u5f97\u591a\u4e2a\u6bd4\u8d5b\u3002 ONE2ONE\uff1a\u5728\u56fe\u8868\u7684\u4efb\u4f55\u9876\u70b9\u4e0a\u6700\u591a\u5141\u8bb8\u6b64\u6807\u7b7e\u7684\u4e00\u4e2a\u8f93\u5165\u8fb9\u548c\u4e00\u4e2a\u8f93\u51fa\u8fb9\u3002\u8fb9\u6807\u7b7emarried\u662fONE2ONE\u591a\u6837\u6027\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u4e00\u4e2a\u4eba\u4e0e\u53e6\u4e00\u4e2a\u4eba\u7ed3\u5a5a\u3002 \u9ed8\u8ba4\u7684\u591a\u6837\u6027\u662fMULTI\u3002\u901a\u8fc7\u8c03\u7528make()\u6784\u5efa\u5668\u4e0a\u7684\u65b9\u6cd5\u6765\u5b8c\u6210\u8fb9\u6807\u7b7e\u7684\u5b9a\u4e49\uff0c\u8be5\u6784\u5efa\u5668\u8fd4\u56de\u5b9a\u4e49\u7684\u8fb9\u6807\u7b7e\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\u3002 mgmt = graph.openManagement() follow = mgmt.makeEdgeLabel('follow').multiplicity(MULTI).make() mother = mgmt.makeEdgeLabel('mother').multiplicity(MANY2ONE).make() mgmt.commit()","title":"5.1.1 Edge Lable Multiplicity\uff08\u8fb9\u6807\u7b7e\u7684\u591a\u6837\u6027\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#52-defining-property-keys","text":"\u9876\u70b9\u548c\u8fb9\u7684\u5c5e\u6027\u662f\u952e\u503c\u5bf9.\u4f8b\u5982\uff0c\u5c5e\u6027name='Daniel'\u5177\u6709\u952ename\u548c\u503c'Daniel'\u3002 \u5c5e\u6027\u952e\u662fJanusGraph\u67b6\u6784\u7684\u4e00\u90e8\u5206\uff0c\u53ef\u4ee5\u7ea6\u675f\u5141\u8bb8\u7684\u6570\u636e\u7c7b\u578b\u548c\u503c\u7684Cardinality\uff08\u57fa\u6570\uff09\u3002 \u8981\u5b9a\u4e49\u5c5e\u6027\u952e\uff0c\u8bf7\u8c03\u7528makePropertyKey(String)\u6253\u5f00\u7684\u56fe\u6216\u7ba1\u7406\u4e8b\u52a1\u5668\uff08management transaction\uff09\uff0c\u5e76\u63d0\u4f9b\u5c5e\u6027\u952e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u5c5e\u6027\u952e\u540d\u79f0\u5728\u56fe\u5f62\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\uff0c\u5efa\u8bae\u907f\u514d\u4f7f\u7528\u5c5e\u6027\u540d\u79f0\u4e2d\u7684\u7a7a\u683c\u6216\u7279\u6b8a\u5b57\u7b26\u3002\u6b64\u65b9\u6cd5\u8fd4\u56de\u5c5e\u6027\u952e\u7684\u6784\u5efa\u5668\u3002","title":"5.2 Defining Property Keys (\u5b9a\u4e49\u5c5e\u6027\u952e)"},{"location":"janusgraph_basics/schema_and_data_modeling/#521-property-key-data-type","text":"\u4f7f\u7528dataType(Class)\u6765\u5b9a\u4e49\u5c5e\u6027\u952e\u7684\u6570\u636e\u7c7b\u578b\u3002JanusGraph\u5c06\u5f3a\u5236\u6267\u884c\u4e0e\u5173\u8054\u952e\u7684\u6240\u6709\u503c\uff0c\u786e\u4eba\u90fd\u5177\u6709\u5df2\u914d\u7f6e\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4ece\u800c\u786e\u4fdd\u6dfb\u52a0\u5230\u56fe\u4e2d\u7684\u6570\u636e\u6709\u6548\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e3aname\u952e\u5177\u6709String\u6570\u636e\u7c7b\u578b\u3002 \u5b9a\u4e49\u6570\u636e\u7c7b\u578bObject.class\uff0c\u4ee5\u4fbf\u5141\u8bb8\u4efb\u4f55\uff08\u53ef\u5e8f\u5217\u5316\uff09\u503c\u4e0e\u952e\u5173\u8054\u3002\u4f46\u662f\uff0c\u9f13\u52b1\u5c3d\u53ef\u80fd\u4f7f\u7528\u5177\u4f53\u7684\u6570\u636e\u7c7b\u578b\u3002\u914d\u7f6e\u7684\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u662f\u5b9e\u4f53\u7c7b\uff0c\u800c\u4e0d\u662f\u63a5\u53e3\u6216\u62bd\u8c61\u7c7b\u3002JanusGraph\u5f3a\u5236\u5b9e\u73b0\u7c7b\u76f8\u7b49\uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8\u6dfb\u52a0\u5df2\u914d\u7f6e\u6570\u636e\u7c7b\u578b\u7684\u5b50\u7c7b\u3002 JanusGraph\u652f\u6301\u4ee5\u4e0b\u6570\u636e\u7c7b\u578b\u3002 \u88685.1 \u539f\u751fJanusGraph\u6570\u636e\u7c7b\u578b \u540d\u79f0 \u63cf\u8ff0 String \u5b57\u7b26\u4e32 Character \u5355\u4e2a\u5b57\u7b26 Boolean true\u6216false Byte byte\u503c Short short\u503c Integer integer\u503c Long long\u503c Float 4\u5b57\u8282\u6d6e\u70b9\u6570 Double 8\u5b57\u8282\u6d6e\u70b9\u6570 Date \u65f6\u95f4(java.util.Date) Geoshape \u5730\u7406\u5f62\u72b6\uff0c\u5982\u70b9\uff0c\u5706\u6216\u6846 UUID \u901a\u7528\u552f\u4e00\u6807\u8bc6\u7b26\uff08java.util.UUID\uff09","title":"5.2.1 Property Key Data Type\uff08\u5c5e\u6027\u952e\u6570\u636e\u7c7b\u578b\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#522-property-key-cardinality","text":"\u4f7f\u7528cardinality(Cardinality)\u5b9a\u4e49\u4e0e\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u9876\u70b9\u7684\u952e\u5173\u8054\u7684\u503c\u5141\u8bb8\u7684\u57fa\u6570\u3002 \u57fa\u6570\u7684\u8bbe\u7f6e SINGLE:\u5bf9\u4e8e\u6b64\u952e\uff0c\u6bcf\u4e2a\u5143\u7d20\u6700\u591a\u5141\u8bb8\u4e00\u4e2a\u503c\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u2192\u503c\u6620\u5c04\u5bf9\u4e8e\u56fe\u4e2d\u7684\u6240\u6709\u5143\u7d20\u90fd\u662f\u552f\u4e00\u7684\u3002\u5c5e\u6027\u952ebirthDate\u662fSINGLE\u57fa\u6570\u7684\u4e00\u4e2a\u4f8b\u5b50\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u53ea\u6709\u4e00\u4e2a\u51fa\u751f\u65e5\u671f\u3002 LIST:\u5141\u8bb8\u6bcf\u4e2a\u5143\u7d20\u7684\u4efb\u610f\u6570\u91cf\u7684\u503c\u7528\u4e8e\u6b64\u7c7b\u952e\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u4e0e\u5141\u8bb8\u91cd\u590d\u503c\u7684\u503c\u5217\u8868\u76f8\u5173\u8054\u3002\u5047\u8bbe\u6211\u4eec\u5c06\u4f20\u611f\u5668\u5efa\u6a21\u4e3a\u56fe\u5f62\u4e2d\u7684\u9876\u70b9\uff0c\u5219\u5c5e\u6027\u952esensorReading\u662f\u5177\u6709LIST\u57fa\u6570\u7684\u793a\u4f8b\uff0c\u4ee5\u5141\u8bb8\u8bb0\u5f55\u5927\u91cf\uff08\u53ef\u80fd\u91cd\u590d\u7684\uff09\u4f20\u611f\u5668\u8bfb\u6570\u3002 SET:\u5141\u8bb8\u591a\u4e2a\u4f46\u4e0d\u91cd\u590d\u7684\u503c\u7528\u4e8e\u6b64\u7c7b\u952e\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u952e\u4e0e\u4e00\u7ec4\u4e0d\u91cd\u590d\u7684\u503c\u76f8\u5173\u8054\u3002name\u5982\u679c\u6211\u4eec\u60f3\u8981\u6355\u83b7\u4e2a\u4eba\u7684\u6240\u6709\u59d3\u540d\uff08\u5305\u62ec\u6635\u79f0\uff0c\u5a5a\u524d\u59d3\u540d\u7b49\uff09\uff0c\u5219\u5c5e\u6027\u952e\u5177\u6709SET\u57fa\u6570\u3002 \u9ed8\u8ba4\u7684\u57fa\u6570\u662fSINGLE\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fb9\u548c\u5c5e\u6027\u4f7f\u7528SINGLE\u4f5c\u4e3a\u57fa\u6570\uff0c\u662f\u4e0d\u652f\u6301\u4e3a\u4e3a\u8fb9\u6216\u5c5e\u6027\u9644\u52a0\u591a\u4e2a\u503c\u3002 mgmt = graph.openManagement() birthDate = mgmt.makePropertyKey('birthDate').dataType(Long.class).cardinality(Cardinality.SINGLE).make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() sensorReading = mgmt.makePropertyKey('sensorReading').dataType(Double.class).cardinality(Cardinality.LIST).make() mgmt.commit()","title":"5.2.2 Property Key Cardinality\uff08\u5c5e\u6027\u952e\u7684\u57fa\u6570\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#53-relation-types","text":"\u8fb9\u6807\u7b7e\u548c\u5c5e\u6027\u952e\u5171\u540c\u79f0\u4e3a\u5173\u7cfb\u7c7b\u578b\u3002\u5173\u7cfb\u7c7b\u578b\u7684\u540d\u79f0\u5728\u56fe\u4e2d\u5fc5\u987b\u552f\u4e00\uff0c\u8fd9\u610f\u5473\u7740\u5c5e\u6027\u952e\u548c\u8fb9\u7f18\u6807\u7b7e\u4e0d\u80fd\u5177\u6709\u76f8\u540c\u7684\u540d\u79f0\u3002JanusGraph API\u4e2d\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u67e5\u8be2\u662f\u5426\u5b58\u5728\u6216\u68c0\u7d22\u5305\u542b\u5c5e\u6027\u952e\u548c\u8fb9\u6807\u7b7e\u7684\u5173\u7cfb\u7c7b\u578b\u3002 mgmt = graph.openManagement() if (mgmt.containsRelationType('name')) name = mgmt.getPropertyKey('name') mgmt.getRelationTypes(EdgeLabel.class) mgmt.commit()","title":"5.3 Relation Types\uff08\u5173\u7cfb\u7c7b\u578b\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#54-defining-vertex-labels","text":"\u50cf\u8fb9\u4e00\u6837\uff0c\u9876\u70b9\u4e5f\u6709\u6807\u7b7e\u3002\u4f46\u4e0e\u8fb9\u7f18\u6807\u7b7e\u4e0d\u540c\uff0c\u9876\u70b9\u6807\u7b7e\u662f\u53ef\u9009\u7684\u3002\u9876\u70b9\u6807\u7b7e\u53ef\u7528\u4e8e\u533a\u5206\u4e0d\u540c\u7c7b\u578b\u7684\u9876\u70b9\uff0c\u4f8b\u5982\u7528\u6237\u9876\u70b9\u548c\u4ea7\u54c1\u9876\u70b9\u3002 \u5c3d\u7ba1\u6807\u7b7e\u5728\u6982\u5ff5\u548c\u6570\u636e\u6a21\u578b\u7ea7\u522b\u662f\u53ef\u9009\u7684\uff0c\u4f46JanusGraph\u5c06\u6807\u7b7e\u4f5c\u4e3a\u5185\u90e8\u5b9e\u73b0\u5206\u914d\u5404\u6bcf\u4e2a\u9876\u70b9\u3002\u7531AddVertex\u65b9\u6cd5\u521b\u5efa\u7684\u9876\u70b9\u4f7f\u7528JanuSgraph\u7684\u9ed8\u8ba4\u6807\u7b7e\u3002 \u8981\u521b\u5efa\u6807\u7b7e\uff0c\u8c03\u7528makeVertexLabel(String).make()\u6253\u5f00\u7684\u56fe\u5f62\u6216\u7ba1\u7406\u4e8b\u52a1\uff0c\u5e76\u63d0\u4f9b\u9876\u70b9\u6807\u7b7e\u7684\u540d\u79f0\u4f5c\u4e3a\u53c2\u6570\u3002\u9876\u70b9\u6807\u7b7e\u540d\u79f0\u5728\u56fe\u8868\u4e2d\u5fc5\u987b\u662f\u552f\u4e00\u7684\u3002 mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() mgmt.commit() // Create a labeled vertex person = graph.addVertex(label, 'person') // Create an unlabeled vertex v = graph.addVertex() graph.tx().commit()","title":"5.4 Defining Vertex Labels\uff08\u5b9a\u4e49\u9876\u70b9\u6807\u7b7e\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#55-automatic-schema-makerschema","text":"\u5982\u679c\u6ca1\u6709\u660e\u786e\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7b7e\uff0c\u5219\u5728\u6dfb\u52a0\u8fb9\uff0c\u9876\u70b9\u6216\u5c5e\u6027\u8bbe\u7f6e\u671f\u95f4\u9996\u6b21\u4f7f\u7528\u65f6\uff0c\u5c06\u9690\u5f0f\u5b9a\u4e49\u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7b7e\u3002DefaultSchemaMaker\u914d\u7f6e\u7528\u4e8eJanusGraph\u56fe\u5b9a\u4e49\u8fd9\u6837\u7684\u7c7b\u578b\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u9690\u5f0f\u521b\u5efa\u7684\u8fb9\u6807\u7b7e\u5177\u6709\u591a\u6837\u6027MULTI\uff0c\u9690\u5f0f\u521b\u5efa\u7684\u5c5e\u6027\u952e\u5177\u6709\u57fa\u6570SINGLE\u548c\u6570\u636e\u7c7b\u578bObject.class\u3002\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0\u548c\u6ce8\u518c\u4ed6\u4eec\u81ea\u5df1\u7684DefaultSchemaMaker\u6765\u63a7\u5236schema\u5143\u7d20\u7684\u81ea\u52a8\u521b\u5efa\u3002 \u5f3a\u70c8\u5efa\u8bae\u901a\u8fc7schema.default=none\u5728JanusGraph\u56fe\u5f62\u914d\u7f6e\u4e2d\u8fdb\u884c\u8bbe\u7f6e\uff0c\u660e\u786e\u5b9a\u4e49\u6240\u6709schema\u5143\u7d20\u5e76\u7981\u7528\u81ea\u52a8schema\u521b\u5efa\u3002","title":"5.5 Automatic Schema Maker\uff08\u81ea\u52a8\u521b\u5efaschema\uff09"},{"location":"janusgraph_basics/schema_and_data_modeling/#56-changing-schema-elementsschema","text":"\u8fb9\u6807\u7b7e\uff0c\u5c5e\u6027\u952e\u6216\u9876\u70b9\u6807\u7684\u5b9a\u4e49\u4e00\u65e6\u63d0\u4ea4\u5230\u56fe\uff0c\u5c31\u65e0\u6cd5\u66f4\u6539\u3002\u53ef\u4ee5\u901a\u8fc7JanusGraphManagement.changeName(JanusGraphSchemaElement, String) \u66f4\u6539\u5c5e\u6027\u952e\u7684\u540d\u79f0\uff0c\u5982\u4e0b\u793a\u4f8b\u5c5e\u6027\u952eplace\u91cd\u547d\u540d\u4e3alocation. mgmt = graph.openManagement() place = mgmt.getPropertyKey('place') mgmt.changeName(place, 'location') mgmt.commit() \u8981\u6ce8\u610f\u7684\u662f\uff0c\u5728\u5f53\u524d\u8fd0\u884c\u7684\u4e8b\u52a1\u548c\u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6JanusGraph\u56fe\u5f62\u5b9e\u4f8b\u4e2d\uff0c\u6a21\u5f0f\u540d\u79f0\u66f4\u6539\u53ef\u80fd\u4e0d\u4f1a\u7acb\u5373\u53ef\u89c1\u3002\u5c3d\u7ba1\u5b58\u50a8\u540e\u7aef\u5411\u6240\u6709\u7684JanusGraph\u5b9e\u4f8b\u901a\u77e5schema\u540d\u79f0\u7684\u66f4\u6539\uff0c\u4f46\u6a21\u5f0fschema\u7684\u66f4\u6539\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u751f\u6548\uff0c\u5e76\u4e14\u5728\u67d0\u4e9b\u6545\u969c\u60c5\u51b5\uff0c\u5982\u7f51\u7edc\u5206\u533a\uff0c\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u542f\u52a8\u5b9e\u4f8b\u3002\u5982\u679c\u8fd9\u4e9b\u4e0e\u91cd\u547d\u540d\u540c\u65f6\u53d1\u751f\u3002\u56e0\u6b64\uff0c\u7528\u6237\u5fc5\u987b\u786e\u4fdd\u6ee1\u8db3\u4ee5\u4e0b\u4efb\u4e00\u6761\u4ef6\uff1a \u91cd\u547d\u540d\u7684\u6807\u7b7e\u548c\u952e\u5f53\u524d\u672a\u5904\u4e8e\u6d3b\u8dc3\u72b6\u6001\uff08\u65e2\u5199\u5165\u6216\u8bfb\u53d6\uff09\uff0c\u5e76\u4e14\u5728\u6240\u6709JanusGraph\u5e94\u7b54schema\u540d\u79f0\u66f4\u6539\u524d\u4e0d\u4f1a\u4f7f\u7528\u3002 \u8fd0\u884c\u4e8b\u52a1\u4f1a\u4e3b\u52a8\u9002\u5e94\u77ed\u6682\u7684\u4e2d\u95f4\u65f6\u671f\uff0c\u5728\u8fd9\u671f\u95f4\uff0c\u65e7\u540d\u79f0\u6216\u65b0\u540d\u79f0\u90fd\u662f\u6709\u6548\u7684\uff0c\u8fd9\u53d6\u51b3\u4e8eJanuSgraph\u5b9e\u4f8b\u548c\u540d\u79f0\u66f4\u6539\u516c\u544a\u7684\u72b6\u6001\u3002\u8fd9\u53ef\u80fd\u610f\u5473\u7740\u540c\u65f6\u5230\u67e5\u8be2\u4e24\u4e2a\u540d\u79f0\u7684schema\u3002 \u5982\u679c\u9700\u8981\u91cd\u65b0\u5b9a\u4e49\u73b0\u6709schema\u7c7b\u578b\uff0c\u5efa\u8bae\u5c06\u6b64\u7c7b\u578b\u7684\u540d\u79f0\u4fee\u6539\u6210\u73b0\u5728\u672a\u4f7f\u7528\uff08\u5e76\u4e14\u6c38\u4e0d\u4f7f\u7528\uff09\u3002\u4e4b\u540e\uff0c\u53ef\u4ee5\u4f7f\u7528\u539f\u59cb\u540d\u79f0\u5b9a\u4e49\u65b0\u7684\u6807\u7b7e\u6216key\uff0c\u4ece\u800c\u6709\u6548\u7684\u66ff\u6362\u65e7\u6807\u7b7e\u6216\u952e\u3002\u4f46\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e0d\u4f1a\u5f71\u54cd\u4ee5\u524d\u73b0\u6709\u7c7b\u578b\u5199\u5165\u7684\u9876\u70b9\u3001\u8fb9\u6216\u5c5e\u6027\u3002 \u4e0d\u652f\u6301\u5728\u7ebf\u91cd\u65b0\u5b9a\u4e49\u73b0\u6709\u56fe\u5f62\u5143\u7d20\uff0c\u5fc5\u987b\u901a\u8fc7\u6279\u91cf\u56fe\u5f62\u8f6c\u6362\u5b8c\u6210\u3002","title":"5.6 Changing Schema Elements(\u66f4\u6539schema\u5143\u7d20)"},{"location":"janusgraph_basics/schema_and_data_modeling/#57-schema-constraintsschema","text":"\u6a21\u5f0f\u7684\u5b9a\u4e49\u5141\u8bb8\u7528\u6237\u914d\u7f6e\u663e\u5f0f\u5c5e\u6027\u548c\u8fde\u63a5\u7ea6\u675f\u3002\u5c5e\u6027\u53ef\u4ee5\u7ed1\u5b9a\u5230\u7279\u5b9a\u7684\u9876\u70b9\u6807\u7b7e\u548c\uff08\u6216\uff09\u8fb9\u6807\u7b7e\u3002\u6b64\u5916\uff0c\u94fe\u63a5\u7ea6\u675f\u5141\u8bb8\u7528\u6237\u660e\u786e\u5b9a\u4e49\u90a3\u4e24\u4e2a\u9876\u70b9\u6807\u7b7e\u5141\u8bb8\u53ef\u4ee5\u901a\u8fc7\u8fb9\u6807\u7b7e\u8fde\u63a5\u3002\u8fd9\u4e9b\u7ea6\u675f\u53ef\u7528\u4e8e\u786e\u4fdd\u56fe\u5f62\u4e0e\u7ed9\u5b9a\u7684\u57df\u6a21\u578b\u5339\u914d\u3002\u4f8b\u5982\u5728\u4f17\u795e\u56fe\uff0c\u4e00\u4e2agod\u53ef\u4ee5\u662f\u53e6\u4e00\u4e2a\u5144\u5f1f\u7684god\uff0c\u4e0d\u662f\u4e00\u4e2amonster\u7684\u5144\u5f1f\uff0c\u795e\u53ef\u4ee5\u6709\u5e74\u9f84\u5c5e\u6027\uff0c\u4f46\u662flocation\u4e0d\u80fd\u6709\u5e74\u9f84\u5c5e\u6027\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7981\u7528\u8fd9\u4e9b\u7ea6\u675f\u3002 \u542f\u7528\u8fd9\u4e9bschema\u7ea6\u675f\u9700\u8981\u8bbe\u7f6eschema.constraints=true\u3002\u6b64\u8bbe\u7f6e\u53d6\u51b3\u4e8e\u8bbe\u7f6eschema.default\u3002\u5982\u679cschema.default\u8bbe\u7f6e\u6210none, \u5219\u8fdd\u53cdschema\u7ea6\u675f\u4f1a\u629b\u51faIllegalArgumentException\u3002\u5982\u679cschema.default\u6ca1\u6709\u8bbe\u7f6e\u6210none\uff0c\u5219\u4f1a\u81ea\u52a8\u521b\u5efaschema\u7ea6\u675f\uff0c\u4f46\u4e0d\u4f1a\u629b\u51fa\u5f02\u5e38\u3002\u6fc0\u6d3b\u6a21\u5f0f\u7ea6\u675f\u5bf9\u73b0\u6709\u6570\u636e\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u6a21\u5f0f\u7ea6\u675f\u4ec5\u4f5c\u7528\u5728\u63d2\u5165\u7684\u8fc7\u7a0b\u3002\u56e0\u6b64\uff0c\u8fd9\u4e9b\u7ea6\u675f\u5b8c\u5168\u4e0d\u4f1a\u5f71\u54cd\u6570\u636e\u7684\u8bfb\u53d6\u3002 \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addProperties(VertexLabel, PropertyKey...)\u7ed1\u5b9a\u591a\u4e2a\u5c5e\u6027\u5230\u9876\u70b9\uff0c\u4f8b\u5982\uff1a mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() birthDate = mgmt.makePropertyKey('birthDate').dataType(Long.class).cardinality(Cardinality.SINGLE).make() mgmt.addProperties(person, name, birthDate) mgmt.commit() \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addProperties(EdgeLabel, PropertyKey...)\u4e3a\u8fb9\u7ed1\u5b9a\u591a\u4e2a\u5c5e\u6027\u3002\u4f8b\u5982\uff1a mgmt = graph.openManagement() follow = mgmt.makeEdgeLabel('follow').multiplicity(MULTI).make() name = mgmt.makePropertyKey('name').dataType(String.class).cardinality(Cardinality.SET).make() mgmt.addProperties(follow, name) mgmt.commit() \u53ef\u4ee5\u4f7f\u7528JanusGraphManagement.addConnection(EdgeLabel, VertexLabel out, VertexLabel in)\u5b9a\u4e49\u4f20\u51fa\uff0c\u4f20\u5165\u548c\u8fb9\u4e4b\u95f4\u7684\u8fde\u63a5\uff0c\u4f8b\u5982\uff1a mgmt = graph.openManagement() person = mgmt.makeVertexLabel('person').make() company = mgmt.makeVertexLabel('company').make() works = mgmt.makeEdgeLabel('works').multiplicity(MULTI).make() mgmt.addConnection(works, person, company) mgmt.commit()","title":"5.7 Schema Constraints\uff08schema\u7ea6\u675f\uff09"},{"location":"janusgraph_basics/technical_limitations/","text":"","title":"17.\u6280\u672f\u9650\u5236"},{"location":"janusgraph_basics/things_to_consider_in_a_multi_node_janusgraph_cluster/","text":"","title":"10.\u591a\u8282\u70b9JanusGraph\u96c6\u7fa4\u4e2d\u9700\u8981\u8003\u8651\u7684\u4e8b\u9879"},{"location":"janusgraph_basics/transaction_log/","text":"","title":"14.JanusGraph\u65e5\u5fd7"},{"location":"janusgraph_basics/transactions/","text":"","title":"12.\u4e8b\u52a1"},{"location":"storage_backend/apache_cassandra/","text":"\u7b2c18\u7ae0Apache Cassandra \u5f53\u60a8\u9700\u8981\u53ef\u6269\u5c55\u6027\u548c\u9ad8\u53ef\u7528\u6027\u800c\u4e0d\u5f71\u54cd\u6027\u80fd\u65f6\uff0cApache Cassandra\u6570\u636e\u5e93\u662f\u6b63\u786e\u7684\u9009\u62e9\u3002\u5546\u7528\u786c\u4ef6\u6216\u4e91\u57fa\u7840\u67b6\u6784\u7684\u7ebf\u6027\u53ef\u6269\u5c55\u6027\u548c\u7ecf\u8fc7\u9a8c\u8bc1\u7684\u5bb9\u9519\u4f7f\u5176\u6210\u4e3a\u5173\u952e\u4efb\u52a1\u6570\u636e\u7684\u5b8c\u7f8e\u5e73\u53f0\u3002Cassandra\u5bf9\u8de8\u591a\u4e2a\u6570\u636e\u4e2d\u5fc3\u8fdb\u884c\u590d\u5236\u7684\u652f\u6301\u662f\u540c\u7c7b\u4ea7\u54c1\u4e2d\u6700\u4f73\u7684\uff0c\u53ef\u4e3a\u60a8\u7684\u7528\u6237\u63d0\u4f9b\u66f4\u4f4e\u7684\u5ef6\u8fdf\uff0c\u5e76\u8ba9\u60a8\u5728\u77e5\u9053\u81ea\u5df1\u53ef\u4ee5\u5728\u533a\u57df\u4e2d\u65ad\u540e\u5e78\u5b58\u4e0b\u6765\u3002\u5df2\u77e5\u6700\u5927\u7684Cassandra\u96c6\u7fa4\u5728400\u591a\u53f0\u673a\u5668\u4e0a\u62e5\u6709\u8d85\u8fc7300 TB\u7684\u6570\u636e\u3002 \u4ee5\u4e0b\u90e8\u5206\u6982\u8ff0\u4e86JanusGraph\u4e0eApache Cassandra\u4e00\u8d77\u4f7f\u7528\u7684\u5404\u79cd\u65b9\u5f0f\u3002 18.1 Cassandra\u5b58\u50a8\u540e\u7aef JanusGraph\u63d0\u4f9b\u4ee5\u4e0b\u540e\u7aef\u7528\u4e8eCassandra\uff1a \u200b \u2022cql - \u57fa\u4e8eCQL\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002\u8fd9\u662f\u63a8\u8350\u7684\u9a71\u52a8\u7a0b\u5e8f\u3002 \u200b \u2022cassandrathrift - JanusGraph\u7684Thrift\u8fde\u63a5\u6c60\u9a71\u52a8\u7a0b\u5e8f \u200b \u2022cassandra- Astyanax driver\u3002Astyanax\u9879\u76ee\u5df2\u7ecf\u505c\u6b62\u3002 \u200b \u2022embeddedcassandra - \u7528\u4e8e\u5728\u540c\u4e00\u4e2aJVM\u4e2d\u8fd0\u884cCassandra\u548cJanusGraph\u7684\u5d4c\u5165\u5f0f\u9a71\u52a8\u7a0b\u5e8f Cassandra\u6709\u4e24\u4e2a\u4f9b\u5ba2\u6237\u4f7f\u7528\u7684\u534f\u8bae\uff1aCQL\u548cThrift\u3002Thrift\u662f\u6700\u521d\u7684\u754c\u9762\uff0c\u4f46\u662f\u4eceCassandra 2.1\u5f00\u59cb\u5c31\u88ab\u5f03\u7528\u4e86\u3002JanusGraph\u7684\u6838\u5fc3\u6700\u521d\u662f\u5728Thrift\u5f03\u7528\u4e4b\u524d\u7f16\u5199\u7684\uff0c\u5b83\u6709\u51e0\u4e2a\u652f\u6301Thrift\u7684\u7c7b\u3002\u4f7f\u7528Cassandra 4.0\uff0c\u5c06\u5728Cassandra\u4e2d\u5220\u9664Thrift\u652f\u6301\u3002\u5efa\u8baeJanusGraph\u7528\u6237\u4f7f\u7528cql\u5b58\u50a8\u540e\u7aef\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u60a8\u8ba1\u5212\u4f7f\u7528\u57fa\u4e8eThrift\u7684\u9a71\u52a8\u7a0b\u5e8f\u5e76\u4e14\u4f7f\u7528\u7684\u662fCassandra 2.2\u6216\u66f4\u9ad8\u7248\u672c\uff0c\u5219\u9700\u8981\u663e\u5f0f\u542f\u7528Thrift\uff0c\u4ee5\u4fbfJanusGraph\u53ef\u4ee5\u8fde\u63a5\u5230\u7fa4\u96c6\u3002\u901a\u8fc7./bin/nodetool enablethrift\u5728\u6bcf\u4e2aCassandra\u8282\u70b9\u4e0a\u8fd0\u884c\u6765\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002 \u6ce8\u610f\uff1a\u5982\u679c\u5728Cassandra\u4e0a\u542f\u7528\u4e86\u5b89\u5168\u6027\uff0c\u5219\u7528\u6237\u5fc5\u987b\u5177\u6709CREATE permission on \uff0c\u5426\u5219\u5fc5\u987b\u7531\u7ba1\u7406\u5458\u63d0\u524d\u521b\u5efa\u5bc6\u94a5\u7a7a\u95f4\uff0c\u5305\u62ec\u6240\u9700\u7684\u8868\u6216\u7528\u6237\u5fc5\u987b\u5177\u6709\u7684\u5bc6\u94a5\u7a7a\u95f4CREATE permission on \u3002\u5305\u542b\u6240\u9700\u8868\u7684create table\u6587\u4ef6\u4f4d\u4e8econf/cassandra/cassandraTables.cql\u3002\u8bf7\u5728\u6267\u884c\u4e4b\u524d\u5b9a\u4e49\u952e\u7a7a\u95f4\u3002 18.2. \u672c\u5730\u670d\u52a1\u5668\u6a21\u5f0f Cassandra\u53ef\u4ee5\u4f5c\u4e3aJanusGraph\u548c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u5728\u540c\u4e00\u672c\u5730\u4e3b\u673a\u4e0a\u7684\u72ec\u7acb\u6570\u636e\u5e93\u8fd0\u884c\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0cJanusGraph\u548cCassandra\u901a\u8fc7localhost\u5957\u63a5\u5b57\u76f8\u4e92\u901a\u4fe1\u3002\u5728Cassandra\u4e0a\u8fd0\u884cJanusGraph\u9700\u8981\u4ee5\u4e0b\u8bbe\u7f6e\u6b65\u9aa4\uff1a \u200b 1.\u4e0b\u8f7dCassandra\uff0c\u89e3\u538b\u7f29\uff0c\u5e76\u5728conf/cassandra.yaml\u548c\u4e2d\u8bbe\u7f6e\u6587\u4ef6\u7cfb\u7edf\u8def\u5f84conf/log4j-server.properties \u200b 2.\u4f7f\u7528\u9884\u6253\u5305\u53d1\u884c\u7248\u4e2d\u63d0\u4f9b\u7684\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u5c06Gremlin Server\u8fde\u63a5\u5230Cassandra\u9700\u8981\u542f\u7528Cassandra Thrift\u3002\u542f\u7528Cassandra Thrift\u6253\u5f00conf/cassandra.yaml\u5e76\u66f4\u65b0start_rpc: false\u5230start_rpc: true\u3002\u5982\u679cCassandra\u5df2\u7ecf\u8fd0\u884c\uff0c\u53ef\u4ee5\u624b\u52a8\u542f\u52a8Thrift bin/nodetool enablethrift\u3002\u53ef\u4ee5\u901a\u8fc7bin/nodetoolstatusthrift \u9a8c\u8bc1Thrift\u72b6\u6001\u3002 \u200b 3.\u901a\u8fc7\u8c03\u7528bin/cassandra -f\u89e3\u538b\u7f29Cassandra\u7684\u76ee\u5f55\u4e2d\u7684\u547d\u4ee4\u884c\u542f\u52a8Cassandra \u3002\u8bfb\u53d6\u8f93\u51fa\u4ee5\u68c0\u67e5Cassandra\u662f\u5426\u5df2\u6210\u529f\u542f\u52a8\u3002 \u60a8\u53ef\u4ee5\u6309\u5982\u4e0b\u65b9\u5f0f\u521b\u5efaCassandra JanusGraph JanusGraph g = JanusGraphFactory.build(). set(\"storage.backend\", \"cql\"). set(\"storage.hostname\", \"127.0.0.1\"). open(); \u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578bconf\u548cg\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002 18.3.\u672c\u5730\u96c6\u88c5\u7bb1\u6a21\u5f0f Cassandra\u6ca1\u6709Windows\u6216OSX\u7684\u672c\u673a\u5b89\u88c5\u3002\u5728OSX\uff0cWindows\u6216Linux\u4e0a\u8fd0\u884cCassandra\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u4e4b\u4e00\u662f\u4f7f\u7528Docker\u5bb9\u5668\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u5355\u4e2aDocker\u547d\u4ee4\u4e0b\u8f7d\u5e76\u8fd0\u884cCassandra \u3002\u5b89\u88c5\u60a8\u6253\u7b97\u4f7f\u7528\u7684JanusGraph\u7248\u672c\u652f\u6301\u7684\u7248\u672c\u975e\u5e38\u91cd\u8981\u3002\u53ef\u4ee5\u5728\u201c \u7248\u672c\u201d\u9875\u9762\u4e0a\u7279\u5b9a\u7248\u672c\u7684\u201c\u7ecf\u6d4b\u8bd5\u7684\u517c\u5bb9\u6027\u201d\u90e8\u5206\u4e0b\u627e\u5230\u517c\u5bb9\u7248\u672c\u3002\u8be5\u5361\u73ca\u5fb7\u62c9\u6cca\u575e\u7a97\u4e2d\u5fc3\u9875\u9762\u53ef\u4ee5\u4e3a\u53ef\u7528\u7684\u7248\u672c\uff0c\u4f7f\u7528\u7684\u6307\u4ee4\u5f15\u7528\u3002\u5728\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u6b63\u5728\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u4ee5\u542f\u7528Cassandra Thrift -e CASSANDRA_START_RPC=true\u3002\u53ef\u4ee5\u5728\u6b64\u5904\u627e\u5230\u7aef\u53e3\u7684\u63cf\u8ff0\u3002\u7aef\u53e39160\u7528\u4e8eThrift\u5ba2\u6237\u7aefAPI\u3002\u7aef\u53e39042\u7528\u4e8eCQL\u672c\u673a\u5ba2\u6237\u7aef\u3002\u7aef\u53e37000,7001\u548c7099\u7528\u4e8e\u8282\u70b9\u95f4\u901a\u4fe1\u3002Cassandra 3.11\u7248\u672c\u662fJanusGraph 0.2.0\u7684\u6700\u65b0\u517c\u5bb9\u7248\u672c\uff0c\u5728\u4e0b\u9762\u7684\u53c2\u8003\u547d\u4ee4\u4e2d\u6307\u5b9a\u3002 docker run --name jg-cassandra -d -e CASSANDRA_START_RPC = true -p 9160\uff1a9160 \\ -p 9042\uff1a9042 -p 7199\uff1a7199 -p 7001\uff1a7001 -p 7000\uff1a7000 cassandra\uff1a3.11 18.4\u3002\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f \u5f53\u56fe\u5f62\u9700\u8981\u8d85\u51fa\u5355\u4e2a\u673a\u5668\u7684\u8303\u56f4\u65f6\uff0cCassandra\u548cJanusGraph\u5728\u903b\u8f91\u4e0a\u5206\u6210\u4e0d\u540c\u7684\u673a\u5668\u3002\u5728\u6b64\u6a21\u578b\u4e2d\uff0cCassandra\u96c6\u7fa4\u7ef4\u62a4\u56fe\u5f62\u8868\u793a\uff0c\u5e76\u4e14\u4efb\u610f\u6570\u91cf\u7684JanusGraph\u5b9e\u4f8b\u90fd\u7ef4\u62a4\u5bf9Cassandra\u96c6\u7fa4\u7684\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u8bfb/\u5199\u8bbf\u95ee\u3002\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u76f4\u63a5\u4e0eJanusGraph\u4ea4\u4e92\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684Cassandra\u96c6\u7fa4\uff0c\u5176\u4e2d\u4e00\u53f0\u673a\u5668\u7684IP\u5730\u5740\u4e3a77.77.77.77\uff0c\u7136\u540e\u5c06JanusGraph\u4e0e\u96c6\u7fa4\u8fde\u63a5\u5b8c\u6210\u5982\u4e0b\uff08\u9017\u53f7\u5206\u9694IP\u5730\u5740\u4ee5\u5f15\u7528\u591a\u53f0\u673a\u5668\uff09\uff1a JanusGraph graph = JanusGraphFactory.build(). set(\"storage.backend\", \"cql\"). set(\"storage.hostname\", \"77.77.77.77\"). open(); \u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578bconf\u548cg\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002 18.5\u3002\u4f7f\u7528Gremlin Server\u7684\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f Gremlin Server\u53ef\u4ee5\u5305\u88c5\u5728\u524d\u4e00\u5c0f\u8282\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2aJanusGraph\u5b9e\u4f8b\u4e0a\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5fc5\u662f\u57fa\u4e8eJava\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u5ba2\u6237\u7aef\u4e0eGremlin Server\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u975e\u5e38\u9002\u7528\u4e8e\u591a\u8bed\u8a00\u4f53\u7cfb\u7ed3\u6784\uff0c\u5176\u4e2d\u4f7f\u7528\u4e0d\u540c\u8bed\u8a00\u7f16\u5199\u7684\u5404\u79cd\u7ec4\u4ef6\u9700\u8981\u5728\u56fe\u5f62\u4e0a\u8fdb\u884c\u5f15\u7528\u548c\u8ba1\u7b97\u3002 \u4f7f\u7528bin/gremlin-server.sh\u7136\u540e\u5728\u5916\u90e8Gremlin\u63a7\u5236\u53f0\u4f1a\u8bdd\u4e2d\u4f7f\u7528bin/gremlin.sh\u60a8\u53ef\u4ee5\u901a\u8fc7\u7ebf\u8def\u53d1\u9001Gremlin\u547d\u4ee4\uff1a :plugin use tinkerpop.server :remote connect tinkerpop.server conf/remote.yaml : g.addV() \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2aGremlin Server\u90fd\u5c06\u914d\u7f6e\u4e3a\u8fde\u63a5\u5230Cassandra\u96c6\u7fa4\u3002\u4ee5\u4e0b\u663e\u793a\u4e86Gremlin Server\u914d\u7f6e\u7684\u56fe\u5f62\u7279\u5b9a\u7247\u6bb5\u3002\u6709\u5173\u5b8c\u6574\u793a\u4f8b\u4ee5\u53ca\u6709\u5173\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u7b2c7\u7ae0JanusGraph Server\u3002 ... \u56fe\u8868\uff1a{ g\uff1aconf / janusgraph-cql.properties } scriptEngines\uff1a{ gremlin-groovy\uff1a{ \u63d2\u4ef6\uff1a{org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin\uff1a{}\uff0c org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin\uff1a{}\uff0c org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin\uff1a{}\uff0c org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin\uff1a{classImports\uff1a[java.lang.Math]\uff0cmethodImports\uff1a[java.lang.Math\uff03*]}\uff0c org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin\uff1a{files\uff1a[scripts / empty-sample.groovy]}}}} ... \u6709\u5173Gremlin Server\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Apache TinkerPop\u6587\u6863 18.6\u3002JanusGraph\u5d4c\u5165\u5f0f\u6a21\u5f0f \u6700\u540e\uff0c\u53ef\u4ee5\u5c06Cassandra\u5d4c\u5165\u5230JanusGraph\u4e2d\uff0c\u8fd9\u610f\u5473\u7740JanusGraph\u548cCassandra\u5728\u540c\u4e00\u4e2aJVM\u4e2d\u8fd0\u884c\uff0c\u5e76\u901a\u8fc7\u8fdb\u7a0b\u8c03\u7528\u800c\u4e0d\u662f\u901a\u8fc7\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u6d88\u9664\u4e86(\u53cd)\u5e8f\u5217\u5316\u548c\u7f51\u7edc\u534f\u8bae\u5f00\u9500\uff0c\u56e0\u6b64\u53ef\u4ee5\u5e26\u6765\u76f8\u5f53\u5927\u7684\u6027\u80fd\u6539\u8fdb\u3002\u5728\u8fd9\u79cd\u90e8\u7f72\u6a21\u5f0f\u4e0b\uff0cJanusGraph\u5185\u90e8\u542f\u52a8Cassandra\u5b88\u62a4\u8fdb\u7a0b\uff0cJanusGraphs\u4e0d\u518d\u8fde\u63a5\u5230\u73b0\u6709\u7684\u96c6\u7fa4\uff0c\u800c\u662f\u81ea\u5df1\u7684\u96c6\u7fa4\u3002 \u8981\u5728\u5d4c\u5165\u6a21\u5f0f\u4e0b\u4f7f\u7528JanusGraph\uff0c\u53ea\u9700\u914d\u7f6eembeddedcassandra\u4e3a\u5b58\u50a8\u540e\u7aef\u5373\u53ef\u3002\u4e0b\u9762\u5217\u51fa\u7684\u914d\u7f6e\u9009\u9879\u4e5f\u9002\u7528\u4e8e\u5d4c\u5165\u5f0fCassandra\u3002\u5728\u521b\u5efaJanusGraph\u96c6\u7fa4\u65f6\uff0c\u786e\u4fdd\u5404\u4e2a\u8282\u70b9\u53ef\u4ee5\u901a\u8fc7Gossip\u534f\u8bae\u76f8\u4e92\u53d1\u73b0\uff0c\u56e0\u6b64\u8bbe\u7f6e\u4e00\u4e2a\u5e26\u6709Cassandra\u5d4c\u5165\u5f0f\u96c6\u7fa4\u7684JanusGraph\uff0c\u5c31\u50cf\u72ec\u7acb\u7684Cassandra\u96c6\u7fa4\u4e00\u6837\u3002\u5728\u5d4c\u5165\u6a21\u5f0f\u4e0b\u8fd0\u884cJanusGraph\u65f6\uff0c\u4f7f\u7528\u9644\u52a0\u914d\u7f6e\u9009\u9879\u914d\u7f6eCassandra yaml\u6587\u4ef6storage.conf-file\uff0c\u8be5\u9009\u9879\u5c06yaml\u6587\u4ef6\u6307\u5b9a\u4e3a\u5b8c\u6574URL\uff0c\u4f8b\u5982storage.conf-file = file:///home/cassandra.yaml\u3002 \u5f53\u8fd0\u884c\u5d4c\u5165\u4e86JanusGraph\u548cCassandra\u7684\u96c6\u7fa4\u65f6\uff0c\u5efa\u8bae\u901a\u8fc7Gremlin Server\u516c\u5f00JanusGraph\uff0c\u4ee5\u4fbf\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u8fdc\u7a0b\u8fde\u63a5\u5230JanusGraph\u56fe\u6570\u636e\u5e93\u5e76\u6267\u884c\u67e5\u8be2\u3002 \u6ce8\u610f\uff0c\u8fd0\u884c\u5e26\u6709Cassandra\u7684JanusGraph\u9700\u8981\u8fdb\u884cGC\u8c03\u6574\u3002\u867d\u7136\u5d4c\u5165\u5f0fCassandra\u53ef\u4ee5\u63d0\u4f9b\u8f83\u4f4e\u5ef6\u8fdf\u7684\u67e5\u8be2\u5e94\u7b54\uff0c\u4f46\u5176\u8d1f\u8f7d\u4e0b\u7684GC\u884c\u4e3a\u66f4\u96be\u4ee5\u9884\u6d4b\u3002 18.7\u3002Cassandra\u7279\u5b9a\u914d\u7f6e \u6709\u5173\u9664\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\u5916\u7684\u6240\u6709Cassandra\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605\u7b2c15\u7ae0\uff0c\u914d\u7f6e\u53c2\u8003\u3002 \u914d\u7f6eCassandra\u65f6\uff0c\u5efa\u8bae\u8003\u8651\u4ee5\u4e0bCassandra\u7279\u5b9a\u914d\u7f6e\u9009\u9879\uff1a \u200b \u2022\u8bfb\u4e00\u81f4\u6027\u7ea7\u522b\uff1a\u8bfb\u53d6\u64cd\u4f5c\u7684Cassandra\u4e00\u81f4\u6027\u7ea7\u522b \u200b \u2022write-consistency-level\uff1a\u5199\u64cd\u4f5c\u7684Cassandra\u4e00\u81f4\u6027\u7ea7\u522b \u200b \u2022replication-factor\uff1a\u8981\u4f7f\u7528\u7684\u590d\u5236\u56e0\u5b50\u3002\u590d\u5236\u56e0\u5b50\u8d8a\u9ad8\uff0c\u56fe\u5f62\u6570\u636e\u5e93\u4ee5\u6570\u636e\u590d\u5236\u4e3a\u4ee3\u4ef7\u52a0\u5de5\u6545\u969c\u7684\u80fd\u529b\u5c31\u8d8a\u5f3a\u3002\u5e94\u4e3a\u751f\u4ea7\u7cfb\u7edf\u8986\u76d6\u9ed8\u8ba4\u503c\u4ee5\u786e\u4fdd\u7a33\u5065\u6027\u3002\u5efa\u8bae\u503c\u4e3a3\u3002\u53ea\u6709\u5728\u6700\u521d\u521b\u5efa\u5bc6\u94a5\u7a7a\u95f4\u65f6\u624d\u80fd\u8bbe\u7f6e\u6b64\u590d\u5236\u56e0\u5b50\u3002\u5728\u73b0\u6709\u952e\u7a7a\u95f4\u4e0a\uff0c\u5c06\u5ffd\u7565\u6b64\u503c\u3002 \u200b \u2022thrift.frame_size_mb\uff1athrift\u7528\u4e8e\u4f20\u8f93\u7684\u6700\u5927\u5e27\u5927\u5c0f\u3002\u68c0\u7d22\u975e\u5e38\u5927\u7684\u7ed3\u679c\u96c6\u65f6\u589e\u52a0\u6b64\u503c\u3002\u4ec5\u9002\u7528\u4e8estorage.backend = cassandrathrift \u200b \u2022keyspace\uff1a\u7528\u4e8e\u5b58\u50a8JanusGraph\u56fe\u7684\u952e\u7a7a\u95f4\u7684\u540d\u79f0\u3002\u5141\u8bb8\u591a\u4e2aJanusGraph\u56fe\u5728\u540c\u4e00\u4e2aCassandra\u96c6\u7fa4\u4e2d\u5171\u5b58\u3002 \u6709\u5173Cassandra\u4e00\u81f4\u6027\u7ea7\u522b\u548c\u53ef\u63a5\u53d7\u503c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605Cassandra Thrift API\u3002\u901a\u5e38\uff0c\u66f4\u9ad8\u7ea7\u522b\u66f4\u4e00\u81f4\u4e14\u66f4\u5065\u58ee\u4f46\u5177\u6709\u66f4\u9ad8\u7684\u5ef6\u8fdf\u3002 18.8\u3002\u5168\u5c40\u56fe\u64cd\u4f5c \u5728Cassandra\u4e0a\u7684JanusGraph\u652f\u6301\u5168\u5c40\u9876\u70b9\u548c\u8fb9\u7f18\u8fed\u4ee3\u3002\u4f46\u662f\uff0c\u8bf7\u6ce8\u610f\u6240\u6709\u8fd9\u4e9b\u9876\u70b9\u548c/\u6216\u8fb9\u5c06\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4OutOfMemoryException\u3002\u4f7f\u7528\u7b2c37\u7ae0\uff0cJanusGraph\u548cTinkerPop\u7684Hadoop-Gremlin\u6709\u6548\u5730\u8fed\u4ee3\u5927\u56fe\u4e2d\u7684\u6240\u6709\u9876\u70b9\u6216\u8fb9\u3002 18.9\u3002\u5728Amazon EC2\u4e0a\u90e8\u7f72 Amazon Elastic Compute Cloud\uff08Amazon EC2\uff09\u662f\u4e00\u79cdWeb\u670d\u52a1\uff0c\u53ef\u5728\u4e91\u4e2d\u63d0\u4f9b\u53ef\u8c03\u6574\u5927\u5c0f\u7684\u8ba1\u7b97\u5bb9\u91cf\u3002\u5b83\u65e8\u5728\u4f7f\u5f00\u53d1\u4eba\u5458\u66f4\u8f7b\u677e\u5730\u8fdb\u884cWeb\u89c4\u6a21\u8ba1\u7b97\u3002 \u200b \u6309\u7167\u4ee5\u4e0b\u6b65\u9aa4\u5728EC2\u4e0a\u8bbe\u7f6eCassandra\u96c6\u7fa4\uff0c\u5e76\u5728Cassandra\u4e0a\u90e8\u7f72JanusGraph\u3002\u8981\u9075\u5faa\u8fd9\u4e9b\u8bf4\u660e\uff0c\u60a8\u9700\u8981\u5177\u6709\u5df2\u5efa\u7acb\u7684\u8eab\u4efd\u9a8c\u8bc1\u51ed\u636e\u4ee5\u53caAWS\u548cEC2\u7684\u4e00\u4e9b\u57fa\u672c\u77e5\u8bc6\u7684Amazon AWS\u8d26\u6237\u3002 18.9.1\u3002\u8bbe\u7f6eCassandra\u96c6\u7fa4 \u200b \u8fd9\u4e9b\u7528\u4e8e\u914d\u7f6e\u548c\u542f\u52a8DataStax Cassandra Community Edition AMI\u7684\u8bf4\u660e\u57fa\u4e8eDataStax AMI Docs\uff0c\u5e76\u4fa7\u91cd\u4e8e\u4e0eJanusGraph\u90e8\u7f72\u76f8\u5173\u7684\u65b9\u9762\u3002 18.9.2\u3002\u8bbe\u7f6e\u5b89\u5168\u7ec4 \u200b \u2022\u5bfc\u822a\u5230EC2\u63a7\u5236\u53f0\u4eea\u8868\u677f\uff0c\u7136\u540e\u5355\u51fb\u201c\u7f51\u7edc\u548c\u5b89\u5168\u201d\u4e0b\u7684\u201c\u5b89\u5168\u7ec4\u201d\u3002 \u200b \u2022\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5b89\u5168\u7ec4\u3002\u5355\u51fb\u201c\u5165\u7ad9\u201d\u3002\u5c06\u201c\u521b\u5efa\u65b0\u89c4\u5219\u201d\u4e0b\u62c9\u83dc\u5355\u8bbe\u7f6e\u4e3a\u201c\u81ea\u5b9a\u4e49TCP\u89c4\u5219\u201d\u3002\u4ece\u6e900.0.0.0/0\u6dfb\u52a0\u7aef\u53e322\u7684\u89c4\u5219\u3002\u4ece\u5b89\u5168\u7ec4\u6210\u5458\u6dfb\u52a0\u7aef\u53e31024-65535\u7684\u89c4\u5219\u3002\u5982\u679c\u60a8\u4e0d\u60f3\u5728\u5b89\u5168\u7ec4\u6210\u5458\u4e4b\u95f4\u6253\u5f00\u6240\u6709\u975e\u7279\u6743\u7aef\u53e3\uff0c\u5219\u81f3\u5c11\u5728\u5b89\u5168\u7ec4\u6210\u5458\u4e2d\u6253\u5f007000,7199\u548c9160\u3002\u63d0\u793a\uff1a\u4e00\u65e6\u5728\u6846\u4e2d\u8f93\u5165\u201csg\u201d\uff0c\u201cSource\u201d\u4e0b\u62c9\u5217\u8868\u5c06\u81ea\u52a8\u5b8c\u6210\u5b89\u5168\u7ec4\u6807\u8bc6\u7b26\uff0c\u56e0\u6b64\u60a8\u65e0\u9700\u4e8b\u5148\u51c6\u5907\u597d\u51c6\u786e\u7684\u503c\u3002 18.9.3\u3002\u542f\u52a8DataStax Cassandra AMI \u200b \u2022\u201c \u5728\u6240\u9700\u533a\u57df\u4e2d\u542f\u52a8DataStax AMI \u200b \u2022\u5728\u201c\u8bf7\u6c42\u5b9e\u4f8b\u5411\u5bfc\u201d\u7684\u201c\u5b9e\u4f8b\u8be6\u7ec6\u4fe1\u606f\u201d\u9875\u9762\u4e0a\uff0c\u5c06\u201c\u5b9e\u4f8b\u6570\u201d\u8bbe\u7f6e\u4e3a\u6240\u9700\u7684Cassandra\u8282\u70b9\u6570\u3002\u5c06\u201c\u5b9e\u4f8b\u7c7b\u578b\u201d\u8bbe\u7f6e\u4e3a\u81f3\u5c11m1.large\u3002\u6211\u4eec\u5efa\u8bae\u4f7f\u7528m1.large\u3002 \u200b \u2022\u5728\u201c\u8bf7\u6c42\u5b9e\u4f8b\u5411\u5bfc\u201d\u7684\u201c\u9ad8\u7ea7\u5b9e\u4f8b\u9009\u9879\u201d\u9875\u9762\u4e0a\uff0c\u8bbe\u7f6e\u201c\u7528\u6237\u6570\u636e\u201d\u4e0b\u7684\u201c\u4f5c\u4e3a\u6587\u672c\u201d\u5355\u9009\u6309\u94ae\uff0c\u7136\u540e\u5c06\u5176\u586b\u5165\u6587\u672c\u6846\uff1a --clustername [cassandra-cluster-name] \u200b --totalnodes [number-of-instances] \u200b --version community \u200b --opscenter no \u200b \u6b64\u914d\u7f6e\u4e2d\u7684[number-of-instances]\u5fc5\u987b\u4e0e\u4e0a\u4e00\u4e2a\u5411\u5bfc\u9875\u9762\u4e0a\u914d\u7f6e\u7684EC2\u5b9e\u4f8b\u6570\u76f8\u5339\u914d\u3002[cassandra-cluster-name]\u53ef\u4ee5\u662f\u7528\u4e8e\u6807\u8bc6\u7684\u4efb\u4f55\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff1a \u200b --clustername janusgraph \u200b --totalnodes 4 \u200b --version community \u200b --opscenter no \u200b \u5728\u201c\u8bf7\u6c42\u5b9e\u4f8b\u5411\u5bfc\u201d\u7684\u201c\u6807\u7b7e\u201d\u9875\u9762\u4e0a\uff0c\u60a8\u53ef\u4ee5\u5e94\u7528\u4efb\u4f55\u6240\u9700\u7684\u914d\u7f6e\u3002\u8fd9\u4e9b\u6807\u8bb0\u4ec5\u5b58\u5728\u4e8eEC2\u7ba1\u7406\u7ea7\u522b\uff0c\u5bf9Cassandra\u5b88\u62a4\u7a0b\u5e8f\u7684\u914d\u7f6e\u6216\u64cd\u4f5c\u6ca1\u6709\u5f71\u54cd\u3002 \u200b \u5728\u201c\u8bf7\u6c42\u5b9e\u4f8b\u5411\u5bfc\u201d\u7684\u201c\u521b\u5efa\u5bc6\u94a5\u5bf9\u201d\u9875\u9762\u4e0a\uff0c\u9009\u62e9\u73b0\u6709\u5bc6\u94a5\u5bf9\u6216\u521b\u5efa\u65b0\u5bc6\u94a5\u5bf9\u3002\u5305\u542b\u6240\u9009\u5bc6\u94a5\u5bf9\u7684\u79c1\u6709\u4e00\u534a\u7684PEM\u6587\u4ef6\u5c06\u9700\u8981\u8fde\u63a5\u5230\u8fd9\u4e9b\u5b9e\u4f8b\u3002 \u200b \u5728\u201c\u8bf7\u6c42\u5b9e\u4f8b\u5411\u5bfc\u201d\u7684\u201c\u914d\u7f6e\u9632\u706b\u5899\u201d\u9875\u9762\u4e0a\uff0c\u9009\u62e9\u5148\u524d\u521b\u5efa\u7684\u5b89\u5168\u7ec4\u3002 \u200b \u5728\u6700\u7ec8\u5411\u5bfc\u9875\u9762\u4e0a\u67e5\u770b\u5e76\u542f\u52a8\u5b9e\u4f8b\u3002 18.9.4\u3002\u9a8c\u8bc1\u6210\u529f\u542f\u52a8\u5b9e\u4f8b \u200b \u2022SSH\u5230\u4efb\u4f55Cassandra\u5b9e\u4f8b\u8282\u70b9\uff1a ssh -i [your-private-key].pem ubuntu@[public-dns-name-of-any-cassandra-instance] \u200b \u2022\u8fd0\u884cCassandra nodetool nodetool -h 127.0.0.1 ring\u4ee5\u68c0\u67e5Cassandra\u4ee4\u724c\u73af\u7684\u72b6\u6001\u3002\u60a8\u5e94\u8be5\u5728\u6b64\u547d\u4ee4\u7684\u8f93\u51fa\u4e2d\u770b\u5230\u4e0e\u524d\u9762\u6b65\u9aa4\u4e2d\u542f\u52a8\u7684\u5b9e\u4f8b\u4e00\u6837\u591a\u7684\u8282\u70b9\u3002 \u200b \u8bf7\u6ce8\u610f\uff0cAMI\u9700\u8981\u51e0\u5206\u949f\u6765\u914d\u7f6e\u6bcf\u4e2a\u5b9e\u4f8b\u3002\u5f53\u60a8\u901a\u8fc7SSH\u8fde\u63a5\u5230\u5b9e\u4f8b\u65f6\uff0c\u5c06\u5728\u6210\u529f\u914d\u7f6e\u65f6\u663e\u793ashell\u63d0\u793a\u7b26\u3002 18.9.5. \u542f\u52a8JanusGraph\u5b9e\u4f8b \u200b \u542f\u52a8\u5176\u4ed6EC2\u5b9e\u4f8b\u4ee5\u8fd0\u884cJanusGraph\uff0c\u5b83\u4eec\u5728\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f\u6216\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f\u4e0b\u914d\u7f6e\u4e3aGremlin-Server\uff0c\u5982\u4e0a\u6240\u8ff0\u3002\u60a8\u53ea\u9700\u8bb0\u4e0b\u5176\u4e2d\u4e00\u4e2aCassandra\u96c6\u7fa4\u5b9e\u4f8b\u7684IP\u5730\u5740\uff0c\u5e76\u5c06\u5176\u914d\u7f6e\u4e3a\u4e3b\u673a\u540d\u3002\u8981\u8fd0\u884c\u7684\u7279\u5b9aEC2\u5b9e\u4f8b\u548c\u7279\u5b9a\u914d\u7f6e\u53d6\u51b3\u4e8e\u60a8\u7684\u7528\u4f8b\u3002 18.9.6. Amazon Linux AMI\u4e0a\u7684JanusGraph\u5b9e\u4f8b\u793a\u4f8b \u200b \u2022\u5728Cassandra\u96c6\u7fa4\u7684\u540c\u4e00\u533a\u57df\u4e2d\u542f\u52a8Amazon Linux AMI\u3002\u6839\u636e\u6240\u9700\u7684\u8d44\u6e90\u91cf\u9009\u62e9\u6240\u9700\u7684EC2\u5b9e\u4f8b\u7c7b\u578b\u3002\u4f7f\u7528\u9ed8\u8ba4\u914d\u7f6e\u9009\u9879\uff0c\u5e76\u9009\u62e9\u4e0e\u4e0a\u4e00\u6b65\u4e2d\u914d\u7f6e\u7684Cassandra\u7fa4\u96c6\u76f8\u540c\u7684\u5bc6\u94a5\u5bf9\u548c\u5b89\u5168\u7ec4\u3002 \u200b \u2022\u901a\u8fc7SSH\u8fdb\u5165\u65b0\u521b\u5efa\u7684\u5b9e\u4f8bssh -i [your-private-key].pem ec2-user@[public-dns-name-of-the-instance]\u3002\u60a8\u53ef\u80fd\u9700\u8981\u7b49\u5f85\u4e00\u4e9b\u5b9e\u4f8b\u624d\u80fd\u542f\u52a8\u3002 \u200b \u2022\u4e0b\u8f7d\u5f53\u524d\u7684JanusGraph\u53d1\u884c\u7248\uff0cwget\u5e76\u5c06\u672c\u5730\u5b58\u6863\u89e3\u538b\u7f29\u5230\u4e3b\u76ee\u5f55\u3002\u542f\u52a8Gremlin\u63a7\u5236\u53f0\u4ee5\u9a8c\u8bc1JanusGraph\u662f\u5426\u6210\u529f\u8fd0\u884c\u3002\u6709\u5173\u5982\u4f55\u89e3\u538b\u7f29JanusGraph\u5e76\u542f\u52a8Gremlin\u63a7\u5236\u53f0\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c \u5165\u95e8\u6307\u5357\u201d \u200b \u2022\u4f7f\u7528vi janusgraph.properties\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u884c\u521b\u5efa\u914d\u7f6e\u6587\u4ef6:: storage.backend = cql storage.hostname = [IP-address-of-one-Cassandra-EC2-instance] \u60a8\u53ef\u4ee5\u6dfb\u52a0\u6b64\u9875\u9762\u6216\u7b2c15\u7ae0\u201c \u914d\u7f6e\u53c2\u8003\u201d\u4e2d\u7684\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u3002 \u518d\u6b21\u542f\u52a8Gremlin\u63a7\u5236\u53f0\u5e76\u952e\u5165\u4ee5\u4e0b\u5185\u5bb9:: gremlin graph = JanusGraphFactory.open\uff08'janusgraph.properties'\uff09 == janusgraph [CQL\uff1a[IP-address-of-one-Cassandra-EC2-instance] \u60a8\u5df2\u6210\u529f\u5c06\u6b64JanusGraph\u5b9e\u4f8b\u8fde\u63a5\u5230Cassandra\u96c6\u7fa4\uff0c\u5e76\u4e14\u53ef\u4ee5\u5f00\u59cb\u5728\u56fe\u8868\u4e0a\u8fd0\u884c\u3002 18.9.7. \u4eceEC2\u5916\u90e8\u8fde\u63a5\u5230EC2\u4e2d\u7684Cassandra\u96c6\u7fa4 \u5728\u5b89\u5168\u7ec4\u4e2d\u6253\u5f00\u901a\u5e38\u7684Cassandra\u7aef\u53e3\uff089160,7000,7199\uff09\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3aCassandra\u8282\u70b9\u9ed8\u8ba4\u5e7f\u64ad\u4ed6\u4eec\u7684ec2\u5185\u90e8IP\uff0c\u800c\u4e0d\u662f\u4ed6\u4eec\u9762\u5411\u516c\u4f17\u7684IP\u3002 \u7531\u6b64\u4ea7\u751f\u7684\u884c\u4e3a\u662f\uff0c\u60a8\u53ef\u4ee5\u901a\u8fc7\u8fde\u63a5\u5230\u4efb\u4f55Cassandra\u8282\u70b9\u4e0a\u7684\u7aef\u53e39160\u5728\u7fa4\u96c6\u4e0a\u6253\u5f00JanusGraph\u56fe\uff0c\u4f46\u662f\u5bf9\u8be5\u56fe\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u4f1a\u8d85\u65f6\u3002\u8fd9\u662f\u56e0\u4e3aCassandra\u544a\u8bc9\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u65e0\u6cd5\u8bbf\u95ee\u7684IP\u3002 \u8981\u89e3\u51b3\u6b64\u95ee\u9898\uff0c\u8bf7\u5c06/etc/cassandra/cassandra.yaml\u4e2d\u6bcf\u4e2a\u5b9e\u4f8b\u7684\u201cbroadcast-address\u201d\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u9762\u5411\u516c\u4f17\u7684IP\uff0c\u7136\u540e\u91cd\u65b0\u542f\u52a8\u5b9e\u4f8b\u3002\u5bf9\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u8282\u70b9\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u7fa4\u96c6\u8fd4\u56de\u540e\uff0cnodetool\u4f1a\u62a5\u544a\u5141\u8bb8\u6765\u81ea\u672c\u5730\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u7684\u6b63\u786e\u7684\u9762\u5411\u516c\u4f17\u7684IP\u3002 \u66f4\u6539\u201c\u5e7f\u64ad\u5730\u5740\u201d\u5c5e\u6027\u5141\u8bb8\u60a8\u4eceec2\u5916\u90e8\u8fde\u63a5\u5230\u7fa4\u96c6\uff0c\u4f46\u8fd9\u4e5f\u53ef\u80fd\u610f\u5473\u7740\u6e90\u81eaec2\u7684\u6d41\u91cf\u5fc5\u987b\u5728\u5230\u8fbe\u7fa4\u96c6\u4e4b\u524d\u5f80\u8fd4\u4e92\u8054\u7f51\u5e76\u8fd4\u56de\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4ec5\u5bf9\u5f00\u53d1\u548c\u6d4b\u8bd5\u6709\u7528\u3002","title":"18.Apache Cassandra"},{"location":"storage_backend/apache_hbase/","text":"\u7b2c19\u7ae0Apache HBase Apache hbase\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u3001\u5206\u5e03\u5f0f\u7684\u3001\u7248\u672c\u5316\u7684\u3001\u975e\u5173\u7cfb\u6570\u636e\u5e93\u3002\u6b63\u5982BigTable\u5229\u7528Google\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\u4e00\u6837\uff0cApacheHBASE\u5728Hadoop\u548cHDFS\u4e4b\u4e0a\u63d0\u4f9b\u4e86\u7c7b\u4f3cBigTable\u7684\u529f\u80fd\u3002 19.1. HBase\u8bbe\u7f6e \u4ee5\u4e0b\u90e8\u5206\u6982\u8ff0\u4e86JanusGraph\u4e0eApache HBase\u534f\u540c\u4f7f\u7528\u7684\u5404\u79cd\u65b9\u5f0f\u3002 19.1.1. \u672c\u5730\u670d\u52a1\u5668\u6a21\u5f0f HBase\u53ef\u4ee5\u4f5c\u4e3a\u72ec\u7acb\u6570\u636e\u5e93\u5728\u4e0eJanusGraph\u548c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u76f8\u540c\u7684\u672c\u5730\u4e3b\u673a\u4e0a\u8fd0\u884c\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0cJanusGraph\u548cHBase\u901a\u8fc7 localhost \u5957\u63a5\u5b57\u76f8\u4e92\u901a\u4fe1\u3002\u5728HBase\u4e0a\u8fd0\u884cJanusGraph\u9700\u8981\u4ee5\u4e0b\u8bbe\u7f6e\u6b65\u9aa4\uff1a \u00b7 \u4ece http://www.apache.org/dyn/closer.cgi/hbase/stable/ \u4e0b\u8f7d\u5e76\u63d0\u53d6\u7a33\u5b9a\u7684HBase \u3002 \u00b7 \u901a\u8fc7\u8c03\u7528\u89e3\u538b\u7f29\u7684HBase\u76ee\u5f55 start-hbase.sh \u4e2d\u7684 bin \u76ee\u5f55\u4e2d\u7684\u811a\u672c\u6765\u542f\u52a8HBase \u3002\u8981\u505c\u6b62HBase\uff0c\u8bf7\u4f7f\u7528 stop-hbase.sh \u3002 $ ./bin/start-hbase.sh starting master, logging to ../logs/hbase-master-machine-name.local.out now\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aHBASE\u7b80\u56fe\uff0c\u5982\u4e0b\u6240\u793a\uff1a JanusGraph graph = JanusGraphFactory.build() .set( storage.backend , hbase ) .open(); \u8bf7\u6ce8\u610f\uff0c\u7531\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c1d\u8bd5\u4f7f\u7528localhost\u8fde\u63a5\uff0c\u56e0\u6b64\u60a8\u65e0\u9700\u6307\u5b9a\u4e3b\u673a\u540d\u3002\u6b64\u5916\uff0c\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002 19.1.2\u3002\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f \u5f53\u56fe\u5f62\u9700\u8981\u8d85\u51fa\u5355\u4e2a\u673a\u5668\u7684\u8303\u56f4\u65f6\uff0cHBase\u548cJanusGraph\u5728\u903b\u8f91\u4e0a\u5206\u6210\u4e0d\u540c\u7684\u673a\u5668\u3002\u5728\u6b64\u6a21\u578b\u4e2d\uff0cHBase\u96c6\u7fa4\u7ef4\u62a4\u56fe\u5f62\u8868\u793a\uff0c\u5e76\u4e14\u4efb\u610f\u6570\u91cf\u7684JanusGraph\u5b9e\u4f8b\u90fd\u7ef4\u62a4\u5bf9HBase\u96c6\u7fa4\u7684\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u8bfb/\u5199\u8bbf\u95ee\u3002\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u76f4\u63a5\u4e0eJanusGraph\u4ea4\u4e92\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u8fd0\u884c\u7684HBase\u96c6\u7fa4\uff0c\u5176ZooKeeper\u4ef2\u88c1\u7531IP\u5730\u5740\u4e3a77.77.77.77,77.77.77.78\u548c77.77.77.79\u7684\u4e09\u53f0\u673a\u5668\u7ec4\u6210\uff0c\u7136\u540e\u5c06JanusGraph\u4e0e\u96c6\u7fa4\u8fde\u63a5\u5982\u4e0b\uff1a JanusGraph g = JanusGraphFactory.build() .set( storage.backend , hbase ) .set( storage.hostname , 77.77.77.77, 77.77.77.78, 77.77.77.79 ) .open(); storage.hostname \u63a5\u53d7\u4ee5\u9017\u53f7\u5206\u9694\u7684IP\u5730\u5740\u5217\u8868\u4ee5\u53caJanusGraph\u5e94\u8fde\u63a5\u7684HBase\u96c6\u7fa4\u4e2d\u4efb\u4f55\u673a\u5668\u5b50\u96c6\u7684\u4e3b\u673a\u540d\u3002\u6b64\u5916\uff0c\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002 19.1.3\u3002\u4f7f\u7528Gremlin Server\u7684\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f \u6700\u540e\uff0cGremlin Server\u53ef\u4ee5\u5305\u88c5\u5728\u524d\u4e00\u5c0f\u8282\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2aJanusGraph\u5b9e\u4f8b\u4e0a\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5fc5\u662f\u57fa\u4e8eJava\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u5ba2\u6237\u7aef\u4e0eGremlin Server\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u975e\u5e38\u9002\u7528\u4e8e\u591a\u8bed\u8a00\u4f53\u7cfb\u7ed3\u6784\uff0c\u5176\u4e2d\u4f7f\u7528\u4e0d\u540c\u8bed\u8a00\u7f16\u5199\u7684\u5404\u79cd\u7ec4\u4ef6\u9700\u8981\u5728\u56fe\u5f62\u4e0a\u8fdb\u884c\u5f15\u7528\u548c\u8ba1\u7b97\u3002 http://gremlin-server.janusgraph.machine1/mygraph/vertices/1 http://gremlin-server.janusgraph.machine2/mygraph/tp/gremlin?script=g.v(1).out('follows').out('created') \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2aGremlin Server\u90fd\u5c06\u914d\u7f6e\u4e3a\u8fde\u63a5\u5230HBase\u96c6\u7fa4\u3002\u4ee5\u4e0b\u663e\u793a\u4e86Gremlin Server\u914d\u7f6e\u7684\u56fe\u5f62\u7279\u5b9a\u7247\u6bb5\u3002\u6709\u5173\u5b8c\u6574\u793a\u4f8b\u4ee5\u53ca\u6709\u5173\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u4fe1\u606f \uff0c \u8bf7\u53c2\u9605 \u7b2c7\u7ae0 JanusGraph Server \u3002 ... graphs: { g: conf/janusgraph-hbase.properties } scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} ... ... 19.2\u3002HBase\u7279\u5b9a\u914d\u7f6e \u6709\u5173\u9664\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\u5916\u7684\u6240\u6709HBase\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 \u914d\u7f6eHBase\u65f6\uff0c\u5efa\u8bae\u8003\u8651\u4ee5\u4e0bHBase\u7279\u5b9a\u914d\u7f6e\u9009\u9879\uff1a \u00b7 storage.hbase.table \uff1a\u7528\u4e8e\u5b58\u50a8JanusGraph\u56fe\u7684HBase\u8868\u7684\u540d\u79f0\u3002\u5141\u8bb8\u591a\u4e2aJanusGraph\u56fe\u5728\u540c\u4e00HBase\u96c6\u7fa4\u4e2d\u5171\u5b58\u3002 \u6709\u5173\u66f4\u591aHBase\u914d\u7f6e\u9009\u9879\u53ca\u5176\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 HBase\u914d\u7f6e\u6587\u6863 \u3002\u901a\u8fc7 storage.hbase.ext \u5728JanusGraph\u914d\u7f6e\u4e2d\u4e3a\u76f8\u5e94\u7684HBase\u914d\u7f6e\u9009\u9879\u6dfb\u52a0\u524d\u7f00\uff0c\u5b83\u5c06\u5728\u521d\u59cb\u5316\u65f6\u4f20\u9012\u7ed9HBase\u3002\u4f8b\u5982\uff0c\u8981\u4e3aHBase\u4f7f\u7528znode / hbase-secure\uff0c\u8bf7\u8bbe\u7f6e\u5c5e\u6027\uff1a storage.hbase.ext.zookeeper.znode.parent=/hbase-secure \u3002\u524d\u7f00\u5141\u8bb8\u901a\u8fc7JanusGraph\u914d\u7f6e\u4efb\u610fHBase\u914d\u7f6e\u9009\u9879\u3002 \u91cd\u8981\uff1a HBase\u540e\u7aef\u4f7f\u7528\u6beb\u79d2\u6765\u8868\u793a\u65f6\u95f4\u6233\u3002\u5728JanusGraph 0.2.0\u53ca\u66f4\u65e9\u7248\u672c\u4e2d\uff0c\u5982\u679cgraph.timestamps\u672a\u660e\u786e\u8bbe\u7f6e\u8be5\u5c5e\u6027\uff0c\u5219\u9ed8\u8ba4\u4e3aMICRO\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cgraph.timestamps\u5fc5\u987b\u5c06\u5c5e\u6027\u663e\u5f0f\u8bbe\u7f6e\u4e3aMILLI\u3002graph.timestamps\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u4e0d\u8981\u5c06\u8be5\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u5176\u4ed6\u503c\u3002 19.3\u3002\u5168\u5c40\u56fe\u64cd\u4f5c HBus\u4e0a\u7684JanusGraph\u652f\u6301\u5168\u5c40\u9876\u70b9\u548c\u8fb9\u7f18\u8fed\u4ee3\u3002\u4f46\u662f\uff0c\u8bf7\u6ce8\u610f\u6240\u6709\u8fd9\u4e9b\u9876\u70b9\u548c/\u6216\u8fb9\u5c06\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4 OutOfMemoryException \u3002\u4f7f\u7528 \u7b2c37\u7ae0\uff0c JanusGraph \u548cTinkerPop \u7684Hadoop-Gremlin \u5730\u8fed\u4ee3\u5927\u56fe\u4e2d\u7684\u6240\u6709\u9876\u70b9\u6216\u8fb9\u3002 19.4\u3002\u7ba1\u7406HBase\u7fa4\u96c6\u7684\u63d0\u793a\u548c\u6280\u5de7 \u5728 HBase shell \u5728\u4e3b\u670d\u52a1\u5668\u4e0a\uff0c\u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u96c6\u7fa4\u7684\u6574\u4f53\u72b6\u6001\u68c0\u67e5\u3002 $HBASE_HOME/bin/hbase shell \u4eceshell\u4e2d\uff0c\u4ee5\u4e0b\u547d\u4ee4\u5bf9\u4e8e\u7406\u89e3\u96c6\u7fa4\u7684\u72b6\u6001\u901a\u5e38\u662f\u6709\u7528\u7684\u3002 status 'janusgraph' status 'simple' status 'detailed' \u4e0a\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u8bc6\u522b\u67d0\u4e2a\u533a\u57df\u670d\u52a1\u5668\u662f\u5426\u5df2\u7ecf\u6545\u969c\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u5c31\u6709\u53ef\u80fd ssh \u8fdb\u5165\u5931\u8d25\u7684\u533a\u57df\u670d\u52a1\u5668\u673a\u5668\u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop regionserver sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start regionserver \u4f7f\u7528 PSSH \u53ef\u4ee5\u7b80\u5316\u6b64\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u5355\u72ec\u767b\u5f55\u6bcf\u53f0\u673a\u5668\u6765\u8fd0\u884c\u547d\u4ee4\u3002\u5c06\u533a\u57df\u670d\u52a1\u5668\u7684IP\u5730\u5740\u653e\u5165 hosts.txt \u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u3002 pssh -h host.txt sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop regionserver pssh -h host.txt sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start regionserver \u63a5\u4e0b\u6765\uff0c\u6709\u65f6\u9700\u8981\u91cd\u65b0\u542f\u52a8\u4e3b\u670d\u52a1\u5668(\u4f8b\u5982\uff0c\u62d2\u7edd\u8fde\u63a5\u7684\u5f02\u5e38)\u3002\u4e3a\u6b64\uff0c\u5728\u4e3b\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop master sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start master \u6700\u540e\uff0c\u5982\u679c\u5df2\u7ecf\u90e8\u7f72\u4e86HBASE\u96c6\u7fa4\uff0c\u5e76\u4e14\u4e3b\u670d\u52a1\u5668\u6216\u533a\u57df\u670d\u52a1\u5668\u9700\u8981\u66f4\u591a\u5185\u5b58\uff0c\u53ea\u9700\u7f16\u8f91 $HBASE_HOME/conf/hbase-env.sh \u76f8\u5173\u673a\u5668\u4e0a\u7684\u6587\u4ef6 -Xmx -Xms \u53c2\u6570\u3002\u7f16\u8f91\u5b8c\u540e\uff0c\u5982\u524d\u9762\u6240\u8ff0\uff0c\u505c\u6b62/\u542f\u52a8\u4e3b\u670d\u52a1\u5668\u548c/\u6216\u533a\u57df\u670d\u52a1\u5668\u3002","title":"19.Apache Hbase"},{"location":"storage_backend/apache_hbase/#19apache-hbase","text":"Apache hbase\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u3001\u5206\u5e03\u5f0f\u7684\u3001\u7248\u672c\u5316\u7684\u3001\u975e\u5173\u7cfb\u6570\u636e\u5e93\u3002\u6b63\u5982BigTable\u5229\u7528Google\u6587\u4ef6\u7cfb\u7edf\u63d0\u4f9b\u7684\u5206\u5e03\u5f0f\u6570\u636e\u5b58\u50a8\u4e00\u6837\uff0cApacheHBASE\u5728Hadoop\u548cHDFS\u4e4b\u4e0a\u63d0\u4f9b\u4e86\u7c7b\u4f3cBigTable\u7684\u529f\u80fd\u3002","title":"\u7b2c19\u7ae0Apache HBase"},{"location":"storage_backend/apache_hbase/#191-hbase","text":"\u4ee5\u4e0b\u90e8\u5206\u6982\u8ff0\u4e86JanusGraph\u4e0eApache HBase\u534f\u540c\u4f7f\u7528\u7684\u5404\u79cd\u65b9\u5f0f\u3002","title":"19.1. HBase\u8bbe\u7f6e"},{"location":"storage_backend/apache_hbase/#1911","text":"HBase\u53ef\u4ee5\u4f5c\u4e3a\u72ec\u7acb\u6570\u636e\u5e93\u5728\u4e0eJanusGraph\u548c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u76f8\u540c\u7684\u672c\u5730\u4e3b\u673a\u4e0a\u8fd0\u884c\u3002\u5728\u8fd9\u4e2a\u6a21\u578b\u4e2d\uff0cJanusGraph\u548cHBase\u901a\u8fc7 localhost \u5957\u63a5\u5b57\u76f8\u4e92\u901a\u4fe1\u3002\u5728HBase\u4e0a\u8fd0\u884cJanusGraph\u9700\u8981\u4ee5\u4e0b\u8bbe\u7f6e\u6b65\u9aa4\uff1a \u00b7 \u4ece http://www.apache.org/dyn/closer.cgi/hbase/stable/ \u4e0b\u8f7d\u5e76\u63d0\u53d6\u7a33\u5b9a\u7684HBase \u3002 \u00b7 \u901a\u8fc7\u8c03\u7528\u89e3\u538b\u7f29\u7684HBase\u76ee\u5f55 start-hbase.sh \u4e2d\u7684 bin \u76ee\u5f55\u4e2d\u7684\u811a\u672c\u6765\u542f\u52a8HBase \u3002\u8981\u505c\u6b62HBase\uff0c\u8bf7\u4f7f\u7528 stop-hbase.sh \u3002 $ ./bin/start-hbase.sh starting master, logging to ../logs/hbase-master-machine-name.local.out now\uff0c\u60a8\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2aHBASE\u7b80\u56fe\uff0c\u5982\u4e0b\u6240\u793a\uff1a JanusGraph graph = JanusGraphFactory.build() .set( storage.backend , hbase ) .open(); \u8bf7\u6ce8\u610f\uff0c\u7531\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c1d\u8bd5\u4f7f\u7528localhost\u8fde\u63a5\uff0c\u56e0\u6b64\u60a8\u65e0\u9700\u6307\u5b9a\u4e3b\u673a\u540d\u3002\u6b64\u5916\uff0c\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002","title":"19.1.1. \u672c\u5730\u670d\u52a1\u5668\u6a21\u5f0f"},{"location":"storage_backend/apache_hbase/#1912","text":"\u5f53\u56fe\u5f62\u9700\u8981\u8d85\u51fa\u5355\u4e2a\u673a\u5668\u7684\u8303\u56f4\u65f6\uff0cHBase\u548cJanusGraph\u5728\u903b\u8f91\u4e0a\u5206\u6210\u4e0d\u540c\u7684\u673a\u5668\u3002\u5728\u6b64\u6a21\u578b\u4e2d\uff0cHBase\u96c6\u7fa4\u7ef4\u62a4\u56fe\u5f62\u8868\u793a\uff0c\u5e76\u4e14\u4efb\u610f\u6570\u91cf\u7684JanusGraph\u5b9e\u4f8b\u90fd\u7ef4\u62a4\u5bf9HBase\u96c6\u7fa4\u7684\u57fa\u4e8e\u5957\u63a5\u5b57\u7684\u8bfb/\u5199\u8bbf\u95ee\u3002\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u76f4\u63a5\u4e0eJanusGraph\u4ea4\u4e92\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u8fd0\u884c\u7684HBase\u96c6\u7fa4\uff0c\u5176ZooKeeper\u4ef2\u88c1\u7531IP\u5730\u5740\u4e3a77.77.77.77,77.77.77.78\u548c77.77.77.79\u7684\u4e09\u53f0\u673a\u5668\u7ec4\u6210\uff0c\u7136\u540e\u5c06JanusGraph\u4e0e\u96c6\u7fa4\u8fde\u63a5\u5982\u4e0b\uff1a JanusGraph g = JanusGraphFactory.build() .set( storage.backend , hbase ) .set( storage.hostname , 77.77.77.77, 77.77.77.78, 77.77.77.79 ) .open(); storage.hostname \u63a5\u53d7\u4ee5\u9017\u53f7\u5206\u9694\u7684IP\u5730\u5740\u5217\u8868\u4ee5\u53caJanusGraph\u5e94\u8fde\u63a5\u7684HBase\u96c6\u7fa4\u4e2d\u4efb\u4f55\u673a\u5668\u5b50\u96c6\u7684\u4e3b\u673a\u540d\u3002\u6b64\u5916\uff0c\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002","title":"19.1.2\u3002\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f"},{"location":"storage_backend/apache_hbase/#1913gremlin-server","text":"\u6700\u540e\uff0cGremlin Server\u53ef\u4ee5\u5305\u88c5\u5728\u524d\u4e00\u5c0f\u8282\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2aJanusGraph\u5b9e\u4f8b\u4e0a\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6700\u7ec8\u7528\u6237\u5e94\u7528\u7a0b\u5e8f\u4e0d\u5fc5\u662f\u57fa\u4e8eJava\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4f5c\u4e3a\u5ba2\u6237\u7aef\u4e0eGremlin Server\u8fdb\u884c\u901a\u4fe1\u3002\u8fd9\u79cd\u7c7b\u578b\u7684\u90e8\u7f72\u975e\u5e38\u9002\u7528\u4e8e\u591a\u8bed\u8a00\u4f53\u7cfb\u7ed3\u6784\uff0c\u5176\u4e2d\u4f7f\u7528\u4e0d\u540c\u8bed\u8a00\u7f16\u5199\u7684\u5404\u79cd\u7ec4\u4ef6\u9700\u8981\u5728\u56fe\u5f62\u4e0a\u8fdb\u884c\u5f15\u7528\u548c\u8ba1\u7b97\u3002 http://gremlin-server.janusgraph.machine1/mygraph/vertices/1 http://gremlin-server.janusgraph.machine2/mygraph/tp/gremlin?script=g.v(1).out('follows').out('created') \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2aGremlin Server\u90fd\u5c06\u914d\u7f6e\u4e3a\u8fde\u63a5\u5230HBase\u96c6\u7fa4\u3002\u4ee5\u4e0b\u663e\u793a\u4e86Gremlin Server\u914d\u7f6e\u7684\u56fe\u5f62\u7279\u5b9a\u7247\u6bb5\u3002\u6709\u5173\u5b8c\u6574\u793a\u4f8b\u4ee5\u53ca\u6709\u5173\u5982\u4f55\u914d\u7f6e\u670d\u52a1\u5668\u7684\u8be6\u7ec6\u4fe1\u606f \uff0c \u8bf7\u53c2\u9605 \u7b2c7\u7ae0 JanusGraph Server \u3002 ... graphs: { g: conf/janusgraph-hbase.properties } scriptEngines: { gremlin-groovy: { plugins: { org.janusgraph.graphdb.tinkerpop.plugin.JanusGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {}, org.apache.tinkerpop.gremlin.tinkergraph.jsr223.TinkerGraphGremlinPlugin: {}, org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]}, org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [scripts/empty-sample.groovy]}}}} ... ...","title":"19.1.3\u3002\u4f7f\u7528Gremlin Server\u7684\u8fdc\u7a0b\u670d\u52a1\u5668\u6a21\u5f0f"},{"location":"storage_backend/apache_hbase/#192hbase","text":"\u6709\u5173\u9664\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\u5916\u7684\u6240\u6709HBase\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 \u914d\u7f6eHBase\u65f6\uff0c\u5efa\u8bae\u8003\u8651\u4ee5\u4e0bHBase\u7279\u5b9a\u914d\u7f6e\u9009\u9879\uff1a \u00b7 storage.hbase.table \uff1a\u7528\u4e8e\u5b58\u50a8JanusGraph\u56fe\u7684HBase\u8868\u7684\u540d\u79f0\u3002\u5141\u8bb8\u591a\u4e2aJanusGraph\u56fe\u5728\u540c\u4e00HBase\u96c6\u7fa4\u4e2d\u5171\u5b58\u3002 \u6709\u5173\u66f4\u591aHBase\u914d\u7f6e\u9009\u9879\u53ca\u5176\u8bf4\u660e\uff0c\u8bf7\u53c2\u9605 HBase\u914d\u7f6e\u6587\u6863 \u3002\u901a\u8fc7 storage.hbase.ext \u5728JanusGraph\u914d\u7f6e\u4e2d\u4e3a\u76f8\u5e94\u7684HBase\u914d\u7f6e\u9009\u9879\u6dfb\u52a0\u524d\u7f00\uff0c\u5b83\u5c06\u5728\u521d\u59cb\u5316\u65f6\u4f20\u9012\u7ed9HBase\u3002\u4f8b\u5982\uff0c\u8981\u4e3aHBase\u4f7f\u7528znode / hbase-secure\uff0c\u8bf7\u8bbe\u7f6e\u5c5e\u6027\uff1a storage.hbase.ext.zookeeper.znode.parent=/hbase-secure \u3002\u524d\u7f00\u5141\u8bb8\u901a\u8fc7JanusGraph\u914d\u7f6e\u4efb\u610fHBase\u914d\u7f6e\u9009\u9879\u3002 \u91cd\u8981\uff1a HBase\u540e\u7aef\u4f7f\u7528\u6beb\u79d2\u6765\u8868\u793a\u65f6\u95f4\u6233\u3002\u5728JanusGraph 0.2.0\u53ca\u66f4\u65e9\u7248\u672c\u4e2d\uff0c\u5982\u679cgraph.timestamps\u672a\u660e\u786e\u8bbe\u7f6e\u8be5\u5c5e\u6027\uff0c\u5219\u9ed8\u8ba4\u4e3aMICRO\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cgraph.timestamps\u5fc5\u987b\u5c06\u5c5e\u6027\u663e\u5f0f\u8bbe\u7f6e\u4e3aMILLI\u3002graph.timestamps\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u4e0d\u8981\u5c06\u8be5\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u5176\u4ed6\u503c\u3002","title":"19.2\u3002HBase\u7279\u5b9a\u914d\u7f6e"},{"location":"storage_backend/apache_hbase/#193","text":"HBus\u4e0a\u7684JanusGraph\u652f\u6301\u5168\u5c40\u9876\u70b9\u548c\u8fb9\u7f18\u8fed\u4ee3\u3002\u4f46\u662f\uff0c\u8bf7\u6ce8\u610f\u6240\u6709\u8fd9\u4e9b\u9876\u70b9\u548c/\u6216\u8fb9\u5c06\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4 OutOfMemoryException \u3002\u4f7f\u7528 \u7b2c37\u7ae0\uff0c JanusGraph \u548cTinkerPop \u7684Hadoop-Gremlin \u5730\u8fed\u4ee3\u5927\u56fe\u4e2d\u7684\u6240\u6709\u9876\u70b9\u6216\u8fb9\u3002","title":"19.3\u3002\u5168\u5c40\u56fe\u64cd\u4f5c"},{"location":"storage_backend/apache_hbase/#194hbase","text":"\u5728 HBase shell \u5728\u4e3b\u670d\u52a1\u5668\u4e0a\uff0c\u53ef\u4ee5\u7528\u4e8e\u83b7\u53d6\u96c6\u7fa4\u7684\u6574\u4f53\u72b6\u6001\u68c0\u67e5\u3002 $HBASE_HOME/bin/hbase shell \u4eceshell\u4e2d\uff0c\u4ee5\u4e0b\u547d\u4ee4\u5bf9\u4e8e\u7406\u89e3\u96c6\u7fa4\u7684\u72b6\u6001\u901a\u5e38\u662f\u6709\u7528\u7684\u3002 status 'janusgraph' status 'simple' status 'detailed' \u4e0a\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u8bc6\u522b\u67d0\u4e2a\u533a\u57df\u670d\u52a1\u5668\u662f\u5426\u5df2\u7ecf\u6545\u969c\u3002\u5982\u679c\u662f\u8fd9\u6837\uff0c\u5c31\u6709\u53ef\u80fd ssh \u8fdb\u5165\u5931\u8d25\u7684\u533a\u57df\u670d\u52a1\u5668\u673a\u5668\u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop regionserver sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start regionserver \u4f7f\u7528 PSSH \u53ef\u4ee5\u7b80\u5316\u6b64\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u5355\u72ec\u767b\u5f55\u6bcf\u53f0\u673a\u5668\u6765\u8fd0\u884c\u547d\u4ee4\u3002\u5c06\u533a\u57df\u670d\u52a1\u5668\u7684IP\u5730\u5740\u653e\u5165 hosts.txt \u6587\u4ef6\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u3002 pssh -h host.txt sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop regionserver pssh -h host.txt sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start regionserver \u63a5\u4e0b\u6765\uff0c\u6709\u65f6\u9700\u8981\u91cd\u65b0\u542f\u52a8\u4e3b\u670d\u52a1\u5668(\u4f8b\u5982\uff0c\u62d2\u7edd\u8fde\u63a5\u7684\u5f02\u5e38)\u3002\u4e3a\u6b64\uff0c\u5728\u4e3b\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh stop master sudo -u hadoop $HBASE_HOME/bin/hbase-daemon.sh start master \u6700\u540e\uff0c\u5982\u679c\u5df2\u7ecf\u90e8\u7f72\u4e86HBASE\u96c6\u7fa4\uff0c\u5e76\u4e14\u4e3b\u670d\u52a1\u5668\u6216\u533a\u57df\u670d\u52a1\u5668\u9700\u8981\u66f4\u591a\u5185\u5b58\uff0c\u53ea\u9700\u7f16\u8f91 $HBASE_HOME/conf/hbase-env.sh \u76f8\u5173\u673a\u5668\u4e0a\u7684\u6587\u4ef6 -Xmx -Xms \u53c2\u6570\u3002\u7f16\u8f91\u5b8c\u540e\uff0c\u5982\u524d\u9762\u6240\u8ff0\uff0c\u505c\u6b62/\u542f\u52a8\u4e3b\u670d\u52a1\u5668\u548c/\u6216\u533a\u57df\u670d\u52a1\u5668\u3002","title":"19.4\u3002\u7ba1\u7406HBase\u7fa4\u96c6\u7684\u63d0\u793a\u548c\u6280\u5de7"},{"location":"storage_backend/building_janusgraph/","text":"\u7b2c41\u7ae0\u5efa\u7acbJanusGraph \u82e5\u8981\u9488\u5bf9\u6700\u65b0\u7248\u672c\u7684JanusGraph\u8fdb\u884c\u5f00\u53d1\uff0c\u8bf7\u4f9d\u8d56\u4e8eJanusGraph\u7248\u672c\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u7248\u672c\u662f\u5f00\u53d1\u7248\u672c\uff0c\u56e0\u6b64\u4e0d\u7a33\u5b9a\uff0c\u53ef\u80fd\u4f1a\u66f4\u6539\u3002\u9664\u975e\u60a8\u5bf9JanusGraph\u6700\u65b0\u7684\u5f00\u53d1\u72b6\u6001\u611f\u5174\u8da3\uff0c\u5426\u5219\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u7a33\u5b9a\u7684JanusGraph\u7248\u672c\u3002 dependency groupId org.janusgraph /groupId artifactId janusgraph-core /artifactId version X.Y.Z-SNAPSHOT /version /dependency \u68c0\u67e5 \u4e3b\u652f \u6700\u65b0\u7248\u672c\u3002\u5feb\u7167\u53ef\u901a\u8fc7 Sonatype\u50a8\u5b58\u5e93 . \u6dfb\u52a0\u6b64\u4f9d\u8d56\u9879\u65f6\uff0c\u8bf7\u786e\u4fdd\u5c06\u4ee5\u4e0b\u5b58\u50a8\u5e93\u6dfb\u52a0\u5230 pom.xml : repository id ossrh /id name Sonatype Nexus Snapshots /name url https://oss.sonatype.org/content/repositories/snapshots /url releases enabled false /enabled /releases snapshots enabled true /enabled /snapshots /repository 41.2.\u5e38\u89c1\u95ee\u9898 Maven\u6784\u5efa\u5bfc\u81f4\u8b66\u544a\u9519\u8bef \u5728\u6784\u5efa\u6216\u4f9d\u8d56JanusGraph\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528maven\u7a0b\u5e8f\u96c6\u63d2\u4ef6\u3002","title":"40.JanusGraph\u6570\u636e\u6a21\u578b"},{"location":"storage_backend/building_janusgraph/#41janusgraph","text":"\u82e5\u8981\u9488\u5bf9\u6700\u65b0\u7248\u672c\u7684JanusGraph\u8fdb\u884c\u5f00\u53d1\uff0c\u8bf7\u4f9d\u8d56\u4e8eJanusGraph\u7248\u672c\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u7248\u672c\u662f\u5f00\u53d1\u7248\u672c\uff0c\u56e0\u6b64\u4e0d\u7a33\u5b9a\uff0c\u53ef\u80fd\u4f1a\u66f4\u6539\u3002\u9664\u975e\u60a8\u5bf9JanusGraph\u6700\u65b0\u7684\u5f00\u53d1\u72b6\u6001\u611f\u5174\u8da3\uff0c\u5426\u5219\u6211\u4eec\u5efa\u8bae\u4f7f\u7528\u7a33\u5b9a\u7684JanusGraph\u7248\u672c\u3002 dependency groupId org.janusgraph /groupId artifactId janusgraph-core /artifactId version X.Y.Z-SNAPSHOT /version /dependency \u68c0\u67e5 \u4e3b\u652f \u6700\u65b0\u7248\u672c\u3002\u5feb\u7167\u53ef\u901a\u8fc7 Sonatype\u50a8\u5b58\u5e93 . \u6dfb\u52a0\u6b64\u4f9d\u8d56\u9879\u65f6\uff0c\u8bf7\u786e\u4fdd\u5c06\u4ee5\u4e0b\u5b58\u50a8\u5e93\u6dfb\u52a0\u5230 pom.xml : repository id ossrh /id name Sonatype Nexus Snapshots /name url https://oss.sonatype.org/content/repositories/snapshots /url releases enabled false /enabled /releases snapshots enabled true /enabled /snapshots /repository","title":"\u7b2c41\u7ae0\u5efa\u7acbJanusGraph"},{"location":"storage_backend/building_janusgraph/#412","text":"Maven\u6784\u5efa\u5bfc\u81f4\u8b66\u544a\u9519\u8bef \u5728\u6784\u5efa\u6216\u4f9d\u8d56JanusGraph\u65f6\uff0c\u4e00\u5b9a\u8981\u4f7f\u7528maven\u7a0b\u5e8f\u96c6\u63d2\u4ef6\u3002","title":"41.2.\u5e38\u89c1\u95ee\u9898"},{"location":"storage_backend/goole_cloud_bigtable/","text":"\u7b2c20\u7ae0Google Cloud Bigtable \u200b Cloud Bigtable\u662fGoogle\u7684NoSQL\u5927\u6570\u636e\u6570\u636e\u5e93\u670d\u52a1\u3002\u5b83\u4e0e\u8bb8\u591a\u6838\u5fc3Google\u670d\u52a1\u76f8\u540c\uff0c\u5305\u62ec\u641c\u7d22\uff0c\u5206\u6790\uff0c\u5730\u56fe\u548cGmail\u3002 Bigtable\u65e8\u5728\u4ee5\u4e00\u81f4\u7684\u4f4e\u5ef6\u8fdf\u548c\u9ad8\u541e\u5410\u91cf\u5904\u7406\u5927\u91cf\u5de5\u4f5c\u8d1f\u8f7d\uff0c\u56e0\u6b64\u5b83\u662f\u8fd0\u8425\u548c\u5206\u6790\u5e94\u7528\u7a0b\u5e8f\uff08\u5305\u62ec\u7269\u8054\u7f51\uff0c\u7528\u6237\u5206\u6790\u548c\u8d22\u52a1\u6570\u636e\u5206\u6790\uff09\u7684\u7406\u60f3\u9009\u62e9\u3002 20.1\u3002Bigtable\u8bbe\u7f6e Bigtable\u4e3a\u6240\u6709\u6570\u636e\u8bbf\u95ee\u64cd\u4f5c\u5b9e\u73b0HBase\u63a5\u53e3\uff0c\u5e76\u4e14\u9700\u8981\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\u624d\u80fd\u8fde\u63a5\u3002 20.1.1\u3002\u8fde\u63a5\u5230Bigtable \u914d\u7f6eJanusGraph\u4ee5\u8fde\u63a5Bigtable\u662f\u901a\u8fc7\u4f7f\u7528 hbase \u540e\u7aef\uff0c\u81ea\u5b9a\u4e49\u8fde\u63a5\u5b9e\u73b0\uff0c\u5305\u542bBigtable\u5b9e\u4f8b\u7684Google Cloud Platform\u9879\u76ee\u7684\u9879\u76eeID\u4ee5\u53ca\u60a8\u8981\u8fde\u63a5\u7684Cloud Bigtable\u5b9e\u4f8bID\u6765\u5b9e\u73b0\u7684\u3002 \u4f8b\uff1a","title":"20.Google Cloud Bigtable"},{"location":"storage_backend/goole_cloud_bigtable/#201bigtable","text":"Bigtable\u4e3a\u6240\u6709\u6570\u636e\u8bbf\u95ee\u64cd\u4f5c\u5b9e\u73b0HBase\u63a5\u53e3\uff0c\u5e76\u4e14\u9700\u8981\u4e00\u4e9b\u914d\u7f6e\u9009\u9879\u624d\u80fd\u8fde\u63a5\u3002","title":"20.1\u3002Bigtable\u8bbe\u7f6e"},{"location":"storage_backend/goole_cloud_bigtable/#2011bigtable","text":"\u914d\u7f6eJanusGraph\u4ee5\u8fde\u63a5Bigtable\u662f\u901a\u8fc7\u4f7f\u7528 hbase \u540e\u7aef\uff0c\u81ea\u5b9a\u4e49\u8fde\u63a5\u5b9e\u73b0\uff0c\u5305\u542bBigtable\u5b9e\u4f8b\u7684Google Cloud Platform\u9879\u76ee\u7684\u9879\u76eeID\u4ee5\u53ca\u60a8\u8981\u8fde\u63a5\u7684Cloud Bigtable\u5b9e\u4f8bID\u6765\u5b9e\u73b0\u7684\u3002 \u4f8b\uff1a","title":"20.1.1\u3002\u8fde\u63a5\u5230Bigtable"},{"location":"storage_backend/inmemory_storage_backend/","text":"\u7b2c22\u7ae0InMemory\u5b58\u50a8\u540e\u7aef JanusGraph\u9644\u5e26\u5185\u5b58\u5b58\u50a8\u540e\u7aef\uff0c\u53ef\u901a\u8fc7\u4ee5\u4e0b\u914d\u7f6e\u4f7f\u7528\uff1a storage.backend = inmemory \u6216\u8005\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\u6253\u5f00\u5185\u5b58\u4e2d\u7684JanusGraph\u56fe\uff1a graph = JanusGraphFactory.build().set('storage.backend', 'inmemory').open() \u5185\u5b58\u5b58\u50a8\u540e\u7aef\u6ca1\u6709\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u3002\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u4e2a\u540e\u7aef\u5c06\u6240\u6709\u6570\u636e\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\u3002\u5173\u95ed\u56fe\u5f62\u6216\u7ec8\u6b62\u627f\u8f7dJanusGraph\u56fe\u5f62\u7684\u8fc7\u7a0b\u5c06\u4e0d\u53ef\u64a4\u9500\u5730\u5220\u9664\u56fe\u5f62\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002\u6b64\u540e\u7aef\u662f\u7279\u5b9aJanusGraph\u56fe\u5f62\u5b9e\u4f8b\u7684\u672c\u5730\u540e\u7aef\uff0c\u4e0d\u80fd\u8de8\u591a\u4e2aJanusGraph\u56fe\u8868\u5171\u4eab\u3002 22.1. \u7406\u60f3\u7684\u7528\u4f8b \u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e3b\u8981\u662f\u4e3a\u4e86\u7b80\u5316\u6d4b\u8bd5\uff08\u9488\u5bf9\u90a3\u4e9b\u4e0d\u9700\u8981\u6301\u4e45\u6027\u7684\u6d4b\u8bd5\uff09\u548c\u56fe\u5f62\u63a2\u7d22\u800c\u5f00\u53d1\u7684\u3002\u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e0d\u9002\u7528\u4e8e\u751f\u4ea7\u7528\u9014\uff0c\u5927\u578b\u56fe\u5f62\u6216\u9ad8\u6027\u80fd\u7528\u4f8b\u3002\u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e0d\u662f\u6027\u80fd\u6216\u5185\u5b58\u4f18\u5316\u3002\u6240\u6709\u6570\u636e\u90fd\u5b58\u50a8\u5728\u5206\u914d\u7ed9Java\u865a\u62df\u673a\u7684\u5806\u7a7a\u95f4\u4e2d\u3002","title":"22.\u5185\u5b58\u5b58\u50a8\u540e\u7aef"},{"location":"storage_backend/inmemory_storage_backend/#22inmemory","text":"JanusGraph\u9644\u5e26\u5185\u5b58\u5b58\u50a8\u540e\u7aef\uff0c\u53ef\u901a\u8fc7\u4ee5\u4e0b\u914d\u7f6e\u4f7f\u7528\uff1a storage.backend = inmemory \u6216\u8005\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728Gremlin\u63a7\u5236\u53f0\u4e2d\u6253\u5f00\u5185\u5b58\u4e2d\u7684JanusGraph\u56fe\uff1a graph = JanusGraphFactory.build().set('storage.backend', 'inmemory').open() \u5185\u5b58\u5b58\u50a8\u540e\u7aef\u6ca1\u6709\u5176\u4ed6\u914d\u7f6e\u9009\u9879\u3002\u987e\u540d\u601d\u4e49\uff0c\u8fd9\u4e2a\u540e\u7aef\u5c06\u6240\u6709\u6570\u636e\u4fdd\u5b58\u5728\u5185\u5b58\u4e2d\u3002\u5173\u95ed\u56fe\u5f62\u6216\u7ec8\u6b62\u627f\u8f7dJanusGraph\u56fe\u5f62\u7684\u8fc7\u7a0b\u5c06\u4e0d\u53ef\u64a4\u9500\u5730\u5220\u9664\u56fe\u5f62\u4e2d\u7684\u6240\u6709\u6570\u636e\u3002\u6b64\u540e\u7aef\u662f\u7279\u5b9aJanusGraph\u56fe\u5f62\u5b9e\u4f8b\u7684\u672c\u5730\u540e\u7aef\uff0c\u4e0d\u80fd\u8de8\u591a\u4e2aJanusGraph\u56fe\u8868\u5171\u4eab\u3002","title":"\u7b2c22\u7ae0InMemory\u5b58\u50a8\u540e\u7aef"},{"location":"storage_backend/inmemory_storage_backend/#221","text":"\u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e3b\u8981\u662f\u4e3a\u4e86\u7b80\u5316\u6d4b\u8bd5\uff08\u9488\u5bf9\u90a3\u4e9b\u4e0d\u9700\u8981\u6301\u4e45\u6027\u7684\u6d4b\u8bd5\uff09\u548c\u56fe\u5f62\u63a2\u7d22\u800c\u5f00\u53d1\u7684\u3002\u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e0d\u9002\u7528\u4e8e\u751f\u4ea7\u7528\u9014\uff0c\u5927\u578b\u56fe\u5f62\u6216\u9ad8\u6027\u80fd\u7528\u4f8b\u3002\u5185\u5b58\u5b58\u50a8\u540e\u7aef\u4e0d\u662f\u6027\u80fd\u6216\u5185\u5b58\u4f18\u5316\u3002\u6240\u6709\u6570\u636e\u90fd\u5b58\u50a8\u5728\u5206\u914d\u7ed9Java\u865a\u62df\u673a\u7684\u5806\u7a7a\u95f4\u4e2d\u3002","title":"22.1. \u7406\u60f3\u7684\u7528\u4f8b"},{"location":"storage_backend/janusgraph_data_model/","text":"\u7b2c40\u7ae0JanusGraph\u6570\u636e\u6a21\u578b JanusGraph\u4ee5 \u90bb\u63a5\u5217\u8868\u683c\u5f0f \u5b58\u50a8\u56fe\u5f62\uff0c\u8fd9\u610f\u5473\u7740\u56fe\u5f62\u5b58\u50a8\u4e3a\u5177\u6709\u90bb\u63a5\u5217\u8868\u7684\u9876\u70b9\u96c6\u5408\u3002\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\u5305\u542b\u6240\u6709\u9876\u70b9\u7684\u5165\u5c04\u8fb9\uff08\u548c\u5c5e\u6027\uff09\u3002 \u901a\u8fc7\u4ee5\u90bb\u63a5\u5217\u8868\u683c\u5f0f\u5b58\u50a8\u56fe\u5f62\uff0cJanusGraph\u786e\u4fdd\u6240\u6709\u9876\u70b9\u7684\u5165\u5c04\u8fb9\u7f18\u548c\u5c5e\u6027\u7d27\u5bc6\u5730\u5b58\u50a8\u5728\u5b58\u50a8\u540e\u7aef\u4e2d\uff0c\u4ece\u800c\u52a0\u901f\u904d\u5386\u3002\u7f3a\u70b9\u662f\u6bcf\u4e2a\u8fb9\u7f18\u5fc5\u987b\u5b58\u50a8\u4e24\u6b21 - \u8fb9\u7f18\u7684\u6bcf\u4e2a\u672b\u7aef\u9876\u70b9\u4e00\u6b21\u3002 \u6b64\u5916\uff0cJanusGraph\u6309\u6392\u5e8f\u987a\u5e8f\u7ef4\u62a4\u6bcf\u4e2a\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\uff0c\u5176\u987a\u5e8f\u7531\u6392\u5e8f\u952e\u548c\u8fb9\u6807\u7b7e\u7684\u6392\u5e8f\u987a\u5e8f\u5b9a\u4e49\u3002\u6392\u5e8f\u987a\u5e8f\u5141\u8bb8\u4f7f\u7528\u4ee5 \u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 \u6709\u6548\u5730\u68c0\u7d22\u90bb\u63a5\u5217\u8868\u7684\u5b50\u96c6\u3002 JanusGraph\u5c06\u56fe\u5f62\u7684\u90bb\u63a5\u5217\u8868\u8868\u793a \u5b58\u50a8 \u5728\u652f\u6301Bigtable\u6570\u636e\u6a21\u578b\u7684\u4efb\u4f55 \u5b58\u50a8\u540e\u7aef \u4e2d 40.1. Bigtable\u6570\u636e\u6a21\u578b \u5728 Bigtable\u6570\u636e\u6a21\u578b\u4e0b\uff0c \u6bcf\u4e2a\u8868\u90fd\u662f\u884c\u7684\u96c6\u5408\u3002\u6bcf\u884c\u7531\u5bc6\u94a5\u552f\u4e00\u6807\u8bc6\u3002\u6bcf\u884c\u7531\u4efb\u610f\uff08\u5927\u4f46\u6709\u9650\uff09\u6570\u91cf\u7684\u5355\u5143\u7ec4\u6210\u3002\u5355\u5143\u683c\u7531\u5217\u548c\u503c\u7ec4\u6210\u3002\u5355\u5143\u683c\u7531\u7ed9\u5b9a\u884c\u5185\u7684\u5217\u552f\u4e00\u6807\u8bc6\u3002Bigtable\u6a21\u578b\u4e2d\u7684\u884c\u79f0\u4e3a\u201c\u5bbd\u884c\u201d\uff0c\u56e0\u4e3a\u5b83\u4eec\u652f\u6301\u5927\u91cf\u5355\u5143\u683c\uff0c\u5e76\u4e14\u4e0d\u5fc5\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u90a3\u6837\u9884\u5148\u5b9a\u4e49\u8fd9\u4e9b\u5355\u5143\u683c\u7684\u5217\u3002 JanusGraph\u5bf9Bigtable\u6570\u636e\u6a21\u578b\u8fd8\u6709\u4e00\u4e2a\u989d\u5916\u8981\u6c42\uff1a\u5355\u5143\u683c\u5fc5\u987b\u6309\u5217\u6392\u5e8f\uff0c\u5e76\u4e14\u5217\u8303\u56f4\u6307\u5b9a\u7684\u5355\u5143\u683c\u5b50\u96c6\u5fc5\u987b\u662f\u6709\u6548\u53ef\u68c0\u7d22\u7684\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4f7f\u7528\u7d22\u5f15\u7ed3\u6784\uff0c\u8df3\u8fc7\u5217\u8868\u6216\u4e8c\u8fdb\u5236\u641c\u7d22\uff09\u3002 \u6b64\u5916\uff0c\u7279\u5b9a\u7684Bigtable\u5b9e\u73b0\u53ef\u4ee5\u4f7f\u884c\u6309\u5176\u952e\u7684\u987a\u5e8f\u6392\u5e8f\u3002JanusGraph\u53ef\u4ee5\u5229\u7528\u8fd9\u6837\u7684\u952e\u5e8f\u6765\u6709\u6548\u5730\u5212\u5206\u56fe\u5f62\uff0c\u4ece\u800c\u4e3a\u975e\u5e38\u5927\u7684\u56fe\u5f62\u63d0\u4f9b\u66f4\u597d\u7684\u52a0\u8f7d\u548c\u904d\u5386\u6027\u80fd\u3002\u4f46\u662f\uff0c\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u3002 40.2. JanusGraph\u6570\u636e\u5e03\u5c40 JanusGraph\u5c06\u6bcf\u4e2a\u90bb\u63a5\u5217\u8868\u4f5c\u4e3a\u4e00\u884c\u5b58\u50a8\u5728\u5e95\u5c42\u5b58\u50a8\u540e\u7aef\u4e2d\u3002\uff0864\u4f4d\uff09\u9876\u70b9id\uff08JanusGraph\u552f\u4e00\u5206\u914d\u7ed9\u6bcf\u4e2a\u9876\u70b9\uff09\u662f\u6307\u5411\u5305\u542b\u9876\u70b9\u90bb\u63a5\u5217\u8868\u7684\u884c\u7684\u952e\u3002\u6bcf\u4e2a\u8fb9\u548c\u5c5e\u6027\u90fd\u5b58\u50a8\u5728\u884c\u4e2d\u7684\u5355\u4e2a\u5355\u5143\u683c\u4e2d\uff0c\u4ece\u800c\u5141\u8bb8\u6709\u6548\u7684\u63d2\u5165\u548c\u5220\u9664\u3002\u56e0\u6b64\uff0c\u7279\u5b9a\u5b58\u50a8\u540e\u7aef\u4e2d\u6bcf\u884c\u5141\u8bb8\u7684\u6700\u5927\u5355\u5143\u6570\u4e5f\u662fJanusGraph\u53ef\u4ee5\u652f\u6301\u6b64\u9876\u7aef\u7684\u6700\u5927\u9876\u70b9\u6570\u3002 \u5982\u679c\u5b58\u50a8\u540e\u7aef\u652f\u6301\u952e\u987a\u5e8f\uff0c\u5219\u90bb\u63a5\u5217\u8868\u5c06\u6309\u9876\u70b9id\u6392\u5e8f\uff0c\u5e76\u4e14JanusGraph\u53ef\u4ee5\u5206\u914d\u9876\u70b9id\uff0c\u4ee5\u4fbf\u56fe\u5f62\u88ab\u6709\u6548\u5730\u5206\u533a\u3002\u5206\u914dID\u4f7f\u5f97\u7ecf\u5e38\u5171\u540c\u8bbf\u95ee\u7684\u9876\u70b9\u5177\u6709\u5c0f\u7684\u7edd\u5bf9\u5dee\u5f02\u7684id\u3002 40.3. \u4e2a\u522b\u8fb9\u7f18\u5e03\u5c40 \u6bcf\u4e2a\u8fb9\u548c\u5c5e\u6027\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u683c\u5b58\u50a8\u5728\u5176\u76f8\u90bb\u9876\u70b9\u7684\u884c\u4e2d\u3002\u5b83\u4eec\u88ab\u5e8f\u5217\u5316\uff0c\u4f7f\u5f97\u5217\u7684\u5b57\u8282\u987a\u5e8f\u9075\u5faa\u8fb9\u6807\u7b7e\u7684\u6392\u5e8f\u952e\u3002\u53d8\u91cfid\u7f16\u7801\u65b9\u6848\u548c\u538b\u7f29\u5bf9\u8c61\u5e8f\u5217\u5316\u7528\u4e8e\u4f7f\u6bcf\u4e2a\u8fb9\u7f18/\u5355\u5143\u7684\u5b58\u50a8\u8db3\u8ff9\u5c3d\u53ef\u80fd\u5c0f\u3002 \u8003\u8651\u5728\u4e0a\u56fe\u4e2d\u9876\u884c\u53ef\u89c6\u5316\u7684\u5355\u4e2a\u8fb9\u7684\u5b58\u50a8\u5e03\u5c40\u3002\u6df1\u84dd\u8272\u6846\u8868\u793a\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u65b9\u6848\u7f16\u7801\u7684\u6570\u5b57\uff0c\u4ee5\u51cf\u5c11\u5b83\u4eec\u6d88\u8017\u7684\u5b57\u8282\u6570\u3002\u7ea2\u6846\u8868\u793a\u4f7f\u7528\u5173\u8054\u5c5e\u6027\u952e\u4e2d\u5f15\u7528\u7684\u538b\u7f29\u5143\u6570\u636e\u5e8f\u5217\u5316\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\u503c\uff08\u5373\u5bf9\u8c61\uff09\u3002\u7070\u8272\u6846\u8868\u793a\u672a\u538b\u7f29\u7684\u5c5e\u6027\u503c\uff08\u5373\u5e8f\u5217\u5316\u5bf9\u8c61\uff09\u3002 \u8fb9\u7684\u5e8f\u5217\u5316\u8868\u793a\u4ece\u8fb9\u6807\u7b7e\u7684\u552f\u4e00ID\u5f00\u59cb\uff08\u7531JanusGraph\u6307\u5b9a\uff09\u3002\u8fd9\u901a\u5e38\u662f\u4e00\u4e2a\u5c0f\u6570\u5b57\uff0c\u5e76\u4f7f\u7528\u53d8\u91cfid\u7f16\u7801\u8fdb\u884c\u538b\u7f29\u3002\u8be5id\u7684\u6700\u540e\u4e00\u4f4d\u662f\u504f\u79fb\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8fd9\u662f\u4f20\u5165\u8fb9\u7f18\u8fd8\u662f\u4f20\u51fa\u8fb9\u7f18\u3002\u63a5\u4e0b\u6765\uff0c\u5b58\u50a8\u5305\u62ec\u6392\u5e8f\u952e\u7684\u5c5e\u6027\u503c\u3002\u6392\u5e8f\u952e\u662f\u4f7f\u7528\u8fb9\u7f18\u6807\u7b7e\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u6392\u5e8f\u952e\u5bf9\u8c61\u5143\u6570\u636e\u53ef\u4ee5\u5f15\u7528\u8fb9\u7f18\u6807\u7b7e\u3002\u4e4b\u540e\uff0c\u5b58\u50a8\u76f8\u90bb\u9876\u70b9\u7684id\u3002JanusGraph\u4e0d\u5b58\u50a8\u5b9e\u9645\u7684\u9876\u70b9id\uff0c\u800c\u662f\u5b58\u50a8\u62e5\u6709\u6b64\u90bb\u63a5\u5217\u8868\u7684\u9876\u70b9\u7684id\u7684\u5dee\u5f02\u3002\u5dee\u5f02\u53ef\u80fd\u662f\u6bd4\u7edd\u5bf9id\u5c0f\u7684\u6570\u5b57\uff0c\u56e0\u6b64\u538b\u7f29\u5f97\u66f4\u597d\u3002\u9876\u70b9id\u540e\u8ddf\u6b64\u8fb9\u7684id\u3002JanusGraph\u4e3a\u6bcf\u6761\u8fb9\u5206\u914d\u4e86\u4e00\u4e2a\u552f\u4e00\u7684id\u3002\u8fd9\u6837\u5c31\u7ed3\u675f\u4e86\u8fb9\u7f18\u5355\u5143\u683c\u7684\u5217\u503c\u3002\u8fb9\u7684\u5355\u5143\u683c\u7684\u503c\u5305\u542b\u8fb9\u7684\u7b7e\u540d\u5c5e\u6027\u7684\u538b\u7f29\u5e8f\u5217\u5316\uff08\u7531\u6807\u7b7e\u7684\u7b7e\u540d\u952e\u5b9a\u4e49\uff09\u4ee5\u53ca\u5728\u672a\u538b\u7f29\u5e8f\u5217\u5316\u4e2d\u6dfb\u52a0\u5230\u8fb9\u7684\u4efb\u4f55\u5176\u4ed6\u5c5e\u6027\u3002 \u5c5e\u6027\u7684\u5e8f\u5217\u5316\u8868\u793a\u66f4\u7b80\u5355\uff0c\u53ea\u5305\u542b\u5217\u4e2d\u5c5e\u6027\u7684\u952eID\u3002\u5c5e\u6027id\u548c\u5c5e\u6027\u503c\u5b58\u50a8\u5728\u503c\u4e2d\u3002 list() \u4f46\u662f\uff0c\u5982\u679c\u5c06\u5c5e\u6027\u952e\u5b9a\u4e49\u4e3a\uff0c\u5219\u5c5e\u6027id\u4e5f\u5b58\u50a8\u5728\u5217\u4e2d\u3002","title":"41.\u6784\u5efaJanusGraph"},{"location":"storage_backend/janusgraph_data_model/#40janusgraph","text":"JanusGraph\u4ee5 \u90bb\u63a5\u5217\u8868\u683c\u5f0f \u5b58\u50a8\u56fe\u5f62\uff0c\u8fd9\u610f\u5473\u7740\u56fe\u5f62\u5b58\u50a8\u4e3a\u5177\u6709\u90bb\u63a5\u5217\u8868\u7684\u9876\u70b9\u96c6\u5408\u3002\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\u5305\u542b\u6240\u6709\u9876\u70b9\u7684\u5165\u5c04\u8fb9\uff08\u548c\u5c5e\u6027\uff09\u3002 \u901a\u8fc7\u4ee5\u90bb\u63a5\u5217\u8868\u683c\u5f0f\u5b58\u50a8\u56fe\u5f62\uff0cJanusGraph\u786e\u4fdd\u6240\u6709\u9876\u70b9\u7684\u5165\u5c04\u8fb9\u7f18\u548c\u5c5e\u6027\u7d27\u5bc6\u5730\u5b58\u50a8\u5728\u5b58\u50a8\u540e\u7aef\u4e2d\uff0c\u4ece\u800c\u52a0\u901f\u904d\u5386\u3002\u7f3a\u70b9\u662f\u6bcf\u4e2a\u8fb9\u7f18\u5fc5\u987b\u5b58\u50a8\u4e24\u6b21 - \u8fb9\u7f18\u7684\u6bcf\u4e2a\u672b\u7aef\u9876\u70b9\u4e00\u6b21\u3002 \u6b64\u5916\uff0cJanusGraph\u6309\u6392\u5e8f\u987a\u5e8f\u7ef4\u62a4\u6bcf\u4e2a\u9876\u70b9\u7684\u90bb\u63a5\u5217\u8868\uff0c\u5176\u987a\u5e8f\u7531\u6392\u5e8f\u952e\u548c\u8fb9\u6807\u7b7e\u7684\u6392\u5e8f\u987a\u5e8f\u5b9a\u4e49\u3002\u6392\u5e8f\u987a\u5e8f\u5141\u8bb8\u4f7f\u7528\u4ee5 \u9876\u70b9\u4e3a\u4e2d\u5fc3\u7684\u7d22\u5f15 \u6709\u6548\u5730\u68c0\u7d22\u90bb\u63a5\u5217\u8868\u7684\u5b50\u96c6\u3002 JanusGraph\u5c06\u56fe\u5f62\u7684\u90bb\u63a5\u5217\u8868\u8868\u793a \u5b58\u50a8 \u5728\u652f\u6301Bigtable\u6570\u636e\u6a21\u578b\u7684\u4efb\u4f55 \u5b58\u50a8\u540e\u7aef \u4e2d","title":"\u7b2c40\u7ae0JanusGraph\u6570\u636e\u6a21\u578b"},{"location":"storage_backend/janusgraph_data_model/#401-bigtable","text":"\u5728 Bigtable\u6570\u636e\u6a21\u578b\u4e0b\uff0c \u6bcf\u4e2a\u8868\u90fd\u662f\u884c\u7684\u96c6\u5408\u3002\u6bcf\u884c\u7531\u5bc6\u94a5\u552f\u4e00\u6807\u8bc6\u3002\u6bcf\u884c\u7531\u4efb\u610f\uff08\u5927\u4f46\u6709\u9650\uff09\u6570\u91cf\u7684\u5355\u5143\u7ec4\u6210\u3002\u5355\u5143\u683c\u7531\u5217\u548c\u503c\u7ec4\u6210\u3002\u5355\u5143\u683c\u7531\u7ed9\u5b9a\u884c\u5185\u7684\u5217\u552f\u4e00\u6807\u8bc6\u3002Bigtable\u6a21\u578b\u4e2d\u7684\u884c\u79f0\u4e3a\u201c\u5bbd\u884c\u201d\uff0c\u56e0\u4e3a\u5b83\u4eec\u652f\u6301\u5927\u91cf\u5355\u5143\u683c\uff0c\u5e76\u4e14\u4e0d\u5fc5\u50cf\u5173\u7cfb\u6570\u636e\u5e93\u4e2d\u90a3\u6837\u9884\u5148\u5b9a\u4e49\u8fd9\u4e9b\u5355\u5143\u683c\u7684\u5217\u3002 JanusGraph\u5bf9Bigtable\u6570\u636e\u6a21\u578b\u8fd8\u6709\u4e00\u4e2a\u989d\u5916\u8981\u6c42\uff1a\u5355\u5143\u683c\u5fc5\u987b\u6309\u5217\u6392\u5e8f\uff0c\u5e76\u4e14\u5217\u8303\u56f4\u6307\u5b9a\u7684\u5355\u5143\u683c\u5b50\u96c6\u5fc5\u987b\u662f\u6709\u6548\u53ef\u68c0\u7d22\u7684\uff08\u4f8b\u5982\uff0c\u901a\u8fc7\u4f7f\u7528\u7d22\u5f15\u7ed3\u6784\uff0c\u8df3\u8fc7\u5217\u8868\u6216\u4e8c\u8fdb\u5236\u641c\u7d22\uff09\u3002 \u6b64\u5916\uff0c\u7279\u5b9a\u7684Bigtable\u5b9e\u73b0\u53ef\u4ee5\u4f7f\u884c\u6309\u5176\u952e\u7684\u987a\u5e8f\u6392\u5e8f\u3002JanusGraph\u53ef\u4ee5\u5229\u7528\u8fd9\u6837\u7684\u952e\u5e8f\u6765\u6709\u6548\u5730\u5212\u5206\u56fe\u5f62\uff0c\u4ece\u800c\u4e3a\u975e\u5e38\u5927\u7684\u56fe\u5f62\u63d0\u4f9b\u66f4\u597d\u7684\u52a0\u8f7d\u548c\u904d\u5386\u6027\u80fd\u3002\u4f46\u662f\uff0c\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u3002","title":"40.1. Bigtable\u6570\u636e\u6a21\u578b"},{"location":"storage_backend/janusgraph_data_model/#402-janusgraph","text":"JanusGraph\u5c06\u6bcf\u4e2a\u90bb\u63a5\u5217\u8868\u4f5c\u4e3a\u4e00\u884c\u5b58\u50a8\u5728\u5e95\u5c42\u5b58\u50a8\u540e\u7aef\u4e2d\u3002\uff0864\u4f4d\uff09\u9876\u70b9id\uff08JanusGraph\u552f\u4e00\u5206\u914d\u7ed9\u6bcf\u4e2a\u9876\u70b9\uff09\u662f\u6307\u5411\u5305\u542b\u9876\u70b9\u90bb\u63a5\u5217\u8868\u7684\u884c\u7684\u952e\u3002\u6bcf\u4e2a\u8fb9\u548c\u5c5e\u6027\u90fd\u5b58\u50a8\u5728\u884c\u4e2d\u7684\u5355\u4e2a\u5355\u5143\u683c\u4e2d\uff0c\u4ece\u800c\u5141\u8bb8\u6709\u6548\u7684\u63d2\u5165\u548c\u5220\u9664\u3002\u56e0\u6b64\uff0c\u7279\u5b9a\u5b58\u50a8\u540e\u7aef\u4e2d\u6bcf\u884c\u5141\u8bb8\u7684\u6700\u5927\u5355\u5143\u6570\u4e5f\u662fJanusGraph\u53ef\u4ee5\u652f\u6301\u6b64\u9876\u7aef\u7684\u6700\u5927\u9876\u70b9\u6570\u3002 \u5982\u679c\u5b58\u50a8\u540e\u7aef\u652f\u6301\u952e\u987a\u5e8f\uff0c\u5219\u90bb\u63a5\u5217\u8868\u5c06\u6309\u9876\u70b9id\u6392\u5e8f\uff0c\u5e76\u4e14JanusGraph\u53ef\u4ee5\u5206\u914d\u9876\u70b9id\uff0c\u4ee5\u4fbf\u56fe\u5f62\u88ab\u6709\u6548\u5730\u5206\u533a\u3002\u5206\u914dID\u4f7f\u5f97\u7ecf\u5e38\u5171\u540c\u8bbf\u95ee\u7684\u9876\u70b9\u5177\u6709\u5c0f\u7684\u7edd\u5bf9\u5dee\u5f02\u7684id\u3002","title":"40.2. JanusGraph\u6570\u636e\u5e03\u5c40"},{"location":"storage_backend/janusgraph_data_model/#403","text":"\u6bcf\u4e2a\u8fb9\u548c\u5c5e\u6027\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u683c\u5b58\u50a8\u5728\u5176\u76f8\u90bb\u9876\u70b9\u7684\u884c\u4e2d\u3002\u5b83\u4eec\u88ab\u5e8f\u5217\u5316\uff0c\u4f7f\u5f97\u5217\u7684\u5b57\u8282\u987a\u5e8f\u9075\u5faa\u8fb9\u6807\u7b7e\u7684\u6392\u5e8f\u952e\u3002\u53d8\u91cfid\u7f16\u7801\u65b9\u6848\u548c\u538b\u7f29\u5bf9\u8c61\u5e8f\u5217\u5316\u7528\u4e8e\u4f7f\u6bcf\u4e2a\u8fb9\u7f18/\u5355\u5143\u7684\u5b58\u50a8\u8db3\u8ff9\u5c3d\u53ef\u80fd\u5c0f\u3002 \u8003\u8651\u5728\u4e0a\u56fe\u4e2d\u9876\u884c\u53ef\u89c6\u5316\u7684\u5355\u4e2a\u8fb9\u7684\u5b58\u50a8\u5e03\u5c40\u3002\u6df1\u84dd\u8272\u6846\u8868\u793a\u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\u65b9\u6848\u7f16\u7801\u7684\u6570\u5b57\uff0c\u4ee5\u51cf\u5c11\u5b83\u4eec\u6d88\u8017\u7684\u5b57\u8282\u6570\u3002\u7ea2\u6846\u8868\u793a\u4f7f\u7528\u5173\u8054\u5c5e\u6027\u952e\u4e2d\u5f15\u7528\u7684\u538b\u7f29\u5143\u6570\u636e\u5e8f\u5217\u5316\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\u503c\uff08\u5373\u5bf9\u8c61\uff09\u3002\u7070\u8272\u6846\u8868\u793a\u672a\u538b\u7f29\u7684\u5c5e\u6027\u503c\uff08\u5373\u5e8f\u5217\u5316\u5bf9\u8c61\uff09\u3002 \u8fb9\u7684\u5e8f\u5217\u5316\u8868\u793a\u4ece\u8fb9\u6807\u7b7e\u7684\u552f\u4e00ID\u5f00\u59cb\uff08\u7531JanusGraph\u6307\u5b9a\uff09\u3002\u8fd9\u901a\u5e38\u662f\u4e00\u4e2a\u5c0f\u6570\u5b57\uff0c\u5e76\u4f7f\u7528\u53d8\u91cfid\u7f16\u7801\u8fdb\u884c\u538b\u7f29\u3002\u8be5id\u7684\u6700\u540e\u4e00\u4f4d\u662f\u504f\u79fb\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8fd9\u662f\u4f20\u5165\u8fb9\u7f18\u8fd8\u662f\u4f20\u51fa\u8fb9\u7f18\u3002\u63a5\u4e0b\u6765\uff0c\u5b58\u50a8\u5305\u62ec\u6392\u5e8f\u952e\u7684\u5c5e\u6027\u503c\u3002\u6392\u5e8f\u952e\u662f\u4f7f\u7528\u8fb9\u7f18\u6807\u7b7e\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u6392\u5e8f\u952e\u5bf9\u8c61\u5143\u6570\u636e\u53ef\u4ee5\u5f15\u7528\u8fb9\u7f18\u6807\u7b7e\u3002\u4e4b\u540e\uff0c\u5b58\u50a8\u76f8\u90bb\u9876\u70b9\u7684id\u3002JanusGraph\u4e0d\u5b58\u50a8\u5b9e\u9645\u7684\u9876\u70b9id\uff0c\u800c\u662f\u5b58\u50a8\u62e5\u6709\u6b64\u90bb\u63a5\u5217\u8868\u7684\u9876\u70b9\u7684id\u7684\u5dee\u5f02\u3002\u5dee\u5f02\u53ef\u80fd\u662f\u6bd4\u7edd\u5bf9id\u5c0f\u7684\u6570\u5b57\uff0c\u56e0\u6b64\u538b\u7f29\u5f97\u66f4\u597d\u3002\u9876\u70b9id\u540e\u8ddf\u6b64\u8fb9\u7684id\u3002JanusGraph\u4e3a\u6bcf\u6761\u8fb9\u5206\u914d\u4e86\u4e00\u4e2a\u552f\u4e00\u7684id\u3002\u8fd9\u6837\u5c31\u7ed3\u675f\u4e86\u8fb9\u7f18\u5355\u5143\u683c\u7684\u5217\u503c\u3002\u8fb9\u7684\u5355\u5143\u683c\u7684\u503c\u5305\u542b\u8fb9\u7684\u7b7e\u540d\u5c5e\u6027\u7684\u538b\u7f29\u5e8f\u5217\u5316\uff08\u7531\u6807\u7b7e\u7684\u7b7e\u540d\u952e\u5b9a\u4e49\uff09\u4ee5\u53ca\u5728\u672a\u538b\u7f29\u5e8f\u5217\u5316\u4e2d\u6dfb\u52a0\u5230\u8fb9\u7684\u4efb\u4f55\u5176\u4ed6\u5c5e\u6027\u3002 \u5c5e\u6027\u7684\u5e8f\u5217\u5316\u8868\u793a\u66f4\u7b80\u5355\uff0c\u53ea\u5305\u542b\u5217\u4e2d\u5c5e\u6027\u7684\u952eID\u3002\u5c5e\u6027id\u548c\u5c5e\u6027\u503c\u5b58\u50a8\u5728\u503c\u4e2d\u3002 list() \u4f46\u662f\uff0c\u5982\u679c\u5c06\u5c5e\u6027\u952e\u5b9a\u4e49\u4e3a\uff0c\u5219\u5c5e\u6027id\u4e5f\u5b58\u50a8\u5728\u5217\u4e2d\u3002","title":"40.3. \u4e2a\u522b\u8fb9\u7f18\u5e03\u5c40"},{"location":"storage_backend/oracle_berkeley_DB_java/","text":"\u7b2c21\u7ae0Oracle Berkeley DB Java\u7248 Oracle Berkeley DB Java\u7248\u662f\u4e00\u4e2a\u5b8c\u5168\u7528Java\u7f16\u5199\u7684\u5f00\u6e90\uff0c\u53ef\u5d4c\u5165\uff0c\u4e8b\u52a1\u5b58\u50a8\u5f15\u64ce\u3002\u5b83\u5145\u5206\u5229\u7528Java\u73af\u5883\u6765\u7b80\u5316\u5f00\u53d1\u548c\u90e8\u7f72\u3002Oracle Berkeley DB Java\u7248\u7684\u4f53\u7cfb\u7ed3\u6784\u652f\u6301\u8bfb\u5bc6\u96c6\u578b\u548c\u5199\u5bc6\u96c6\u578b\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9ad8\u6027\u80fd\u548c\u5e76\u53d1\u6027\u3002 \u5728 Oracle Berkeley\u6570\u636e\u5e93Java\u7248 \u5b58\u50a8\u540e\u7aef\u5728\u540c\u4e00\u4e2aJVM\u8fd0\u884cJanusGraph\u548c\u4e00\u53f0\u673a\u5668\u4e0a\u63d0\u4f9b\u672c\u5730\u6301\u4e45\u6027\u3002\u56e0\u6b64\uff0cBerkeleyDB\u5b58\u50a8\u540e\u7aef\u8981\u6c42\u6240\u6709\u56fe\u5f62\u6570\u636e\u90fd\u9002\u5408\u672c\u5730\u78c1\u76d8\uff0c\u5e76\u4e14\u6240\u6709\u7ecf\u5e38\u8bbf\u95ee\u7684\u56fe\u5f62\u5143\u7d20\u90fd\u9002\u5408\u4e3b\u5b58\u50a8\u5668\u3002\u8fd9\u5bf9\u5546\u54c1\u786c\u4ef6\u4e0a\u5177\u670910-100\u4e07\u4e2a\u9876\u70b9\u7684\u56fe\u5f62\u65bd\u52a0\u4e86\u5b9e\u9645\u9650\u5236\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e\u8be5\u5927\u5c0f\u7684\u56fe\u5f62\uff0cBerkeleyDB\u5b58\u50a8\u540e\u7aef\u8868\u73b0\u51fa\u9ad8\u6027\u80fd\uff0c\u56e0\u4e3a\u6240\u6709\u6570\u636e\u90fd\u53ef\u4ee5\u5728\u540c\u4e00JVM\u4e2d\u672c\u5730\u8bbf\u95ee\u3002 21.1. BerkeleyDB JE\u8bbe\u7f6e \u7531\u4e8eBerkeleyDB\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u8fde\u63a5\u4e24\u8005\u53ea\u9700\u8981\u7b80\u5355\u7684\u914d\u7f6e\u800c\u65e0\u9700\u989d\u5916\u7684\u8bbe\u7f6e\uff1a JanusGraph g = JanusGraphFactory.build(). set( storage.backend , berkeleyje ). set( storage.directory , /data/graph ). open(); \u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002 21.2. BerkeleyDB\u7279\u5b9a\u914d\u7f6e \u6709\u5173\u9664\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\u5916\u7684\u6240\u6709BerkeleyDB\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 \u914d\u7f6eBerkeleyDB\u65f6\uff0c\u5efa\u8bae\u8003\u8651\u4ee5\u4e0bBerkeleyDB\u7279\u5b9a\u914d\u7f6e\u9009\u9879\uff1a \u00b7 transactions \uff1a\u542f\u7528\u4e8b\u52a1\u5e76\u68c0\u6d4b\u51b2\u7a81\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002 \u6ce8\u610f\uff1a \u5982\u679c\u591a\u4e2aJanusGraph\u5b9e\u4f8b\u4e0eBerkeleyDB\u7684\u540c\u4e00\u5b9e\u4f8b\u4ea4\u4e92\uff0c\u5219\u7981\u7528\u4e8b\u52a1\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u53ef\u80fd\u5bfc\u81f4\u4e0d\u4e00\u81f4\u751a\u81f3\u7834\u574f\u6570\u636e\u5e93\u3002 \u00b7 cache-percentage \uff1a\u8981\u4e3a\u5176\u7f13\u5b58\u5206\u914d\u7ed9BerkeleyDB\u7684JVM\u5806\u7a7a\u95f4\uff08\u901a\u8fc7-Xmx\u914d\u7f6e\uff09\u7684\u767e\u5206\u6bd4\u3002\u5c3d\u91cf\u7ed9BerkeleyDB\u5c3d\u53ef\u80fd\u591a\u7684\u7a7a\u95f4\uff0c\u800c\u4e0d\u4f1a\u7ed9JanusGraph\u5e26\u6765\u5185\u5b58\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5982\u679cJanusGraph\u4ec5\u8fd0\u884c\u77ed\u4e8b\u52a1\uff0c\u5219\u4f7f\u7528\u503c80\u6216\u66f4\u9ad8\u3002 21.3. \u7406\u60f3\u7684\u7528\u4f8b BerkeleyDB\u5b58\u50a8\u540e\u7aef\u6700\u9002\u5408\u4e2d\u5c0f\u5c3a\u5bf8\u56fe\u5f62\uff0c\u5728\u5546\u7528\u786c\u4ef6\u4e0a\u5177\u6709\u9ad8\u8fbe1\u4ebf\u4e2a\u9876\u70b9\u3002\u5bf9\u4e8e\u8be5\u5927\u5c0f\u7684\u56fe\u5f62\uff0c\u5b83\u53ef\u80fd\u4f1a\u63d0\u4f9b\u6bd4\u5206\u5e03\u5f0f\u5b58\u50a8\u540e\u7aef\u66f4\u9ad8\u7684\u6027\u80fd\u3002\u8bf7\u6ce8\u610f\uff0cBerkeleyDB\u5728\u53ef\u4ee5\u6709\u6548\u5904\u7406\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u91cf\u65b9\u9762\u4e5f\u53d7\u5230\u9650\u5236\uff0c\u56e0\u4e3a\u5b83\u5728\u5355\u4e2a\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u3002\u56e0\u6b64\uff0c\u5b83\u4e0d\u9002\u5408\u5177\u6709\u8bb8\u591a\u5e76\u53d1\u7528\u6237\u53d8\u5f02\u56fe\u5f62\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5373\u4f7f\u8be5\u56fe\u5f62\u662f\u5c0f\u5230\u4e2d\u7b49\u5927\u5c0f\u3002 \u7531\u4e8eBerkeleyDB\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u8be5\u5b58\u50a8\u540e\u7aef\u975e\u5e38\u9002\u5408\u4f7f\u7528JanusGraph\u5bf9\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u3002 21.4. \u5168\u5c40\u56fe\u64cd\u4f5c \u7531BerkeleyDB\u652f\u6301\u7684JanusGraph\u652f\u6301\u5168\u5c40\u56fe\u5f62\u64cd\u4f5c\uff0c\u4f8b\u5982\u8fed\u4ee3\u6240\u6709\u9876\u70b9\u6216\u8fb9\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u6b64\u7c7b\u64cd\u4f5c\u9700\u8981\u626b\u63cf\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u5927\u91cf\u65f6\u95f4\u6765\u5904\u7406\u8f83\u5927\u7684\u56fe\u5f62\u3002 \u4e3a\u4e86\u4e0d\u8017\u5c3d\u5185\u5b58\uff0c\u5efa\u8bae storage.transactions=false \u5728\u8fed\u4ee3\u5927\u56fe\u65f6\u7981\u7528transactions\uff08\uff09\u3002\u542f\u7528\u4e8b\u52a1\u9700\u8981BerkeleyDB\u83b7\u53d6\u6b63\u5728\u8bfb\u53d6\u7684\u6570\u636e\u7684\u8bfb\u9501\u5b9a\u3002\u5728\u904d\u5386\u6574\u4e2a\u56fe\u5f62\u65f6\uff0c\u8fd9\u4e9b\u8bfb\u53d6\u9501\u5b9a\u5f88\u5bb9\u6613\u9700\u8981\u6bd4\u53ef\u7528\u5185\u5b58\u66f4\u591a\u7684\u5185\u5b58\u3002","title":"21.Oracle Berkeley DB Java Edition"},{"location":"storage_backend/oracle_berkeley_DB_java/#21oracle-berkeley-db-java","text":"Oracle Berkeley DB Java\u7248\u662f\u4e00\u4e2a\u5b8c\u5168\u7528Java\u7f16\u5199\u7684\u5f00\u6e90\uff0c\u53ef\u5d4c\u5165\uff0c\u4e8b\u52a1\u5b58\u50a8\u5f15\u64ce\u3002\u5b83\u5145\u5206\u5229\u7528Java\u73af\u5883\u6765\u7b80\u5316\u5f00\u53d1\u548c\u90e8\u7f72\u3002Oracle Berkeley DB Java\u7248\u7684\u4f53\u7cfb\u7ed3\u6784\u652f\u6301\u8bfb\u5bc6\u96c6\u578b\u548c\u5199\u5bc6\u96c6\u578b\u5de5\u4f5c\u8d1f\u8f7d\u7684\u9ad8\u6027\u80fd\u548c\u5e76\u53d1\u6027\u3002 \u5728 Oracle Berkeley\u6570\u636e\u5e93Java\u7248 \u5b58\u50a8\u540e\u7aef\u5728\u540c\u4e00\u4e2aJVM\u8fd0\u884cJanusGraph\u548c\u4e00\u53f0\u673a\u5668\u4e0a\u63d0\u4f9b\u672c\u5730\u6301\u4e45\u6027\u3002\u56e0\u6b64\uff0cBerkeleyDB\u5b58\u50a8\u540e\u7aef\u8981\u6c42\u6240\u6709\u56fe\u5f62\u6570\u636e\u90fd\u9002\u5408\u672c\u5730\u78c1\u76d8\uff0c\u5e76\u4e14\u6240\u6709\u7ecf\u5e38\u8bbf\u95ee\u7684\u56fe\u5f62\u5143\u7d20\u90fd\u9002\u5408\u4e3b\u5b58\u50a8\u5668\u3002\u8fd9\u5bf9\u5546\u54c1\u786c\u4ef6\u4e0a\u5177\u670910-100\u4e07\u4e2a\u9876\u70b9\u7684\u56fe\u5f62\u65bd\u52a0\u4e86\u5b9e\u9645\u9650\u5236\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e\u8be5\u5927\u5c0f\u7684\u56fe\u5f62\uff0cBerkeleyDB\u5b58\u50a8\u540e\u7aef\u8868\u73b0\u51fa\u9ad8\u6027\u80fd\uff0c\u56e0\u4e3a\u6240\u6709\u6570\u636e\u90fd\u53ef\u4ee5\u5728\u540c\u4e00JVM\u4e2d\u672c\u5730\u8bbf\u95ee\u3002","title":"\u7b2c21\u7ae0Oracle Berkeley DB Java\u7248"},{"location":"storage_backend/oracle_berkeley_DB_java/#211-berkeleydb-je","text":"\u7531\u4e8eBerkeleyDB\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u8fde\u63a5\u4e24\u8005\u53ea\u9700\u8981\u7b80\u5355\u7684\u914d\u7f6e\u800c\u65e0\u9700\u989d\u5916\u7684\u8bbe\u7f6e\uff1a JanusGraph g = JanusGraphFactory.build(). set( storage.backend , berkeleyje ). set( storage.directory , /data/graph ). open(); \u5728Gremlin\u63a7\u5236\u53f0\u4e2d\uff0c\u60a8\u65e0\u6cd5\u5b9a\u4e49\u53d8\u91cf\u7684\u7c7b\u578b conf \u548c g \u3002\u56e0\u6b64\uff0c\u53ea\u9700\u7701\u7565\u7c7b\u578b\u58f0\u660e\u5373\u53ef\u3002","title":"21.1. BerkeleyDB JE\u8bbe\u7f6e"},{"location":"storage_backend/oracle_berkeley_DB_java/#212-berkeleydb","text":"\u6709\u5173\u9664\u5e38\u89c4JanusGraph\u914d\u7f6e\u9009\u9879\u5916\u7684\u6240\u6709BerkeleyDB\u7279\u5b9a\u914d\u7f6e\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c15\u7ae0\uff0c \u914d\u7f6e\u53c2\u8003 \u3002 \u914d\u7f6eBerkeleyDB\u65f6\uff0c\u5efa\u8bae\u8003\u8651\u4ee5\u4e0bBerkeleyDB\u7279\u5b9a\u914d\u7f6e\u9009\u9879\uff1a \u00b7 transactions \uff1a\u542f\u7528\u4e8b\u52a1\u5e76\u68c0\u6d4b\u51b2\u7a81\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u3002 \u6ce8\u610f\uff1a \u5982\u679c\u591a\u4e2aJanusGraph\u5b9e\u4f8b\u4e0eBerkeleyDB\u7684\u540c\u4e00\u5b9e\u4f8b\u4ea4\u4e92\uff0c\u5219\u7981\u7528\u4e8b\u52a1\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\uff0c\u4f46\u53ef\u80fd\u5bfc\u81f4\u4e0d\u4e00\u81f4\u751a\u81f3\u7834\u574f\u6570\u636e\u5e93\u3002 \u00b7 cache-percentage \uff1a\u8981\u4e3a\u5176\u7f13\u5b58\u5206\u914d\u7ed9BerkeleyDB\u7684JVM\u5806\u7a7a\u95f4\uff08\u901a\u8fc7-Xmx\u914d\u7f6e\uff09\u7684\u767e\u5206\u6bd4\u3002\u5c3d\u91cf\u7ed9BerkeleyDB\u5c3d\u53ef\u80fd\u591a\u7684\u7a7a\u95f4\uff0c\u800c\u4e0d\u4f1a\u7ed9JanusGraph\u5e26\u6765\u5185\u5b58\u95ee\u9898\u3002\u4f8b\u5982\uff0c\u5982\u679cJanusGraph\u4ec5\u8fd0\u884c\u77ed\u4e8b\u52a1\uff0c\u5219\u4f7f\u7528\u503c80\u6216\u66f4\u9ad8\u3002","title":"21.2. BerkeleyDB\u7279\u5b9a\u914d\u7f6e"},{"location":"storage_backend/oracle_berkeley_DB_java/#213","text":"BerkeleyDB\u5b58\u50a8\u540e\u7aef\u6700\u9002\u5408\u4e2d\u5c0f\u5c3a\u5bf8\u56fe\u5f62\uff0c\u5728\u5546\u7528\u786c\u4ef6\u4e0a\u5177\u6709\u9ad8\u8fbe1\u4ebf\u4e2a\u9876\u70b9\u3002\u5bf9\u4e8e\u8be5\u5927\u5c0f\u7684\u56fe\u5f62\uff0c\u5b83\u53ef\u80fd\u4f1a\u63d0\u4f9b\u6bd4\u5206\u5e03\u5f0f\u5b58\u50a8\u540e\u7aef\u66f4\u9ad8\u7684\u6027\u80fd\u3002\u8bf7\u6ce8\u610f\uff0cBerkeleyDB\u5728\u53ef\u4ee5\u6709\u6548\u5904\u7406\u7684\u5e76\u53d1\u8bf7\u6c42\u6570\u91cf\u65b9\u9762\u4e5f\u53d7\u5230\u9650\u5236\uff0c\u56e0\u4e3a\u5b83\u5728\u5355\u4e2a\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u3002\u56e0\u6b64\uff0c\u5b83\u4e0d\u9002\u5408\u5177\u6709\u8bb8\u591a\u5e76\u53d1\u7528\u6237\u53d8\u5f02\u56fe\u5f62\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u5373\u4f7f\u8be5\u56fe\u5f62\u662f\u5c0f\u5230\u4e2d\u7b49\u5927\u5c0f\u3002 \u7531\u4e8eBerkeleyDB\u5728\u4e0eJanusGraph\u76f8\u540c\u7684JVM\u4e2d\u8fd0\u884c\uff0c\u56e0\u6b64\u8be5\u5b58\u50a8\u540e\u7aef\u975e\u5e38\u9002\u5408\u4f7f\u7528JanusGraph\u5bf9\u5e94\u7528\u7a0b\u5e8f\u4ee3\u7801\u8fdb\u884c\u5355\u5143\u6d4b\u8bd5\u3002","title":"21.3. \u7406\u60f3\u7684\u7528\u4f8b"},{"location":"storage_backend/oracle_berkeley_DB_java/#214","text":"\u7531BerkeleyDB\u652f\u6301\u7684JanusGraph\u652f\u6301\u5168\u5c40\u56fe\u5f62\u64cd\u4f5c\uff0c\u4f8b\u5982\u8fed\u4ee3\u6240\u6709\u9876\u70b9\u6216\u8fb9\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u6b64\u7c7b\u64cd\u4f5c\u9700\u8981\u626b\u63cf\u6574\u4e2a\u6570\u636e\u5e93\uff0c\u8fd9\u53ef\u80fd\u9700\u8981\u5927\u91cf\u65f6\u95f4\u6765\u5904\u7406\u8f83\u5927\u7684\u56fe\u5f62\u3002 \u4e3a\u4e86\u4e0d\u8017\u5c3d\u5185\u5b58\uff0c\u5efa\u8bae storage.transactions=false \u5728\u8fed\u4ee3\u5927\u56fe\u65f6\u7981\u7528transactions\uff08\uff09\u3002\u542f\u7528\u4e8b\u52a1\u9700\u8981BerkeleyDB\u83b7\u53d6\u6b63\u5728\u8bfb\u53d6\u7684\u6570\u636e\u7684\u8bfb\u9501\u5b9a\u3002\u5728\u904d\u5386\u6574\u4e2a\u56fe\u5f62\u65f6\uff0c\u8fd9\u4e9b\u8bfb\u53d6\u9501\u5b9a\u5f88\u5bb9\u6613\u9700\u8981\u6bd4\u53ef\u7528\u5185\u5b58\u66f4\u591a\u7684\u5185\u5b58\u3002","title":"21.4. \u5168\u5c40\u56fe\u64cd\u4f5c"}]}